(function(e){function t(t){for(var o,n,i=t[0],l=t[1],c=t[2],u=0,h=[];u<i.length;u++)n=i[u],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&h.push(s[n][0]),s[n]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);d&&d(t);while(h.length)h.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],o=!0,i=1;i<a.length;i++){var l=a[i];0!==s[l]&&(o=!1)}o&&(r.splice(t--,1),e=n(n.s=a[0]))}return e}var o={},s={app:0},r=[];function n(t){if(o[t])return o[t].exports;var a=o[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=o,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var d=l;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0390":function(e,t,a){e.exports=a.p+"img/notfound2.86a0116d.png"},"0b1a":function(e,t,a){"use strict";a("bb5e")},"0d5a":function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id="0d5a"},"0d9d":function(e,t,a){"use strict";a("5a89"),a("2ef0"),a("2334"),a("3379")},"0ee7":function(e,t,a){"use strict";const o={getLastElement:function(e){if(Array.isArray(e))return e.slice(-1)[0]},getSecondLastElement:function(e){if(Array.isArray(e))return e.slice(-2,-1)[0]},removeFirstElement:function(e){if(Array.isArray(e))return e.shift(),e},removeLastElement:function(e){if(Array.isArray(e))return e.slice(0,e.length-1)},checkIfDuplicateExists:function(e){if(Array.isArray(e))return new Set(e).size!==e.length},removeDuplicates:(e=[])=>{const t=new Map;return e.forEach(e=>t.set(JSON.stringify(e),e)),e=[...t.values()],e},reverseSubArrays:function(e){for(var t=0;t<e.length;t++)e[t].reverse();return e},removeValueFromArray:function(e,t){for(var a=0;a<e.length;a++)e[a]==t&&e.splice(a,1);return e}};t["a"]=o},1:function(e,t){},"100f":function(e,t,a){"use strict";a("3e7c")},"114b":function(e,t,a){e.exports=a.p+"img/organization3.9ead0177.png"},"15b3":function(e,t,a){"use strict";a("3dc1")},1914:function(e,t,a){e.exports=a.p+"img/logo.e245e368.svg"},"1d0f":function(e,t,a){},"1dc8":function(e,t,a){},2:function(e,t){},"21cc":function(e,t,a){"use strict";var o=a("b33c"),s=a("4360"),r=a("fb26"),n=a("f973"),i=a("706e"),l=a("5c7d");const c=a("592d"),d=a("1157"),u=a("dae0"),h={isTrinApp:function(){return!!s["a"].state.crosslinkStatus},attribute:function(e,t,a){a||(a={}),a.quads||(a.quads=[]);var n=o["a"].getURI(e);s["a"].commit("blankNodeIncrement");var i=s["a"].state.blankNodeIndex;a.attribute=new u.BlankNode(i),e=c.sym(n);var d=o["a"].getURI(t);d?t=c.sym(d):"string"===typeof t?t=c.lit(t,null,r["g"].string):"number"===typeof t&&(t=c.lit(t,null,r["g"].integer));var h=new u.DefaultGraph;if(e&&t)return a.quads.push(c.st(a.attribute,r["b"].i_function,e,h)),a.quads.push(c.st(a.attribute,r["b"].o_result,t,h)),a;l["debug"]("c.attribute missing function or result",e,t)},state:function(e,t,a){if(e&&"object"!==d.type(e)&&(e=o["a"].getURI(e),e&&(e=c.sym(e))),t&&("object"===d.type(t)&&"BlankNode"===t.termType||"object"!==d.type(t)&&(t=o["a"].getURI(t),t&&(t=c.sym(t)))),e&&t){a||(a={}),a.quads||(a.quads=[]);var n=a.start,i=h.start(null,n,a);i.state=i.event,delete i.event,s["a"].commit("blankNodeIncrement");s["a"].state.blankNodeIndex;var g=new u.DefaultGraph;return a.quads.push(c.st(e,r["b"].i_entity,a.state,g)),a.quads.push(c.st(t,r["b"].i_attribute,a.state,g)),a}l["debug"]("c.state missing entity or attribute",e,t)},time:function(e,t){var a;return a=e?new Date(e):new Date,h.attribute(r["c"].TL("at"),c.lit(a.toISOString(),null,r["g"].dateTime),t)},start:function(e,t,a){var o=new u.DefaultGraph;if(a||(a={}),e&&a.event)!e&&a&&a.event&&(e=a.event);else{s["a"].commit("blankNodeIncrement");var n=s["a"].state.blankNodeIndex;e=new u.BlankNode(n)}if(a.startAttribute||(a=h.time(t,a),a.startAttribute=a.attribute,a.attribute=null),a.event||(a.event=e),a.startAttribute)return a.quads.push(c.st(e,r["b"].t_start,a.startAttribute,o)),a},capability:function(e,t,a){t=o["a"].getURI(t),e=o["a"].getURI(e);if(t&&e){var s=n["a"].capability(e,t);if(s)return{capability:s[0]};new u.DefaultGraph;a||(a={});var i=h.attribute(r["b"].b_capable,t,a),l=h.state(e,i.attribute,i);return l.capability=l.state,l}},event:function(e){if("object"===typeof e){var t=e.capability,a=e.start,s=(e.end,e.input),n=e.output;e.cause,e.effect;if(t){var i=o["a"].getURI(t);i&&(t="object"===typeof i?i:c.sym(i));var l=h.start(null,a,e);if(l.event)return l.quads.push(c.st(l.event,r["b"].t_execute,t)),s&&("array"!==d.type(s)&&(s=[s]),s.forEach((function(e){"object"!==d.type(e)&&(e=o["a"].getURI(e),e&&(e=c.sym(e))),e&&l.quads.push(c.st(e,r["b"].i_input,l.event))}))),n&&("array"!==d.type(n)&&(n=[n]),n.forEach((function(e){l.quads.push(c.st(l.event,r["b"].o_output,c.sym(o["a"].getURI(e))))}))),l}}},addStateForInput:function(e,t,a,s){e=o["a"].getURI(e),t=o["a"].getURI(t);var n=o["a"].getURI(a);if(n?a=c.sym(n):"string"===typeof a?a=c.lit(a,null,r["g"].string):"number"===typeof a&&(a=c.lit(Result,null,r["g"].integer)),e&&t&&a){s||(s={}),s.quads||(s.quads=[]),s.input||(s.input=[]);const o=h.attribute(t,a,s),r=h.state(e,o.attribute,o);return delete r.attribute,r.input=r.input.concat(r.state),delete r.state,r}l["error"]("Bad Input to c.addStateForInput",e,t,a,s)},getTrinpodFunction:function(e){switch(e){case"company":return r["e"].w_trinapp_add_business_pod.value;case"project":return r["e"].w_trinapp_add_project.value;case"building":return r["e"].w_trinapp_add_building.value;case"organization":return r["f"].f_add_organization_trinpod;case"site":return r["f"].f_add_site_trinpod;case"sub_org":return r["f"].f_add_suborg_trinpod;case"group":return r["f"].f_add_group_trinpod}},checkTrinpodID:async function(e){if(e)try{var t=await window.solid.session.fetch(s["a"].state.server+"/trinpodIDExists?trinpodID="+e,{credentials:"include"}),a=await t.text();return a}catch(o){console.log(o),l["debug"](o),h.trinpodIDLookupTimeout=null}else l["error"]("need trinpodID to check")},createTrinpods:async function(e){if(Array.isArray(e)&&e.length>0){var t=[],a=performance.now();for(const a of e){const e=await h.createTrinpod(a[0],a[1],a[2],a[3],a[4]);t.push(e),console.log(e)}var o=performance.now(),s=(o-a)/1e3;return["finished",t,s]}},createTrinpod:async function(e,t,a,n,c){if(e&&t&&o["a"].getURI(a)&&n){if(/^[a-z][a-z0-9\-]+$/.test(e)){var d=await h.checkTrinpodID(e);if("Exists"!==d){const d=o["a"].getSubdomain(a);if(d){const b=await h.checkTrinpodID(d);if(console.log("Parent pod: "+b),"Exists"===b){const d=new URL(s["a"].state.server),b=d.protocol+"//"+e+"."+d.host+"/i",v=o["a"].getBaseURI(a),y=h.getTrinpodFunction(n);if(y&&v&&b){var u=h.capability(s["a"].state.webId,y);u=h.addStateForInput(b,r["b"].m_label,t,u),u=h.addStateForInput(b,r["c"].FOAF("maker"),a,u);var g=r["c"].NEO("a_pod-solid");"construction"===c&&(g=r["c"].NEO("a_pod-construction")),u=h.addStateForInput(b,r["c"].RDF("type"),g,u);const n=h.event(u),i=h.quadsToTurtle(n.quads);var m=performance.now();await window.solid.session.fetch(o["a"].getBaseURI(a)+"/node/Substance",{credentials:"include",method:"PATCH",body:"INSERT DATA {"+i+"}",headers:{"Content-Type":"application/sparql-update"}});var p=performance.now(),f=(p-m)/1e3;return["created",{uri:b,trinpodID:e,duration:f}]}return l["error"]("could not build pod info",{trinpodFunction:y,podNodeURI:v,trinpodUri:b}),h.createAlert("Error:","Could not build Pod information","TrinPod Function: "+i["a"].getLabel(y)+" , Parent uri: "+v+" , TrinPod uri: "+b,"danger",!0,!0,"pageMessages"),["error","could not build pod info",{trinpodFunction:y,podNodeURI:v,trinpodUri:b}]}return l["error"]("Unable to find parent pod",{parentId:d,parentPod:a,trinpodID:e}),h.createAlert("Error:","Unable to find Parent TrinPod","Parent TrinPod: "+a+" , New TrinPod user: "+e,"danger",!0,!0,"pageMessages"),["error","Unable to find parent pod",{parentId:d,parentPod:a,trinpodID:e}]}return l["error"]("Unable to make parentId",{parentPod:a,trinpodID:e}),h.createAlert("Error:","Unable to make parentId","Parent TrinPod: "+a+" , New TrinPod user: "+e,"danger",!0,!0,"pageMessages"),["error","Unable to make parentId",{parentPod:a,trinpodID:e}]}return l["error"]("That trinpodID is already being used:",e),h.createAlert("Error:","That TrinPod ID is already being used","Parent TrinPod: "+e,"danger",!0,!0,"pageMessages"),["error","That trinpodID is already being used:",e]}return l["error"]("Invalid trinpodID /^[a-z][a-z0-9-]+$/.test(trinpodID)",e),h.createAlert("Error:","Invalid TrinPod ID","ID must start with a letter and can include any letters or numbers","danger",!0,!0,"pageMessages"),["error","Invalid trinpodID /^[a-z][a-z0-9-]+$/.test(trinpodID)",e]}return l["error"]("missing information to build pod",{trinpodID:e,trinpodName:t,parentPod:a,trinpodType:n}),h.createAlert("Error:","Missing information to build Pod","TrinPod ID: "+e+" , Name: "+t+" , Parent TrinPod: "+a+" ,Type: "+n,"danger",!0,!0,"pageMessages"),["error","missing information to build pod",{trinpodID:e,trinpodName:t,parentPod:a,trinpodType:n}]},addMember:async function(e,t,a){var n=performance.now();const c=await i["a"].validateWebId(e);if("string"===typeof t&&(t=[t]),Array.isArray(t)&&t.length>0){var d=[],u=[],g=[];if(c){if(!a||a&&(i["a"].isPodBusiness(e)||i["a"].isPodOrganization(e))){var m=i["a"].getMember(e);if(Array.isArray(m)||(m=[]),i["a"].isPodProject(e)||i["a"].isPodBusiness(e)||i["a"].isPodOrganization(e)||i["a"].isPodGroup(e)){if(await Promise.all(t.map(async t=>{const a=await i["a"].validateWebId(t);a?m.includes(t)?(l["error"]("Already a member",{memberWebId:t,parentWebid:e}),g.push(t)):d.push(t):(l["error"]("Invalid member",t),u.push(t))})),g.length>0)return l["error"]("Existing members included",{parentWebid:e,alreadyMember:g,invalidMembers:u}),h.createAlert("Error:","Existing members included","Parent: "+e+" , Existing: "+alreadyMembers.join(),"danger",!0,!0,"pageMessages"),["error","Existing members included",{parentWebid:e,alreadyMember:g,invalidMembers:u}];if(u.length>0)return l["error"]("Invalid member webids included",{parentWebid:e,alreadyMember:g,invalidMembers:u}),h.createAlert("Error:","Existing member webids included","Parent: "+e+" , Invalid: "+u.join(),"danger",!0,!0,"pageMessages"),["error","Invalid member webids included",{parentWebid:e,alreadyMember:g,invalidMembers:u}];var p;p=a?r["e"].w_trinapp_add_employee.value:r["e"].w_trinapp_add_member.value;var f=h.capability(s["a"].state.webId,p);if(f){for(const o of d)f=h.addStateForInput(e,r["c"].VCARD("hasMember"),o,f);const t=h.event(f),a=h.quadsToTurtle(t.quads);await window.solid.session.fetch(o["a"].getBaseURI(e)+"/node/Substance",{credentials:"include",method:"PATCH",body:"INSERT DATA {"+a+"}",headers:{"Content-Type":"application/sparql-update"}});var b=performance.now(),v=(b-n)/1e3;return["added",{members:d,parentWebid:e,duration:v}]}return l["error"]("User does not have required capability",{user:s["a"].state.webId,Function:p}),h.createAlert("Error:","Your webid does not have required capability","Webid: "+s["a"].state.webid+" , Function: "+i["a"].getLabel(p),"danger",!0,!0,"pageMessages"),["error","User does not have required capability",{user:s["a"].state.webId,Function:p}]}return l["error"]("Parent Pod type does not have members",e),h.createAlert("Error:","Parent Pod type does not have members","Parent Webid: "+e,"danger",!0,!0,"pageMessages"),["error","Parent Pod type does not have members",e]}return l["error"]("Parent Pod type does not have employees",e),h.createAlert("Error:","Parent Pod type does not have employees","Parent Webid: "+e,"danger",!0,!0,"pageMessages"),["error","Parent Pod type does nt have employees",e]}return l["error"]("Invalid parentWebid",{parentWebid:e,memberWebids:t}),h.createAlert("Error:","Invalid Parent Webid","Parent Webid: "+e,"danger",!0,!0,"pageMessages"),["error","Invalid parentWebid",{parentWebid:e,memberWebids:t}]}return l["error"]("Invalid memberWebids",{parentWebid:e,memberWebids:t}),h.createAlert("Error:","Invalid Member Webids","Member Webids: "+t.join(),"danger",!0,!0,"pageMessages"),["error","Invalid memberWebids",{parentWebid:e,memberWebids:t}]},createContainer:async function(e,t,a){var o=performance.now();if("string"===typeof a){const c=await i["a"].validateWebId(e);if(!c)return l["error"]("Invalid podWebid",{podWebid:e,parentContainer:t,name:a}),h.createAlert("Error:","Invalid Pod Webid","Pod: "+e+" , Parent Container: "+t+" , Name: "+a,"danger",!0,!0,"pageMessages"),["error","Invalid podWebid",{podWebid:e,parentContainer:t,name:a}];if(await i["a"].aLoadURI(t),!i["a"].isContainer(t))return l["error"]("Invalid parentContainer",{podWebid:e,parentContainer:t,name:a}),h.createAlert("Error:","Invalid Parent Container","Pod: "+e+" , Parent Container: "+t+" , Name: "+a,"danger",!0,!0,"pageMessages"),["error",{podWebid:e,parentContainer:t,name:a}];{const e=t+encodeURIComponent(a)+"/";if(i["a"].isContainer(e)){var s=performance.now(),r=(s-o)/1e3;return["exists",{containerUri:e,duration:r}]}try{const t=await window.solid.session.fetch(e,{method:"PUT",body:'<> <http://www.w3.org/2000/01/rdf-schema#label> "'+decodeURIComponent(a)+'" .',headers:{"Content-Type":"text/turtle",link:'<http://www.w3.org/ns/ldp#Container>; rel="type", <http://www.w3.org/ns/ldp#BasicContainer>; rel="type"'}});if(t.ok){s=performance.now(),r=(s-o)/1e3;return["created",{uri:t.url,duration:r}]}throw t.status+" "+t.statusText}catch(n){alert(n)}}}},count:0,uploadSize:0,totalSize:0,toUploadCount:0,allNodes:[],importDirectoryTree:async function(e,t){l["debug"]("importDirectory",e,t),t||(t="/home/");var a=performance.now();e||(e=s["a"].state.webId);const n=h.isTrinApp(),u=c.blankNode(),g=await window.showDirectoryPicker(),m=c.blankNode(),p=new JSZip;if("object"!==d.type(g)||"directory"!==g.kind||!g.name)return l["error"]("Cound not resove directory",{rootFolder:g}),["error","Cound not resove directory",{rootFolder:g}];m.path=encodeURIComponent(g.name)+"/",m.pod=e,m.handle=g;var f=[];rdfStore.add(m,r["c"].RDF("type"),r["c"].LDP("BasicContainer"),u),rdfStore.add(m,r["c"].RDFS("label"),"Root",u),rdfStore.add(m,r["c"].NEO("m_folder"),"/home/"+g.name+"/",u);for await(const o of g.values())f.push(await h.importDirectoryRecurse(m,o,u,f)),l["debug"](o.kind,o.name);var b=performance.now(),v=(b-a)/1e3;const y=i["a"].getContents(m);y||(y=m),h.count=0;for(const o of y){const e=i["a"].getContentsNested(o);Array.isArray(e)&&e.length>0&&e.forEach(e=>{e.permUri||"file"===e.handle.kind&&(h.totalSize+=e.size,h.count+=1)})}h.uploadSize=h.totalSize,h.toUploadCount=h.count;for(const o of y){const e=i["a"].getContentsNested(o);var w=[];if(Array.isArray(e)&&e.length>0&&(e.forEach(e=>{e.permUri||"file"===e.handle.kind&&w.push(e)}),h.appMessage(""),w.length>0)){for(const e of w){var I=i["a"].getContainer(e);if("object"===d.type(I)&&(I=I.name),"string"!==typeof I&&(I=decodeURIComponent(e.path.split("/").reverse()[1])),"file"===e.handle.kind){if(n){const t=await e.handle.getFile();p.file(e.path,t,{date:new Date(t.lastModifiedDate)})}else h.appMessage("Uploading: "+Math.round(100-h.uploadSize/h.totalSize*100)+"% ("+(h.count-h.toUploadCount)+" of "+h.count+")<br>"+I+"<br>"+e.name),await h.uploadFile(e,null,null,null,t);h.toUploadCount-=1,h.uploadSize=h.uploadSize-e.size,l["debug"]("item",e,i["a"].getContainer(e))}}h.appMessage("")}}if(l["debug"]("zip",p),n)try{var S=o["a"].getBaseURI(e)+t,R=await p.generateAsync({type:"uint8array"});await window.solid.session.fetch(S,{method:"PUT",body:R,headers:{link:'<https://trinity.graphmetrix.net/node/t_2qv>; rel="type"'}});h.createAlert("Please Note:","I will send you an email notification when the bulk upload is complete","","success",!0,!0,"pageMessages")}catch(A){alert(A)}return rdfStore.removeMatches(null,null,null,u),["imported",{rootNode:m,toUpload:w,uploadSize:h.uploadSize,where:u,errors:f.flat(),duration:v}]},appMessage:function(e){""===e&&(e=null),!0===h.isTrinApp()&&s["a"].commit("apiMessage",e)},importDirectoryRecurse:async function(e,t,a,o){const s=await h.importHandleNode(t,a,o,e);if(Array.isArray(s)){const n=s[0],i=s[1];if("object"===d.type(i))if(o=i.errors,"object"===d.type(n)&&"BlankNode"===n.termType){rdfStore.add(e,r["c"].LDP("contains"),n,a);const i=s[1].kind;if(i&&"directory"===i)for await(const e of t.values())o.push(await h.importDirectoryRecurse(n,e,a,o.flat()))}else l["error"]("Unable to create handle node",{parentNode:e,handle:t,where:a}),h.createAlert("Error:","Unable to create handle node","Kind: "+t.kind+" , Name: "+t.name,"danger",!0,!0,"pageMessages"),o.push(["error","Unable to create handle node",{parentNode:e,handle:t,where:a}]);else l["error"]("Bad object returned from importHandleNode",{parentNode:e,node:n,handleResults:s,handle:t,where:a}),h.createAlert("Error:","Bad object returned from import","Parent: "+e.name+" , Node: "+n.name,"danger",!0,!0,"pageMessages"),o.push(["error","Bad object returned from importHandleNode",{parentNode:e,node:n,handleResults:s,handle:t,where:a}])}else l["error"]("Unable to get importHandleNode results",{parentNode:e,handle:t,where:a}),h.createAlert("Error:","Unable to get import results","Parent: "+e.name,"danger",!0,!0,"pageMessages"),o.push(["error","Unable to get importHandleNode results",{parentNode:e,handle:t,where:a}]);return o.flat()},importHandleNode:async function(e,t,a,o){const s=c.blankNode();s.handle=e,h.count=h.count+1,h.allNodes.push(s),s.pod=o.pod;const n=e.name;var i="";for(let r of n){var d=r.codePointAt(0);switch(d>300&&(s.encodingIssue=n),d){case 1089:i+="ß",delete s.encodingIssue;break;case 1044:i+="ä",delete s.encodingIssue;break;case 1054:i+="Ä",delete s.encodingIssue;break;case 1041:i+="ü",delete s.encodingIssue;break;case 1066:i+="Ü",delete s.encodingIssue;break;case 1060:i+="ö",delete s.encodingIssue;break;case 1065:i+="Ö",delete s.encodingIssue;break;case 1042:i+="é",delete s.encodingIssue;break;default:i+=r;break}}s.name=i;const u=e.kind;s.path=o.path+encodeURIComponent(s.name);var g,m=o.path+s.name;if(rdfStore.add(s,r["c"].NEO("m_folder"),m,t),"directory"===u)g=r["c"].LDP("BasicContainer"),s.path=s.path+"/";else if("file"===u){g=r["c"].REG("file");const t=await e.getFile(e);s.size=t.size,s.modified=t.lastModified,s.mimeType=t.type}return g?rdfStore.add(s,r["c"].RDF("type"),g,t):(l["error"]("Unable to determine type",{handle:e,node:s,name:n,kind:u}),h.createAlert("Error:","Unable to determine type","Name: "+n+" , Kind: "+u,"danger",!0,!0,"pageMessages"),a.push(["error","Unable to determine type",{handle:e,node:s,name:n,kind:u}])),n?rdfStore.add(s,r["c"].RDFS("label"),n,t):(l["error"]("Unable to determine name",{handle:e,node:s,name:n,kind:u}),h.createAlert("Error:","Unable to determine name","Node: "+s.value+" , Kind: "+u,"danger",!0,!0,"pageMessages"),a.push(["error","Unable to determine name",{handle:e,node:s,name:n,kind:u}])),[s,{name:n,kind:u,errors:a.flat()}]},uploadFile:async function(e,t,a,r,n){n||(n="/home/");var c,u,g=performance.now();if(o["a"].isBlankNode(e)){!0,c=e.handle,a=e.name;r=e.pod;r?e.name&&(a=e.name):r=s["a"].state.webId;var m=e.path;if(!m)return l["error"]("Could not find upload directory path",{handleOrBlank:e,containerNode:t,name:a,pod:r}),h.createAlert("Error:","Could not find upload directory path","File: "+a,"danger",!0,!0,"pageMessages"),["error","Could not find upload directory path",{handleOrBlank:e,containerNode:t,name:a,pod:r}];u=o["a"].getBaseURI(r)+n+m}else i["a"].isContainer(t)&&!o["a"].isBlankNode(t)&&(c=e,u=o["a"].getURI(t)+encodeURIComponent(a));if(!u)return l["error"]("Unable to resove request uri",{handleOrBlank:e,containerNode:t,handle:c,name:a,pod:r}),h.createAlert("Error:","Unable to resove request uri","Container: "+o["a"].getURI(t)+" , File: "+a,"danger",!0,!0,"pageMessages"),["error","Unable to resove request uri",{handleOrBlank:e,containerNode:t,handle:c,name:a,pod:r}];if("object"!==d.type(c))return l["error"]("Invalid file handle",{containerNode:t,handle:c,name:a}),h.createAlert("Error:","Unable to retrieve file","Container: "+o["a"].getURI(t)+"Path: "+m+" , File: "+a,"danger",!0,!0,"pageMessages"),["error","Invalid file handle",{containerNode:t,handle:c,name:a}];if("file"!==c.kind)return l["error"]("Handle is not a file",{containerNode:t,handle:c,name:a}),h.createAlert("Error:","Handle is not a file","Path: "+m+" , File: "+a,"danger",!0,!0,"pageMessages"),["error","Handle is not a file",{containerNode:t,handle:c,name:a}];var p=await c.getFile();if("object"!==d.type(p)||!p.size)return l["error"]("Unable to retrieve file",{containerNode:t,handle:c,file:p,name:a}),h.createAlert("Error:","Unable to retrieve file","Path: "+m+" , File: "+a,"danger",!0,!0,"pageMessages"),["error","Unable to retrieve file",{containerNode:t,handle:c,file:p,name:a}];if(p=await p.arrayBuffer(),p=await new Uint8Array(p),!o["a"].checkURL(u))return l["error"]("Unable to resolve container uri",{handleOrBlank:e,newUri:u,containerNode:t,handle:c,name:a,pod:r}),h.createAlert("Error:","Unable to resolve container uri","Path: "+m+" , File: "+a,"danger",!0,!0,"pageMessages"),["error","Unable to resolve container uri",{handleOrBlank:e,newUri:u,containerNode:t,handle:c,name:a,pod:r}];try{var f=await window.solid.session.fetch(u,{method:"PUT",body:p});if(new RegExp("^2..$").test(f.status)){var b=performance.now(),v=(b-g)/1e3,y=await f.headers.get("Content-Location");o["a"].isBlankNode(e)&&(e.permUri=y);var w=[f.statusText,{result:f,uri:y,duration:v}];return l["debug"](w),w}return void alert("Upload failed:"+f.status+" - "+f.statusText)}catch(I){alert(I)}},quadsToTurtle:function(e){if(e&&Array.isArray(e)){var t,a=[],o={},s=new u.DefaultGraph;e.forEach((function(e){e.graph=s,a.push(e)})),o.solid=r["c"].SOLID().value,o.neo=r["c"].NEO().value,o.ldp=r["c"].LDP().value,o.rdf=r["c"].RDF().value,o.rdfs=r["c"].RDFS().value,o.sio=r["c"].SIO().value,o.acl=r["c"].ACL().value,o.vcard=r["c"].VCARD().value;const n=new u.Writer({prefixes:o});return n.addQuads(e),n.end((e,a)=>t=a),t}},createReadTriple:function(e){s["a"].commit("blankNodeIncrement");const t=s["a"].state.blankNodeIndex;var a=new u.BlankNode(t);const o=[],n=new u.DefaultGraph;return o.push(c.st(a,r["c"].ACL("accessTo"),c.sym(e),n)),o.push(c.st(a,r["c"].ACL("agentClass"),r["c"].FOAF("Agent"),n)),o.push(c.st(a,r["c"].ACL("mode"),r["c"].ACL("Read"),n)),o.push(c.st(a,r["c"].RDF("type"),r["c"].ACL("Authorization"),n)),o},createAlert:function(e,t,a,o,s,r,n){var i={info:"fa fa-info-circle",success:"fa fa-thumbs-up",warning:"fa fa-exclamation-triangle",danger:"fa ffa fa-exclamation-circle"},l=!1,c=["alert","animated","flipInX"];c.push("alert-"+o.toLowerCase()),s&&c.push("alert-dismissible");var u=d("<i />",{class:i[o]}),h=d("<div />",{class:c.join(" ")});if(e){var g=d("<h4 />",{html:e}).appendTo(h);l||(g.prepend(u),l=!0)}if(t){var m=d("<strong />",{html:t}).appendTo(h);l||(m.prepend(u),l=!0)}if(a){var p=d("<p />",{html:a}).appendTo(h);l||(p.prepend(u),l=!0)}if(s)d("<span />",{class:"close","data-dismiss":"alert",html:"<i class='fa fa-times-circle'></i>"}).appendTo(h);d("#"+n).prepend(h),r&&setTimeout((function(){h.addClass("flipOutX"),setTimeout((function(){h.remove()}),5e3)}),6e3)}};t["a"]=h},2382:function(e,t,a){"use strict";a("ba66")},"27e7":function(e,t,a){"use strict";a("afe7")},2994:function(e,t,a){"use strict";a("c57d")},"2ae3":function(e,t,a){e.exports=a.p+"img/geometry2.f313f08d.png"},3:function(e,t){},"348e":function(e,t,a){},"34d2":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"viewport",staticStyle:{position:"relative"},attrs:{id:"viewport",scroll:"no"}},[o("div",{staticStyle:{position:"absolute",top:"30px",left:"35px"}},[e.getSelectedRoomName?o("v-btn",{staticClass:"white--text",attrs:{color:"#3577cb"}},[e._v(" "+e._s(e.getSelectedRoomName)+" ")]):e._e(),o("v-slider",{staticStyle:{width:"150px"},attrs:{"thumb-label":"always",max:2,min:1,step:1},model:{value:e.floorSplitFactor,callback:function(t){e.floorSplitFactor=t},expression:"floorSplitFactor"}}),o("v-switch",{attrs:{label:"GLTF geometry",color:"blue","hide-details":""},model:{value:e.gltfGeoVisible,callback:function(t){e.gltfGeoVisible=t},expression:"gltfGeoVisible"}}),o("v-switch",{attrs:{label:"Show spaces",color:"blue","hide-details":""},model:{value:e.spacesVisible,callback:function(t){e.spacesVisible=t},expression:"spacesVisible"}})],1),e.ifcloading?o("div",{attrs:{id:"text-container"}},[o("p",[e._v("Progress: "+e._s(e.ifcloadpercentage)+"%")])]):e._e(),o("div",{attrs:{id:"toolBar"}},[o("div",{staticClass:"toolbar-tools"},[e._m(0),o("div",{staticClass:"tool-separator",attrs:{id:"tool_separator_1"}}),e.twodim?e._e():o("button",{staticClass:"menubutton",attrs:{id:"twodim-button",title:"2D",data_operatorclass:"toolbar-orthograpic"},on:{click:e.setup2dview}},[o("img",{attrs:{src:a("81a4")}})]),e.twodim?o("button",{staticClass:"menubutton",attrs:{id:"threedim-button",title:"3D",data_operatorclass:"toolbar-perspective"},on:{click:e.setup2dview}},[o("img",{attrs:{src:a("bfe7")}})]):e._e(),o("div",{staticClass:"tool-separator",attrs:{id:"tool_separator_2"}}),e.twodim?e._e():o("button",{staticClass:"menubutton",attrs:{id:"redline-button",title:"Rotate",data_operatorclass:"toolbar-redline-note"},on:{click:e.toggleRotation}},[o("img",{attrs:{src:e.icon_rotate}})]),o("button",{staticClass:"menubutton",attrs:{id:"click-button",title:"Multiselect"},on:{click:e.multiSelect}},[o("img",{attrs:{src:e.icon_click}})]),e.twodim?e._e():o("button",{staticClass:"menubutton",attrs:{id:"camera-button",title:"Walkmode"},on:{click:e.setupPersonView}},[o("img",{attrs:{src:e.icon_camera}})]),o("div",{staticClass:"tool-separator",attrs:{id:"tool_separator_4"}}),e.twodim?e._e():o("button",{staticClass:"menubutton",attrs:{id:"snapshot-button",title:"Snapshot",data_operatorclass:"toolbar-snapshot"},on:{click:e.moveToObject}},[o("img",{attrs:{src:a("7a13")}})]),o("button",{staticClass:"menubutton",attrs:{id:"map-button",title:"Map"},on:{click:e.toggleMap}},[o("img",{attrs:{src:a("5410")}})]),o("button",{staticClass:"menubutton",attrs:{id:"settings-button",title:"Settings",data_operatorclass:"toolbar-settings"},on:{click:function(e){}}},[o("img",{attrs:{src:a("4382")}})])])]),o("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.labelDialog,callback:function(t){e.labelDialog=t},expression:"labelDialog"}},[o("v-card",{staticStyle:{"text-align":"left"}},[o("v-card-text",[o("v-container",{staticStyle:{"background-color":"white"}},[o("v-row",[o("h2",[e._v(e._s(e.$t("text_create_issue")))])]),o("v-row",[o("v-text-field",{attrs:{label:e.$t("text_title")},model:{value:e.labelObject.title,callback:function(t){e.$set(e.labelObject,"title",t)},expression:"labelObject.title"}})],1),o("v-row",[o("v-text-field",{attrs:{label:e.$t("text_description")},model:{value:e.labelObject.description,callback:function(t){e.$set(e.labelObject,"description",t)},expression:"labelObject.description"}})],1),o("v-row",[o("h3",[e._v(e._s(e.$t("text_issue_tags")))]),o("br"),o("v-select",{attrs:{items:e.labelTagList,label:e.$t("text_all"),multiple:"",chips:"",solo:""},model:{value:e.labelObject.tags,callback:function(t){e.$set(e.labelObject,"tags",t)},expression:"labelObject.tags"}})],1),o("v-row",[o("h3",[e._v(e._s(e.$t("text_issue_responsible")))]),o("br"),o("v-select",{attrs:{items:e.employeeNameList,"menu-props":"auto",label:"Select","hide-details":"","prepend-icon":"mdi-account","single-line":""},model:{value:e.labelObject.responsible,callback:function(t){e.$set(e.labelObject,"responsible",t)},expression:"labelObject.responsible"}})],1),o("v-row",[o("div",{staticStyle:{"margin-top":"60px"}},[o("h3",[e._v(e._s(e.$t("text_photo")))])]),o("div",{staticStyle:{width:"200px","margin-top":"10px"}},[o("vue-image-chooser",{staticStyle:{width:"200px",height:"150px"},attrs:{name:"image-chooser",progress:e.progress,error:e.error},on:{change:e.uploadImage}})],1)])],1)],1),o("v-card-actions",[o("v-spacer"),o("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.labelDialog=!1}}},[e._v(e._s(e.$t("text_cancel")))]),o("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return e.createLabel()}}},[e._v(e._s(e.$t("text_create")))]),e.loading?o("v-progress-circular",{staticStyle:{width:"20px",height:"20px","margin-left":"5px","margin-right":"5px"},attrs:{indeterminate:"",color:"primary"}}):e._e()],1)],1)],1)],1)},s=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("button",{staticClass:"menubutton",attrs:{id:"home-button",title:"Reset Camera",data_operatorclass:"toolbar-home"}},[o("img",{attrs:{src:a("9a79")}})])}],r=a("a026"),n=a("2f62"),i=a("4360"),l=a("db38"),c=(a("78f0"),a("0d9d"),a("0ee7"),a("b827")),d=a("b33c"),u=a("706e"),h=a("fb26"),g=a("d8d8"),m=a("7fff"),p=(a("b91f"),a("5a89")),f=a("a2ed"),b=(a("05b2"),a("00ce")),v=(a("ec14"),a("85ce")),y=a("e90a"),w=a("0dbf"),I=a("34ad"),S=a("aea1");const R={};r["default"].use(l["a"]);const A=a("592d"),E=new b["a"];E.ifcManager.setupThreeMeshBVH(w["b"],w["c"],w["a"]);const x="pk.eyJ1IjoibWFydGhpbmkiLCJhIjoiY2w1ejBnYnpvMDlvYTNvcnlyN3B5YXNxeCJ9.FOG1KIIZzpyVWoNJkpcFkA";async function _(){console.log("Initialize multithreading.."),await E.ifcManager.useWebWorkers(!0,"../IFCWorker.js"),await E.ifcManager.setWasmPath("../")}async function j(e,t){const a=E.ifcManager.getAllItemsOfType(e,t);return a}function T(e,t,a){i["a"].state.rs.tempRdfStore.add(e,t,a,A.default),i["a"].state.rs.rdfStore.add(e,t,a,A.default)}R.zoomToObject=function(){var e=null,t=null,a=5,o=5;i["a"].state.bv.animate=!0,e=i["a"].state.bv.INTERSECTED?(new p["i"]).setFromObject(i["a"].state.bv.INTERSECTED):(new p["i"]).setFromObject(i["a"].state.bv.focusobject);var s=new p["uc"];let r,n;s=e.getSize(s),s.x>=s.y?i["a"].state.bv.camerafocuswidth=s.x:i["a"].state.bv.camerafocuswidth=s.y;var l=5e3;if(i["a"].state.bv.INTERSECTED){var c=new p["uc"];i["a"].state.bv.INTERSECTED.getWorldPosition(c),o=c.y,console.log(c.x),console.log(c.z),t=c.x+.5*i["a"].state.bv.camerafocuswidth,a=c.z+.5*i["a"].state.bv.camerafocuswidth,i["a"].state.bv.controls3d.target.set(c.x+s.x/2,c.y+s.y/2,c.z-s.z/2)}else t=i["a"].state.bv.coords.x+.5*i["a"].state.bv.camerafocuswidth,a=-i["a"].state.bv.coords.y+.5*i["a"].state.bv.camerafocuswidth,i["a"].state.bv.controls3d.target.set(i["a"].state.bv.coords.x,i["a"].state.bv.coords.y,i["a"].state.bv.coords.z);function d(e){void 0===r&&(r=e);n!==e&&(l>=o+40&&(l-=60),i["a"].state.bv.camera.position.set(t,l,a)),l>=o+40?(n=e,window.requestAnimationFrame(d)):i["a"].state.bv.autorotate||setTimeout((function(){i["a"].state.bv.animate=!1}),5e3)}window.requestAnimationFrame(d),i["a"].state.bv.camera.position.set(t,l,a),console.log("Zoom to object")},R.moveToObject=function(){var e=new p["uc"],t=new p["uc"],a=new p["uc"],o=(new p["i"]).setFromObject(i["a"].state.bv.INTERSECTED);let s,r;i["a"].state.bv.animate=!0,t=o.getSize(t),a=o.getCenter(a),console.log("SizeX:"+t.x+" SizeY:"+t.y),t.x>=t.y?i["a"].state.bv.camerafocuswidth=t.x:i["a"].state.bv.camerafocuswidth=t.y;i["a"].state.bv.INTERSECTED.getWorldPosition(e);var n=a.x+(15+.5*i["a"].state.bv.camerafocuswidth),l=a.y+(15+.5*i["a"].state.bv.camerafocuswidth),c=a.z+(15+.5*i["a"].state.bv.camerafocuswidth),d=a.x,u=a.y,h=a.z,g=i["a"].state.bv.camera.position.x,m=i["a"].state.bv.camera.position.z,f=i["a"].state.bv.camera.position.y,b=i["a"].state.bv.controls3d.target.x,v=i["a"].state.bv.controls3d.target.y,y=i["a"].state.bv.controls3d.target.z,w=2,I=g,S=m,R=f,A=b,E=v,x=y;function _(e){void 0===s&&(s=e);r!==e&&(I-=(g-n)/15,S-=(m-c)/15,R-=(f-l)/15,A-=(b-d)/15,E-=(v-u)/15,x-=(y-h)/15,i["a"].state.bv.camera.position.set(I,R,S),i["a"].state.bv.controls3d.target.set(A,E,x)),w<=15?(r=e,w+=1,window.requestAnimationFrame(_)):i["a"].state.bv.autorotate||(i["a"].state.bv.animate=!1)}window.requestAnimationFrame(_),console.log("Zoom to object")};var F={bw:R,name:"BIMViewer",data(){return{height:0,autoRotate:!0,bval:-.01,file:"",colors:!1,viewerWindow:null,labelDialog:!1,labelLocation:null,loading:!1,labelTagList:["Bug","Warning","Info","Unknown"],labelObject:{title:"",description:"",tags:["Unknown"],responsible:"",imageuri:""},employeeNameList:["https://espen.trinpod.us/i"],employeeList:["Espen Marthiniussen"],background:"#ffff00",ifcloadpercentage:"0",ifcloading:!1,progress:null,error:null,floorSplitFactor:1,gltfGeoVisible:!1,spacesVisible:!1,buildingLat:0,scaleFactor:1,container:void 0,preselectMat:void 0,preselectModel:void 0,previousSelectedRoom:void 0,twodim:!0,icon_home:a("9a79"),icon_camera:a("4635"),icon_rotate:a("a142"),icon_click:a("9ce8"),icon_edgeface:a("b737"),icon_cuttingplane:a("bc83")}},methods:{...Object(n["c"])("bv",["RESIZE"]),...Object(n["b"])("bv",["INIT","ANIMATE","RENDER","CALL_RAYCAST","CONVERT_TO_UTM","CONVERT_FROM_UTM","CONVERT_TO_SPHERICAL","ADD_TO_SCENE","INITIALIZE_PLAYER"]),addEventListerners(){document.addEventListener("dblclick",this.pickFromIFC,!1),document.addEventListener("keyup",this.keyEvents),document.addEventListener("dblclick",this.setIssueLabel,!1)},removeEventListerners(){document.removeEventListener("dblclick",this.pickFromIFC,!1),document.removeEventListener("keyup",this.keyEvents),document.removeEventListener("dblclick",this.setIssueLabel,!1)},mouseDown(e){e.stopImmediatePropagation();let t=i["a"].state.bv.scene.getObjectByName("buildingbox"),a=this.$el.getBoundingClientRect();i["a"].state.bv.mouseVector.x=(e.clientX-a.left)/(a.right-a.left)*2-1,i["a"].state.bv.mouseVector.y=-(e.clientY-a.top)/(a.bottom-a.top)*2+1,i["a"].state.bv.raycaster.setFromCamera(i["a"].state.bv.mouseVector,i["a"].state.bv.camera);const o=i["a"].state.bv.raycaster.intersectObjects(t.children,!0);if(!o.length)return;const s=o[0],r=s.point;i["a"].state.bv.controls3d.target.set(r.x,r.y,r.z),i["a"].state.bv.controls3d.update()},createBuildingObb:function(e,t,a,o,s,r={x:0,y:0,z:0}){console.log("oBB: "+a);f["c"].datumsToSpherical(e,t);var n,l,c,d=Math.sqrt(a.v2.x*a.v2.x+a.v2.y*a.v2.y+a.v2.z*a.v2.z),u=Math.sqrt(a.v3.x*a.v3.x+a.v3.y*a.v3.y);n=d*this.scaleFactor,l=a.v3.z*this.scaleFactor,c=u*this.scaleFactor,i["a"].state.bv.coords={x:n/2,y:l/2,z:-c/2};var h=this.lineDashBox(n,l,c),g=new p["ab"](h,new p["Y"]({color:16755200,dashSize:3,gapSize:1}));return g.computeLineDistances(),g.position.x=a.v1.x+r.x,g.position.y=a.v1.y+r.y,g.position.z=a.v1.z+r.z,o&&g.setRotationFromEuler(new p["A"](o.x,o.y,o.z,"XYZ")),g.updateMatrix(),g.matrixAutoUpdate=!1,g.castShadow=!1,g.renderOrder=1,g},drawRoomFromPolyline(e,t,a,o,s,r,n,l,c,d){var u=[];""!=r&&(r=r.replace("^^neo:a_matrix-3xm",""),r=r.replace("[",""),r=r.replace("]",""),u=r.split(",")),t*=this.scaleFactor,a*=this.scaleFactor,o*=this.scaleFactor;const h=new p["qb"]({color:c,side:p["v"],emissive:5592405,transparent:!0,opacity:d}),g=new p["mb"]({color:"white",polygonOffset:!0,polygonOffsetFactor:1}),m=new p["Wb"];var f=new p["uc"](0,o,0),b=new p["uc"](0,o+s*this.scaleFactor,0),v=new p["X"](f,b),y=0;while(u.length>1){const e=u.splice(0,3),s=e[0]*this.scaleFactor,r=e[1]*this.scaleFactor;0==y?(m.moveTo(-s+a,-r-t,o),y+=1):m.lineTo(-s+a,-r-t,o)}m.autoClose=!0;const w={extrudePath:v},I=new p["C"](m,w),S=new p["lb"](I,h),R=new p["lb"](I,g);return S.add(R),S.name=l,S.castShadow=!0,S.receiveShadow=!0,i["a"].state.bv.boundingBoxDrawed.push(String(r)),e.add(S),e},moveToObject(){R.moveToObject()},raycast(e){if(!i["a"].state.bv.lockSelection){let t=this.$el.getBoundingClientRect();return i["a"].state.bv.mouseVector.x=(e.clientX-t.left)/(t.right-t.left)*2-1,i["a"].state.bv.mouseVector.y=-(e.clientY-t.top)/(t.bottom-t.top)*2+1,this.CALL_RAYCAST()}},checkIfPointInsideAnyRoomGeometry(e){const t=[];return i["a"].state.bv.scene.getObjectByName("buildingbox").children.forEach((a,o)=>{if(g["a"].checkIfPointInsideMesh(e,a)){const e=d["a"].decodeCharacters(a.name);t.includes(e)||(t.push(e),console.log("Yay. Found inside: "+e))}}),t},async setIssueLabel(e){e.stopImmediatePropagation();let t=i["a"].state.bv.scene.getObjectByName("buildingbox"),a=this.$el.getBoundingClientRect();i["a"].state.bv.mouseVector.x=(e.clientX-a.left)/(a.right-a.left)*2-1,i["a"].state.bv.mouseVector.y=-(e.clientY-a.top)/(a.bottom-a.top)*2+1,i["a"].state.bv.raycaster.setFromCamera(i["a"].state.bv.mouseVector,i["a"].state.bv.camera);const o=i["a"].state.bv.raycaster.intersectObjects(t.children,!0);if(!o.length)return;const s=o[0],r=s.point;this.labelLocation=r;this.checkIfPointInsideAnyRoomGeometry(r);this.labelDialog=!0,this.$route.query.location&&(this.employeeList=await g["a"].getEmployeeList(this.$route.query.location+"i"),this.employeeList.forEach(e=>{this.employeeNameList.push(e.name)}))},setRoomLabel(e,t){console.log("Setting label for: "+t),i["a"].state.bv.selectedRoomNames.push(t);let a="";i["a"].state.rs.rdfStore.match(null,h["c"].FOAF("name"),A.literal(t))[0]&&(a=i["a"].state.rs.rdfStore.match(null,h["c"].FOAF("name"),A.literal(t))[0].subject.value),console.log("URI: "+a),""!=a&&i["a"].state.rs.rdfStore.match(A.sym(a),h["c"].IFOUR("trafficload"),null)[0]&&console.log("Trafficload: "+i["a"].state.rs.rdfStore.match(A.sym(a),h["c"].IFOUR("trafficload"),null)[0].object.value);try{let a=[],o=i["a"].state.bv.scene.getObjectByName("roomlabel");t?a.push(t):a=this.checkIfPointInsideAnyRoomGeometry(e),this.labelLocation=e;let s=i["a"].state.rs.rdfStore.match(A.sym(a[0]),h["c"].RDFS("label"),null)[0].object.value;s=d["a"].decodeCharacters(s),i["a"].state.bv.multiSelect||(i["a"].state.bv.selectedRoomNames=[]),i["a"].state.bv.selectedRoomNames.push(s.replace("Rom ","").replace("Room ",""));let r=i["a"].state.rs.rdfStore.match(A.sym(a[0]),h["c"].RDFS("label"),null)[0].subject.value,n=i["a"].state.rs.rdfStore.match(A.sym(a[0]),h["c"].IFOUR("m_polyline"),null)[0].object.value;console.log("Roomgeo"),console.log(n),this.addRoomLabelHTML(s,e,a[0],r),i["a"].state.bv.scene.remove(o)}catch(o){}},createLabel(){this.labelDialog=!1;let e=Date.now();this.addLabelToDatabase(this.labelObject.title,this.labelObject.description,this.labelLocation,this.labelObject.tags,this.labelObject.responsible,this.labelObject.imageuri,"Not started",e),i["a"].state.tasks.push({id:e,uri:"",position:this.labelLocation,title:this.labelObject.title,description:this.labelObject.description,imageuri:this.labelObject.imageuri,responsible:this.labelObject.responsible,state:"Not started",date:"16.09.2022",type:"issue"}),this.addLabelHTML(this.labelObject.title,this.labelLocation,this.labelObject.description,this.labelObject.imageuri),i["a"].state.bv.labelrenderer.render(i["a"].state.bv.scene,i["a"].state.bv.camera)},addLabelToDatabase(e,t,a,o,s,r,n,l){let c="[0,0,0,0,0,0,"+a.x+","+a.y+","+a.z+"]^^neo:a_matrix-3m";const m=d["a"].getBlankNode("Issuelabel: "+e);if(this.employeeList.forEach(e=>{e.name==s&&(s=e.personuri)}),g["a"].sendEmailToResponsible(s),!i["a"].state.blankExisted){i["a"].state.rs.tempRdfStore=A.graph(),o.forEach(e=>{T(m,h["c"].TAG("tag"),e)}),console.log("Adding label to store..."),T(m,h["c"].RDF("type"),h["c"].CTO("TaskContext")),T(m,h["c"].RDFS("label"),A.literal(e,"en")),T(m,h["c"].RDFS("comment"),t),T(m,h["c"].TAG("tag"),"i4task."+l),T(m,h["c"].IFOUR("taskStatus"),n),T(m,h["c"].FOAF("aimChatID"),A.sym(s)),T(m,h["c"].FOAF("maker"),A.sym(i["a"].state.webId)),T(m,h["c"].FOAF("image"),A.sym(r)),T(m,h["c"].NEO("m_matrix"),c);let a=d["a"].storeToTurtle(i["a"].state.rs.tempRdfStore,"");a=u["a"].modifyTurtle(a),console.log(a),u["a"].uploadTurtle(this.$route.query.location+"i",a,!1).then(e=>{console.log(e)})}},removeLabelFromDatabase(){},loadIssueLabelsFromStore(e){console.log("loading labels.."),i["a"].state.rs.rdfStore.match(null,h["c"].TAG("tag"),null).forEach(e=>{if(e.object.value.includes("i4task")){console.log("Found item: "+e.object.value);let t="",a="",o="",s="",r="",n="",l="Not started";i["a"].state.rs.rdfStore.match(e.subject,h["c"].IFOUR("taskStatus"),null).forEach(e=>{l=e.object.value}),i["a"].state.rs.rdfStore.match(e.subject,h["c"].RDFS("label"),null).forEach(a=>{t=a.object.value,s=e.subject.value,console.log("Label",t)}),i["a"].state.rs.rdfStore.match(e.subject,h["c"].RDFS("comment"),null).forEach(e=>{a=e.object.value}),i["a"].state.rs.rdfStore.match(e.subject,h["c"].FOAF("image"),null).forEach(e=>{o=e.object.value}),i["a"].state.rs.rdfStore.match(e.subject,h["c"].FOAF("aimChatID"),null).forEach(e=>{r=e.object.value,n=i["a"].state.rs.rdfStore.match(A.sym(e.object.value),h["c"].FOAF("name"),null)[0].object.value||""});let c="",d=new p["uc"](0,0,0);if(i["a"].state.rs.rdfStore.match(e.subject,h["c"].NEO("t_"),null).forEach(e=>{c=e.object.value}),console.log("Matrix: "+c),c.length>=10){c=c.replace("]^^neo:a_matrix-3m",""),c=c.replace("[0,0,0,0,0,0,","");const e=c.split(",");d.x=parseInt(e[0]),d.y=parseInt(e[1]),d.z=parseInt(e[2])}console.log(d);let u=!1;i["a"].state.tasks.forEach(t=>{t.uri===e.subject.value&&(u=!0)}),this.addLabelHTML(t,d,a,o,s)}}),this.RENDER()},async addLabelHTML(e,t,a,o,s){const r=document.createElement("div");r.classList.add("base-label");const n=document.createElement("div");n.classList.add("label"),r.appendChild(n);const l=document.createElement("div");l.setAttribute("style","display: flex; justify-content: space-between;"),n.appendChild(l);const c=document.createElement("h4");c.textContent=e,l.appendChild(c);const d=document.createElement("div");d.classList.add("hidden"),d.classList.add("texttop"),n.appendChild(d);const u=document.createElement("img");u.classList.add("hidden"),u.setAttribute("style","width: 80px; margin-right: 8px; margin-top: 3px");try{const e=await window.solid.session.fetch(o,{method:"GET",credentials:"include"});console.log(e);let t=await e.arrayBuffer(),a=URL.createObjectURL(new Blob([t],{type:"image/jpeg"}));u.setAttribute("src",a),d.appendChild(u)}catch(p){console.log(p)}const h=document.createElement("span");h.classList.add("texttop"),h.textContent=a,d.appendChild(h),d.appendChild(document.createElement("br"));const g=document.createElement("button");g.classList.add("details-button"),g.classList.add("hidden"),g.textContent="Show details",d.appendChild(g),r.onmouseenter=()=>{d.classList.remove("hidden"),g.classList.remove("hidden"),u.classList.remove("hidden")},r.onmouseleave=()=>{d.classList.add("hidden"),g.classList.add("hidden"),u.classList.add("hidden")};const m=new S["a"](r);m.position.copy(t),i["a"].state.bv.scene.add(m)},async addRoomLabelHTML(e,t,a,o){const s=document.createElement("div");s.classList.add("base-label");const r=document.createElement("div");r.classList.add("label"),s.appendChild(r);const n=document.createElement("div");n.setAttribute("style","display: flex; justify-content: space-between;"),r.appendChild(n);const l=document.createElement("h4");l.textContent=e,n.appendChild(l);const c=document.createElement("div");c.classList.add("hidden"),c.classList.add("texttop"),r.appendChild(c);const d=document.createElement("button");d.classList.add("details-button"),d.classList.add("hidden"),d.textContent="Show room details",c.appendChild(d),s.onmouseenter=()=>{c.classList.remove("hidden"),d.classList.remove("hidden")},s.onmouseleave=()=>{c.classList.add("hidden"),d.classList.add("hidden")},d.onclick=()=>{console.log("Button clicked."),i["a"].state.cp.roomDetailURI=o};const u=new S["a"](s);u.position.copy(t),u.name="roomlabel",i["a"].state.bv.scene.add(u)},async uploadImage(e){console.log(e),this.progress=0;let t=new FormData;t.append("image",e);let a=this.$route.query.location+"Home/Issues/"+e.file.name;try{window.solid.session.fetch(a,{method:"PUT",credentials:"include",body:e.file,headers:{"Content-Type":""},onUploadProgress:function(e){this.progress=parseInt(Math.round(e.loaded/e.total*100))}.bind(this)}).then(e=>{this.progress=100,this.labelObject.imageuri=a,console.log("done uploading",e)})}catch(o){this.error="Error has occured"}},async pickFromIFC(e){e.stopImmediatePropagation();const t=await this.raycast(e);if(!t.length)return;let a=t[0];t.forEach(e=>{e.object.visible&&(a=e)});const o=a.point;let s="";a.object&&(s=a.object.name),this.setRoomLabel(o,s),this.RENDER();try{const e="_expressid",t=a.object.geometry.index.array;let o=a.object.geometry.attributes[e].array[t[3*a.faceIndex]];console.log("Expressid1: "+o);const s=a.object.geometry,r=a.object.modelID;this.markIFCElementWithColor(o,r,s)}catch(r){}},markIFCElementWithColor(e,t,a){const o=i["a"].state.bv.scene.getObjectByName("buildingbox");let s=new p["ob"]({transparent:!0,opacity:.6,color:16746751,depthTest:!1}),r=E.ifcManager.createSubset({modelID:t,ids:[e],material:s,scene:o,removePrevious:!0});o.add(r),this.RENDER()},getFloorTagfromJson(e,t){for(let a=0;a<=Object.keys(e.storeys).length;a++)if(Object.values(e.storeys)[a]==t)return Object.keys(e.storeys)[a];return""},toggleRotation(){i["a"].state.bv.controls3d.autoRotate=!i["a"].state.bv.controls3d.autoRotate,i["a"].state.bv.animate=i["a"].state.bv.controls3d.autoRotate,this.autoRotate=i["a"].state.bv.controls3d.autoRotate,i["a"].state.bv.controls3d.rotateSpeed=.5,i["a"].state.bv.controls3d.autoRotateSpeed=.5,console.log("Toggle rotation")},toggleMap(){var e=i["a"].state.bv.scene.getObjectByName("map");e?(i["a"].state.bv.scene.remove(e),this.RENDER(),console.log("Toggle map")):(i["a"].state.bv.scene.add(i["a"].state.bv.map),this.show3DMap(),this.RENDER())},toggleColors(){this.colors=!this.colors;var e=i["a"].state.bv.roomGeometry.pop();i["a"].state.bv.roomGeometry.length=i["a"].state.bv.roomGeometry.length-1,i["a"].state.bv.roomGeometry.push(e)},lockSelection(){1==i["a"].state.bv.lockSelection?i["a"].state.bv.lockSelection=!1:i["a"].state.bv.lockSelection=!0},multiSelect(){i["a"].state.bv.scene.getObjectByName("buildingbox").children.forEach((e,t)=>{if(!e.name.includes("placemarker"))try{e.material.color.setHex(2250103),e.material.opacity=.9,e.children.forEach((e,t)=>{e.material.color.setHex(2250103),e.material.opacity=.9})}catch(a){}}),i["a"].state.bv.selectedRoomName="",i["a"].state.bv.selectedRoomNames=[],i["a"].state.bv.selectedRoomIDs=[],1==i["a"].state.bv.multiSelect?i["a"].state.bv.multiSelect=!1:i["a"].state.bv.multiSelect=!0,this.RENDER()},changeFocusObject(e){R.zoomToObject()},async setupBuildingBox(){const e=new p["f"];i["a"].state.bv.scene.add(e);const t=await m["a"].getIFCmetaDataFromJson(this.$route.query.location+"home/IFC/building.json"),a=t.buildinglat,o=t.buildinglong,s=t.rotation,r=16729139;let n=t.buildingdimensions;this.buildingLat=a,this.scaleFactor=1/Math.cos(a*Math.PI/180);const l=this.createBuildingObb(a,o,n,s,r);l.name="buildingbox";const c=f["c"].datumsToSpherical(a,o);i["a"].state.bv.buildingboxPosition={x:c.x,y:0,z:c.y},i["a"].state.currentBuildingTag=t.tag,i["a"].state.bv.scene.getObjectByName("map").position.set(-i["a"].state.bv.buildingboxPosition.x,0,i["a"].state.bv.buildingboxPosition.z),this.ADD_TO_SCENE({buildingbox:l}),i["a"].state.bv.focusobject=i["a"].state.bv.scene.getObjectByName("buildingbox"),R.zoomToObject(),i["a"].state.bv.selectedRoomURI=this.$route.query.select,this.selectRoomFromURI(),this.RENDER()},async changeRoomGeometry(){let e=i["a"].state.bv.scene.getObjectByName("buildingbox");e||(e=await this.setupBuildingBox()),i["a"].state.bv.boundingBoxDrawed=[],i["a"].state.bv.roomGeometry.forEach((t,a)=>{i["a"].state.bv.scene.getObjectByName(t.roomuri)||(e=this.drawRoomFromPolyline(e,t.x,t.y,t.z,t.height,t.polyline,this.buildingLat,t.roomuri,t.color,t.opacity),console.log(t))}),this.RENDER()},selectRoomFromURI(){if(i["a"].state.bv.selectedRoomURI){const t=i["a"].state.bv.scene.getObjectByName("buildingbox");let a=i["a"].state.bv.selectedRoomURI,o=i["a"].state.rs.rdfStore.match(A.sym(a),h["c"].IFOUR("m_polyline"),null)[0].object.value;var e=o+"";e=e.replace("^^neo:a_matrix-3m",""),e=e.replaceAll('"',"");const s=e.split(";");let r='{"x":'+s[2]+', "y":'+s[3]+', "z":'+s[4]+', "height":'+s[5]+', "color":16711680, "opacity":1, "roomuri":"'+a+'", "polyline":"'+s[6]+'"}';console.log(r);let n=JSON.parse(r);i["a"].state.bv.roomGeometry.push(n),setTimeout((function(){i["a"].state.bv.INTERSECTED=i["a"].state.bv.scene.getObjectByName(a),R.moveToObject()}),100),this.previousSelectedRoom&&i["a"].state.bv.scene.getObjectByName(this.previousSelectedRoom).material.color.setHex(2250103),i["a"].state.bv.scene.getObjectByName(a).material.color.setHex(16711680),this.previousSelectedRoom=a;const l=g["a"].getMeshCenterPointTop(i["a"].state.bv.scene.getObjectByName(a)).applyMatrix4(t.matrixWorld);this.setRoomLabel(l,a),this.RENDER()}},setup2dview(){i["a"].state.bv.twodim=!i["a"].state.bv.twodim,this.twodim=i["a"].state.bv.twodim,i["a"].state.bv.twodim?(i["a"].state.bv.controls3d.enabled=!1,i["a"].state.bv.controls2d.enabled=!0):(i["a"].state.bv.controls3d.enabled=!0,i["a"].state.bv.controls2d.enabled=!1),this.RENDER(),i["a"].state.bv.controls2d.update()},setupPersonView(){i["a"].state.bv.thirdperson=!i["a"].state.bv.thirdperson,this.INITIALIZE_PLAYER(),this.RENDER()},zoomToLatLong(e,t){var a=2;const o=e,s=t;let r=f["c"].datumsToSpherical(o,s);i["a"].state.bv.controls3d.target.set(r.x,0,-r.y),i["a"].state.bv.camera.position.set(r.x+5,a,5-r.y),i["a"].state.bv.scene.getObjectByName("sdfmesh").position.set(r.x,0,-r.y),this.RENDER()},parseIFC(e){},loadFloorPlan(){g["a"].loadGeometryUsingTag(i["a"].state.currentBuildingTag+".E02",this.$route.query.location,["FLOORPLAN"])},async highlight(e){let t={id:-1},a=new p["ob"]({transparent:!0,opacity:.6,color:16746751,depthTest:!1}),o=await this.raycast(e);if(console.log(o),o[0]&&(o=o[0]),o){t.id=o.object.modelID;const e=o.faceIndex,s=o.object.geometry,r=E.ifcManager,n=r.getExpressId(s,e);console.log(n),E.ifcManager.createSubset({modelID:t.id,ids:[n],material:a,scene:i["a"].state.bv.scene,removePrevious:!0})}else E.ifcManager.removeSubset(t.id,a)},async drawIFC(){this.ifcloading=!0;let e=this.$route.query.location+"home/IFC/building.ifc";console.log("IFC uri: "+e);try{const a=await window.solid.session.fetch(e,{method:"GET",credentials:"include"});console.log(a);let o=await a.arrayBuffer(),s=URL.createObjectURL(new Blob([o],{type:"application/ifc"})),r="buildingbox";i["a"].state.bv.selectedRoomIDs.forEach((e,t)=>{r=e});const n=i["a"].state.bv.scene.getObjectByName(r);(new p["i"]).setFromObject(n);try{n.material.color.setHex(2250103),n.material.opacity=.1,n.children.forEach((e,t)=>{e.material.color.setHex(2250103),e.material.opacity=.1})}catch(t){}const l=await E.loadAsync(s);l.scale.set(this.scaleFactor,this.scaleFactor,this.scaleFactor),n.add(l),this.RENDER()}catch(t){console.log(t)}},addIFCelementstoScene(e,t){const a=i["a"].state.bv.scene.getObjectByName("buildingbox"),o=e.modelID;t.forEach((t,s)=>{j(o,t).then(t=>{console.log(t);const s=E.ifcManager,r={modelID:o,scene:i["a"].state.bv.scene,ids:t,removePrevious:!1};e=s.createSubset(r),e.scale.set(this.scaleFactor,this.scaleFactor,this.scaleFactor),e.name="IFCshell",a.add(e),this.RENDER()})})},drawIFCWalls(){const e=i["a"].state.bv.scene.getObjectByName("buildingbox"),t=e.getObjectByName("IFCshell");t?(console.log("Trying to show/hide shell!"),t.visible=!t.visible):(console.log("Loading the IFC elements..."),E.load("../Mir111Shell.ifc",e=>{this.addIFCelementstoScene(e,this.scaleFactor,[y["IFCDOOR"],y["IFCWINDOW"],y["IFCWALL"],y["IFCSLAB"],y["IFCWALLSTANDARDCASE"]])})),this.RENDER(),i["a"].state.bv.scene.getObjectByName("buildingbox").children.forEach((e,t)=>{try{e.material.color.setHex(2250103),e.material.opacity=.9,e.children.forEach((e,t)=>{e.material.color.setHex(2250103),e.material.opacity=.9})}catch(a){}})},setupIFCLoadingProgress(){E.ifcManager.setOnProgress(e=>{const t=e.loaded/e.total*100,a=Math.trunc(t);this.ifcloadpercentage=a.toString(),100===a&&setTimeout(()=>{this.ifcloading=!1},5e3)})},cutIFCpart(){const e=i["a"].state.bv.scene.getObjectByName("buildingbox"),t=e.getObjectByName("IFCshell");t?(console.log("Trying to show/hide shell!"),t.visible=!t.visible):(console.log("Loading IFC part..."),E.load("../Mir111Full.ifc",t=>{t.visible=!1;const a=new p["lb"](t.geometry,new p["mb"]({transparent:!1,opacity:1,color:7842559}));console.log(a),a.scale.set(this.scaleFactor,this.scaleFactor,this.scaleFactor),a.updateMatrix();let o="buildingbox";i["a"].state.bv.selectedRoomIDs.forEach((e,t)=>{o=e});var s=i["a"].state.bv.scene.getObjectByName(o);s.updateMatrix(),console.log(s);var r=(new p["l"]).fromGeometry(s.geometry);s=new p["lb"](r,new p["mb"]),s.updateMatrix(),console.log(s);const n=v["a"].intersect(t,s);n.name="IFCcut",e.add(n),this.RENDER()})),this.RENDER(),i["a"].state.bv.scene.getObjectByName("buildingbox").children.forEach((e,t)=>{try{e.material.color.setHex(2250103),e.material.opacity=.9,e.children.forEach((e,t)=>{e.material.color.setHex(2250103),e.material.opacity=.9})}catch(a){}})},loadGLTF(e){i["a"].state.bv.scene.getObjectByName("buildingbox");const t=new I["a"];t.load(e,(function(e){const t=e.scene;t.scale.set(this.scaleFactor,this.scaleFactor,this.scaleFactor),t.name="Espensmodel"}),(function(e){console.log(e.loaded/e.total*100+"% loaded"),100==e&&console.log("GLTF loading finished!")}),(function(e){console.log("An error happened: "+e)}))},async populateSpaces(){await c["a"].populateStoreFromTurtle();const e=[];i["a"].state.rs.rdfStore.match(null,h["c"].RDF("type"),h["c"].BOT("Space")).forEach(t=>{console.log("Found room: "+t.subject.value),e.push(t.subject.value)}),e.forEach((e,t)=>{i["a"].state.rs.rdfStore.match(A.sym(e),h["c"].IFOUR("m_polyline"),null).forEach((t,a)=>{g["a"].addRoomMatrix(t,1789810,.9,e)})})},show3DMap(){const e=i["a"].state.bv.scene.getObjectByName("map").position;i["a"].state.bv.scene.remove(i["a"].state.bv.scene.getObjectByName("map"));let t=new f["a"](x,"mapbox/streets-v10",f["a"].STYLE),a=new f["a"](x,"mapbox.terrain-rgb",f["a"].MAP_ID,"pngraw");i["a"].state.bv.map=new f["b"](f["b"].HEIGHT,t,a),this.activateNewMap(e)},show2DMap(){const e=i["a"].state.bv.scene.getObjectByName("map").position;i["a"].state.bv.scene.remove(i["a"].state.bv.scene.getObjectByName("map"));let t=new f["a"](x,"mapbox/streets-v10",f["a"].STYLE);i["a"].state.bv.map=new f["b"](f["b"].PLANAR,t),this.activateNewMap(e)},showSatteliteMap(){const e=i["a"].state.bv.scene.getObjectByName("map").position;i["a"].state.bv.scene.remove(i["a"].state.bv.scene.getObjectByName("map"));let t=new f["a"](x,"mapbox.satellite",f["a"].MAP_ID,"jpg70",!1),a=new f["a"](x,"mapbox.terrain-rgb",f["a"].MAP_ID,"pngraw");i["a"].state.bv.map=new f["b"](f["b"].HEIGHT,t,a),this.activateNewMap(e)},activateNewMap(e){i["a"].state.bv.map.position=e,i["a"].state.bv.map.receiveShadow=!0,i["a"].state.bv.map.name="map",i["a"].state.bv.map.renderOrder=2,i["a"].state.bv.scene.add(i["a"].state.bv.map),i["a"].state.bv.map.updateMatrixWorld(!0)},lineDashBox(e,t,a){e*=.5,t*=.5,a*=.5;const o=new p["l"],s=[];return s.push(-e,-t,-a,-e,t,-a,-e,t,-a,e,t,-a,e,t,-a,e,-t,-a,e,-t,-a,-e,-t,-a,-e,-t,a,-e,t,a,-e,t,a,e,t,a,e,t,a,e,-t,a,e,-t,a,-e,-t,a,-e,-t,-a,-e,-t,a,-e,t,-a,-e,t,a,e,t,-a,e,t,a,e,-t,-a,e,-t,a),o.setAttribute("position",new p["E"](s,3)),o},keyEvents(e){return e.isComposing||90===e.keyCode?(console.log("Z key down 1"),void R.moveToObject()):76===e.keyCode?(console.log("L key down 2"),void this.lockSelection()):73===e.keyCode?(console.log("I key down"),void this.drawIFC()):81===e.keyCode?(console.log("Q key down"),void this.drawIFCWalls()):void 0}},computed:{getSelectedRoomName(){return i["a"].state.bv.selectedRoomName},getAutoRotate(){return this.autoRotate},getLockSelection(){return i["a"].state.bv.lockSelection},getMultiSelect(){return i["a"].state.bv.multiSelect}},watch:{"$store.state.bv.roomGeometry":function(e){console.log("Detected ROOM geometry change......"),this.changeRoomGeometry()},"$store.state.bv.selectedRoomNames":function(e){i["a"].state.bv.selectedRoomName="",i["a"].state.bv.selectedRoomNames.forEach((e,t)=>{i["a"].state.bv.selectedRoomName=i["a"].state.bv.selectedRoomName+" - "+e})},"$store.state.bv.selectedRoomIDs":function(e){i["a"].state.bv.scene.getObjectByName("buildingbox").children.forEach((e,t)=>{if(!e.name.includes("IFC")&&!e.name.includes("placemarker"))try{e.material.color.setHex(2250103),e.children.forEach((e,t)=>{e.material.color.setHex(2250103)})}catch(a){}}),i["a"].state.bv.selectedRoomIDs.forEach((e,t)=>{var a=i["a"].state.bv.scene.getObjectByName(e);a&&a.material.color.setHex(16711680)}),this.RENDER()},"$store.state.bv.wayBetweenRooms":function(e){const t=i["a"].state.bv.scene.getObjectByName("buildingbox");t.children.forEach((e,t)=>{try{e.name.includes("placemarker")||(e.material.opacity=.6,e.children.forEach((e,t)=>{e.material.opacity=.6}))}catch(a){}});for(var a=t.children.length-1;a>=0;a--)t.children[a].name.includes("arrow")&&t.remove(t.children[a]);g["a"].showWay(i["a"].state.bv.wayBetweenRooms,i["a"].state.bv.scaleFactor),i["a"].state.bv.needsrender=!0,this.RENDER()},"$store.state.bv.animate":function(e){e&&this.ANIMATE()},"$store.state.bv.drawBuildingBoxFlag":function(e){e&&(console.log("Should draw building box nearby.."),console.log(i["a"].state.cp.buildingLocationList),i["a"].state.cp.buildingLocationList.forEach(e=>{if(!e.uri.includes(this.$route.query.location))if(console.log("Found other building: "+e.uri),i["a"].state.bv.scene.getObjectByName(e.uri))console.log("Building box already exist..");else{console.log("Building box does not exist.");const t=f["c"].datumsToSpherical(e.buildinglat,e.buildinglong),a=new p["uc"](-i["a"].state.bv.buildingboxPosition.x+t.x,0,i["a"].state.bv.buildingboxPosition.z-t.y),o=this.createBuildingObb(e.buildinglat,e.buildinglong,e.buildingdimensions,e.rotation,16729139,a);o.name=e.uri,this.ADD_TO_SCENE({buildingbox:o})}}),i["a"].state.bv.drawBuildingBoxFlag=!1)},"$store.state.bv.selectedRoomURI":function(e){this.selectRoomFromURI()},"$store.state.bv.twodim":function(e){},"$store.state.bv.needsrender":function(e){e&&(this.RENDER(),i["a"].state.bv.needsrender=!1)},"$store.state.bv.coords":function(e){i["a"].state.bv.twodimcamera.position.set(e.x,300,-e.y),i["a"].state.bv.controls2d.target.set(e.x,0,-e.y)},floorSplitFactor:function(e,t){i["a"].state.bv.animate=!0,console.log("Detected splitfactor change...",e," : ",t);var a=i["a"].state.bv.scene.getObjectByName("buildingbox");if(a)for(var o=a.children.length-1;o>=0;o--){console.log("Found a child to move..");const s=g["a"].getMeshHeightAboveGround(a.children[o]).min;let r=3;if(e>t){if(r=4,a.children[o]){const e=a.children[o],t={x:0,y:s*r,z:0},n={x:e.position.x,y:e.position.y,z:e.position.z};new i["a"].state.bv.TWEEN.Tween(n).to({y:t.y},1500).easing(i["a"].state.bv.TWEEN.Easing.Quadratic.Out).onUpdate(()=>{e.position.y=n.y}).onComplete((function(){setTimeout((function(){i["a"].state.bv.animate=!1}),1e3)})).start()}}else if(r=.25,a.children[o]){const e=a.children[o],t={x:0,y:-s*r,z:0},n={x:e.position.x,y:e.position.y,z:e.position.z};new i["a"].state.bv.TWEEN.Tween(n).to({y:t.y},1500).easing(i["a"].state.bv.TWEEN.Easing.Quadratic.Out).onUpdate(()=>{e.position.y=n.y}).onComplete((function(){setTimeout((function(){i["a"].state.bv.animate=!1}),1e3)})).start()}}},gltfGeoVisible:function(e){i["a"].state.bv.gltfGeoVisible=e;var t=i["a"].state.bv.scene.getObjectByName("buildingbox");if(t&&!e){for(var a=t.children.length-1;a>=0;a--)console.log(t.children[a].name),t.children[a].name.includes("HOVEDBYGG")&&(console.log("Trying to remove.."),t.remove(t.children[a]));i["a"].state.bv.gltfLoadedList=[],this.RENDER()}t&&e&&(g["a"].loadGeometryUsingTag(i["a"].state.currentBuildingTag,this.$route.query.location,["BUILDING"]),this.RENDER())},spacesVisible:function(e){var t=i["a"].state.bv.scene.getObjectByName("buildingbox");if(e)this.populateSpaces();else for(var a=t.children.length-1;a>=0;a--)if(""!=t.children[a].name)try{(i["a"].state.rs.rdfStore.match(null,h["c"].FOAF("name"),A.literal(t.children[a].name))[0]||i["a"].state.rs.rdfStore.match(A.sym(t.children[a].name),h["c"].FOAF("name"),null)[0])&&t.remove(t.children[a])}catch(o){}i["a"].state.bv.needsrender=!0},labelDialog:function(e){this.labelDialog?this.removeEventListerners():this.addEventListerners()},scaleFactor:function(e){i["a"].state.bv.scaleFactor=e},file:function(e){let t=new FileReader;t.onload=e=>{var t=new TextEncoder("utf-8"),o=t.encode(e.target.result);const s=a("e90a"),r=new s.IfcAPI;r.SetWasmPath("../"),r.Init().then(e=>{const t=r.OpenModel(o);console.log("Printing object:"),console.log(r.GetLine(t,33774));let a=r.GetLine(t,33774,!0);console.log(a),console.log(ifcspaces)})},t.readAsText(e)}},mounted(){let e=0,t=0;this.$route.path.includes("BimViewer")?(e=window.innerWidth,t=window.innerHeight-70):(e=.65*window.innerWidth,t=window.innerHeight-70),this.INIT({width:e,height:t,el:this.$el}),_(),this.setupIFCLoadingProgress(),i["a"].state.bv.GLTFloadingFlag=!1,i["a"].state.bv.gltfLoadedList=[],this.gltfGeoVisible=i["a"].state.bv.gltfGeoVisible,this.spacesVisible=i["a"].state.bv.spacesVisible,console.log("Original lat: 66.32649, long: 14.1868"),this.CONVERT_TO_UTM({lat:66.32587,long:14.18655,zoneNum:33}).then(e=>{console.log("Converted UTM x:"+e.easting+" y: "+e.northing+" zoneNum: "+e.zoneNum+" letter: "+e.zoneLetter),this.CONVERT_FROM_UTM({easting:e.easting,northing:e.northing,zoneNum:e.zoneNum,zoneLetter:e.zoneLetter}).then(e=>{console.log("Converted back lat: "+e.lat+" long: "+e.long)})}),this.setupBuildingBox();i["a"].state.bv.camera,i["a"].state.bv.scene;this.loadIssueLabelsFromStore("Warning"),this.RENDER(),i["a"].state.bv.gltfGeoVisible&&g["a"].loadGeometryUsingTag(i["a"].state.currentBuildingTag,this.$route.query.location,["BUILDING"]),!i["a"].state.bv.IFCPropertyJson&&i["a"].state.isLoggedIn&&m["a"].getIFCpropertiesJson(this.$route.query.location),setTimeout((function(){const e=[];e.push("polyline;V014;0.39180128404599995;20.59;0;2.9;[0,0,0,5.45,0,0,5.45,0.47,0,5.45,2.87,0,5.45,4,0,0,4,0,0,0,0]"),e.push("polyline;V013;4.54180128405;20.59;0;2.9;[0,0,0,2.725,0,0,2.725,4.7,0,0,4.7,0,0,0,0]"),e.push("polyline;V013.1;6.59180128405;15.09;0;2.9;[0,0,0,-2.65,-3.245314017740486e-16,0,-2.6499999999999995,-2.0500000000000003,0,2.5105259382520737e-16,-2.05,0,0,0,0]"),e.push("polyline;V012.1;21.841801284000002;15.14;0;2.9;[0,0,0,-5.45,-6.674325055353075e-16,0,-5.449999999999998,-12.45,0,1.5246852649384546e-15,-12.45,0,0,0,0]"),e.push("polyline;V011.1;25.457801284000002;17.69;0;2.9;[0,0,0,-2.9,-3.5514757175273243e-16,0,-2.9,-0.5210000000000004,0,-2.8999999999999995,-3.4960000000000004,0,4.2813652098191467e-16,-3.496,0,0,0,0]"),e.push("polyline;V011;25.457801284000002;15.14;0;2.9;[0,0,0,-2.4,-2.9391523179536476e-16,0,-2.3999999999999995,-3.4960000000000004,0,4.2813652098191467e-16,-3.496,0,0,0,0]"),e.push("polyline;V010;25.577801284;20.59;0;2.9;[0,0,0,5.45,0,0,5.45,4.104,0,0,4.104,0,0,0,0]"),e.push("polyline;N007;29.771801284000002;28.105;0;2.9;[0,0,0,7.125,0,0,7.125,3.89,0,6.595,3.89,0,0,3.89,0,0,0,0]"),e.push("polyline;N008;29.621801284;20.98;0;2.9;[0,0,0,-7.125,-8.725608443924891e-16,0,-7.124999999999999,-4.6850000000000005,0,5.737470254005349e-16,-4.685,0,0,0,0]"),e.push("polyline;V009.1;32.611801284;18.84;0;2.9;[0,0,0,-1.75,-2.143131898507868e-16,0,-1.7499999999999996,-2.78,0,3.404518101629642e-16,-2.78,0,0,0,0]"),e.push("polyline;V009;29.831801284;18.69;0;2.9;[0,0,0,3.55,0,0,3.55,2.78,0,0,2.78,0,0,0,0]"),e.push("polyline;V008;32.711801284;20.59;0;2.9;[0,0,0,5.45,0,0,5.45,1.19,0,0,1.19,0,0,0,0]"),e.push("polyline;V007;36.5015668809;15.06;0;2.9;[0,0,0,-2.53,-3.0983564018428034e-16,0,-2.5299999999999994,-2.4497655968200007,0,-0.0799999999999997,-2.4497655968200003,0,3.000097596806919e-16,-2.4497655968200003,0,0,0,0]"),e.push("polyline;V006;36.6215668809;17.59;0;2.9;[0,0,0,2.53,0,0,2.53,1.87023440318,0,0,1.87023440318,0,0,0,0]"),e.push("polyline;N006;41.701801284;24.13;0;2.9;[0,0,0,-8.46,-1.0360511920786608e-15,0,-8.459999999999999,-7.650000000000001,0,-3.974999999999999,-7.650000000000001,0,2.620000000000001,-7.65,0,3.540000000000001,-7.65,0,6.340000000000001,-7.6499999999999995,0,6.34,7.764260706594219e-16,0,0,0,0]"),e.push("polyline;N005;41.701801284;38.69500003580001;0;2.9;[0,0,0,4.684274006738626e-16,-7.65,0,5.905000035760001,-7.65,0,5.9050000357600005,3.6157696963792453e-16,0,0,0,0]"),e.push("polyline;V012;10.046518690200001;12.7932422759;0;2.9;[0,0,0,-1.8017577240876206,-0.0014414061792685745,0,-1.801757724094091,-0.02671740617928987,0,-2.146757724094038,-0.026717406179269574,0,-2.146757724093207,-0.8047174061791494,0,-4.946757724092777,-0.804717406179347,0,-4.946757724092776,-3.3047174061819633,0,-2.146757724093209,-3.3047174061787654,0,-2.146757724086411,-5.504717406178422,0,-1.9567577240864413,-5.504717406177062,0,-1.9567577240948413,-5.6547174061770455,0,-1.952757724094841,-5.65471740617807,0,-1.952757724094122,-6.784717406177895,0,-2.1967577240940868,-6.784717406175432,0,-2.1967577240884886,-9.184717406175059,0,-1.956757724088524,-9.1847174061765,0,-1.9567577240888445,-9.654717406176426,0,-1.9567577240946847,-9.794717406176408,0,0.4101449956078221,-9.794717406176577,0,0.40838443222724513,-6.494717406177338,0,0.1632422759087946,-6.4947174061796344,0,0.16324227590959697,-3.6947174061800654,0,0.35324227590956664,-3.694717406178705,0,0.3532422759089278,-2.3847174061789067,0,0.553242275908898,-2.384717406180107,0,0.5532422759094592,-0.12471740617945368,0,0.35324227590948964,-0.1247174061792535,0,0.35324227590957774,-0.026717406179268488,0,-0.0017577240907376839,-0.026717406179288486,0,0,0,0]"),e.push("polyline;V016;3.94180128405;10.295;0;2.9;[0,0,0,1.73,0,0,2.185,0,0,2.185,2.26,0,-1.945,2.26,0,-1.945,0,0,-1.93985782234,0,0,0,0,0]"),e.push("polyline;V017;6.3518012840499996;12.24;0;2.9;[0,0,0,4.13,0,0,4.13,3.52,0,0.05,3.52,0,0.05,1.31,0,0.025,1.31,0,0,1.31,0,0,0,0]"),e.push("polyline;V020.1;5.201801284049999;7.96;0;2.9;[0,0,0,2.43,0,0,2.43,4.72,0,0,4.72,0,0,0,0]"),e.push("polyline;V020;3.94180128405;6.08;0;2.9;[0,0,0,5.69,0,0,5.69,6.088,0,0.79,6.088,0,0.79,5.98,0,0.75,5.98,0,0.75,1.26,0,0.75,1.11,0,0,1.11,0,0,0,0]"),e.push("polyline;V021;16.221801283999998;0.39;0;2.9;[0,0,0,-3.45,-4.225031457058369e-16,0,-3.4499999999999997,-2.9540000000000006,0,3.6176066446812815e-16,-2.954,0,0,0,0]"),e.push("polyline;V022;16.371801284;3.84;0;2.9;[0,0,0,3.45,0,0,3.45,2.97,0,0,2.97,0,0,0,0]"),e.push("polyline;V023;19.491801284;3.84;0;2.9;[0,0,0,3.45,0,0,3.45,2.97,0,0,2.97,0,0,0,0]"),e.push("polyline;V024;25.581801284;0.39;0;2.9;[0,0,0,-3.45,-4.225031457058369e-16,0,-3.4499999999999997,-2.9700000000000006,0,3.637200993467639e-16,-2.97,0,0,0,0]"),e.push("polyline;V025;25.731801284;3.84;0;2.9;[0,0,0,3.45,0,0,3.45,2.97,0,0,2.97,0,0,0,0]"),e.push("polyline;V026;31.771801284000002;0.39;0;2.9;[0,0,0,-3.45,-4.225031457058369e-16,0,-3.4499999999999997,-2.9200000000000004,0,3.5759686535102713e-16,-2.92,0,0,0,0]"),e.push("polyline;V027;34.941801284;0.39;0;2.9;[0,0,0,-4.9,-6.000769315822031e-16,0,-4.9,-3.0500000000000003,0,3.735172737399427e-16,-3.05,0,0,0,0]"),e.push("polyline;V028;41.561801284;0.39;0;2.9;[0,0,0,-4.9,-6.000769315822031e-16,0,-4.9,-3.3265561999400006,0,4.0738564024403037e-16,-3.32655619994,0,0,0,0]"),e.push("polyline;V028.2;35.061801284;5.29;0;2.9;[0,0,0,4.9,0,0,4.9,3.02344380006,0,0,3.02344380006,0,0,1.55,0,0,1.16,0,0,0,0]"),e.push("polyline;V028.1;36.611801284;12.24;0;2.9;[0,0,0,3.90069637327,0,0,6.55,0,0,6.75,0,0,6.75,4.95,0,6.725,4.95,0,6.725,5.34,0,0,5.34,0,0,0,0]"),e.push("polyline;V001;36.461801284;7.94;0;2.9;[0,0,0,-4.3,-5.265981236333618e-16,0,-4.299999999999999,-4.605000000000001,0,2.4500000000000006,-4.605,0,2.45,-0.23999999999999969,0,2.45,-0.1999999999999997,0,2.25,-0.19999999999999973,0,2.25,2.755455298081545e-16,0,0,0,0]"),e.push("polyline;V002;18.441801284;12.19;0;2.9;[0,0,0,6.65,0,0,6.65,11.815,0,0,11.815,0,0,0,0]"),e.push("polyline;V003;18.291801284;5.54;0;2.9;[0,0,0,-4.209,-5.154538377611209e-16,0,-4.209,-0.15967136805100052,0,-4.359,-0.15967136805100052,0,-4.359,-5.338235397483313e-16,0,-6.65,-8.143901214329899e-16,0,-6.65,-2.140000000000001,0,-6.65,-2.450000000000001,0,-4.359,-2.4500000000000006,0,-4.359,-2.1400000000000006,0,-4.209,-2.1400000000000006,0,-4.209,-2.4500000011200003,0,-2.7500005737699995,-2.4500000283200007,0,3.000384692593013e-16,-2.4500000283200003,0,0,0,0]"),e.push("polyline;0V03.1;13.267801283999999;9.74;0;2.9;[0,0,0,1.65,0,0,1.65,2.42399998649,0,0,2.42399999881,0,0,0,0]"),e.push("polyline;V004;13.267801283999999;7.94;0;2.9;[0,0,0,1.125,0,0,1.125,2.42399997168,0,0,2.42399997168,0,0,0,0]"),e.push("polyline;V005;13.267801283999999;6.665;0;2.9;[0,0,0,1.125,0,0,1.125,2.42399997168,0,0,2.42399997168,0,0,0,0]"),e.push("polyline;0V03;13.267801283999999;12.19;0;2.9;[0,0,0,2.3,0,0,2.3,2.424,0,0,2.424,0,0,0,0]"),e.push("polyline;%C3%98003;63.991801284000005;10.87;0;2.9;[0,0,0,4.505,0,0,4.505,3.68699998522,0,0.00006659266824370003,3.68500001478,0,0,3.835,0,0,3.81,0,0,3.31,0,0,0,0]"),e.push("polyline;M001;86.501801284;12.05;0;2.9;[0,0,0,3.25,0,0,3.25,2.4,0,2,2.4,0,1.3500000000099999,2.4,0,1.35,1.43,0,0,1.43,0,0,0,0]"),e.push("polyline;M002;86.501801284;8.65;0;2.9;[0,0,0,2.985,0,0,2.985,2.4,0,0,2.4,0,0,0,0]"),e.push("polyline;M003;91.151801284;10.05;0;2.9;[0,0,0,-2,-2.4492935982947064e-16,0,-1.9999999999999996,-3.0700000000000003,0,-0.7999999999989996,-3.07,0,-0.7999999999929998,-2.1,0,2.571758278209442e-16,-2.1,0,0,0,0]"),e.push("polyline;M004;93.561801284;7.5;0;2.9;[0,0,0,-2.4,-2.9391523179536476e-16,0,-2.3999999999999995,-4.51,0,5.523157064154562e-16,-4.51,0,0,0,0]"),e.push("polyline;M005;91.301801284;12.05;0;2.9;[0,0,0,2,0,0,2,2.26,0,0,2.26,0,0,0,0]"),e.push("polyline;M007;86.351801284;18.7480031249;0;2.9;[0,0,0,2.658,0,0,2.658,7.45,0,0,7.45,0,0,0,0]"),e.push("polyline;F001;90.2488012917;21.0050031249;0;2.9;[0,0,0,-5.789,-7.089480320264027e-16,0,-5.789,-2.021000000000001,0,-4.617,-2.0210000000000004,0,-4.616999999999999,-3.8970000076200004,0,-2.8099968750899995,-3.8970000076200004,0,4.772448585609044e-16,-3.89700000762,0,0,0,0]"),e.push("polyline;%C3%98021;85.951801284;21.0050031249;0;2.9;[0,0,0,-1.79876944444,-2.2028572425375088e-16,0,-1.7987694444399998,-1.1953429853300002,0,-1.4128716427099999,-1.6552380769200001,0,-0.5760080155469999,-0.9530261160260001,0,0.000007224525273246713,-0.953026116026,0,0,0,0]"),e.push("polyline;%C3%98022;82.64895031859999;23.815;0;2.9;[0,0,0,2.8100219127300003,0,0,2.81001373438,1.07885097303,0,1.74383241693,1.07885097303,0,0.911227430642,2.07111095665,0,0.911227430642,3.30285096541,0,0,3.30285096541,0,0,0,0]"),e.push("polyline;%C3%98023;81.951801284;23.815;0;2.9;[0,0,0,3.3849970754000003,0,0,3.38499690186,1.77600000508,0,3.01001373438,1.77600000508,0,3.01002342886,0.497149034587,0,0,0.497149034587,0,0,0,0]"),e.push("polyline;%C3%98024;78.801801284;23.815;0;2.9;[0,0,0,3.3849973832,0,0,3.3849970871300004,3.03,0,0,3.03,0,0,0,0]"),e.push("polyline;%C3%98025;75.201801284;23.815;0;2.9;[0,0,0,3.3849977349800002,0,0,3.38499739493,3.48,0,0,3.48,0,0,0,0]"),e.push("polyline;%C3%98026;70.851801284;23.815;0;2.9;[0,0,0,3.38499816003,0,0,3.3849977467,4.23,0,1.5,4.23,0,1.5,2.23,0,0,2.23,0,0,0,0]"),e.push("polyline;%C3%98027;66.931801284;23.815;0;2.9;[0,0,0,3.38499854308,0,0,3.38499817176,3.8,0,0,3.8,0,0,0,0]"),e.push("polyline;%C3%98028;64.311801284;23.815;0;2.9;[0,0,0,3.38499879909,0,0,3.3849985548,2.5,0,0,2.5,0,0,0,0]"),e.push("polyline;%C3%98029;58.7328975191;23.815;0;2.9;[0,0,0,3.38499934423,0,0,3.38499881081,5.4589037649800005,0,0,5.4589037649800005,0,0,0,0]"),e.push("polyline;%C3%98030;58.6128975191;20.430000644;0;2.9;[0,0,0,-3.38499935595,-4.1454286263800195e-16,0,-3.384999355949999,-6.47109623502,0,6.323206322034809e-7,-6.47109623502,0,0,0,0]"),e.push("polyline;%C3%98020;75.251801284;18.779999983699998;0;2.9;[0,0,0,3.58999998374,0,0,3.58999998374,1.78,0,-1.522848336320001e-8,1.78,0,0,0,0]"),e.push("polyline;%C3%98013;73.651801284;18.7799999701;0;2.9;[0,0,0,3.58999997006,0,0,3.58999997006,1.48,0,-1.2661885762100007e-8,1.48,0,0,0,0]"),e.push("polyline;%C3%98013.1;69.651801284;18.7799999358;0;2.9;[0,0,0,3.5899999358300003,0,0,3.5899999358300003,3.88,0,-3.319467722920002e-8,3.88,0,0,0,0]"),e.push("polyline;%C3%98014;69.531801284;15.19;0;2.9;[0,0,0,-3.58999993481,-4.396481929104273e-16,0,-3.5899999174399997,-2.0300000000000002,0,2.4860330022691267e-16,-2.03,0,0,0,0]"),e.push("polyline;%C3%98015;65.801801284;18.7799999029;0;2.9;[0,0,0,3.5899999029000003,0,0,3.5899999029000003,1.58,0,-1.3517421848500008e-8,1.58,0,0,0,0]"),e.push("polyline;%C3%98016;64.001801284;18.779999887499997;0;2.9;[0,0,0,3.5899998875000003,0,0,3.5899998875000003,1.68,0,-1.4372950829500008e-8,1.68,0,0,0,0]"),e.push("polyline;%C3%98017;63.881801284;15.19;0;2.9;[0,0,0,-3.5899998864700002,-4.3964818699048474e-16,0,-3.5899998676499996,-2.2000000000000006,0,2.6942229581241775e-16,-2.2,0,0,0,0]"),e.push("polyline;%C3%98018;60.311801284;18.7479998843;0;2.9;[0,0,0,3.68799988432,0,0,3.68799988432,1.25,0,1.7698720711200013e-8,1.25,0,0,0,0]"),e.push("polyline;%C3%98033;60.191801284;15.24;0;2.9;[0,0,0,-3.50799988602,-4.2960608318236726e-16,0,-3.507999965989999,-5.648,0,6.91680512158425e-16,-5.648,0,0,0,0]"),e.push("polyline;%C3%98031;52.141801284;18.748;0;2.9;[0,0,0,1.156,0,0,1.156,2.252,0,3.188605646190002e-8,2.252,0,0,0,0]"),e.push("polyline;%C3%98032;52.141801284;17.442;0;2.9;[0,0,0,2.202,0,0,2.202,2.252,0,0,2.252,0,0,0,0]"),e.push("polyline;N021;59.506801284;30.5282293944;0;2.9;[0,0,0,-2.96377060564,-3.629572185604039e-16,0,-5.00677060564,-6.131525596262081e-16,0,-5.006770605639999,-6.995000000000001,0,5.5182293943600005,-6.994999999999999,0,5.918229394360001,-6.994999999999999,0,6.27822939436,-6.994999999999999,0,6.278229394359999,7.688613532115799e-16,0,5.65,6.919254415182546e-16,0,0,0,0]"),e.push("polyline;N021.1;56.111801284;39.135;0;2.9;[0,0,0,3.45,0,0,3.45,3.395,0,1.393,3.395,0,0,3.395,0,0,0,0]"),e.push("polyline;N022.1;55.961801284;35.685;0;2.9;[0,0,0,-3.45,-4.225031457058369e-16,0,-3.4499999999999997,-3.4500000000000006,0,4.225031457058369e-16,-3.45,0,0,0,0]"),e.push("polyline;N022;52.511801284;51.135;0;2.9;[0,0,0,11.85,0,0,11.85,6.995,0,0,6.995,0,0,0,0]"),e.push("polyline;%C3%98023.1;52.511801284;58.359;0;2.9;[0,0,0,2.298,0,0,2.298,2.34900050095,0,2.27208470471,2.34900002847,0,0,2.3474725972,0,0,0,0]"),e.push("polyline;%C3%98023.2;54.985290044;58.335;0;2.9;[0,0,0,2.247999999997057,0.00151124009024343,0,2.2480847047160752,-0.1244887314449699,0,2.2479999999973534,4.521511240089098,0,3.964710504344993e-15,4.521511240090343,0,0,0,0]"),e.push("polyline;N025;52.511801284;68.0051957557;0;2.9;[0,0,0,5.413548409840001,0,0,9.52019575574,0,0,9.52019575574,2.47338792094,0,9.52019575574,6.995,0,0,6.995,0,0,1.77450937975,0,0,0,0]"),e.push("polyline;N014;48.961801284;64.8916473459;0;2.9;[0,0,0,-3.1135484098400004,-3.812997094100888e-16,0,-3.11354840984,-4.65,0,5.694607616035193e-16,-4.65,0,4.0413344371862655e-16,-3.3,0,0,0,0]"),e.push("polyline;N014.1;45.661801284;64.74164734589999;0;2.9;[0,0,0,1.84988128164,0,0,1.84994109394,3.3,0,0,3.3,0,0,0,0]"),e.push("polyline;N014.2;49.111801284;68.0051957557;0;2.9;[0,0,0,5.11349222252,0,0,5.11354840984,3.1,0,0,3.1,0,0,0,0]"),e.push("polyline;N010;36.4816689404;46.335;0;2.9;[0,0,0,6.99999621874894,0.0001323435903302405,0,6.999999999996419,-0.19986765629692518,0,7.000000000004821,5.030132343630796,0,-1.962988690866474e-15,5.030132343629,0,0,0,0]"),e.push("polyline;N011;36.4815328155;53.535;0;2.9;[0,0,0,7.050000000000003,0.00013328897369274068,0,7.0500000000001455,5.030268468532693,0,1.3823577699190182e-16,5.030268468539025,0,0,0,0]"),e.push("polyline;0%C3%9802.1;41.961801284;23.88;0;2.9;[0,0,0,3.3818693442099996,0,0,3.3801572058000002,1.03859120886,0,0,1.03859120886,0,0,0,0]"),e.push("polyline;0%C3%9802;43.0003924929;20.499842794200003;0;2.9;[0,0,0,-0.010157205800951159,6.161408791137086,0,-3.3151572057960115,6.161408791133492,0,-3.315157205804406,6.311408791134434,0,-3.5901572057961557,6.311408791132393,0,-3.590157205797761,6.161408791131435,0,-3.3801572057984317,6.161408791137184,0,-3.380157205802952,4.431408791132149,0,-3.380157205799156,-5.532900526628026e-15,0,0,0,0]"),e.push("polyline;VO15;0.251801284046;12.2348578223;0;2.9;[0,0,0,1.54985782234,0,0,1.54985782234,0.14,0,1.93985782234,0.14,0,1.93985782234,0,0,6.00485782234,0,0,6.00485782234,0.14,0,6.39485782234,0.14,0,6.39485782234,0,0,6.46985782234,0,0,11.8448578223,0,0,11.8462339716,0.14,0,11.9848578223,0.14,0,11.9848578223,3.3,0,6.00485782234,3.3,0,6.00485782234,4.8,0,4.27485782234,4.8,0,4.27485782234,3.3,0,3.66985782234,3.3,0,3.66985782234,3.538,0,1.93985782234,3.538,0,1.93985782234,3.3,0,0,3.3,0,0,0,0]"),e.push("polyline;N012;36.4813966906;60.735;0;2.9;[0,0,0,7.050000000000003,0.00013328897369274068,0,7.049999999996536,5.030404593442717,0,-2.6266966032806316e-15,5.030404593449048,0,0,0,0]"),e.push("polyline;N013;36.4812592386;68.0051957557;0;2.9;[0,0,0,7.120195755737458,0.00013461611131224984,0,7.120195755740383,5.030542045490361,0,-2.6192508448610874e-14,5.0305420454890735,0,-9.68414801474915e-15,3.15505142524388,0,0,0,0]"),e.push("polyline;N010.1;34.316801284;44.8351176582;0;2.9;[0,0,0,3.65011765822,0,0,3.65011765822,1.96496502346,0,0,1.96489601347,0,0,0,0]"),e.push("polyline;N011.1;34.316801284;51.635;0;2.9;[0,0,0,3.65,0,0,3.65,1.96483646105,0,0,1.96476745328,0,0,0,0]"),e.push("polyline;N012.1;36.2814940577;55.585;0;2.9;[0,0,0,-3.6501176582176407,-0.00006900999100127861,0,-3.6501176582243606,-1.9646927736421247,0,3.380562702600537e-15,-1.9646927736411357,0,0,0,0]"),e.push("polyline;N013.1;34.316801284;66.035;0;2.9;[0,0,0,3.65,0,0,3.65,1.96456421123,0,0,1.96449520346,0,0,0,0]"),e.push("polyline;N013.4;34.366801284000005;68.0541957557;0;2.9;[0,0,0,1.9191957557400001,0,0,1.9191957557400001,1.9144933128400001,0,0.0490000001717,1.91445795447,0,0,1.91445795447,0,0,0,0]"),e.push("polyline;0%C3%9804;42.3420898321;17.355;0;2.9;[0,0,0,1.34280158206,0,0,1.715,0,0,1.715,2.92966213222,0,1.4646959189900002,2.92966213222,0,-0.13500000001,2.93,0,-0.545,2.93,0,-0.545,0,0,0,0,0]"),e.push("polyline;N023;52.511801284;55.935;0;2.9;[0,0,0,4.65,0,0,4.65,6.995,0,-0.0019999999750600003,6.995,0,-0.00191645302151,2.41250272847,0,0,2.41250272847,0,0,0,0]"),e.push("polyline;N015;49.761801284;51.71;0;2.9;[0,0,0,-6.35,-7.776507174585692e-16,0,-6.349999999999999,-5.450000000000001,0,6.674325055353075e-16,-5.45,0,0,0,0]"),e.push("polyline;N016;44.311801284;51.56;0;2.9;[0,0,0,2.8,0,0,2.8,5.45,0,0,5.45,0,0,0,0]"),e.push("polyline;N017;46.761801284;46.61;0;2.9;[0,0,0,-2,-2.4492935982947064e-16,0,-1.9999999999999998,-2.4500000000000006,0,0.2500000000000003,-2.45,0,0.25,3.061616997868383e-17,0,0,0,0]"),e.push("polyline;N017.1;46.911801284;48.61;0;2.9;[0,0,0,2,0,0,2,0.25,0,2.25,0.25,0,2.25,2.85,0,0,2.85,0,0,0,0]"),e.push("polyline;N018;44.311801284;46.21;0;2.9;[0,0,0,3.7,0,0,3.7,2.81774939693,0,3.7,5.45,0,0,5.45,0,0,0,0]"),e.push("polyline;1N06;44.361801284;42.26;0;2.9;[0,0,0,2.925,0,0,2.925,2.77,0,0,2.76792660977,0,0,0,0]"),e.push("polyline;N004;43.271801284;38.695;0;2.9;[0,0,0,4.515,0,0,4.515,3.58,0,0,3.58,0,0,0,0]"),e.push("polyline;N005.1;41.901801284;37.05;0;2.9;[0,0,0,1.2,0,0,1.2,1.25,0,0,1.25,0,0,0,0]"),e.push("polyline;N005.2;41.901801284;38.695;0;2.9;[0,0,0,1.525,0,0,1.525,1.25,0,0,1.25,0,0,0,0]"),e.push("polyline;N005.3;41.901801284;35.73;0;2.9;[0,0,0,1.55,0,0,1.55,1.25,0,0,1.25,0,0,0,0]"),e.push("polyline;N003.2;41.901801284;28.91;0;2.9;[0,0,0,4.78,0,0,4.78,0.06,0,4.78,4.95,0,0,4.95,0,0,0,0]"),e.push("polyline;N002;47.431801284;32.061;0;2.9;[0,0,0,5.87,0,0,5.87,2,0,0,2,0,0,0,0]"),e.push("polyline;N001;47.431801284;26.039;0;2.9;[0,0,0,1.909,0,0,1.999,0,0,1.999,1.57,0,1.789,1.57,0,1.789,2,0,0,2,0,0,0,0]"),e.push("polyline;0%C3%9801.1;45.271751964299995;14.9683686802;0;2.9;[0,0,0,-0.636170469449,-7.79084129122787e-17,0,-0.5216313197550001,-0.001091318667690064,0,-0.5216313197549999,-2.21966213222,0,-0.09163131975509972,-2.21966213222,0,-0.0916313197551,-0.0010913186676900113,0,0,0,0]"),e.push("polyline;0V02;36.5015668809;12.44;0;2.9;[0,0,0,-2.5,-3.061616997868383e-16,0,-2.4999999999999996,-2.4497655968200007,0,-2.499999999999997,-26.3297655968,0,-2.1549999999999967,-26.3297655968,0,-2.1549999999999967,-26.356489564799997,0,-0.34666298015699676,-26.3550428952,0,-0.34499999999999675,-26.3297655968,0,3.2244663160421223e-15,-26.3297655968,0,6.955000000000004,-26.3297655968,0,6.955000000000003,-23.3837655968,0,2.8636853690133116e-15,-23.3837655968,0,2.845438131706016e-15,-23.2347655968,0,2.492127530152005e-15,-20.3497655968,0,7.341470499784285e-16,-5.99476559682,0,7.150000000000001,-5.994765596819999,0,7.150000000000003,-23.2337655968,0,7.295000000000003,-23.2337655968,0,8.450000000000003,-23.2337655968,0,8.45,-4.729765596819999,0,7.150000000000001,-4.729765596819999,0,7.150000000000001,-4.794765596819999,0,6.950000000000001,-4.794765596819999,0,6.950000000000001,-4.7647655968199984,0,0.2000000000000006,-4.764765596819999,0,5.835154936833041e-16,-4.764765596819999,0,0,0,0]"),e.push("polyline;%C3%98005.1;85.951801284;5.965;0;2.9;[0,0,0,-4.72163125596,-5.782330604365512e-16,0,-4.72163125596,-3.2800000000000002,0,-4.64416301578,-3.2800000000000002,0,-4.64416301578,-3.4300000000000006,0,-3.7141630157799996,-3.4300000000000006,0,-3.7141630157799996,-3.2800000000000002,0,-0.39999999999999963,-3.28,0,4.0168415012033185e-16,-3.28,0,0,0,0]"),e.push("polyline;%C3%98026.1;75.08180128400001;22.415;0;2.9;[0,0,0,-1.4,-1.7145055188062944e-16,0,-1.3999999999999997,-1.9000000000000001,0,2.326828918379971e-16,-1.9,0,0,0,0]"),e.push("polyline;0%C3%9805;52.141801284;20.1300000117;0;2.9;[0,0,0,1.23000001173,0,0,1.23000014408,9.54,0,1.23000001173,25.01,0,1.22999688681,33.81,0,1.22999688681,40.46,0,-0.675003113187,40.46,0,-0.675003113187,34.21,0,-0.0000031131870166200006,34.21,0,-0.00000311318702018,33.81,0,-0.675003113181,33.81,0,-0.674994543678,32.6795505507,0,-0.8749945436719999,32.6795490346,0,-0.8749951306,32.756973884,0,-1.41461410531,32.756973884,0,-2.22359599493,32.0781574788,0,-1.89453680553,31.6860000076,0,-0.874987011958,31.6860000076,0,-0.874987569505,31.759549032,0,-0.6749875695109999,31.7595505482,0,-0.674987004372,31.685000005099997,0,-0.30000309608700004,31.685000005099997,0,-0.300003113187,31.86,0,-0.0000031131870486,31.8600000293,0,0,0,0]"),e.push("polyline;N003.1;41.901801284;32.7138986764;0;2.9;[0,0,0,3.6838986764199997,0,0,3.6838986764199997,3.277,0,1.71393398282,3.277,0,0,1.56306601718,0,0,0,0]"),e.push("polyline;N003;46.851801284000004;29.03;0;2.9;[0,0,0,-5.03,-6.159973399711187e-16,0,-5.029999999999999,-4.950000000000001,0,-3.6838986764199992,-4.950000000000001,0,-3.6838986764199992,-3.3869339828200005,0,-1.9699646935899997,-1.6730000000000003,0,2.048834094973522e-16,-1.673,0,0,0,0]"),e.push("polyline;0%C3%9808.1;67.421801284;12.27;0;2.9;[0,0,0,1.28,0,0,1.28,0.38,0,0.33,0.38,0,0.33,0.28,0,0,0.28,0,0,0,0]"),e.push("polyline;0%C3%9808.3;68.951801284;10.94;0;2.9;[0,0,0,-0.21,-2.5717582782094416e-17,0,-0.20999999999999988,-1,0,1.2246467991473532e-16,-1,0,0,0,0]"),e.push("polyline;0%C3%9808.2;68.951801284;11.27;0;2.9;[0,0,0,-1,-1.2246467991473532e-16,0,-0.9999999999999999,-1.0000000000000002,0,-0.6699999999999999,-1,0,1.2246467991473532e-16,-1,0,0,0,0]"),e.push("polyline;0N01;50.061801284;58.36;0;2.9;[0,0,0,15.85,0,0,16.15,0,0,16.15,-2.63203787229,0,19.0248936723,-2.63,0,19.275,-2.63,0,19.665,-2.63,0,26.149,-2.63,0,26.149,-0.48,0,34.11,-0.48,0,34.11,-0.395,0,34.27,-0.395,0,34.27,9.445,0,34.26,9.445,0,34.26,1.875,0,34.11,1.875,0,34.11,2.3,0,33.75,2.3,0,33.75,2.05,0,33.35,2.05,0,33.35,2.3,0,26.55,2.3,0,26.55,2.05,0,26.15,2.05,0,26.15,2.3,0,19.35,2.3,0,19.35,2.05,0,18.95,2.05,0,18.95,2.3,0,12.15,2.3,0,12.15,2.05,0,11.75,2.05,0,11.75,2.3,0,4.95,2.3,0,4.95,2.05,0,4.55,2.05,0,4.55,2.3,0,-2.25,2.3,0,-2.25,2.05,0,-2.65,2.05,0,-2.65,2.3,0,-4.231644627110001,2.3,0,-4.2317642517200005,-4.3,0,-2.65,-4.3,0,-2.65,-2.415845301580003e-13,0,0,0,0]"),e.push("polyline;0N04;44.837310663800004;60.86;0;2.9;[0,0,0,2.5,0,0,2.5,5.07449062025,0,0,5.07449062025,0,0,0.924490620251,0,0,0,0]"),e.push("polyline;0N04.1;44.711310663800006;58.36;0;2.9;[0,0,0,-2.5,-3.061616997868383e-16,0,-2.5,-0.7000000000000003,0,8.572527594031472e-17,-0.7,0,0,0,0]"),e.push("polyline;0N05;44.111801284;42.51;0;2.9;[0,0,0,-15.55,-1.9043257726741342e-15,0,-15.55,-0.4004906202510019,0,-18.35,-0.40049062025100224,0,-18.65,-0.4004906202510023,0,-18.65,1.3499999999999979,0,-20.3817696893,1.3499999999999976,0,-22.1816473459,1.3499999999999974,0,-22.1816473459,-2.7164683421971816e-15,0,-25.4951957557,-3.122260987585319e-15,0,-25.4951957557,-2.400000000000003,0,3.1750000000000003,-2.3999999999999995,0,3.175,3.888253587292846e-16,0,0,0,0]"),e.push("polyline;N012.2;34.366801284000005;55.485;0;2.9;[0,0,0,1.8,0,0,1.8,1.91472869549,0,0,1.91469466427,0,0,0,0]"),e.push("polyline;N012.3;34.316801284;60.735;0;2.9;[0,0,0,1.39988234178,0,0,1.39988234178,0.9330192063849999,0,0,0.9330192063849999,0,0,0,0]"),e.push("polyline;N012.4;36.2814231571;59.3351176582;0;2.9;[0,0,0,-1.399882341779809,-0.00002646650789044393,0,-1.399882341779013,-0.9316026666423844,0,-4.1263718245261594e-16,-0.9316026666424988,0,0,0,0]"),e.push("polyline;N011.4;34.366801284000005;53.535;0;2.9;[0,0,0,1.8,0,0,1.8,1.91476556266,0,0,1.91473153143,0,0,0,0]"),e.push("polyline;N011.2;35.249820490400005;46.485;0;2.9;[0,0,0,-1.4,-1.7145055188062944e-16,0,-1.3999999999999997,-0.9330192063850001,0,1.1426189846423939e-16,-0.9330192063849999,0,0,0,0]"),e.push("polyline;N011.3;36.2816661044;46.485;0;2.9;[0,0,0,-1.399999999999788,-0.000026468732365305036,0,-1.399999999995813,-0.9318456140179027,0,-4.6505463054732216e-15,-0.9318456140175422,0,0,0,0]"),e.push("polyline;N010.2;34.366801284000005;41.085;0;2.9;[0,0,0,1.75,0,0,1.75,1.915,0,0,1.9149669140799999,0,0,0,0]"),e.push("polyline;N010.3;34.316801284;46.335;0;2.9;[0,0,0,1.39988234178,0,0,1.39988234178,0.9330192063849999,0,0,0.9330192063849999,0,0,0,0]"),e.push("polyline;N010.4;36.2816954069;44.9351176582;0;2.9;[0,0,0,-1.399882341779809,-0.00002646650789044393,0,-1.3998823417817932,-0.9318749164614333,0,-2.001606616997692e-15,-0.9318749164615474,0,0,0,0]"),e.push("polyline;N013.2;35.249820490400005;60.885;0;2.9;[0,0,0,-1.4,-1.7145055188062944e-16,0,-1.3999999999999997,-0.9330192063850001,0,1.1426189846423939e-16,-0.9330192063849999,0,0,0,0]"),e.push("polyline;N013.3;36.2813938546;60.885;0;2.9;[0,0,0,-1.399999999999788,-0.000026468732365305036,0,-1.4000000000030328,-0.9315733641988541,0,-3.042796456421623e-15,-0.9315733641994934,0,0,0,0]"),e.push("polyline;0%C3%9801.2;42.902089832099996;15.06;0;2.9;[0,0,0,-0.43,-5.265981236333619e-17,0,-0.4299999999999999,-0.71,0,8.694992273946207e-17,-0.71,0,0,0,0]"),e.push("polyline;0%C3%9801;56.636801284;14.94;0;2.9;[0,0,0,4.567932560819627e-16,-7.46,0,-0.29999999999999954,-7.46,0,-0.2999999999999997,-4.615,0,-8.875,-4.615000000000001,0,-8.875,-7.325000000000001,0,-5.489999999999999,-7.325,0,-5.49,-6.795,0,-5.19,-6.795,0,-5.1899999999999995,-7.325,0,-5.089999999999999,-7.325,0,-5.089999999999999,-7.475,0,-5.369999999999999,-7.475,0,-5.369999999999999,-11.214711452,0,-5.08183760684,-11.214711452,0,-4.984999999999999,-11.364711452,0,-3.654999999999999,-11.364711452,0,-3.519999999999999,-11.214711452,0,-2.549999999999999,-11.214711452,0,-2.414999999999999,-11.364711452,0,-1.0849999999999993,-11.364711452,0,-0.9503040809999993,-11.2150493198,0,6.867237125886385e-16,-11.2150493198,0,9.14504997263286e-16,-14.935,0,-0.9499391344049991,-14.935,0,-1.072198417939999,-14.294711452,0,-2.414999999999999,-14.294711452,0,-2.550060865599999,-14.935,0,-2.649999999999999,-14.935,0,-2.649999999999999,-18.025,0,1.103712927731552e-15,-18.025,0,1.2255796373031433e-15,-20.0152344032,0,2.5000000000000013,-20.0152344032,0,2.500000000000001,-14.405,0,2.5424117442200007,-14.405,0,2.5424117442200003,-7.485,0,2.5000000000000004,-7.485,0,2.5000000000000004,-7.085,0,2.5425000000000004,-7.085,0,2.5425000000000004,-3.805,0,2.5000000000000004,-3.80490593235,0,2.5,-3.40488097837,0,2.5425,-3.405,0,2.5425,-0.12499999999999985,0,2.5001802339699997,-0.12499999999999985,0,2.5001802339699997,1.5309188604114204e-16,0,0,0,0]"),e.push("polyline;%C3%98001;42.231801284;12.282588255799999;0;2.9;[0,0,0,6.79514691891,0,0,6.79514691891,0.12,0,6.97514691891,0.12,0,6.97514691891,6.869,0,5.86658825578,6.869,0,5.86658825578,6.92,0,0,6.92,0,0,0,0]"),e.push("polyline;%C3%98001.3;41.951801284;0.426;0;2.9;[0,0,0,-1.3498057020202126e-15,7.348,0,-4.830441336860002,7.347999999999999,0,-4.830441336860001,7.148999999999999,0,-4.881441336860001,7.148999999999999,0,-4.88144133686,-8.967062262616763e-16,0,0,0,0]"),e.push("polyline;%C3%98001.2;53.231801284;12.2525;0;2.9;[0,0,0,0.3123197660340815,0.00011902163469557517,0,0.3124999999996115,-0.09700000000006433,0,2.110499999995328,-0.09700000000005003,0,2.110500000002986,-0.04202094638127534,0,2.2105000000044273,-0.042020946381279914,0,2.2105000000022357,6.930000000003434,0,0.31250000000007966,6.929999999999123,0,0.31249999999965744,6.960426914828556,0,-0.029999999999978943,6.960426914827444,0,-0.03000000000002441,3.6800000000011654,0,0.3125000000002241,3.68002495398409,0,0.31250000000029365,3.2799999999965124,0,-2.2941717969793274e-16,3.2799999999952782,0,0,0,0]"),e.push("polyline;%C3%98001.1;60.165801284000004;0.426;0;2.9;[0,0,0,-9.61600000000328,-0.003999999999894853,0,-9.615999999996959,-7.1309999999959395,0,-11.51399999995606,-7.130999999998477,0,-11.514180234012922,-7.333905932345835,0,-11.856500000029374,-7.333905932342836,0,-11.85650000003894,-10.614000000016459,0,-10.789999999968636,-10.6140000000475,0,-10.789999999979916,-10.862000000003702,0,-5.990000017717692,-10.862000050570902,0,-5.989999999999488,-10.562987687693907,0,-4.830441336868047,-10.5629876877019,0,-4.830441336863916,-10.86600000001759,0,2.8536201179818477e-15,-10.86599999999279,0,0,0,0]"),e.push("polyline;%C3%98002;60.311801284;6.365;0;2.9;[0,0,0,-6.484504801485234e-16,3.53,0,-5.575000000000001,3.529999999999999,0,-5.575000000000001,3.560264525249999,0,-5.925000000000001,3.559999999999999,0,-5.925,0.2799999999999989,0,-5.575,0.28045186881199896,0,-5.575,-1.0241108857869742e-15,0,0,0,0]"),e.push("polyline;0%C3%9807;56.786801284;14.94;0;2.9;[0,0,0,2.5001802459799998,-3.899745563147662e-8,0,2.5001802339701213,0.12502495398054456,0,2.5424999625101226,0.12502499460844746,0,2.5425000600873635,3.4054268497124465,0,2.5001802339673644,3.405426914832545,0,2.4999999999989195,5.358999999995356,0,-4.9618347914118886e-15,5.359,0,0,0,0]"),e.push("polyline;0%C3%9808;62.265801284;14.94;0;2.9;[0,0,0,2.5,0,0,2.5001802339699997,2.00628947923,0,3,2.00628947923,0,3,1.726,0,3.92,1.726,0,3.92,5.036,0,2.5,5.036,0,2.5,21.4572285716,0,0,21.4572285716,0,0,0,0]"),e.push("polyline;%C3%98006;82.671801284;10.836631256;0;2.9;[0,0,0,-6.025262251804977e-16,3.28,0,-1.6033687440400006,3.2799999999999994,0,-1.603368744040001,6.63,0,-5.103371868950001,6.629999999999999,0,-5.103371868950001,3.6799999999999993,0,-4.103368744040001,3.6799999999999993,0,-4.10336874404,1.2012285715699993,0,-1.45336874404,1.2012285715699997,0,-1.45336873337,0.000024955430830833033,0,0,0,0]"),e.push("polyline;%C3%98005;78.5921167564;11.94;0;2.9;[0,0,0,5.57500000000419,-0.00031547231924414405,0,5.57499999999879,3.929684527682852,0,0.7999999999998132,3.929684527681189,0,0.8000000000002634,4.079684527681345,0,-1.334018616058752e-14,4.079709481661788,0,-1.3300829621726296e-14,3.67968452768133,0,-0.49981976603400374,3.679684527683939,0,-0.4998197660339615,0.4000249539810653,0,5.606206146015202e-16,0.4000249539804569,0,0,0,0]"),e.push("polyline;%C3%98004;75.31391483910001;12.439819766000001;0;2.9;[0,0,0,0.499819766034,0,0,0.499819766034,-0.400024953981,0,0,-0.400024953981,0,0,-3.6809374983399996,0,0.499819766034,-3.6809374983399996,0,0.499819766034,-4.08096245232,0,0,-4.08096245232,0,-0.00018023396597400003,-6.16211355505,0,1.56981976603,-6.16211355505,0,1.56981976603,-7.4871135550500005,0,6.07481976603,-7.48511355505,0,6.07481976603,3.27788644495,0,0,3.27820191727,0,0,0,0]"),e.push("polyline;%C3%98007;81.0518000199;18.7500013849;0;2.9;[0,0,0,3.060001384899807,0.0000010866180278134203,0,3.060001384902767,1.3200012641681111,0,3.5600013849027987,1.320001264169996,0,3.5600013849013026,4.900001264170222,0,-0.0000017400089216396455,4.90000126416969,0,0,0,0]"),e.push("polyline;%C3%98012;77.171801284;15.09;0;2.9;[0,0,0,-6.888638245203861e-16,3.75,0,-0.1000000000000007,3.75,0,-0.10000312491300069,3.76,0,-3.660001342290001,3.759998735829999,0,-3.66,-0.01999997272560067,0,-0.1,-0.020000000000000018,0,-0.1,-1.8369701987210297e-17,0,0,0,0]"),e.push("polyline;0%C3%9803;42.3420898321;20.31;0;2.9;[0,0,0,2.26,0,0,2.26,2.93,0,1.85,2.93,0,0.288925626628,2.93,0,0,2.93,0,0,0,0]"),e.push("polyline;0V05;10.181801283999999;5.29;0;2.9;[0,0,0,4.9,0,0,5.015,0,0,5.015,2.87,0,4.9,2.87,0,4.9,2.936,0,0.145,2.936,0,-0.045,2.936,0,-0.045,-0.01,0,0,-0.01,0,0,0,0]")}),4e3)},beforeDestroy(){this.removeEventListerners()},created(){this.addEventListerners()}},O=F,C=(a("71b0"),a("2877")),N=a("6544"),L=a.n(N),P=a("8336"),D=a("b0af"),k=a("99d9"),U=a("a523"),M=a("169a"),B=a("490a"),V=a("0fd9"),G=a("b974"),z=a("ba0d"),W=a("2fa4"),H=a("b73d"),q=a("8654"),Y=Object(C["a"])(O,o,s,!1,null,"22db587f",null);t["a"]=Y.exports;L()(Y,{VBtn:P["a"],VCard:D["a"],VCardActions:k["a"],VCardText:k["c"],VContainer:U["a"],VDialog:M["a"],VProgressCircular:B["a"],VRow:V["a"],VSelect:G["a"],VSlider:z["a"],VSpacer:W["a"],VSwitch:H["a"],VTextField:q["a"]})},"3a29":function(e,t,a){e.exports=a.p+"img/paragraph3.c46aba7a.png"},"3dc1":function(e,t,a){},"3e76":function(e){e.exports=JSON.parse('{"tag":"NMH.Y.SYKEHUS.HN.H.MOIRANA.SJOFORSGATA.HOVEDBYGG","storeys":{"EU1":"Mir_somatisk U etg","E01":"Mir_somatisk 1 etg","E02":"Mir_somatisk 2 etg","E03":"Mir_somatisk 3 etg","E04":"Mir_somatisk 4 etg","E05":"Mir_somatisk 5 etg","E06":"Mir_somatisk 6 etg"},"numberofstoreys":7,"buildingdimensions":{"v1":{"x":0,"y":20.11,"z":0},"v2":{"x":112.61,"y":0,"z":0},"v3":{"x":0,"y":78.4,"z":30}},"buildinglat":66.32595328821219,"buildinglong":14.1852250223792,"building2lat":66.32597229455098,"building2long":14.1877771172976,"xAnchorDisplacement":0,"yAnchorDisplacement":10.33,"matrikkelnr":"13242342355","buildingYear":1981,"buildingType":"Sykehus","buildingProtectionStatus":"1. fredning","buildingAddress":"Sjøforsgata 36","buildingNetArea":5705,"buildingGrossArea":6754,"numberOfRooms":1231,"operationsManager":""}')},"3e7c":function(e,t,a){},4:function(e,t){},"40d5":function(e,t,a){"use strict";a("841b")},"42a0":function(e,t,a){},4360:function(e,t,a){"use strict";var o=a("a026"),s=a("2f62"),r=a("5a89"),n=a("4721"),i=a("aea1"),l=a("02ba"),c=a("0719"),d=a("a2ed"),u=(a("0918"),a("a550"),a("32e1"),a("22b5")),h=a("10a2"),g=a("7d1a"),m=a("34ad"),p=a("657e"),f={namespaced:!0,state:{bimViewerCanvas:void 0,mapMode:!1,width:0,height:0,twodim:!1,thirdperson:!1,animationid:null,camera:null,twodimcamera:null,thirdpersoncamera:null,thirdPersonCameraOrigin:null,xAxis:new r["uc"](1,0,0),tempCameraVector:new r["uc"],tempModelVector:new r["uc"],thirdpersonContainer:new r["I"],thirdpersonLoaded:!1,coords:null,focuslat:null,focuslong:null,focusobject:null,buildingboxPosition:null,INTERSECTED:null,intersectXY:{x:0,y:0},selectedRoomURI:null,selectedRoomIDs:[],selectedRoomNames:[],selectedRoomName:"",lockSelection:!1,multiSelect:!1,raycaster:null,projector:null,mouseVector:null,camerafocuswidth:20,controls3d:null,controls2d:null,params:null,buildingbox:null,map:null,scene:null,renderer:null,labelrenderer:null,needsrender:!1,axisLines:[],boxes:[],lights:[],roomGeometry:[],boundingBoxDrawed:[],wayBetweenRooms:[],keysPressed:{},scaleFactor:1,characterControls:null,GLTFloadingFlag:!1,GLTFloadingQueue:[],IFCPropertyJson:null,animate:!0,gltfGeoVisible:!1,spacesVisible:!1,gltfLoadedList:[],TWEEN:u,physicsWorld:void 0,cannonDebugger:void 0,personBody:void 0,timestep:1/60,lastLabelCheck:(new Date).getTime(),sphereMesh:void 0,sphereBody:void 0,boxMesh:void 0,boxBody:void 0,bedModel:void 0,bedBody:void 0,allActions:void 0,baseActions:void 0,model:void 0,skeleton:void 0,mixer:void 0,clock:void 0,numAnimations:0,movingForward:!1,mousedown:!1,arrowModel:void 0,arrowModelStart:!1,drawBuildingBoxFlag:!1,selectedStorey:{name:"HAV",hag:3,uri:""}},getters:{},mutations:{SET_VIEWPORT_SIZE(e,{width:t,height:a}){e.width=t,e.height=a},RESIZE(e,{width:t,height:a}){console.log("Resizing view: "+t),e.width=t,e.height=a,e.renderer.setSize(t,a),e.twodim?(e.twodimcamera.aspect=t/a,e.twodimcamera.updateProjectionMatrix(),e.labelrenderer.setSize(t,a)):e.thirdperson?(e.thirdpersoncamera.aspect=t/a,e.thirdpersoncamera.updateProjectionMatrix()):(e.camera.aspect=t/a,e.camera.updateProjectionMatrix(),e.labelrenderer.setSize(t,a)),e.needsrender=!0},INITIALIZE_RENDERER(e,t){e.renderer=new r["yc"]({antialias:!0}),e.renderer.shadowMap.enabled=!0,e.renderer.shadowMap.type=r["Db"];const a=Math.min(window.devicePixelRatio,2);e.renderer.setPixelRatio(a),e.renderer.setSize(e.width,e.height),t.appendChild(e.renderer.domElement)},INITIALIZE_LABEL_RENDERER(e,t){e.labelrenderer=new i["b"],e.labelrenderer.setSize(e.width,e.height),e.labelrenderer.domElement.style.position="absolute",e.labelrenderer.domElement.style.pointerEvents="none",e.labelrenderer.domElement.style.top="0",t.appendChild(e.labelrenderer.domElement)},INITIALIZE_CAMERA(e){e.camera=new r["Eb"](75,1,.2,1e12);var t=.2,a=500;e.twodimcamera=new r["Cb"](e.width/-2,e.width/2,e.height/2,e.height/-2,t,a),e.twodimcamera.position.set(0,300,0),e.thirdpersoncamera=new r["Eb"](75,window.innerWidth/window.innerHeight,.01,1e3),e.thirdpersoncamera.position.set(0,3.2,-1),e.thirdPersonCameraOrigin=new r["uc"](0,1.3,0),e.thirdpersoncamera.lookAt(e.thirdPersonCameraOrigin),e.thirdpersonContainer.add(e.thirdpersoncamera)},INITIALIZE_CONTROLS(e,t){e.controls3d=new n["a"](e.camera,e.renderer.domElement),e.coords=d["c"].datumsToSpherical(e.focuslat,e.focuslong),console.log(e.coords.x+" "+-e.coords.y),e.controls3d.target.set(e.coords.x,-10,-e.coords.y),e.controls3d.panSpeed=2,e.controls3d.noZoom=!1,e.controls3d.noPan=!1,e.controls3d.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},e.controls3d.touches={ONE:r["gc"].ROTATE,TWO:r["gc"].DOLLY_PAN},e.controls3d.autoRotate=!1,e.controls3d.rotateSpeed=.5,e.controls3d.autoRotateSpeed=.5,e.controls3d.enableDamping=!1,e.controls3d.minDistance=5,e.controls3d.zoomSpeed=1.5,e.controls2d=new n["a"](e.twodimcamera,e.renderer.domElement),e.controls2d.panSpeed=2,e.controls2d.zoomSpeed=.9,e.controls2d.enableDamping=!1,e.controls2d.noZoom=!1,e.controls2d.noPan=!1,e.controls2d.minDistance=5,e.controls2d.enablePan=!0,e.controls2d.enableRotate=!1,e.controls2d.touches={ONE:r["gc"].PAN,TWO:r["gc"].DOLLY_PAN},e.controls2d.screenSpacePanning=!1,e.controls2d.target.set(0,0,0)},INITIALIZE_MAP(e){var t="pk.eyJ1IjoibWFydGhpbmkiLCJhIjoiY2w1ejBnYnpvMDlvYTNvcnlyN3B5YXNxeCJ9.FOG1KIIZzpyVWoNJkpcFkA",a=new d["a"](t,"mapbox/streets-v10",d["a"].STYLE);new d["a"](t,"mapbox.terrain-rgb",d["a"].MAP_ID,"pngraw");e.map=new d["b"](d["b"].PLANAR,a),e.map.receiveShadow=!0,e.map.name="map",e.map.renderOrder=2,e.scene.add(e.map),e.map.updateMatrixWorld(!0)},INITIALIZE_SCENE(e){e.scene=new r["Tb"],e.scene.background=new r["o"](13421772);new r["qb"]({color:39168,flatShading:!0});function t(){var e=new l["a"];e.scale.setScalar(1e8);var t={turbidity:5,rayleigh:2,mieCoefficient:.005,mieDirectionalG:.8,inclination:.48,azimuth:.25,exposure:.5};const a=e.material.uniforms;a["turbidity"].value=t.turbidity,a["rayleigh"].value=t.rayleigh,a["mieCoefficient"].value=t.mieCoefficient,a["mieDirectionalG"].value=t.mieDirectionalG;var o=Math.PI*(t.inclination-.5),s=2*Math.PI*(t.azimuth-.5),n=new r["uc"];return n.x=Math.cos(s),n.y=Math.sin(s)*Math.sin(o),n.z=Math.sin(s)*Math.cos(o),a["sunPosition"].value.copy(n),e}e.scene.add(t())},INITIALIZE_LIGHTS(e){d["c"].datumsToSpherical(e.focuslat,e.focuslong);var t=new r["u"](16777215,1);t.castShadow=!0,t.position.set(3,1,3),t.shadow.mapSize.width=5,t.shadow.mapSize.height=5,t.shadow.camera.near=5,t.shadow.camera.far=50,t.name="light";var a=new r["u"](16777215,.8);a.castShadow=!0,a.position.set(-3,1,-3),a.name="light",a.shadow.mapSize.width=512,a.shadow.mapSize.height=512,a.shadow.camera.near=500,a.shadow.camera.far=5e4;let o=new r["b"](16777215,.4);o.name="light",e.lights=[],e.lights.push(t),e.lights.push(o),e.lights.push(a),e.scene.add(...e.lights)},INITIALIZE_PLAYER_CONTROLS(e){function t(e,t){e.enabled=!0,e.setEffectiveTimeScale(1),e.setEffectiveWeight(t)}function a(a){const o=a.getClip(),s=e.baseActions[o.name];t(a,s.weight),a.play()}function o(e){e.getClip();e.reset(),e.stop()}e.thirdpersonLoaded||(e.scene.add(e.thirdpersonContainer),e.clock=new r["n"],e.allActions=[],e.baseActions={idle:{weight:1},MacarenaDance:{weight:0},SillyDancing:{weight:0},run:{weight:0},walk:{weight:0},push:{weight:0},jump:{weight:0}});const s=new m["a"];e.thirdpersonLoaded||s.load("../Doctor3.glb",(function(t){e.model=t.scene,e.model.name="Person",e.model.scale.set(.01,.01,.01),e.model.position.y=e.model.position.y+.9,e.thirdpersonContainer.add(e.model),e.thirdpersonContainer.position.y=e.thirdpersonContainer.position.y-2,e.model.traverse((function(e){e.isMesh&&(e.castShadow=!0)})),e.skeleton=new r["Zb"](e.model),e.skeleton.visible=!1,e.thirdpersonContainer.add(e.skeleton);const o=t.animations;e.mixer=new r["d"](e.model);let n=o.length;for(let s=0;s<n;++s){let t=o[s];const r=t.name;if(e.baseActions[r]){const o=e.mixer.clipAction(t);a(o),e.baseActions[r].action=o,e.allActions.push(o),e.numAnimations+=1}}s.load("../hospitalbed.glb",(function(t){e.bedModel=t.scene,e.bedModel.scale.set(.01,.01,.01),e.scene.add(e.bedModel)}),(function(t){let a=t.loaded/t.total*100;console.log(a+"% loaded"),100==a&&(console.log("GLTF loading finished!"),setTimeout((function(){window.requestAnimationFrame(()=>{e.needsrender=!0})}),300),e.GLTFloadingFlag=!1)}),(function(e){console.log("An error happened: "+e)}));const i=new r["j"](5,3,5),l=new r["mb"]({color:65280});e.boxMesh=new r["lb"](i,l),e.scene.add(e.boxMesh),e.physicsWorld=new h["h"]({gravity:new h["g"](0,-9.82,0)});const c=new h["a"]({type:h["a"].STATIC,shape:new h["d"]});c.quaternion.setFromEuler(-Math.PI/2,0,0),e.physicsWorld.addBody(c);const d=new h["c"]("personContactMaterial",{friction:1,restitution:0});e.physicsWorld.addContactMaterial(d),e.personBody=new h["a"]({shape:new h["b"](new h["g"](.4,.9,.4)),mass:80,material:d});const u=new h["c"](d,{friction:1,restitution:0,contactEquationStiffness:1e9,contactEquationRelaxation:1,frictionEquationStiffness:1e5,frictionEquationRelaxation:3});e.physicsWorld.addContactMaterial(u);const m=new h["a"]({type:h["a"].STATIC,shape:new h["b"](new h["g"](3,4,.1)),material:u});m.quaternion.setFromAxisAngle(new h["g"](1,0,0),-Math.PI/2.5),m.position=new h["g"](0,1,-3),e.physicsWorld.addBody(m),e.bedBody=new h["a"]({mass:10,shape:new h["b"](new h["g"](2,1.5,1))}),e.physicsWorld.addBody(e.bedBody),e.boxBody=new h["a"]({type:h["a"].STATIC,shape:new h["b"](new h["g"](800,.2,800))}),e.boxBody.position=new h["g"](-400,e.selectedStorey.hag*e.scaleFactor,-400),e.physicsWorld.addBody(e.boxBody),e.personBody.position.y=e.personBody.position.y+e.selectedStorey.hag*e.scaleFactor+.8,e.personBody.position.x=e.personBody.position.x+59*e.scaleFactor,e.personBody.position.z=e.personBody.position.z-23*e.scaleFactor,e.physicsWorld.addBody(e.personBody),e.cannonDebugger=new g["a"](e.scene,e.physicsWorld,{})})),e.thirdpersonLoaded||(window.addEventListener("keydown",t=>{const{keyCode:s}=t;87!==s&&38!==s||(e.baseActions.SillyDancing.weight=0,e.baseActions.MacarenaDance.weight=0,e.baseActions.idle.weight=0,e.baseActions.run.weight=5,a(e.baseActions.run.action),o(e.baseActions.idle.action),o(e.baseActions.MacarenaDance.action),o(e.baseActions.SillyDancing.action),e.movingForward=!0)}),window.addEventListener("keyup",t=>{const{keyCode:s}=t;87!==s&&38!==s||(e.baseActions.idle.weight=1,e.baseActions.run.weight=0,e.baseActions.jump.weight=0,o(e.baseActions.run.action),a(e.baseActions.idle.action),o(e.baseActions.jump.action),e.movingForward=!1)}),window.addEventListener("keydown",t=>{const{keyCode:s}=t;68===s&&(e.baseActions.MacarenaDance.weight=5,e.baseActions.SillyDancing.weight=0,e.baseActions.run.weight=0,e.baseActions.idle.weight=0,o(e.baseActions.SillyDancing.action),a(e.baseActions.MacarenaDance.action),o(e.baseActions.run.action),o(e.baseActions.idle.action),e.movingForward=!1)}),window.addEventListener("keydown",t=>{const{keyCode:s}=t;65===s&&(e.baseActions.SillyDancing.weight=5,e.baseActions.MacarenaDance.weight=0,e.baseActions.run.weight=0,e.baseActions.idle.weight=0,a(e.baseActions.SillyDancing.action),o(e.baseActions.MacarenaDance.action),o(e.baseActions.run.action),o(e.baseActions.idle.action),e.movingForward=!1)}),window.addEventListener("keydown",t=>{const{keyCode:s}=t;69===s&&(e.baseActions.jump.weight=40,a(e.baseActions.jump.action),setTimeout((function(){e.baseActions.jump.weight=0,o(e.baseActions.jump.action)}),800))}),window.addEventListener("pointerdown",t=>{e.mousedown=!0}),window.addEventListener("pointerup",t=>{e.mousedown=!1}),window.addEventListener("pointermove",t=>{if(e.thirdperson&&e.mousedown){const{movementX:a,movementY:o}=t,s=(new r["ec"]).setFromVector3(e.thirdpersoncamera.position.clone().sub(e.thirdPersonCameraOrigin)),n=s.phi-.02*o;s.theta-=.02*a,s.phi=Math.max(.01,Math.min(.6*Math.PI,n)),e.thirdpersoncamera.position.copy(e.thirdPersonCameraOrigin.clone().add((new r["uc"]).setFromSpherical(s))),e.thirdpersoncamera.lookAt(e.thirdpersonContainer.position.clone().add(e.thirdPersonCameraOrigin))}}),e.thirdpersonLoaded=!0)}},actions:{INIT({state:e,commit:t,dispatch:a,rootState:o},{width:s,height:n,el:i}){return new Promise(o=>{function l(t){e.scene.children.forEach(a=>{a.name.includes("buildinglabel")&&(t>=2e3?a.visible=!0:(1==a.visible&&(e.drawBuildingBoxFlag=!0),a.visible=!1))})}async function u(t){if(t<=2e3)return;const a=[],o=[];if(e.scene.children.forEach(t=>{if(t.name.includes("buildinglabel")){let s=void 0;s=e.twodim?t.position.clone().project(e.twodimcamera):t.position.clone().project(e.camera),a.push(t),o.push(s)}}),o.length>=2){const e=[],t=[];for(let s=0;s<o.length;s++)for(let r=s+1;r<o.length;r++){const n=o[s].distanceTo(o[r]);if(n<=.1){let o=0,n=0;a[s].cluster&&(o=a[s].cluster.length),a[r].cluster&&(n=a[r].cluster.length),o<n?(h(a[r],a[s]),a[s].visible=!1,e.push(a[s].element.uri),t.push(a[r].element.uri)):(h(a[s],a[r]),a[r].visible=!1,e.push(a[r].element.uri),t.push(a[s].element.uri))}else{let o=0,n=0;a[s].cluster&&(o=a[s].cluster.length),a[r].cluster&&(n=a[r].cluster.length),o<n?(t.includes(a[r].element.uri)||g(a[r],a[s]),e.includes(a[s].element.uri)||(a[s].visible=!0)):(t.includes(a[s].element.uri)||g(a[s],a[r]),e.includes(a[r].element.uri)||(a[r].visible=!0))}}}}function h(e,t){e.cluster||(e.cluster=[]),e.cluster.includes(e.element.uri)||e.cluster.push(e.element.uri),e.cluster.includes(t.element.uri)||e.cluster.push(t.element.uri),e.element.classList.remove("building-base-label"),e.element.classList.add("building-base-label"),e.element.childNodes[1].classList.remove("hidden"),e.element.childNodes[1].innerText=parseInt(e.cluster.length)+"",e.element.onmouseenter&&(e.element.mouseenter=e.element.onmouseenter),e.element.onmouseleave&&(e.element.mouseleave=e.element.onmouseleave),e.element.onmouseenter=null,e.element.onmouseleave=null}function g(e,t){e.cluster||(e.cluster=[]),t.cluster||(t.cluster=[]),e.cluster.includes(e.element.uri)||e.cluster.push(e.element.uri),e.cluster.includes(t.element.uri)&&e.cluster.splice(e.cluster.indexOf(t.element.uri),1),e.element.classList.add("building-base-label"),e.element.classList.remove("building-base-label"),e.element.childNodes[1].classList.add("hidden"),e.element.childNodes[1].innerText=parseInt(e.cluster.length)+"",t.element.childNodes[1].innerText=parseInt(t.cluster.length)+"",e.element.mouseenter&&(e.element.onmouseenter=e.element.mouseenter),e.element.mouseleave&&(e.element.onmouseleave=e.element.mouseleave)}e.params={time:0},e.focuslat=66.32624,e.focuslong=14.18643,e.coords=d["c"].datumsToSpherical(e.focuslat,e.focuslong),e.clock=new r["n"],t("SET_VIEWPORT_SIZE",{width:s,height:n}),t("INITIALIZE_RENDERER",i),t("INITIALIZE_LABEL_RENDERER",i),t("INITIALIZE_CAMERA"),t("INITIALIZE_CONTROLS"),t("INITIALIZE_SCENE"),e.mapMode&&t("INITIALIZE_MAP"),t("INITIALIZE_LIGHTS"),e.controls3d.addEventListener("change",()=>{try{if(!e.twodim){const t=(new Date).getTime()-e.lastLabelCheck;if(t>=600){e.lastLabelCheck=(new Date).getTime();const t=e.controls3d.getDistance();l(t),u(t)}a("RENDER")}}catch(t){console.log(t)}}),e.controls2d.addEventListener("change",()=>{try{if(e.twodim){const t=(new Date).getTime()-e.lastLabelCheck;if(t>=200){e.lastLabelCheck=(new Date).getTime();const t=4e3*(1-e.twodimcamera.zoom);l(t),u(t)}a("RENDER")}}catch(t){console.log(t)}}),e.projector=new c["a"],e.mouseVector=new r["tc"],e.raycaster=new r["Qb"],e.raycaster.firstHitOnly=!0,o()})},ANIMATE({state:e,dispatch:t}){window.requestAnimationFrame(()=>{e.twodim?e.controls2d.update():e.controls3d.update(),e.params.time+=.01,e.animate&&(t("RENDER"),t("ANIMATE"))})},RENDER({state:e,dispatch:t}){null!==e.animationid&&cancelAnimationFrame(e.animationid),e.animationid=window.requestAnimationFrame(()=>{u["update"](),e.twodim?(e.renderer.render(e.scene,e.twodimcamera),e.labelrenderer.render(e.scene,e.twodimcamera)):e.thirdperson?t("THIRDPERSON_ANIMATE"):(e.renderer.render(e.scene,e.camera),e.labelrenderer.render(e.scene,e.camera))})},CALL_RAYCAST({state:e,dispatch:t}){e.twodim?e.raycaster.setFromCamera(e.mouseVector,e.twodimcamera):e.raycaster.setFromCamera(e.mouseVector,e.camera);let a=e.raycaster.intersectObjects(e.scene.getObjectByName("buildingbox").children,!0),o=a[0];return o||(a=e.raycaster.intersectObjects(e.scene.children,!1)),a.forEach(e=>{e.object.visible&&(o=e)}),o&&(e.intersectXY.x=o.point.x,e.intersectXY.y=o.point.z),t("RENDER"),console.log(a[0]),a},THIRDPERSON_ANIMATE({state:e,dispatch:t}){for(let a=0;a<e.numAnimations;a++){const t=e.allActions[a],o=t.getClip();e.baseActions[o.name]}if(e.mixer){const t=e.clock.getDelta();e.mixer.update(t)}if(e.movingForward){e.thirdpersoncamera.getWorldDirection(e.tempCameraVector);const t=e.tempCameraVector.setY(0).normalize();e.model.getWorldDirection(e.tempModelVector);const a=e.tempModelVector.setY(0).normalize(),o=t.angleTo(e.xAxis)*(t.z>0?1:-1),s=a.angleTo(e.xAxis)*(a.z>0?1:-1),r=s-o;let n=r;r>Math.PI&&(n=r-2*Math.PI),r<-Math.PI&&(n=r+2*Math.PI),e.model.rotateY(Math.max(-.1,Math.min(n,.1))),e.thirdpersonContainer.position.add(t.multiplyScalar(.2)),e.personBody.position.x=e.thirdpersonContainer.position.x,e.personBody.position.z=e.thirdpersonContainer.position.z,e.camera.lookAt(e.thirdpersonContainer.position.clone().add(e.thirdPersonCameraOrigin)),console.log("state.personBody"),console.log(e.personBody)}e.physicsWorld&&(e.physicsWorld.step(e.timestep),e.thirdpersonContainer.position.copy(e.personBody.position),e.thirdpersonContainer.position.y=e.personBody.position.y-.9,e.personBody.quaternion.copy(e.thirdpersonContainer.quaternion),e.bedModel&&e.bedModel.position.copy(e.bedBody.position)),e.renderer.render(e.scene,e.thirdpersoncamera),window.requestAnimationFrame(()=>{t("RENDER")})},CONVERT_TO_UTM({commit:e,state:t},{lat:a,long:o,zoneNum:s,zoneLetter:r}){return new Promise((e,t)=>{let n=p.fromLatLon(a,o,s,r);e(n)})},CONVERT_FROM_UTM({commit:e,state:t},{easting:a,northing:o,zoneNum:s,zoneLetter:r}){return new Promise((e,t)=>{let n=p.toLatLon(a,o,s,r);e(n)})},CONVERT_TO_SPHERICAL({commit:e,state:t},{lat:a,long:o}){return new Promise((e,t)=>{let s=d["c"].datumsToSpherical(a,o);e(s)})},ADD_TO_SCENE({commit:e,state:t},{buildingbox:a}){t.boxes=[],t.boxes.push(a),t.scene.add(...t.boxes)},INITIALIZE_PLAYER({commit:e,dispatch:t}){e("INITIALIZE_PLAYER_CONTROLS")}}},b={namespaced:!0,state:{roomDetailURI:"",buildingDetailURI:"",buildingLocationList:[]}},v=a("8522");const y=a("592d");window.solid={},window.solid.session=new v["Session"],window.solidFetcher=window.solid.session.fetch,window.solid.storage=v["InMemoryStorage"];const w=function(e,t){return t||(t={}),t.headers||(t.headers={}),t.headers.hypergraph="U2FsdGVkX1/S0rANmPZVe3xCIXvlGoGnGudwlp4wFSMFtte++kYYPt0l4B4407c+",window.solid.session.fetch(e,t)};window.solid.hyperFetch=w,window.solidFetcher=w;const I=y.graph(),S=new y.Fetcher(I,{fetch:w}),R=y.graph();console.log("Unique quadstore initialized:",I);var A={namespaced:!0,state:{rdfStore:I,tempRdfStore:R,$rdf:y,rdfFetcher:S,geometryArray:[],urisFetched:[],systemURIs:[],bIndex:[],hyperFetch:w}},E=a("b33c");o["default"].use(s["a"]);const x=a("dae0");o["default"].filter("kb",e=>Math.floor(e/1024));const _="stage.graphmetrix.net",j=4,T=new s["a"].Store({state:{sensors:[],n3store:new x.Store,devMode:!1,blankExisted:!1,customers:[],blankNodeIndex:1,blankNodeString:"",isLoggedIn:!1,webId:"",loggedInName:"",loggedInInitials:"",loginExpire:"",currentBuildingTag:"",tasks:[],bmurl:"",ministryURI:"https://helsenorge"+j+"."+_,server:"https://"+_,serverPath:_,testNum:j,whatToDoVisible:!1,redirect:{path:"/",query:{location:""}},location:""},modules:{bv:f,rs:A,cp:b},mutations:{blankNodeIncrement(e,t){t||(t=1);var a=e.blankNodeIndex,o=a+t;e.blankNodeIndex=o,e.blankNodeString="_:t"+o}},actions:{move({state:e,commit:t,getters:a,dispatch:o},s){console.log("dispatch.move - node changed",s.node);var r=E["a"].getURI(s.location);if(e.node!==r){o("select",{node:r,noPush:!0});var n=Object.assign({},s.query);n.location!==r&&(n.location=r,n.select=r,s.router.push({path:s.path,query:n}))}},select({state:e,commit:t,getters:a,dispatch:o},s){var r=s.node,n=s.push,i=r;if(i!==s.select&&n){var l=E["a"].getEObj();l.select!==i&&(l.select=i,s.router.push({path:s.path,query:l}))}console.log("dispatch.select",r)}},computed:{},methods:{}});t["a"]=T},4382:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAeCAYAAABNChwpAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFrklEQVRIicWXUWwcVxWGv3N3NoZNARskEIUXS0E8UKlxFSkJWGaVvTO265pKlKSt8kCqKjWIVqD2hRr6hFz6QCsQfWhdpBCkQKlRADXJ2jNjaxVR6kqoKag8ICylDylIFcVJIFZ3d+YeHvaO2a7XbRwhcZ5mzj3nP/85d+65Z0RVERF2IhMTE5/MsuwHwJRXnQuC4JHFxcW/7wRHVZGdEoiiaLdz7jVgT8/SmjFmbxzH13ZCwFx35P/KMWCPiFwIgmA4CIJhEbngCR3bKViwjV5qtdpdInI7kBljXozj+EXP+jZvM7+4uPgGQK1We1ZEnulaI4qiaefcNBCISD1Jkl8Bej0ExFr7PHCkUDjnjodhOG+MeTTP8z2eyNVNB5F/ed2e8fHxj+Z5/oRz7nixrqr3WWtfSNP0nl4SW7YgDMOv+OBXgEeAWWBDVR/I8/wtYGybqgGMeZvjwIaIfMdjXAGOeOz3rcC4z+p7SZI8BRBF0UvOubqIfFBVl4BfDAwM1AuHgYGBerPZPAbcKyKRqm4YYybjOD4PYK0FeNJjL7wnAVV1BW6hi+P4vLV2PM9zt7Ky8vten7Nnz64DJ4GThw4d+rwxxsRx/LtiXUQ+oKrd2Juy5Rhaa6eAM8C7srhRiaJozDlXByrAdJqmZ7qS7d8HwjB8RlVngGvARJqmm9kcPnx41/r6+tfolPsWD/S6iJwaHBycX1hYaHUlMwosArtFZD5JkpnuONv2AWPMLJCLSMU5t1m2MAxvvnz58irwI+CAqt6kqjf55x+vr6+/EobhzYW9c86JSEVEMmPMo/1ibVbAWvsR4Ksi8jlgWFVDIE7TdBxgcnJyoN1urwJ7gb+KyLeDIEgBsiyzqvoE8Bngj+VyeX+9Xm/6KiwBkYgkwEVV/TNwMk3TK6ra+Qir1eqngfM+cDfBU8VDlmVfB/aKyF/a7faBRqNxucvudLVaXSmXy6uqequ3/WEXRuQTKuRb1Wp1DLhkAIIgeAoYBv5gjHkQmAFmsiw7V3io6t3+cbYnOABeN9tji8eYAWaMMQ+KyKvAsI/ZqYCITPqtuDOO47/1gnu5zZNNt1mn3W7HQRAAjHQR+wcwX7zXarXfiMglEZmAPp3wfyEi0t5uzRhT7LGAr4Cq1oHDqvrbKIp+6pxrA2RZdtpnAPAqcCDLMguc7gdeLpcj33BeL3TW2o8Bd/ngZefcfV0xOwSyLHs4CIJ9wD7n3L7COQiCd4Cf+def0zluc9VqdaX3O6hWq4OqOucrcKpraQp4FqDrRF/MsuzhTQKNRuOStXaErcfwaEGgXC7Pt9vt+4Fby+XyahiGsxsbGwlApVIJgcdV9bMi8qcgCJ7rInDUk3rXMWw0GlegTysG8FfqWyJiVPULaZq+DFCr1T4lImfo9IJ+8pqq3rG8vPymL/9BEXlJVV2pVPr40tLSP7uNt+2EeZ7PASVV3QBKhX55efnNoaGh/cA3gVU6rfoasCoiDw0NDe0vgnvZxHDOfb9frP/7ZdSvAncCiMhcd3Br7ai19uD7BbTWHvSXENC5ykVkzr9+qdd+yzzg9x1Vfacni3MiUrHWxiJyateuXWf8HMDU1NRQq9W6Q1WPFgNJFEW3FwkUWCKyJeF+E9EScL+IPOYnmQHn3HeBiqrmwLiqjjebzaN0jibNZnMSf1q8zW7n3Dlr7RzQFJHH/B2z1BtsCyM/vS6o6iCdMepxoCIi88An6Fxa28l5b/McsNv7PumxXvDY700A0NHR0XtE5G7gBPATYDpJkpk0Td8WkTUAEfnwpoPqh7xuLU3Tt9M0fQCY9r4nROTI6OjovfQZy2/kz+gbzrmnReRCqVT6cqvV0lKp9GtVHRGRh5Ikefp6sW7oz6jVap0E1lR1JMuyi8aYN1R1BFgTkRM7xdsxgUaj8e8gCMZE5HngKnBVRH4pIl/cyX9hIf8Bo27n43QxI0wAAAAASUVORK5CYII="},"441e":function(e,t,a){"use strict";a("a6fa")},"443f":function(e,t,a){e.exports=a.p+"img/building2.fe984c2d.png"},4635:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAeCAYAAABNChwpAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFgElEQVRIicWXb4ycVRXGf+fO7La7lrpTJEBLpaA0Ta2NyEoaJtVJ5n132tQ1+GdYExODCSUkEIFoTNCA43dCNE38ExQxwQSzCIkLus68o5PdLcuXGkIRQVALUkAFujRl/83Offywd8bd2Znd+qknmZx773Oec573vnfuva9J4kKau6DVgTSAma0BCoXCtqWlpV3A/MGDB18slUr+/0lcKpXc9PT0bmBTo9E4lSTJe+0xkjBJqwTk8/m9zrn7JQ0BqSDwNHBvpVL5+XnUtjiOb5d0D7A98OuSnlhaWvpGrVZ7vauAoaGhrKRxSVvMbB54QVIGuCpwvpckSWm96lEUfR+4M3RPAe+Z2V5JPcC7QC5JkpNNAa01cPjw4a2SHg3Ff1mv1y+vVCrXJUlytXPua0AD+G4cx59bp/gIcKeZzUsqJklyVZIkn0ilUlcCTwHbgF/ncrnNTU5LQL1e/7qkK4Dj2Wz2q7VabaaJlcvlh4FvBdXHisVib3vxXC63BTgG4L2/o1qtPtbExsfH38xkMl8A/gJc09PTc8sqAaVSyZnZbQDOufs6LbhMJvMDM3sO+PDMzMwX2/F0On0rcAlwvFqt/qwdHx0dXXTOfSd0b1slYGJi4oCkHcA/yuXyH9rJIUHDe//DMAtfbsfNbCRg93fiAywuLo4BZyR97NChQ7taAlKp1A0hye+6kYM9GXyuWCymmoODg4M9wCeBxuzs7O+7kWu12pKZTQDU6/UDLQGS9oaYZ9erXq1WT7O8sreePXu2+c9gYGBgp6Q08Nr09PTcBg9xEsDM9rQEmFkm+Lc3IAOcDqIvbQ6kUqnewF/ciGxmb4XmxS0BkurBp89DwJbg318x9n7gb92I7L1XEKKWADP7T8C3b5TAzHYAOOf+1RxbWFho8redB/+y0HynJUDSS8EPrkeOouiDkj4EzI6Pj7/ZHK/VavPAGWBTFEUXb6BhEMB7/+eWAOfcRADzuVyu62twzu0MzVc7PFlTUNdZHB4e7pf0aTOTc+7ploByufws8ApweU9Pz1C3BN77K0Kx1zvAzVdyaQcMgLm5uc8DHwCeqVQqb7QEAEh6MPjbuyVYkfzf7YCkRQDn3Hp3jDuCb52qreBGo/EQsAAcKhQKO+lgzrnnQ7OQzWYvao5ns9mLzOw6AO/9qU7cfD5/PXAAePfcuXOPNMdb77tWq70dx/Fjkr7ivR/J5XIP9/b27vfe7wP2Afsl7TKzSUkH+/r6jgIPAPT19d0VFucUMBlF0d9Z3nBOSnrezJ4zs5Fw9P9i5Wa1arok/Tb4G9Lp9LT3/j5gt6QTwN3pdHq39/6BEH4TLB9k/O9wuQfY7Zz7pqQTZrbHzErAJPBxADP748qaq1a8c+5V7z3AJUmSXNNpKoeHh8tzc3MLwOCRI0cyk5OT+8xsO/BKkiRTIex4+LUsjuMXARqNxt9W1VzZ8d7/M6j8aHiyNTY2NjZrZieAVL1ev9bMrg1QrVN8EN0PfMTMlvr7+091FZAkyWtm9pKky6ampoa7JZT01+CvNrOBIPqtbvHz8/NR2Ob/NDY2NttVQLAfhYTfBtZel5dtUxBQl3QmtK/sEmuSmrepR9vBNQI2b978IPCGpOujKLqrHY+i6FNmdqOZycyeNrPx0C7GcXygPT6O43uBbDhpH+qkbs13QRRFnzWz34Tu48BTkszMPiNpJMzAT5MkORqK/ETSrcCimT0i6TiQNrMvSYpZvtDemCTJkyvrdPwuaNrQ0NDNko5J2tIGeTP78cDAwN2jo6OLAMVisXdmZuYYcFRSe7IzZnZLpVJ5vL3GugIA8vn8DjO7CdhvZua9f8E590SlUnm5U3yhUNjTaDSGgb0sf9Q8A/wqSZJ3OsW3BFxI+y/f+XErJHGL0wAAAABJRU5ErkJggg=="},4678:function(e,t,a){var o={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(e){var t=r(e);return a(t)}function r(e){if(!a.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}s.keys=function(){return Object.keys(o)},s.resolve=r,e.exports=s,s.id="4678"},"4b02":function(e,t,a){"use strict";a("a136")},"4e67":function(e,t,a){"use strict";a("42a0")},5:function(e,t){},"51a2":function(e,t,a){"use strict";a("66a6")},5300:function(e,t,a){"use strict";a("8ac4")},"53a9":function(e,t,a){"use strict";a("f8d2")},5410:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAeCAYAAABNChwpAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFv0lEQVRIib1XX4gkRx3++n9VTffM7Ny6O+hlEBKJJ/hgQA5EIaAXMZD4ELmADx5o0MhFRc+7oCjm4SR6xpyiRCGiiEEwEX0Ip5KNoJiHCCKH3h0o0UX2uL1b7/Z6prurqrurq3y4qbF3Mm4WWf1epur35/t9/avqrhrHGINjx47hwoULMMaAMYYwDME5B6UUWmtIKVEUBcqyxHA4hNYao9EIBw8exPnz5zEHVwjxHaXUux3HWQagAawHQfBMFEVn24Fra2vw57P/ExzHgeu6u8YIIT7vuu5jlNJgzrUE4C7O+aODweAdUsq/z3iNMThy5MieRKRpGvb7/WqRz3Xdx7TWX3otjrqum9FodNvm5ubm2toadn+kKbIse0pKWTLGeJ7nv6qqKmn7+/3+ne3inPObUsovCiEOSynvllI+o5QyABAEgbe+vv4XG7vrEnDOn3Rd9+EkSai1hWH43qqqUs/zHm6a5mkAuHLlyjnGGACgLMsrjLE3zFH9lhDyeJ7nf/Z93yWEJMaYEwC+vrADUsozQgjOGPs0IYTO+8MwdG/evHkaAOI47lJKbwcApZSJomhWfHt7+51KqZUp5yWt9VdbD/cJADuXIM/zM0KInBByklI6K1yWZW2MAQDUda2FEPlgMDgFABsbG/c7jmPjXrE5rut+eTAY/M4Ys5kkyVsAgFL6haZpDAA4jrM6E0AIuY9znsVxfJJS2rEkQoi8qqqPe553zNrG4/GLlNJEKfXDqehV62ua5lor7kEACILAvXz58uGpXzdN00wFejMBN27c+DFjLG4VLsqyPEMpTcIw/C6AFfuUTdN47a6trKxctGPf999kx8vLy+/PsuxveZ6/1Ov1fjAt+jrf930A0FpX7SVwAcAYg8lk8jSlNI6i6FFLZoyZLYfneTs27oEDB16o69pMW7wax/G7pstxMUmSO+wcADjnz7a+Ja/MCmutlRXQ7XY/il1g94JFnufaGHMOuPWx2t7e/vWivG63+x5CyN12zhg71e7ADEKIO3cTsAhhGN5XVZWajoOyLF+ej7l+/fov7VhK+QcALywU8N9iMBjca8dRFB2OougDdl6W5R/DMPSn45oQ8nbr2zcBeZ6v1XW91pr/BADiOD4cRdHbrH15efmedt6eD6O9IAiCe6SUnBBCgyBwpZSXpJS3EUIAAEqp57Ms+007Z986YDEajWbtJYQcIoTEACClLHzfv38+ft8FbG1tXdRaf3/ePhwO71oUv+8CAMB13Y9IKdOW6ak0Tf/6PxcwmUweKoqiDwCHDh26fTwe/0MI8TKA4wDAOb93Mpl8qJ2zb5uQc/6nbrf7Vs75k8aY/vr6+nav13uj9RtjjjDGzgGAUurA6urqWWCPHXAcR7WmelGM67pvBgDGWLK1tdWd91+9enX2XeCcP3Dt2q1za08CjDHrrelkUYzWugRu3QkW3R09z5sdWq7rTuyruUjAjtNuPB5/sqqq79l5kiTvm0wm334NwTt4Oecn4jg+3RKbVFX1agGO44BSegkAiqJ4KM/za71e75udTqdvYwghYbfbPS6E4OPx+IlWurYcKysr2wCQ5/nxPM//yRh7gjGWtDh+PxwOAcxtQqWULsvyJIBH4jgetX1SSqG1LhljfQCgt3CCc/4xpdRXPM9TU44mz/NP+b5/Ko7j189x1EqpH8Vx/NmlpaVXC/A8z43j+EzbVpalaprm54yxo9POPO44ziP2AjP9PW2P6SAI/CiKvjFfuK7rnyZJ8sGW7d9LMLsetTZPVVUN5/w5z/MiWxwAOp3O5xhjSVEUXxNCcGu3N6Y5DpVl2bOEkLBdfEc85lBVVVMUxc/CMOwxxo76vr/wtet0OqcopZ2iKM62hViOLMue01p3kiR5cFG+hTsl+3CaphtZlv0iDMOlTqfzAIBit8SWkM9QSjtZln0rTdONNE2fBxAnSXKUELLwX1QbzvwV6/+NfwEk7LGebyh5RwAAAABJRU5ErkJggg=="},5498:function(e,t,a){e.exports=a.p+"img/i4-logo-hvit.fbc57266.png"},"56d7":function(e,t,a){"use strict";a.r(t);var o=a("a026"),s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-app",[o("v-app-bar",{attrs:{app:"",color:"primary",dark:""}},[o("div",{staticClass:"d-xl-flex align-center"},[o("v-img",{staticClass:"logo",attrs:{alt:"Sykehusbygg Logo",contain:"",src:a("5498"),transition:"scale-transition"}})],1),e.window.width>=1e3&&e.devMode&&e.isLoggedIn?o("v-btn",{attrs:{href:"",target:"_blank",text:""},on:{click:function(t){return e.followLink("ImportData")}}},[o("span",{staticClass:"mr-2"},[e._v(e._s(e.$t("button_importdata")))]),e.window.width>=1e3?o("v-icon",[e._v("mdi-file-import")]):o("v-icon",{attrs:{"x-large":""}},[e._v("mdi-file-import")])],1):e._e(),e.isLoggedIn?o("v-btn",{attrs:{href:"",target:"_blank",text:""},on:{click:function(t){return e.followLink("PodSelect")}}},[o("span",{staticClass:"mr-2"},[e._v(e._s(e.$t("button_podselect")))]),e.window.width>=1e3?o("img",{attrs:{src:a("5b3d")}}):o("img",{attrs:{src:a("6fca")}})]):e._e(),e.isLoggedIn?o("v-btn",{attrs:{href:"",target:"_blank",text:""},on:{click:function(t){return e.followLink("FilesLib")}}},[o("span",{staticClass:"mr-2"},[e._v(e._s(e.$t("button_fileslib")))]),e.window.width>=1e3?o("v-icon",[e._v("mdi-file")]):o("v-icon",{attrs:{"x-large":""}},[e._v("mdi-file")])],1):e._e(),e.isLoggedIn?o("v-btn",{attrs:{href:"",target:"_blank",text:""},on:{click:function(t){return e.followLink("Capacity")}}},[o("span",{staticClass:"mr-2"},[e._v(e._s(e.$t("button_capacity")))]),e.window.width>=1e3?o("v-icon",[e._v("mdi-hospital-building")]):o("v-icon",{attrs:{"x-large":""}},[e._v("mdi-hospital-building")])],1):e._e(),e.isLoggedIn?o("v-btn",{attrs:{href:"",target:"_blank",text:""},on:{click:function(t){return e.followLink("WorkList")}}},[o("span",{staticClass:"mr-2"},[e._v(e._s(e.$t("button_arbeidsliste")))]),e.window.width>=1e3?o("v-icon",[e._v("mdi-format-list-bulleted")]):o("v-icon",{attrs:{"x-large":""}},[e._v("mdi-format-list-bulleted")])],1):e._e(),e.devMode&&e.isLoggedIn?o("v-btn",{attrs:{href:"",target:"_blank",text:""},on:{click:function(t){return e.followLink("IFCexporter")}}},[o("span",{staticClass:"mr-2"},[e._v(e._s(e.$t("button_ifcexporter")))]),e.window.width>=1e3?o("v-icon",[e._v("mdi-format-list-bulleted")]):o("v-icon",{attrs:{"x-large":""}},[e._v("mdi-format-list-bulleted")])],1):e._e(),e.devMode&&e.isLoggedIn?o("v-btn",{attrs:{href:"",target:"_blank",text:""},on:{click:function(t){return e.followLink("BMviewer")}}},[o("span",{staticClass:"mr-2"},[e._v("Viewer")]),e.window.width>=1e3?o("v-icon",[e._v("mdi-format-list-bulleted")]):o("v-icon",{attrs:{"x-large":""}},[e._v("mdi-format-list-bulleted")])],1):e._e(),e.devMode&&e.isLoggedIn?o("v-btn",{attrs:{href:"",target:"_blank",text:""},on:{click:function(t){return e.followLink("Assetslist")}}},[o("span",{staticClass:"mr-2"},[e._v("Assets")]),e.window.width>=1e3?o("v-icon",[e._v("mdi-format-list-bulleted")]):o("v-icon",{attrs:{"x-large":""}},[e._v("mdi-format-list-bulleted")])],1):e._e(),e.devMode&&e.isLoggedIn?o("v-btn",{attrs:{href:"",target:"_blank",text:""},on:{click:function(t){return e.followLink("Chat")}}},[o("span",{staticClass:"mr-2"},[e._v("Chat")]),e.window.width>=1e3?o("v-icon",[e._v("mdi-format-list-bulleted")]):o("v-icon",{attrs:{"x-large":""}},[e._v("mdi-format-list-bulleted")])],1):e._e(),e.isLoggedIn?o("v-btn",{attrs:{href:"",target:"_blank",text:""},on:{click:function(t){return e.followLink("Search")}}},[o("span",{staticClass:"mr-2"},[e._v(e._s(e.$t("button_search")))]),e.window.width>=1e3?o("v-icon",[e._v("mdi-magnify")]):o("v-icon",{attrs:{"x-large":""}},[e._v("mdi-magnify")])],1):e._e(),o("div",{staticStyle:{"margin-left":"auto","margin-right":"0"}},[e._l(e.languages,(function(t){return o("button",{key:t.title,staticStyle:{"margin-left":"5px"},on:{click:function(a){return e.changeLocale(t.language)}}},[o("flag",{attrs:{iso:t.flag,squared:!1}}),e._v(" "+e._s(t.title)+" ")],1)})),e.isLoggedIn?o("v-menu",{attrs:{"close-on-content-click":!1,"nudge-width":200,"offset-x":""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,s=t.attrs;return[o("v-list-item-avatar",e._g(e._b({attrs:{color:"blue",size:"48"}},"v-list-item-avatar",s,!1),a),[o("span",{staticClass:"white--text text-h5"},[e._v(e._s(e.loggedInInitials))])])]}}],null,!1,1218765226)},[o("v-card",[o("v-list",[o("v-list-item",[o("v-list-item-avatar",{attrs:{color:"blue",size:"48"}},[o("span",{staticClass:"white--text text-h5"},[e._v(e._s(e.loggedInInitials))])]),o("v-list-item-content",[o("v-list-item-title",[e._v(e._s(e.loggedInName))]),o("v-list-item-subtitle",[e._v(e._s(e.webId))])],1)],1)],1),o("v-divider"),o("v-list-item-content",[o("v-list-item-subtitle",[e._v(e._s(e.$t("session_expires")+e.loginExpire))])],1),o("v-divider"),o("v-card-actions",[o("v-spacer"),o("v-btn",{attrs:{to:{name:"Logout"},text:""}},[o("span",{staticClass:"mr-3"},[e._v(e._s(e.$t("button_logout")))]),o("v-icon",[e._v("mdi-logout")])],1)],1)],1)],1):e._e()],2)],1),o("v-main",[o("router-view")],1)],1)},r=[],n=a("a925"),i=a("d61f");o["default"].use(i["a"]),o["default"].use(n["a"]);const l={en:{select_region:"Select region",select_unit:"Select unit",select_location:"Select location",select_building:"Select building",select_wings:"Select wing",select_floors:"Select floor",select_functions:"Select functions",select_bedtypes:"Select bed types",select_capacity:"Select room capacity",select_owner:"Select owner",select_rent_contract_user:"Select contractor",select_rent_type:"Select rental contract type",select_rent_status:"Select rental contract status",button_calculate:"Calculate capacity",button_exportxls:"Export as Excel",button_exportpdf:"Export as PDF",button_ifcexporter:"IFC",button_rentmodule:"Rent",text_result:"Result",text_report1:" is total capacity in ",text_report2:" rooms.",text_all:"All",button_importdata:"Import",button_editspec:"Edit spec",button_capacity:"Capacity",button_bimviewer:"Bimviewer",button_start_rotate:"Start rotation",button_stop_rotate:"Stop rotation",button_zoom_to_object:"Zoom to object",button_togglemap:"Map",wayfinding:"Wayfinding",button_togglecolor:"Colors",button_lockselection:"Lock selection",button_unlockselection:"Unlock selection",button_multi1:"Multi",button_multi2:"Single",select_roomfile:"Select room file",select_circulationfile:"Select circulation file",select_geometryfile:"Select geometry file",button_importifc:"Import IFC",button_back:"Back",button_logout:"Log out",button_fileslib:"Files",button_podselect:"Pods",button_arbeidsliste:"Work",button_search:"",text_search:"Search",text_clear:"Clear",text_ok:"Ok",text_dismiss:"Dismiss",session_expires:"Session expires: ",text_file_details:"FILE DETAILS",text_pod_details:"POD DETAILS",text_employees:"Employees",text_employee_new:"Add employee",text_last_changed:"Last changed:",text_download:"Download:",text_files:"Files",text_folders:"Folders",text_pods:"PODs",text_create_container:"Create container in",text_container_name:"Issue title",text_create_issue:"New issue",text_issue_tags:"Tags",text_issue_responsible:"Responsible",text_title:"Title",text_description:"Description",text_photo:"Photo",text_create:"Create",text_add:"Add",text_cancel:"Cancel",text_contracts:"Tenants",text_rent_contracts:"Rental tenants",text_owner:"Owner",text_contract_nr:"Contract nr",text_contract_type:"Contract type",text_contractor:"Contractor",text_from:"From",text_to:"To",text_rented_area:"Rented area",text_share:"Share %",text_color:"Color",text_room_details:"Room details",text_room_geometry:"Room geometry",text_building_details:"Building details",text_netarea:"Net area",text_netarea_calculated:"Net area calculated",text_grossarea:"Gross area",text_doors:"Doors",text_what_to_do:"What do you want to do?"},no:{select_region:"Velg region",select_unit:"Velg helseforetak",select_location:"Velg lokasjon",select_building:"Velg bygning",select_wings:"Velg fløy",select_floors:"Velg etasje",select_functions:"Velg funksjoner",select_bedtypes:"Velg sengeplass typer",select_owner:"Velg eier",select_rent_contract_user:"Velg leietager",select_rent_type:"Velg leieavtale type",select_rent_status:"Velg leieavtale status",select_capacity:"Velg romkapasitet",button_calculate:"Kalkuler kapasitet",button_exportxls:"Eksporter som Excel",button_exportpdf:"Eksporter som PDF",button_ifcexporter:"IFC",button_rentmodule:"Leie",text_result:"Resultat",text_report1:" er total kapasitet på ",text_report2:" rom.",text_all:"Alle",button_importdata:"Importer",button_editspec:"Spesifikasjon",button_capacity:"Kapasitet",button_bimviewer:"Bimviewer",button_start_rotate:"Start rotasjon",button_stop_rotate:"Stop rotasjon",button_zoom_to_object:"Zoom til objekt",button_togglemap:"Kart",button_togglecolor:"Farger",button_lockselection:"Lås seleksjon",wayfinding:"Veifinning",button_unlockselection:"Lås opp seleksjon",button_multi1:"Mange",button_multi2:"En",select_roomfile:"Velg rom fil",select_circulationfile:"Velg sirkulasjon fil",select_geometryfile:"Velg geometri fil",button_importifc:"Importer IFC",button_back:"Tilbake",button_logout:"Logg ut",button_fileslib:"Filer",button_podselect:"Pods",button_arbeidsliste:"Work",button_search:"",text_search:"Søk",text_clear:"Tøm",session_expires:"Sesjon utgår: ",text_file_details:"FIL DETALJER",text_pod_details:"POD DETALJER",text_employees:"Ansatte",text_employee_new:"Legg til ansatt",text_last_changed:"Sist endret:",text_download:"Last ned:",text_files:"Filer",text_folders:"Mapper",text_pods:"PODs",text_create_container:"Opprett mappe i",text_container_name:"Mappe navn",text_create_issue:"Nytt oppføring",text_title:"Tittel",text_description:"Beskrivelse",text_photo:"Bilde",text_issue_tags:"Tagger",text_issue_responsible:"Ansvarlig",text_create:"Opprett",text_add:"Legg til",text_cancel:"Avbryt",text_ok:"Ok",text_dismiss:"Lukk",text_contracts:"Kontrakter",text_rent_contracts:"Leieavtaler",text_owner:"Eier",text_contract_nr:"Leieavtale",text_contract_type:"Leieavtale type",text_contractor:"Leietaker",text_from:"Fra",text_to:"Til",text_rented_area:"Leid Areal",text_share:"Andel %",text_color:"Farge",text_room_details:"Romdetaljer",text_room_geometry:"Romgeometri",text_building_details:"Bygningsdetaljer",text_netarea:"Netto areal",text_netarea_calculated:"Kalkulert netto areal",text_grossarea:"Brutto areal",text_doors:"Dører",text_what_to_do:"Hva vil du gjøre?"}};var c=new n["a"]({locale:"en",fallbackLocale:"no",messages:l}),d=a("4360"),u=(a("706e"),{name:"App",data:()=>({languages:[{flag:"us",language:"en"},{flag:"no",language:"no"}],isLoggedIn:!1,webId:"",loggedInName:"",loggedInInitials:"",loginExpire:"",devMode:!1,window:{width:0,height:0}}),created(){window.addEventListener("resize",this.handleResize),this.handleResize()},destroyed(){window.removeEventListener("resize",this.handleResize)},methods:{changeLocale(e){c.locale=e},followLink(e){this.$route.path.includes(e)||this.$router.push({path:e,query:{location:this.$route.query.location,select:this.$route.query.select}})},handleResize(){this.window.width=window.innerWidth,this.window.height=window.innerHeight}},watch:{"$store.state.isLoggedIn":function(e){this.isLoggedIn=d["a"].state.isLoggedIn},"$store.state.webId":function(e){this.webId=d["a"].state.webId},"$store.state.loggedInName":function(e){this.loggedInName=d["a"].state.loggedInName},"$store.state.loggedInInitials":function(e){this.loggedInInitials=d["a"].state.loggedInInitials},"$store.state.loginExpire":function(e){this.loginExpire=d["a"].state.loginExpire},"$store.state.devMode":function(e){this.devMode=d["a"].state.devMode},"$store.state.redirect":function(e){this.$router.push(e)},$route(e,t){console.log("to.mode",e,"from.mode",t),d["a"].state.location=e.query.location}}}),h=u,g=(a("a39f"),a("2877")),m=a("6544"),p=a.n(m),f=a("7496"),b=a("40dc"),v=a("8336"),y=a("b0af"),w=a("99d9"),I=a("ce7e"),S=a("132d"),R=a("adda"),A=a("8860"),E=a("da13"),x=a("8270"),_=a("5d23"),j=a("f6c4"),T=a("e449"),F=a("2fa4"),O=Object(g["a"])(h,s,r,!1,null,null,null),C=O.exports;p()(O,{VApp:f["a"],VAppBar:b["a"],VBtn:v["a"],VCard:y["a"],VCardActions:w["a"],VDivider:I["a"],VIcon:S["a"],VImg:R["a"],VList:A["a"],VListItem:E["a"],VListItemAvatar:x["a"],VListItemContent:_["a"],VListItemSubtitle:_["b"],VListItemTitle:_["c"],VMain:j["a"],VMenu:T["a"],VSpacer:F["a"]});var N=a("a18c"),L=a("f309"),P=(a("bf40"),a("5363"),a("b6d0")),D=a("f3ed");o["default"].use(L["a"]),o["default"].use(P["a"]),o["default"].use(D["a"]);var k=new L["a"]({icons:{iconfont:"mdi"}}),U=a("fb26");o["default"].config.productionTip=!1,new o["default"]({router:N["a"],store:d["a"],ns:U["default"],vuetify:k,i18n:c,render:e=>e(C)}).$mount("#app")},5711:function(e,t,a){"use strict";a("8b7b")},"575c":function(e,t,a){"use strict";const o={getInitials:function(e){var t=e.split(" "),a=t[0].substring(0,1).toUpperCase();return t.length>1&&(a+=t[t.length-1].substring(0,1).toUpperCase()),a},makeRandomColor:function(){var e="";while(e.length<6)e+=Math.random().toString(16).substr(-6).substr(-1);return"#"+e},arraymove:function(e,t,a){var o=e[t];return e.splice(t,1),e.splice(a,0,o),e},getCharactersAfter:function(e,t){return e.split(t).pop()},getCharactersBefore:function(e,t){return e.split(t)[0]},isLetter:function(e){let t=e.charAt(0);return t.toLowerCase()!=t.toUpperCase()},removeLastCharacter:function(e){return e.substr(0,e.length-1)},removeCharactersAfter:function(e,t){return e.substring(0,e.indexOf(t))}};t["a"]=o},"5b3d":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAKdAAACnQEbaSIpAAAE9GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4wLWMwMDAgNzkuMTcxYzI3ZmFiLCAyMDIyLzA4LzE2LTIyOjM1OjQxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjQuMSAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjMtMDEtMDlUMTA6MTQ6MTUrMDE6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIzLTAxLTA5VDEwOjIzOjIxKzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIzLTAxLTA5VDEwOjIzOjIxKzAxOjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpkNWMyMzcyMy05NDI5LTQ5ZjYtYjQ2NS0xMGJkYjdjZmJlZjYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6ZDVjMjM3MjMtOTQyOS00OWY2LWI0NjUtMTBiZGI3Y2ZiZWY2IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZDVjMjM3MjMtOTQyOS00OWY2LWI0NjUtMTBiZGI3Y2ZiZWY2Ij4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpkNWMyMzcyMy05NDI5LTQ5ZjYtYjQ2NS0xMGJkYjdjZmJlZjYiIHN0RXZ0OndoZW49IjIwMjMtMDEtMDlUMTA6MTQ6MTUrMDE6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyNC4xIChNYWNpbnRvc2gpIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pp8HvMsAAAJrSURBVEiJtZXda49hGMc/v5+xeZlmpslbbWVpix0tOVKIKCcKJ8oJJSSlFP4BlgOtGE4deCntSJETpJR3DlDYvBxoxrSZJNrHwXP/6t7tZiWuunvu57q+1/t1PU9J5X9S+Tf8DuAeMBzOCDAKGJ2RSP4YWJEzVMpkUAMMAZP+IuBG4P14GXQlxl8Ae4E2YCowBWgBtgP3E93uX6yp8Wl0LPWo5QSTnhOJTnMsT8GXIuCdcQzH52KkdzuWxT1YDlyLkmsFnoZ7O7AWaAZKwFvgKnAryGcAg5HuZuBCWqK+KIrXgTddfRB4H9UX6nN1IPD6opLcjfT70xJtSup4MvA/qL3q0kxZWtWbAV9Sdyc2dlUclKKIKrRV3Rfu49V/0KLRqxIb39TaMtAJNCTDVQ9sAQ5nxjil3cBKYGHCnwQcL6nfgapEeAyoC41uAL5QbPYRig0+ACwLzX0J9FIs2KHEzmhVxjjANOATMA+YE3iLKZZtAFgXYScADymWMKVyGTidEcwEqinGcCPFCA5RlKwzOPkM7AAuA/NDxin1oNaoI0mDBtUN4Vllsc21UWOr1cnh/lXdaTG+Kc2qKGzLCDvUs+qbyPAitT16v64+stiFlA6afCr6E0C3OjHcz0S4ieF5NMhmW8x8TEMmi4a6PhMF6v5wv6LOUxvU84F3KmCGEr1tOQeoNxLgscDvyjivZJVG/yS2mTpoyhhqC7L5Fs3co7YEXn0Gv+RPDlDPJQrD6poMrsOxH0jVqyku98usC0uW0jvgNcX/eC6wIINpAl6N4WQiQ12tPgvRD1t8uFL6EcmfqxtztnIZ/FP6CVRagcaX4hcqAAAAAElFTkSuQmCC"},"5c34":function(e,t,a){},6:function(e,t){},"616f":function(e,t,a){e.exports=a.p+"img/rapport2.e52bf56c.png"},"61eb":function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id="61eb"},6289:function(e,t,a){e.exports=a.p+"img/face.ee7cced0.png"},"635a":function(e,t,a){"use strict";(function(e){var o=a("4360"),s=(a("a18c"),a("fb26")),r=(a("6ca8"),a("b418")),n=a("706e"),i=(a("34d2"),a("d8d8")),l=a("b827"),c=a("b33c"),d=a("575c"),u=a("a8b5"),h=a("7a57");a("11c1"),a("3022");const g=a("dae0"),m=(new g.Store,a("592d"));new(a("c513").DataFactory),a("5189"),a("2f5f").toRdf;a("3e8f");const p={};const f=(e,t)=>/^\d/.test(e.name)-/^\d/.test(t.name)||e.name.localeCompare(t.name,void 0,{numeric:!0});function b(e){return(parseInt(e.substr(1),16)<<8)/256}p.searchAndGetTriples=async function(e){let t=o["a"].state.webId.replace("/i","/search/")+encodeURIComponent(e);console.log("Trying to search.."),console.log(t);try{let e=await window.solid.session.fetch(t,{method:"GET",credentials:"include",headers:{Accept:"text/turtle"}}).then(e=>e.text());return m.parse(e,o["a"].state.rs.rdfStore,t,"text/turtle"),e}catch(a){console.log("Search failed"),console.log(a)}},t["a"]={id:p,name:"Capacity",data(){return{valid:!0,totalCalculatedCapacity:0,totalCalculatedRooms:0,search:"",roomTableHeaders:[{text:"Rom navn",align:"start",filterable:!0,value:"roomname"},{text:"Etasje",value:"storey"},{text:"Funksjon",value:"function"},{text:"Kapasitet",value:"capacity"},{text:"RomID",value:"roomid"}],roomTableList:[],roomTableSelectedRow:[],roomDetailsVisible:!1,buildingDetailsVisible:!1,selectedrooms:[],filteredrooms:[],spectext:"",twodim:!1,rhf:[],rhfselected:[],rhfselectedURIs:[],helseforetak:[],hfselected:[],hfselectedURIs:[],lokselected:[],locationNames:[],locationURIs:[],buildingNames:[],buildingURIs:[],buildingSelected:[],wings:["Testwing"],wingURIs:[],wingselected:["Testwing"],floors:[],floorURIs:[],floorselected:[],siteURIs:[],siteNames:[],siteSelected:[],contractOwnerURIs:[],contractOwnerNames:["Helgelandsykehuset HF"],contractOwnerSelected:[],contractUserURIs:[],contractUserNames:["Bildediagnostikk","Medisinsk klinikk","ØNH-, kjeve og øyesykdommer","Nevroklinikken","Kliniske servicefunksjoner","Fysikalsk medisin og rehab.","Mat og Cafe","Klinikk for anestesi og intensivmedisin"],contractUserSelected:[],contractTypeURIs:[],contractTypeNames:["Standard","Andre"],contractTypeSelected:[],contractStatusURIs:[],contractStatusNames:["Aktiv","Inaktiv"],contractStatusSelected:[],roomURIsSelected:[],selectedRoomURIs:[],sengeplass:"",kapasitet:"",selectedfunction:"",hrimage:"hr1111.png",resultat:!0,sengeplasstyper:["134 - Sengerom","113 - Overvåkingsplass","62 - Isolat","84 - Kuvøserom"],romkapasitet:["1-sengs","2-sengs","3-sengs","4-sengs"],functions:["1A.1 - Barnesengeområde","1A.4 - Føde/barsel","1A.6 - Intensiv","1A.9 - Normalsengeområde","1A.5 - Habilitering/Rehabilitering"],values:[{name:"134 - Sengerom",one:0},{name:"113 - Overvåkingsplass",one:0},{name:"62 - Isolat",one:0},{name:"84 - Kuvøserom",one:0}],valid:!0,loading:!1,csfselection:[],csfsearch:null,caseSensitive:!1,partfunctionsSelected:[],colorlist:["#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080"],csfitems:[{id:1,name:"Root",color:"#FF0000",children:[{id:2,name:"Child #1",color:"#0000FF"},{id:3,name:"Child #2",color:"#00FF00"},{id:4,name:"Child #3",color:"#0000FF"}]}]}},components:{RoomDetails:u["a"],BuildingDetails:h["a"]},methods:{calculate(){this.resultat=!0},checklogin(){console.log(window.solid.session.info),window.solid.session.info.isLoggedIn?console.log("Test logged in"):(console.log("Is logged out, reroute"),this.$router.push({path:"/"}))},getAllBuildings(){const e=[];return o["a"].state.rs.rdfStore.match(null,s["c"].RDF("type"),s["c"].BOT("Building")).forEach(t=>{console.log("Found building URI: "+t.subject.value),e.push(t.subject.value)}),e.forEach(e=>{o["a"].state.rs.rdfStore.match(m.sym(e),s["c"].RDFS("label"),null).forEach(t=>{console.log("Found building Name: "+t.object.value),this.buildingURIs.includes(e)||this.buildingURIs.push(e),this.buildingURIs.includes(t.object.value)||this.buildingNames.push(t.object.value)})}),e},createRoomList(){this.roomTableList=[];let e=0,t=0,a=0,r=0;this.selectedrooms.forEach((n,i)=>{let l="";o["a"].state.rs.rdfStore.match(m.sym(n),s["c"].TAG("tag"),null).forEach(e=>{l=e.object.value});let c="";c=l.replace("."+d["a"].getCharactersAfter(l,"."),"");let u=c.replace("."+d["a"].getCharactersAfter(c,"."),"");const h=d["a"].getCharactersAfter(c,"."),g=[];g.push(u+".FLOY_S."+h),g.push(u+".FLOY_N."+h),g.push(u+".FLOY_O."+h),g.push(u+".FLOY_V."+h);let p="";g.forEach(e=>{o["a"].state.rs.rdfStore.match(null,s["c"].TAG("tag"),m.literal(e,null,s["c"].XSD("string"))).forEach(e=>{o["a"].state.rs.rdfStore.match(m.sym(e.subject.value),s["c"].RDFS("label"),null).forEach(e=>{p=e.object.value})})});let f="0";o["a"].state.rs.rdfStore.match(null,s["c"].DUL("hasPart"),m.sym(n)).forEach(e=>{o["a"].state.rs.rdfStore.match(e.subject,s["c"].RDF("type"),s["c"].BOT("Storey")).length>=0&&o["a"].state.rs.rdfStore.match(e.subject,s["c"].RDFS("label"),null).forEach(e=>{f=e.object})});let b=0;o["a"].state.rs.rdfStore.match(m.sym(n),s["c"].NEO("m_port"),null).forEach(e=>{o["a"].state.rs.rdfStore.match(m.sym(e.object.value),s["c"].RDF("type"),s["c"].NEO("y_port")).forEach(e=>{b+=1})});let v="";o["a"].state.rs.rdfStore.match(m.sym(n),s["c"].RDFS("label"),null).forEach(e=>{v=e.object.value});let y="";o["a"].state.rs.rdfStore.match(m.sym(n),s["c"].NEO("b_capable"),null).forEach(n=>{o["a"].state.rs.rdfStore.match(m.sym(n.object.value),s["c"].TAG("tag"),null).forEach(o=>{let s=""+decodeURI(o.object);s.includes("SENGEROM")&&(e+=1),s.includes("OVERV")&&(t+=1),s.includes("ISOLAT")&&(a+=1),s.includes("BARSEL")&&(r+=1)}),o["a"].state.rs.rdfStore.match(m.sym(n.object.value),s["c"].RDFS("label"),null).forEach(e=>{y=e.object.value.replace("Delfunksjon: ","")})}),this.roomTableList.push(JSON.parse('{"roomname":"'+v+'","storey":"'+p+'","function":"'+y+'","capacity":"'+b+'","roomid":"'+n+'"}'))}),this.values=[{name:"134 - Sengerom",one:e},{name:"113 - Overvåkingsplass",one:t},{name:"62 - Isolat",one:a},{name:"84 - Kuvøserom",one:r}]},getRHFDataFromTrinity(){const e=o["a"].state.ministryURI;0!=o["a"].state.rs.rdfStore.match(m.sym(e+"/i"),s["c"].ORG("hasSubOrganization"),null).length?(console.log("RHF FOUND!, getting data from local storage."),o["a"].state.rs.rdfStore.match(m.sym(e+"/i"),s["c"].ORG("hasSubOrganization"),null).forEach(e=>{console.log("RHF URI"+e.object),this.rhfselectedURIs.push(e.object)}),this.rhfselectedURIs.forEach((e,t)=>{const a=m.st(e,s["c"].FOAF("name"),null);let o=[];o.push(a),this.getURIObject(o,a,"").then(e=>{e.forEach((e,t)=>{this.rhf.includes(""+e.object)||(this.rhf.push(""+e.object),this.rhfselected.push(""+e.object))})})})):(console.log("RHF NOT FOUND!, getting data from TrinPod"),n["a"].aLoadURI(e+"/i",null,null).then(t=>{t?(o["a"].state.rs.rdfStore.match(m.sym(e+"/i"),s["c"].ORG("hasSubOrganization"),null).forEach(e=>{console.log("RHF URI"+e.object),o["a"].state.rs.rdfStore.add(e),this.rhfselectedURIs.push(e.object)}),this.rhfselectedURIs.forEach((e,t)=>{const a=m.st(e,s["c"].FOAF("name"),null);let o=[];o.push(a),this.getURIObject(o,a,"").then(e=>{e.forEach((e,t)=>{this.rhf.includes(""+e.object)||(this.rhf.push(""+e.object),this.rhfselected.push(""+e.object))})})})):console.log("Ministry Of Health URI not found.")}))},async getURIObject(e,t,a){return new Promise(s=>{let r=[];0!=o["a"].state.rs.rdfStore.match(t.subject,t.predicate,null).length?(console.log("Getting locally."),e=this.getTripleMatches(e,o["a"].state.rs.rdfStore),e.forEach(e=>{e.object.value.includes(a)&&(console.log("Found URI"+e),r.push(e))}),s(r)):(console.log("Getting TrinPod."),n["a"].aLoadURI(t.subject.value,null,null).then(t=>{t&&(console.log(t),e=this.getTripleMatches(e,o["a"].state.rs.rdfStore),e.forEach(e=>{e.object.value.includes(a)&&(o["a"].state.rs.rdfStore.add(e),r.push(e))}),s(r))}))})},async getURISubject(e,t,a){return new Promise(s=>{let r=[];0!=o["a"].state.rs.rdfStore.match(null,t.predicate,t.object).length?(console.log("Getting locally."),e=this.getTripleMatches(e,o["a"].state.rs.rdfStore),e.forEach(e=>{e.subject.value.includes(a)&&(console.log("Found URI"+e),r.push(e))}),s(r)):(console.log("Getting TrinPod."),n["a"].aLoadURI(t.object.value,null,null).then(t=>{t&&(console.log(t),console.log(e),e=this.getTripleMatches(e,o["a"].state.rs.rdfStore),e.forEach(e=>{e.subject.value.includes(a)&&(o["a"].state.rs.rdfStore.add(e),r.push(e))}),s(r))}))})},getTripleMatches(e,t){let a=[];return e.forEach((o,s)=>{0==s?t.match(e[s].subject,e[s].predicate,e[s].object).forEach(e=>{a.push(e)}):t.match(e[s].subject,e[s].predicate,e[s].object).forEach(e=>{a.includes(e)?(a=this.arrayRemove(a,e),a.push(e)):a.push(e)})}),a},arrayRemove(e,t){return e.filter((function(e){return e!=t}))},async getRoomGeometry(e){this.selectedrooms=e,e.forEach((e,t)=>{o["a"].state.rs.rdfStore.match(m.sym(e),s["c"].IFOUR("m_polyline"),null).forEach((t,a)=>{i["a"].addRoomMatrix(t,1789810,.9,e)})}),this.createRoomList()},loadHovedByggGeometry(){},async getHospitalFunctions(){await p.searchAndGetTriples("#NMH.F.SYKEHUS.*");this.csfitems=[];const e=[],t=[],a=[],r=[];o["a"].state.rs.rdfStore.match(null,s["c"].TAG("tag"),null).forEach(n=>{if(n.object.value.includes("NMH.F.SYKEHUS.")){let i=!1;o["a"].state.rs.rdfStore.match(m.sym(n.subject.value),s["c"].RDFS("label"),null).forEach(e=>{e.object.value.includes("Hovedfunksjon")&&(i=!0)}),i?(console.log("Found: "+n.object.value),t.includes(n.subject.value)||(e.push(n.object.value),t.push(n.subject.value))):r.includes(n.subject.value)||(a.push(n.object.value),r.push(n.subject.value))}});let n=0;e.forEach((e,i)=>{const l=[];a.forEach((t,a)=>{if(t.includes(e+".")){let e=o["a"].state.rs.rdfStore.match(m.sym(r[a]),s["c"].RDFS("label"),null)[0].object.value.replace("Delfunksjon: ","");e=c["a"].decodeCharacters(e),l.push({id:n,name:e,color:this.colorlist[i],tag:t,uri:r[a]}),n++}}),l.sort(f);let d=o["a"].state.rs.rdfStore.match(m.sym(t[i]),s["c"].RDFS("label"),null)[0].object.value.replace("Hovedfunksjon: ","");d=c["a"].decodeCharacters(d),this.csfitems.push({id:n,name:d,color:this.colorlist[i],tag:e,uri:t[i],children:l}),this.csfitems.sort(f),n++})},setAllFunctionsSelected(){this.csfselection.length>0?this.csfselection=[]:this.csfitems.forEach(e=>{this.csfselection.push(e)})},showBuildingDetails(){o["a"].state.cp.buildingDetailURI=this.buildingURIs[0],console.log("Setting building uri: "+this.buildingURIs[0])},async populateSpaces(){let e=await l["a"].populateStoreFromTurtle();console.log(e),o["a"].state.rs.rdfStore.match(null,s["c"].RDF("type"),s["c"].BOT("Space")).forEach(e=>{console.log("Found room: "+e.subject.value),this.selectedRoomURIs.push(e.subject.value)}),this.getRoomGeometry(this.selectedRoomURIs)}},computed:{sItem(){return this.selectedItem},filter(){return this.caseSensitive?(e,t,a)=>e[a].indexOf(t)>-1:void 0}},watch:{"$store.state.bv.twodim":function(e){console.log("Value changed.."),this.twodim=e},rhfselected:function(e){console.log("rhf selected...");var t=0,a=0,o=0,r=0;for(let s=0;s<this.rhfselected.length;s++)console.log("Selected RHF: "+this.rhfselected[s]),"Helse Nord RHF"==this.rhfselected[s]&&(t=1),"Helse Midt-Norge RHF"==this.rhfselected[s]&&(a=1),"Helse Vest RHF"==this.rhfselected[s]&&(o=1),"Helse Sør-Øst RHF"==this.rhfselected[s]&&(r=1);this.hrimage="hr"+t+a+o+r+".png",this.rhfselectedURIs.forEach((e,t)=>{const a=m.st(e,s["c"].ORG("hasSubOrganization"),null);let o=[];o.push(a),this.getURIObject(o,a,"").then(e=>{e.forEach((e,t)=>{console.log("Found HF URIs: "+e.object.value),this.hfselectedURIs.push(e.object);const a=m.st(e.object,s["c"].FOAF("name"),null);let o=[];o.push(a),this.getURIObject(o,a,"").then(e=>{e.forEach((e,t)=>{this.hfselected.includes(""+e.object.value)||(this.helseforetak.push(e.object.value),this.hfselected.push(e.object.value))})})})})})},hfselected:function(e){console.log("hf selected..."),this.hfselectedURIs.forEach((e,t)=>{const a=m.st(e,s["c"].ORG("hasSubOrganization"),null);let o=[];o.push(a),this.getURIObject(o,a,"").then(e=>{e.forEach((e,t)=>{if(!this.locationURIs.includes(e.object)&&e.object.value.includes("/i")){this.locationURIs.push(e.object);const t=m.st(e.object,s["c"].FOAF("name"),null);let a=[];a.push(t),this.getURIObject(a,t,"").then(e=>{e.forEach((e,t)=>{this.locationNames.includes(""+e.object.value)||(this.locationNames.push(e.object.value),this.lokselected.push(e.object.value))})})}})})})},lokselected:function(e){console.log("location selected..."),this.locationURIs.forEach((e,t)=>{const a=m.st(null,s["c"].ACL("owner"),m.sym(e));let r=[];r.push(a),this.getURISubject(r,a,"").then(e=>{e.forEach((e,t)=>{this.siteURIs.includes(e.subject.value)||(console.log("Found Site URIs: "+e.subject.value),this.siteURIs.push(e.subject.value))}),this.siteURIs.forEach((e,t)=>{o["a"].state.rs.rdfStore.match(null,s["c"].ACL("owner"),m.sym(e)).forEach(e=>{console.log("Found Building URIs: "+e.subject.value),this.buildingURIs.includes(e.subject.value)||this.buildingURIs.push(e.subject.value),o["a"].state.rs.rdfStore.match(m.sym(e.subject.value),s["c"].FOAF("name"),null).forEach(e=>{this.buildingNames.includes(""+e.object.value)||this.buildingNames.push(""+e.object.value)})})})}),this.getAllBuildings(),this.buildingURIs.forEach(e=>{e==this.$route.query.location+"i"&&o["a"].state.rs.rdfStore.match(m.sym(e),s["c"].FOAF("name"),null).forEach(e=>{this.buildingNames.includes(""+e.object.value)&&(this.buildingSelected.includes(""+e.object.value)||this.buildingSelected.push(""+e.object.value))})}),0==this.buildingSelected.length&&this.buildingSelected.push(""+this.buildingNames[0]),i["a"].createBuildingLocationList(this.buildingURIs)})},buildingSelected:async function(e){const t=[];this.buildingNames.forEach((e,a)=>{t.push(this.buildingURIs[a])});t.forEach((e,t)=>{n["a"].fetchAndSaveTurtle(e,!0).then(e=>e)}),await l["a"].searchAndGetURIs("#"+o["a"].state.currentBuildingTag+".FLOY*");o["a"].state.rs.rdfStore.match(null,s["c"].RDF("type"),s["c"].NEO("s_instance")).forEach(e=>{o["a"].state.rs.rdfStore.match(m.sym(e.subject.value),s["c"].TAG("tag"),null).forEach(t=>{t.object.value.includes(o["a"].state.currentBuildingTag+".FLOY")&&(console.log("Found wing: "+t.subject.value),this.wingURIs.includes(e.subject.value)||this.wingURIs.push(t.subject.value))})}),this.wingURIs.forEach((e,t)=>{let a=o["a"].state.rs.rdfStore.match(m.sym(e),s["c"].RDFS("label"),null);a.forEach(e=>{console.log("Found wing name: "+e.object.value);const t=c["a"].decodeCharacters(e.object.value);this.wings.includes(t)||this.wings.push(t)})})},wingselected:async function(e){await l["a"].searchAndGetURIs("#"+o["a"].state.currentBuildingTag+"*");o["a"].state.rs.rdfStore.match(null,s["c"].RDF("type"),s["c"].BOT("Storey")).forEach(e=>{console.log("Found storey: "+e.subject.value),this.floorURIs.includes(e.subject.value)||this.floorURIs.push(e.subject.value)}),this.floorURIs.forEach((e,t)=>{let a=o["a"].state.rs.rdfStore.match(m.sym(e),s["c"].RDFS("label"),null);a.forEach(e=>{console.log("Found storey name: "+e.object.value+" URI: "+e.subject.value),this.floors.includes(e.object.value)||this.floors.push(e.object.value)})}),o["a"].state.rs.rdfStore.match(null,s["c"].RDF("type"),s["c"].BOT("Space")).forEach(e=>{this.selectedRoomURIs.includes(e.subject.value)||(console.log("Found room: "+e.subject.value),this.selectedRoomURIs.push(e.subject.value))}),this.getRoomGeometry(this.selectedRoomURIs)},floorselected:async function(e){console.log(this.floorselected),o["a"].state.bv.GLTFloadingQueue=[],i["a"].unloadGeometryContainingString("FLOORPLAN");let t=[],a="";this.floors.forEach((e,r)=>{if(this.floorselected.includes(e)){let a=o["a"].state.rs.rdfStore.match(null,s["c"].RDFS("label"),m.literal(e,"en"));a.forEach(e=>{t.includes(e.subject.value)||(console.log("Found selected Storey URI: "+e.subject.value),t.push(e.subject.value))})}else{let t=o["a"].state.rs.rdfStore.match(null,s["c"].RDFS("label"),m.literal(e,"en"));t.forEach(e=>{o["a"].state.rs.rdfStore.match(m.sym(e.subject.value),s["c"].TAG("tag"),null).forEach(e=>{a=e.object.value,a=a.replace(".FLOY_O",""),i["a"].unloadGeometryUsingTag(a,["FLOORPLAN"]),i["a"].unloadGeometryUsingTag(a,["IFCWALL"]),i["a"].unloadGeometryUsingTag(a,["IFCSLAB"])})})}}),console.log("Selected storeys:"),console.log(t),console.log("Before storey fetch"),t.forEach(e=>{o["a"].state.rs.rdfStore.match(m.sym(e),s["c"].TAG("tag"),null).forEach(e=>{console.log("Storey tag: "+e.object.value),a=e.object.value,a=a.replace(".FLOY_O",""),a=a.replace(".FLOY_S",""),a=a.replace(".FLOY_V",""),a=a.replace(".FLOY_N",""),a=a.replace(".FLOY_M",""),o["a"].state.bv.gltfGeoVisible&&(o["a"].state.bv.twodim?i["a"].loadGeometryUsingTag(a,this.$route.query.location,["FLOORPLAN"]):i["a"].loadGeometryUsingTag(a,this.$route.query.location,["IFCWALL","IFCSLAB"]))})});const r=o["a"].state.bv.scene.getObjectByName("buildingbox");for(var n=r.children.length-1;n>=0;n--)r.remove(r.children[n]);o["a"].state.bv.roomGeometry=[],this.selectedRoomURIs=[];for(let i=0;i<t.length;i++){const e=t[i];o["a"].state.rs.rdfStore.match(m.sym(e),s["c"].SIO("SIO_000202"),null).forEach(e=>{o["a"].state.rs.rdfStore.match(m.sym(e.object.value),s["c"].RDF("type"),s["c"].BOT("Space"))[0]&&(this.selectedRoomURIs.includes(e.object.value)||(console.log("Found room: "+e.object.value),this.selectedRoomURIs.push(e.object.value)))})}this.getRoomGeometry(this.selectedRoomURIs),console.log("Number of rooms found: "+this.selectedRoomURIs.length)},contractUserSelected:async function(e){o["a"].state.bv.scene.remove(o["a"].state.bv.scene.getObjectByName("roomlabel")),o["a"].state.bv.roomGeometry=[];const t=o["a"].state.bv.scene.getObjectByName("buildingbox");for(var a=t.children.length-1;a>=0;a--)t.children[a].name.includes("FLOORPLAN")||t.remove(t.children[a]);this.filteredrooms=[],this.selectedrooms=[],this.filteredrooms.push({uri:"https://hovedbygg111.trinpod.us/node/t_u6",color:"#911eb4"}),this.selectedrooms.push("https://hovedbygg111.trinpod.us/node/t_u6"),this.filteredrooms.push({uri:"https://hovedbygg111.trinpod.us/node/t_uw",color:"#911eb4"}),this.selectedrooms.push("https://hovedbygg111.trinpod.us/node/t_uw"),this.filteredrooms.push({uri:"https://hovedbygg111.trinpod.us/node/t_uk",color:"#911eb4"}),this.selectedrooms.push("https://hovedbygg111.trinpod.us/node/t_uk")},"$store.state.bv.selectedRoomNames":function(e){if(2==o["a"].state.bv.selectedRoomNames.length){console.log("Call wayfinding now.");const e=m.literal(o["a"].state.bv.selectedRoomNames[0],"en"),t=m.literal(o["a"].state.bv.selectedRoomNames[1],"en");console.log("Room1: "+o["a"].state.bv.selectedRoomNames[0]),console.log("Room2: "+o["a"].state.bv.selectedRoomNames[1]);let a=r["a"].methods.wayBetweenRooms(e,t,1,"");o["a"].state.bv.wayBetweenRooms=a}},"$store.state.rs.urisFetched":function(e){this.urisFetched=o["a"].state.rs.urisFetched},"$store.state.cp.roomDetailURI":function(e){e.length>=5?this.roomDetailsVisible=!0:this.roomDetailsVisible=!1},"$store.state.cp.buildingDetailURI":function(e){e.length>=1?this.buildingDetailsVisible=!0:this.buildingDetailsVisible=!1},roomTableSelectedRow:function(e){o["a"].state.bv.selectedRoomIDs=[],o["a"].state.bv.selectedRoomNames=[],e.forEach((e,t)=>{o["a"].state.bv.selectedRoomIDs.push(e.roomid);const a=e.roomname.replace("Room ","").replace("Rom ","");o["a"].state.bv.selectedRoomNames.push(a)})},csfselection:function(e,t){this.partfunctionsSelected=[],o["a"].state.bv.roomGeometry=[];const a=o["a"].state.bv.scene.getObjectByName("buildingbox");for(var s=a.children.length-1;s>=0;s--)a.children[s].name.includes("FLOORPLAN")||a.remove(a.children[s]);e.forEach(e=>{this.partfunctionsSelected.push({uri:e.uri,color:e.color})})},partfunctionsSelected:function(e,t){this.filteredrooms=[],this.selectedrooms=[],e.forEach(e=>{this.selectedRoomURIs.forEach(t=>{try{o["a"].state.rs.rdfStore.match(m.sym(t),null,m.sym(e.uri)).forEach(t=>{this.selectedrooms.includes(t.subject.value)||(this.filteredrooms.push({uri:t.subject.value,color:e.color}),this.selectedrooms.push(t.subject.value))})}catch(a){}})})},filteredrooms:function(e,t){e.forEach(e=>{o["a"].state.rs.rdfStore.match(m.sym(e.uri),s["c"].IFOUR("m_polyline"),null).forEach((t,a)=>{i["a"].addRoomMatrix(t,b(e.color),1,e.uri)})}),this.createRoomList()}},mounted(){this.hrimage="hr1111.png",this.checklogin(),o["a"].state.bv.mapMode=!0,this.getHospitalFunctions(),this.getRHFDataFromTrinity(),o["a"].state.bv.twodim=!0,this.twodim=!0,setTimeout(()=>{o["a"].state.rs.rdfStore.match(null,s["c"].GMXO("2"),"MinistryOfHealth").forEach(e=>{console.log("Trying to set:"),null!=e.subject&&(console.log("setting....."),this.rhfselected.push("Helse Nord RHF"),this.hfselected.push("Helgelandssykehuset HF"),this.lokselected.push("1 - Mo i Rana"),this.buildingSelected.push("111 - Hovedbygg"))})},2e3)},created(){},updated(){console.log("View did update."),o["a"].state.bv.animate=!0,setTimeout(()=>{o["a"].state.bv.animate=!1},1e3)}}}).call(this,a("b639").Buffer)},"66a6":function(e,t,a){},"68cd":function(e,t,a){"use strict";a("ed15")},"6bbc":function(e,t,a){"use strict";a("e678")},"6ca8":function(e,t,a){"use strict";a("11c1"),a("4360"),a("fb26");const o=a("592d");o.graph()},"6d2a":function(e,t,a){e.exports=a.p+"img/room.22ff57df.png"},"6fca":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAACXBIWXMAAAKdAAACnQEbaSIpAAAFyGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgOS4wLWMwMDAgNzkuMTcxYzI3ZmFiLCAyMDIyLzA4LzE2LTIyOjM1OjQxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjQuMSAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjMtMDEtMDlUMTA6MTQ6MTUrMDE6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIzLTAxLTA5VDEwOjI3KzAxOjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDIzLTAxLTA5VDEwOjI3KzAxOjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1NzZjODVhYy1lMWE5LTQwMDgtOGY2Ny04NjNhNjQ4YTJlNDkiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDplOWRiOTIxZi1jMzFiLWVmNDctYTg1Yy0xNDVmMzU2YmExMmUiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjZjM1OWQ1Yy1iMzZjLTQxODUtOTU1ZC0xYzg5ZGZiMTc0MzIiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmNmMzU5ZDVjLWIzNmMtNDE4NS05NTVkLTFjODlkZmIxNzQzMiIgc3RFdnQ6d2hlbj0iMjAyMy0wMS0wOVQxMDoxNDoxNSswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI0LjEgKE1hY2ludG9zaCkiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjU3NmM4NWFjLWUxYTktNDAwOC04ZjY3LTg2M2E2NDhhMmU0OSIgc3RFdnQ6d2hlbj0iMjAyMy0wMS0wOVQxMDoyNyswMTowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDI0LjEgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+L9ZYKAAABFRJREFUWIXNmGuoFlUUhp+jRys10yyM8nK6ipmEZWpW0MUCKSy6g38UIjIhivpRSZFUSHQhScgf3bMoQyxQMCEKTMus/FFUaliiUhyLLC/pQX36sff0jePsmTka2Aubb8/sd631zp79rb1mt6n8n9HjaAuoQ3tDXn/gfuBmYOgRxtwGLAaeB7bUkdsavOK+wA/AkCMUVsQuYDTwUxWpySt+i/9eHIQHX1hHqpvBa4ElNT4WAauAjUAnsB8YBHQAYwnL4vgK+xnA/OSoWtU2msZc9Zwae9ST1IfV3xN+dqm9UvZVjqclHP6hjmogrNgGqWsSPp/orsCB6o4SR7+oHYchLms91U9L/O5Th3dH4KuJJ73gCMRlrbe6p8T3iqYChyTELWkQvM0wS3W8hxIxJjYR+GHCuGzdjVfvUz9Wt6pd6n51m/qlOlu9usTuWMtn8Zs6gdcnxH1e4N2uflXC61J3l9zfpN5b8DE/EeueKoFbE0ZP5TiP5u6vUWeoZ6v9cpw+6lD1FnVpjv9OjnNbItY+c8skL25GwkB1euTMjNd7DLPY9I9xmbou2r4e742uiPdcUeAA9UCFwfjIy3BJN8Rlrb9hfWrIidTE7FD/3YvnAW0V29GPwMjYXwGsrNn+yvAX8EzsT42/eyv470IoFs7IGaTQBUyI/ZcOQ1yGV+Lv2Pi7v4I7Dri8HZjdwPEAWhv+duBGYBTwJ7AZWAv8XGIzERgOnEyoA1cDB4DBQG+gV03cJ1F3VqyDDGPUO2J/ccn4AXWeOkw9RX3QsGcXsdSQihaqgxvE3dsOHNNgBk8HNsX+vpLxNmAmYU2tA+Yk/HTFWVsfZ7gOPXsAyxoQz4uBAZYDryV4G4AvEmPf5exWAqc1iPst6oUNpvojW2nmk9hfUOCsNaQrPHQZrDDUfI/E6+PUWQ3i3pTlqOU1xK7IWxSvszx2vnqDeqWH5r2L41i+ANCwT2Mrcaew3lyi7mjwNOPUEbHfpLIpttnR9i7DbNbhorxA1MdrDF6MvM54PS1n29Ow956rjlTPNNR9+aonQw/DNlmFBZlt8SnLqugMOyNnSu7eGFt1YIc6Wb0uimyPYwNtpbIX4r1VNQJPSAm8s8Ywq6h/jdfb1UtNv9az1A05+76GWrAKc/I+ypyurTBeGDmTCvenlvi5woNrwwfi/bsr/G8u+ikTWFUGdamnRt5jhbElhn/tZPXNwtjbttbq5gr/U5oIxIOLzCLeyPHmVvAyvJ/jVy2h78u0pAQOqwk6LMedpL6nbsmNd6rL1FsLfjtNo/SLsSpvpb68VD8r4fcypJrhhpK/OJ76BlF9OaWjLrn+VuH0gxrbfHu2wo+2tshuC5xe4/hrw2s8scS2n3pNfJAqJI891Ebng6sJ1W0VdhPKsR2AQB/Ckd3AGrtNhFOwJJoIHEI4Wqurfg8HEwgTkEQTgQAjgFnAVVSf9TXB34QPr6frxEFzgUcN//tT/n8A+edfdlvkzUEAAAAASUVORK5CYII="},7:function(e,t){},"706e":function(e,t,a){"use strict";var o=a("0ee7"),s=a("4360"),r=a("4e14"),n=a("fb26"),i=a("b33c"),l=a("f973"),c=a("21cc"),d=a("a026"),u=a("5c7d");const h=a("592d"),g=s["a"].state.rs.rdfStore,m=new h.Fetcher(g,{fetch:s["a"].state.rs.hyperFetch}),p=a("1157"),f={error:function(e){u["error"]("***ERROR***",e)},login:async function(){if(await window.solid.session,u["debug"]("login",s["a"].state.webId),s["a"].state.webId){var e=r["parse"](s["a"].state.webId),t=e.port;t=t?":"+t:"",s["a"].state.podNs=e.scheme+"://"+e.host+t+"/node/",s["a"].state.pod=e.host+t,n["c"].U1=h.Namespace(s["a"].state.podNs),n["d"].U1=s["a"].state.podNs;const R=await s["a"].dispatch("loadDataSet",{uri:s["a"].state.webId,sentFrom:"util-rdf.login"});if(R){var a=h.sym(s["a"].state.webId);s["a"].state.userName=f.getLabel(a);var o=g.anyStatementMatching(a,n["c"].SPACE("storage"));o&&(o=o.object);var l=g.anyStatementMatching(a,n["c"].FOAF("PersonalProfileDocument"));l&&(l=l.object),u["debug"]("session",window.solid.session,o,l),o&&(s["a"].state.storage=o.value),s["a"].state.profile=l?l.value:s["a"].state.webId;var c=d["default"].router.currentRoute,m=c.hash,b=c.path,v=c.query,y=decodeURIComponent(b);u["debug"]("route",c,m,b,v,y);var w=i["a"].deleteKeys(v,["code","state"]),I=window.localStorage.getItem("redirect_uri");if(I){I=r["parse"](decodeURIComponent(I));var S=i["a"].deparam(I.query);"object"===p.type(S)&&S.location&&(w=S)}s["a"].commit("loggedIn",!0),w.location||(w.location=s["a"].state.webId),u["debug"]("state.storage",s["a"].state.storage,w),s["a"].state.node=s["a"].state.webId,s["a"].commit("location",s["a"].state.webId),s["a"].commit("loading",!1),d["default"].router.push({path:b,query:w})}}},getIssuer:function(e){e=i["a"].getURI(e);if(e){var t=f.getWebId(e);if(!t)return i["a"].getBaseURI(e);var a=g.anyStatementMatching(h.sym(t),n["c"].SOLID("oidcIssuer"));if("object"===p.type(a)&&a.object)return a.object.value}},getInbox:function(e){e=i["a"].getURI(e);if(e){var t=f.getWebId(e);if(t){var a=g.anyStatementMatching(h.sym(t),n["c"].LDP("inbox"));if("object"===p.type(a)&&a.object)return a.object.value}}},isNeo:function(e){var t=f.getNamespace(e);return"NEO"===t},isConstructionPod:function(e){var t=i["a"].getURI(e);if(t){var a=f.getTypes(t);return!(!Array.isArray(a)||!a.includes(n["c"].NEO("a_pod-construction").value))}return!1},isChildPod:function(e){var t=f.getWebId(e);if(t){var a=i["a"].unique(g.match(h.sym(t),h.sym(n["c"].ACL("owner"))));return!!(Array.isArray(a)&&a.length>0)}},isParentPod:function(e){var t=i["a"].getURI(e);if(t){var a=f.getWebId(t);if(a){var o=i["a"].unique(g.match(null,h.sym(n["c"].ACL("owner")),h.sym(a)));return!!(Array.isArray(o)&&o.length>0)}}},isParentPodCapable:function(e){var t=i["a"].getURI(e);return!!t&&!(t!==f.getWebId(t)||!f.isParentPod(t)&&f.isChildPod(t))},isPodProject:function(e){return f.isPodType(e,n["c"].DOAP("Project"))},isPodBusiness:function(e){return f.isPodType(e,n["c"].GR("BusinessEntity"))},isPodOrganization:function(e){return f.isPodType(e,n["c"].ORG("Organization"))},isPodGroup:function(e){return f.isPodType(e,n["c"].VCARD("Group"))},isPodBuilding:function(e){return f.isPodType(e,n["c"].BOT("Building"))},isPodSite:function(e){return f.isPodType(e,n["c"].BOT("Site"))},isPodPersonal:function(e){var t=i["a"].getURI(e);if(t){var a=f.getWebId(t);if(t===a){var o=i["a"].getURIs(f.getTypes(t));return!(!Array.isArray(o)||!o.includes(n["c"].FOAF("Person").value))}return!1}},isPodType:function(e,t){var a=f.getWebId(e);return!!a&&f.isType(a,t)},isType:function(e,t){t=i["a"].getURI(t);var a=i["a"].getURI(e);if(a&&t){var o=f.getTypes(a);return!!Array.isArray(o)&&!!o.includes(t)}return!1},isProcess:function(e){return f.isType(e,n["c"].OPMV("Process"))},isAccount:function(e){var t=i["a"].getURI(e);return!(!f.isType(t,n["c"].SOLID("Account"))&&t!==s["a"].state.storage)},isContainer:function(e){return f.containerP(e)},containerP:function(e){return f.isType(e,n["c"].LDP("Container"))||f.isType(e,n["c"].LDP("BasicContainer"))||f.isType(e,n["c"].LDP("IndirectContainer"))||f.isType(e,n["c"].LDP("DirectContainer"))},isPort:function(e){return f.isType(e,n["c"].NEO("x_port"))||f.isObjectPort(e)},isControlledProject:function(e){return!(!f.isPodProject(e)||!ua.userCanControl(e))},isConcept:function(e){var t=i["a"].getURI(e);return!!t&&!!(g.anyStatementMatching(h.sym(t),n["b"].m_cid)||t.includes("http://www.w3.org/ns/iana/media-types/")||t.includes("https://w3id.org/idsa/core/"))},isQuad:function(e){return!("object"!==p.type(e)||!e.subject)},isEvent:function(e){var t=i["a"].getURI(e);if(t){var a=h.sym(t);return!!(g.anyStatementMatching(null,n["b"].i_input,a)||g.anyStatementMatching(a,n["b"].o_output)||g.anyStatementMatching(a,n["b"].t_execute))}return!1},isAttribute:function(e){var t=i["a"].getURI(e);if(t){var a=f.getTypes(t);return!!a&&(a=i["a"].getURIs(a),!!a.includes(n["c"].SIO("SIO_000614").value))}return!1},isState:function(e){if(!i["a"].isBlankNode(e)){var t=i["a"].getURI(e);if(t){var a=f.getTypes(t);return!!a&&(a=i["a"].getURIs(a),!!a.includes(n["c"].NEO("s_state").value))}return!1}},isEntity:function(e){var t=i["a"].getURI(e);if(t){var a=i["a"].unique(g.match(h.sym(t),n["b"].i_entity));return"array"===p.type(a)&&a.length>0}},isObjectContains:function(e){var t=i["a"].getURI(e);return!!t&&!!g.anyStatementMatching(null,n["b"].m_contains,h.sym(t))},isObjectJoin:function(e){var t=i["a"].getURI(e);return!!t&&!!g.anyStatementMatching(null,n["b"].m_join,h.sym(t))},isObjectPort:function(e){var t=i["a"].getURI(e);return!!t&&!!g.anyStatementMatching(null,n["b"].m_port,h.sym(t))},isObjectRelation:function(e,t){var a=!1,o=i["a"].getURI(e);return o&&i["a"].isRdfNode(t)&&g.anyStatementMatching(h.sym(o),t)&&(a=!0),a},isRelation:function(e,t){var a=!1,o=i["a"].getURI(e);return o&&i["a"].isRdfNode(t)&&(g.anyStatementMatching(null,t,h.sym(o))||g.anyStatementMatching(h.sym(o),t))&&(a=!0),a},isRelationPort:function(e){return f.isRelation(e,n["b"].m_port)},isRelationJoin:function(e){return f.isRelation(e,n["b"].m_join)},isRelationContains:function(e){return f.isRelation(e,n["b"].m_contains)},isObjectDo:function(e){var t=i["a"].getURI(e);return!!t&&!!g.anyStatementMatching(null,n["b"].j_do,h.sym(t))},getSubject:function(e,t){var a=i["a"].getURI(e);if(a&&i["a"].isRdfNode(t)){var o=g.anyStatementMatching(null,t,h.sym(a));if(o)return o.subject.value}},getObject:function(e,t){var a=i["a"].getURI(e),o=[];if(a&&i["a"].isRdfNode(t)){var s=g.match(h.sym(a),t);Array.isArray(s)&&s.length>0&&s.forEach(e=>{o.push(e.object.value)})}if(o.length>0)return o},getSystemUp:function(e){var t=f.getSubject(e,n["b"].m_contains)||f.getSubject(e,n["b"].m_port)||f.getSubject(e,n["b"].m_join);return t},getSystemDown:function(e){var t=f.getObject(e,n["b"].m_contains)||f.getObject(e,n["b"].m_port)||f.getObject(e,n["b"].m_join);return t},isSystemObj:function(e){return!(!f.getSystemUp(e)&&!f.getSystemDown(e))},getPortTo:function(e){var t=i["a"].getURI(e);if(t){var a=f.getInherit(t,n["c"].NEO("m_port"));if(a)return i["a"].getURIs(a)}},getPortFrom:function(e){var t=i["a"].getURI(e);if(t){var a=f.getInherit(t,n["c"].NEO("m_port"),!0);if(a)return i["a"].getURIs(a)}},stateToElems:function(e){if(f.isState(e)){var t,a,o=i["a"].getURI(e),s={};if(o){var r=i["a"].unique(g.match(null,n["b"].i_entity,h.sym(o)));if("array"===p.type(r)){var l=r[0];"object"===p.type(l)&&(t=l.subject.value)}var c=i["a"].unique(g.match(null,n["b"].i_attribute,h.sym(o)));if("array"===p.type(c)){var d=c[0];"object"===p.type(d)&&(a=d.subject.value)}t&&(s.e_entity=t),a&&(s.a_attribute=a)}return s}},attributeToElems:function(e){if(f.isAttribute(e)){var t,a,o=i["a"].getURI(e),s={};if(o){var r=i["a"].unique(g.match(h.sym(o),n["b"].i_function));if("array"===p.type(r)){var l=r[0];"object"===p.type(l)&&"object"===p.type(l.object)&&(t=l.object.value)}var c=i["a"].unique(g.match(h.sym(o),n["b"].o_result));if("array"===p.type(c)){var d=c[0];if("object"===p.type(d)){var u=d.object;a="NamedNode"===u.termType?d.object.value:d.object}}"string"===p.type(t)&&(s.f_function=t),s.a_result=a}return s}},f_function:function(e,t){if(f.isState(e)&&!t){var a=f.stateToElems(e);if("object"===p.type(a))return f.f_function(a.a_attribute,!0)}else{var o=f.attributeToElems(e);if("object"===p.type(o))return o.f_function}},a_result:function(e,t){if(f.isState(e)&&!t){var a=f.stateToElems(e);if(a)return f.a_result(a.a_attribute,!0)}else if(f.isAttribute(e)){var o=f.attributeToElems(e);if("object"===p.type(o))return o.a_result}else if(f.isEntity(e)){var s=i["a"].unique(g.match(null,n["c"].NEO("o_result"),h.sym(i["a"].getURI(e)))),r=[];return s.forEach(e=>r.push(e.subject.value)),r}},literalEqual:function(e,t){return e.value===t.value&&e.language===t.language&&(e.datatype&&t.datatype?e.datatype.value===t.datatype.value:!e.datatype&&!t.datatype||void 0)},stateToQuad:function(e){var t=i["a"].getURI(e);if(t){if(f.isState(t)){var a,o,s,r=l["a"].entity(t)[0],n=l["a"]._function(t)[0],c=l["a"].result(t);return r&&(a=h.sym(r)),n&&(o=h.sym(n)),"object"===p.type(c)?"Literal"===c.termType?s=c:"NamedNode"===c.termType&&(s=h.sym(c.value)):s=h.sym(c),i["a"].unique(g.match(a,o,s))}if(f.isEntity(e))return f.stateToQuad(l["a"].state(t));if("array"===p.type(e))return p.map(e,(function(e){return f.stateToQuad(e)}))}},quadToState:function(e){var t;if(f.isQuad(e)){var a,o=e.subject,s=e.predicate.value,r=e.object,n="Literal"===r.termType;a=n?r:r.value;var i=l["a"].state(o.value);i&&Array.isArray(i)&&i.forEach((function(e){var o=l["a"]._function(e);o=o&&Array.isArray(o)?o[0]:null;var r=l["a"].result(e);o!==s||r!==a||(t=e)}))}return t},tripleToState:function(e,t,a){e=i["a"].getURI(e),t=i["a"].getURI(t);var o,s="object"===p.type(a),r=s&&"Literal"===a.termType;return o=r||s?a:h.sym(i["a"].getURI(a)),f.quadToState(h.st(h.sym(e),h.sym(t),o))},sourceQuads:function(e){var t=i["a"].getURI(e);if(t)return i["a"].unique(g.match(h.sym(t)))},targetQuads:async function(e){var t=i["a"].getURI(e);if(t)return i["a"].unique(g.match(null,null,h.sym(t)))},location:function(e,t){var a;return"Files"===t&&(a=i["a"].getURI(e),f.containerP(a)||(a=f.getContainer(a))),a||(a=e),i["a"].getURI(a)},aLoadURI:async function(e,t,a){if(u["debug"]("aLoadURI",e,t),a||(a={}),a.fetch=window.solid.hyperFetch,e=f.getGmxLoad(e,a),a.headers={hypergraph:"U2FsdGVkX1/S0rANmPZVe3xCIXvlGoGnGudwlp4wFSMFtte++kYYPt0l4B4407c+"},!e)return u["error"]("ERROR: bad URI to loadURIa"),"ERROR: bad URI to loadURIa";try{var o=await m.load(e,a);u["debug"]("ur.aLoadURI response",o);var r=i["a"].unique(g.match(null,null,null,h.sym(e)));return u["debug"]("URI loaded",e,r.length),[r,o]}catch(n){return u["debug"]("Cant load URI",e,n),c["a"].createAlert("Error:",n,"","danger",!0,!0,"pageMessages"),s["a"].commit("dequeueDataSet",e),n}},loadPropertiesNode:async function(e){u["debug"]("ur.loadPropertiesNode",e);var t=i["a"].getIRI(e);if(e=h.sym(t),t){var a=f.getTypes(t,!0);if(a){u["debug"]("***TYPES",a);var o,r=i["a"].uriToNamedNode(n["c"].RDFS("domain").value),l=[],c=[],d=await s["a"].dispatch("loadDataSet",{uri:t,sentFrom:"util-rdf.loadPropertiesNode"});if(u["debug"]("property ds",d),d){var g=d.match(null,r);u["debug"]("properties - nPs",d,g),u["debug"]("WOW"),g&&(g.quads.forEach(e=>c.push(h.sym(e.object.value))),g.quads.forEach(e=>l.push(h.sym(e.subject.value)))),u["debug"]("nProps",e,l,c)}if(l)for(o of(l=i["a"].unique(l),l)){s["a"].commit("selectProperties",!1);await s["a"].dispatch("loadDataSet",{uri:o.value,sentFrom:"util-rdf.loadPropertiesNode2"});var m,p=f.getTypes(o);o.label=f.getLabel(o),u["debug"]("prop",p,o);var b=d.match(i["a"].uriToNamedNode(t),i["a"].uriToNamedNode(o)),v=[];b.quads.forEach(e=>v.push(e)),v||(v=[]),o.values=v,m=f.getPropCategory(o),o.category=m[0];var y=s["a"].getters.Properties(e);y[m[0]]||(y[m[0]]={}),y[m[0]][o.value]=o,u["debug"]("props",o,m,o.uri,v),s["a"].commit("properties",{node:i["a"].getURI(e),cat:m[0],prop:o.value,value:o}),s["a"].commit("selectProperties",!0)}}}},aLoadNode:async function(e,t){var a=f.getGmxLoad(e),o=s["a"].state.pod,r={};t&&(r.force=!0),a?(config.logServerAndBrain&&u["debug"]("config.brain:"+s["a"].state.brain),a.match(s["a"].state.brain),u["debug"]("aLoadNode",a,r),await f.aLoadURI(a,null,r),ua.getAvailableModes(e)):"U1"!==f.getNamespace(e)&&(a.match(o)||u["error"]("ERROR - missing NS",e))},loadOntology:async function(e,t,a){if(e||a){"array"!==p.type(e)&&(e=[e]);var o=p.map(e,(function(e){var t;if(t=f.getGmxLoad(e),t&&!t.match("ERROR"))return t}));a&&(config.logServerAndBrain&&u["debug"]("config.brain:"+s["a"].state.brain),o=[s["a"].state.brain+"/ns/GMX"]),o&&(await g.fetcher.load(o),p.map(o,(function(e){var t=i["a"].unique(g.match(null,null,null,h.sym(e)));if(t)for(let o=0;o<t.length;o++){var a=t[o];g.add(a.subject,a.predicate,a.object)}})))}else u["error"]("ERROR: no valid Nodes to load")},loadType:async function(e,t){var a,o=f.getNamespace(e);if(o){var s=f.getNsTerm(e,o);s&&(a=f.getGmxLoad(e))}else u["error"]("ERROR NS not present",e);if(a){await f.aLoadURI(a,"ontology");var r=i["a"].unique(g.match(null,n["c"].RDFS("domain"),h.sym(e)));if(r){var l=[];return p.map(r,(function(e){l.push(e.subject)})),await f.loadOntology(l,!0),u["debug"]("Type loaded",e,t,r),r}u["debug"]("Type loaded - no Props",e,t)}},loadSelect:async function(e,t){u["debug"]("ur.loadSelect",e),await f.aLoadNode(e);var a=i["a"].getIRI(e);if(a){var o=f.getTypes(a);if(o||(o=[]),o){u["debug"]("***TYPES",o),p.inArray(n["c"].SIO("SIO_000135").uri,o)>-1&&await f.loadType(e);const t=o.map(async t=>f.loadType(t,e));var s=await Promise.all(t).then((function(e){return u["debug"]("Types Loaded",o,e),e}));s=p.map(s,(function(e){return e}));var r=p.map(s,(function(e){return e.subject}));if(r)return i["a"].unique(r)}}},getContainer:function(e){var t=i["a"].getURI(e);if(t){var a;a=i["a"].isBlankNode(t)?t:h.sym(t);var o=g.any(null,h.sym(n["c"].SIO("SIO_000202").value),a);if(o&&(t=o.value,u["debug"]("nested",t)),t){var s=g.any(null,h.sym(n["c"].LDP("contains").value),a);if(s)return i["a"].isBlankNode(s)?s:s.value}}},getInherit:function(e,t,a){e=i["a"].getURI(e);var o=[];if(e&&"object"===p.type(t)&&"NamedNode"===t.termType)if(f.isState(e)&&!a){var s=f.stateToElems(e);if(s&&s.e_entity&&s.e_entity!=e)return f.getInherit(s.e_entity,t,a)}else{var r,n;r=i["a"].isBlankNode(e)?e:h.sym(e),a&&(n=r,r=null);var l=i["a"].unique(g.match(r,t,n));if(l&&l.length>0)return l.forEach((function(e){a?o.push(e.subject):o.push(e.object)})),o}},getParentPod:function(e){return f.getInherit(e,n["c"].ACL("owner"))},getParentPodLoad:async function(e){if(i["a"].checkURL(e))return await s["a"].dispatch("loadDataSet",{uri:e,sentFrom:"util-rdf.getParentPodLoad"}),f.getInherit(e,n["c"].ACL("owner"))},getChildPod:function(e){e=i["a"].getURI(e);if(e){var t=f.getInherit(e,n["c"].ACL("owner"),!0);return t}},getContents:function(e){e=i["a"].getURI(e);if(e)return f.getInherit(e,n["c"].LDP("contains"))},getContains:function(e){e=i["a"].getURI(e);if(e)return f.getInherit(e,n["c"].SIO("SIO_000202"))},getContainees:function(e){e=i["a"].getURI(e);if(e)return f.getInherit(e,n["c"].SIO("SIO_000202"),!0)},getLdpContainees:function(e){return f.getInherit(e,n["c"].LDP("contains"),!0)},getAclOwner:function(e){return f.getInherit(e,n["c"].ACL("owner"))},getAclOwnee:function(e){return f.getInherit(e,n["c"].ACL("owner"),!0)},getMember:function(e){return f.getInherit(e,n["c"].VCARD("hasMember"))},getMembee:function(e){return f.getInherit(e,n["c"].VCARD("hasMember"),!0)},getParentPodNested:function(e){return f.getInheritNested(e,f.getParentPod).reverse()},getParentPodNestedLoad:async function(e,t){if(i["a"].checkURL(e)){var a=await f.getInheritNestedLoad(e,f.getParentPod);if(Array.isArray(a))return a.reverse()}},getChildPodNested:function(e){return f.getInheritNested(e,f.getChildPod)},getContentsNested:function(e){return f.getInheritNested(e,f.getContents)},getContainsNested:function(e){return f.getInheritNested(e,f.getContains)},getContaineesNested:function(e){var t=f.getInheritNested(e,f.getContainees);return Array.isArray(t)&&t.length>0?t.reverse():[]},getLdpContaineesNested:function(e){var t=f.getInheritNested(e,f.getLdpContainees);if(t)return t.reverse()},getResourceUpHierarchy:function(e){var t=i["a"].getURI(e);if(t){var a;i["a"].isBlankNode(t)?a=t.pod:f.getWebId(t);var o,s=f.getContaineesNested(t),r=[];o=i["a"].isBlankNode(t)?t:h.sym(t);var l=g.match(o,n["c"].ACL("owner"));return Array.isArray(l)&&l.length>0&&l.forEach(e=>{r.push(e.object.value)}),r.push(a),Array.isArray(s)&&s.forEach(e=>{r=r.concat(f.getLdpContaineesNested(e))}),i["a"].unique(r)}},getEntityDownHierarchy:function(e){var t=i["a"].getURI(e);if(t)f.getContentsNested(t)},getInheritNested:function(e,t,a,o){if(Array.isArray(o)&&o.includes(e))return o;if(Array.isArray(a)&&a.includes(e))return o;var s=t(e);return o?o.push(e):o=[e],s&&0!==s.length?(a=Array.isArray(a)&&a.length>0?a.concat(s):s,f.getInheritNested(a.pop(),t,a,o)):Array.isArray(a)&&a.length>0?f.getInheritNested(a.pop(),t,a,o):o},getInheritNestedLoad:async function(e,t,a,o){u["debug"]("inheritLoad",e),s["a"].state.dataLoad.includes(e)||await s["a"].dispatch("loadDataSet",{uri:e,sentFrom:"util-rdf.getInheritNestedLoad"});var r=t(e);if(o?o.push(e):o=[e],r&&0!==r.length){a=Array.isArray(a)?a.concat(r):r;var n=f.getInheritNestedLoad(a.pop(),t,a,o);return n}if(Array.isArray(a)&&a.length>0){var i=f.getInheritNestedLoad(a.pop(),t,a,o);return i}return o},getCollabObjects:function(e,t){e=i["a"].getURI(e);if(e){var a,o=f.getWebId(e),s=[];return o&&(a=t?g.match(null,n["c"].NEO("m_collaborate-on"),h.sym(e)):g.match(h.sym(o),n["c"].NEO("m_collaborate-on")),Array.isArray(a)&&a.length>0&&a.forEach(e=>{if("object"===p.type(e)){var t=e.object;t&&(t=i["a"].getURI(t),t&&s.push(t))}})),s}},getCollaborators:function(e,t,a){e=i["a"].getURI(e);if(e){var o=f.getCollabObjects(e,a),s=[];return o.length>0&&o.forEach(e=>{var t=f.getWebId(e);t&&s.push(t)}),s=i["a"].unique(s),s}},getCollaboratorsLoad:async function(e){e=i["a"].getURI(e);if(e){var t=await f.loadWebId(e),a=[],o=[];if(t){var r=g.match(h.sym(t),n["c"].NEO("m_collaborate-on"));if(u["debug"]("getCollabsLoad trips",r),Array.isArray(r)&&r.length>0&&r.forEach(e=>{if("object"===p.type(e)){var t=e.object;t&&(t=i["a"].getURI(t),t&&a.push(t))}}),u["debug"]("collabsLoad",a),a.length>0){var l=[];return a.forEach(e=>{e=i["a"].getURI(e),e&&!s["a"].state.dataLoad.includes(e)?l.push(e):e&&o.push(e)}),l.length>0&&await Promise.all(l.map(async e=>{const t=await f.loadWebId(e);t&&o.push(t)})),o}}}},getAllPodServers:function(e){e||(e=s["a"].state.webId);e=i["a"].getURI(e);var t=f.getAllPods(e),a={};if(Array.isArray(t)&&t.length>0)return t.forEach(e=>{var t=i["a"].getPodServer(e);a[t]||(a[t]=[]),a[t].push(e)}),a},getAllPods:function(e){e||(e=s["a"].state.webId);e=i["a"].getURI(e);var t=[],a=[];if(e){var o=f.getJustTopParents(e);if(Array.isArray(o)&&o.length>0){o.forEach(e=>{var a=f.getChildPodNested(e);a&&(t=t.concat(a))}),t.length>0&&t.forEach(e=>{var t=f.getCollaborators(e);t&&(a=a.concat(t))});var r=i["a"].unique(i["a"].getURIs(t.concat(a)));return r}}},getJustTopParents:function(e){var t;e=i["a"].getURI(e);if(e){var a=f.getTopParents(e);t=[],Array.isArray(a)&&a.length>0&&a.forEach(e=>{t.push(e[0])}),t=i["a"].unique(t)}if(Array.isArray(t)&&t.length>0)return t},getTopParents:function(e){var t,a,o=f.getMembeeNested(e),s=f.getCollaborators(e),r=[],n=[],l=[];if((s&&(o=Array.isArray(o)?i["a"].unique(o.concat(s)):s),Array.isArray(o))&&(o=i["a"].getURIs(o),o.forEach(e=>{t=i["a"].getURIs(f.getParentPodNested(e)),a=i["a"].getURIs(f.getChildPodNested(e)),r=r.concat(t),r=r.concat(a),r=r.concat(o)}),r=i["a"].unique(i["a"].getURIs(r)),u["debug"]({uri:e,membees:o,collabs:s,up:t,down:a,pods:r}),Array.isArray(r)))return r.forEach(e=>{f.getChildPod(e)||n.push(e)}),Array.isArray(n)&&n.forEach(e=>{l.push(i["a"].getURIs(f.getParentPodNested(e)))}),l},getTopParentsLoad:async function(e){var t=f.getMembeeNested(e),a=[];if(Array.isArray(t))return t.forEach((async function(e){var t=await f.getParentPodNestedLoad(e);a.push(t)})),a},getMembeeNested:function(e,t){return f.getInheritNested(e,f.getMembee,t)},getMemberNested:function(e){return f.getInheritNested(e,f.getMember)},hasContainedItems:function(e){e=i["a"].getURI(e);if(e){const t=i["a"].unique(g.match(h.sym(e),h.sym(n["c"].LDP("contains").value)));return t&&t.length>0}return!1},hasContainItems:function(e){e=i["a"].getURI(e);if(e){const t=i["a"].unique(g.match(h.sym(e),h.sym(n["c"].NEO("m_contains").value)));return t&&t.length>0}return!1},getAllContainers:function(e,t){if(t||(t=[]),e=i["a"].getURI(e),e){f.containerP(e)&&-1===p.inArray(e,t)&&(t=t.concat(e));var a=f.getContainer(e);return a?(t=t.concat(a.uri),f.getAllContainers(a,t)):p.grep(t,(function(e){return void 0!==e})).reverse()}return p.grep(t,(function(e){return void 0!==e})).reverse()},getContentsCached:function(e){var t=i["a"].getURI(e),a=g.each(h.sym(t),n["c"].LDP("contains"));if(a)return i["a"].unique(a)},isContains:function(e){var t=i["a"].getURI(e);if(t)return!!f.getContains(t)},qLastModifier:function(e){return s["a"].state.webId},qModifiedTime:function(e){var t=i["a"].getURI(e);if(t){var a=i["a"].unique(g.match(h.sym(t),n["c"].POSIX("ctime")));if(a&&a.length>0&&a[0].object)return new Date(a[0].object.value).toLocaleString()}},qCollaborators:function(e){var t=Math.floor(Math.random()*Math.floor(5)),a=new Array;for(let o=0;o<t;o++)a.push(s["a"].state.webId);return a},getTag:function(e){var t=i["a"].getURI(e);if(t){var a=i["a"].unique(g.match(h.sym(t),n["c"].NEO("m_tag")));if(a.length>0)return a[0].object.value}},getFTag:function(e){var t=i["a"].getURI(e);if(t){var a=g.anyStatementMatching(h.sym(t),n["b"].f_tag);if(a)return a.object.value}},rankConcepts:function(e){var t=[];if("array"===p.type(e)){e.forEach((function(e){f.isConcept(e)&&l["a"].rank(e)&&t.push(e)}));var a=function(e,t){var a=l["a"].rank(e),o=l["a"].rank(t);return a-o},o=t.sort(a);return o}},getCID:function(e){var t=i["a"].getURI(e);if(f.isConcept(t)){var a=i["a"].unique(g.match(h.sym(t),h.sym(n["c"].NEO("m_cid").value)));if(a&&a.length>0&&a[0].object)return a[0].object.value}else{var o=f.getType(t);if(o)return f.getCID(o)}},getType:function(e){var t=i["a"].getURI(e);if(t){var a=f.getTypes(t);if(Array.isArray(a)){if(a.includes(n["c"].EVENT("Event").value))return n["c"].EVENT("Event").value;var o=f.rankConcepts(a);if("array"===p.type(o)&&o&&o.length>0)return o.reverse()[0]}}},getText:function(e){var t=i["a"].getURI(e);if(t){var a=g.match(h.sym(t),n["c"].SCHEMA("text"));if(Array.isArray(a)&&(a=i["a"].unique(a)),Array.isArray(a)&&a.length>0){var o=a[0].object;if("object"===p.type(o))return o.value}}},getLabel:function(e,t){var a,o=i["a"].getURI(e);if("object"!==p.type(e)||i["a"].isBlankNode(e)){if("array"===p.type(e))return p.map(e,(function(e){a=f.getLabel(e)}));if(e=i["a"].getURI(o),e){var s;s=i["a"].isBlankNode(e)?e:h.sym(e);var r=i["a"].unique(g.match(s,n["c"].DCTERMS("title"))),l=i["a"].unique(g.match(s,n["c"].RDFS("label"))),c=i["a"].unique(g.match(s,n["c"].VCARD("fn"))),d=i["a"].unique(g.match(s,n["c"].FOAF("name"))),u=i["a"].unique(g.match(s,n["c"].NEO("m_tag"))),m=i["a"].unique(g.match(s,n["c"].TAG("tag"))),b=i["a"].unique(g.match(s,n["c"].NEO("m_cid")));if(r.length>0)a=f.getLabel(r[0].object);else if(l.length>0){var v=[];p.map(l,(function(e){"en"!==e.object.language&&""!==e.object.language||v.push(e.object)})),a=v.length>0?f.getLabel(v[0]):f.getLabel(l[0].object)}else if(c.length>0)a=f.getLabel(c[0].object);else if(d.length>0)a=f.getLabel(d[0].object);else if(m.length>0)a=f.getLabel(m[0].object);else if(u.length>0)a=f.getLabel(u[0].object);else if(b.length>0)a=f.getLabel(b[0].object);else{var y=f.getTypes(e);if(Array.isArray(y))if(y.includes(n["c"].SIO("SIO_000114").value)){var w=f.getText(e);w&&(a=w)}else if(y.includes(n["c"].SIO("SIO_000110").value)){w=f.getText(e);w&&(a=w)}else if(y.includes(n["c"].EVENT("Event").value))a="Event: "+i["a"].getId(e);else if(y.includes(n["c"].FABIO("Page").value))a="Page: "+i["a"].getId(e);else if(y.includes(n["c"].SIO("SIO_000112").value))a="Capability: "+i["a"].getId(e);else{if(e.search("/i$"))return e;if(!t)return i["a"].getId(e)}else{if(e.search("/i$"))return e;if(!t)return i["a"].getId(e)}}}}else if("BlankNode"===e.termType)a=e.value;else if("NamedNode"===e.termType)a=f.getLabel(e.value);else if("Literal"===e.termType){var I=decodeURIComponent(e.value);a='"'===I.substr(0,1)&&'"'===I.substr(I.length-1,1)?I.substr(1,I.length-2):I}else a=e.title?e.title:e.value;return a},getTypes:function(e,t){var a,o=[],s=i["a"].isBlankNode(e);if("array"===p.type(e))return e.forEach(e=>f.getTypes(e));if(a=i["a"].getURI(e),"string"===typeof a||s){var r;r=s?a:h.sym(a);var n=f.parseLinkHeader(a).type,l=f.getWebId(a);if(n&&l!==a)return n;var c=i["a"].unique(g.match(r,h.sym("http://www.w3.org/1999/02/22-rdf-syntax-ns#type")));if(c&&c.length>0){var d=p.map(c,(function(e){var t=e.graph;if(t&&!i["a"].isBlankNode(t))return e.object.value}));return d&&(o=o.concat(d)),i["a"].unique(o.filter(Boolean))}}},getEntities:function(e,t){if(Array.isArray(e))return e.forEach((function(e){return f.getEntity(e,t)}))},getEntity:function(e,t){var a,o=i["a"].getURI(e),s=i["a"].getURI(t),r=[];if(f.isState(e))a=[f.stateToElems(e).e_entity];else if(f.isAttribute(e)){var l=f.attributeToElems(e).a_result;if(l&&"NamedNode"===l.termType)a=[l];else{var c=i["a"].unique(g.match(h.sym(o),n["c"].NEO("i_attribute")));if(c){var d=c.forEach((function(e){return e.object}));d&&(a=f.getEntities(i["a"].unique(d)))}}}else a=(p.type(e),[e]);return t&&a?(p.map(a,(function(e){p.inArray(s,i["a"].getURIs(f.getTypes(e)))>-1&&r.push(e)})),r):a},getRange:function(e){var t;if("object"===p.type(e)?"NamedNode"===e.termType&&(t=e.uri):t=i["a"].getURI(e),t){var a=g.each(h.sym(t),n["c"].RDFS("range"));if(a.length>0){var o=p.map(a,(function(e){return e.value}));if(o)return i["a"].unique(o)}}},getInverse:function(e){if("object"===p.type(e)&&"NamedNode"===e.termType)t=e;else var t=h.sym(i["a"].getURI(e));var a;if(t)return p.map([g.any(null,n["c"].OWL("inverseOf"),t),g.any(t,n["c"].OWL("inverseOf"),null),g.any(null,n["c"].OWL("inverse"),t),g.any(t,n["c"].OWL("inverse"),null)],(function(e){e&&(a=e)})),a},getNsTerm:function(e,t){var a=i["a"].getURI(e);if(t||(t=f.getNamespace(a)),t){var o=r["parse"](a),s=r["parse"](n["c"][t]().uri);return o.scheme="http",a=r["serialize"](o),s.scheme="http",a.replace(r["serialize"](s),"")}},getGmxLoad:function(e){var t=i["a"].getURI(e),a=s["a"].state.storage;if(a){var o=r["parse"](a);a=o.scheme+"://"+o.host;var n=[80,443,void 0];n.includes(o.port)||(a=a+":"+o.port)}else a=s["a"].state.brain;if(t){var l=s["a"].state.dataRedirect[t];return l&&(t=l),t}},getNamespace:function(e){var t=i["a"].getURI(e),a=s["a"].state.pod;if(i["a"].checkURL(t)){var o,l=r["parse"](t);if(l){var c=l.port;c=c?":"+c:"";l.host,l.path;if(p.map(Object.keys(n["d"]),(function(e){var a=i["a"].getURI(n["c"][e]());if(a){var s=r["parse"](a);if(s){var l=s.port,c=s.fragment;l=l?":"+l:"",c||(c="");var d=s.host+l+s.path+c;t.match(d)&&(o=e)}}})),o&&"U1"!==o)return o;t.match(a)}}},dataP:function(e){var t=i["a"].getURI(e),a=f.getNamespace(t);return!a||"U1"===a},propertyP:async function(e){if(e=i["a"].getURI(e),e){await f.aLoadNode(e);var t=f.getTypes(e);return p.inArray(n["c"].OWL("DatatypeProperty").uri,t)>-1}},getDataProperties:async function(e){if(e=i["a"].getURI(e),e){await f.aLoadNode(e);var t=g.each(null,n["c"].RDFS("domain"),h.sym(e));if(t)return p.map(i["a"].unique(t),(function(e){if(f.dataPropertyP(e))return e}))}},getPropCategory:function(e){var t=i["a"].getURI(e);if(t){var a,o=[["annotations",n["c"].OWL("AnnotationProperty")],["properties",n["c"].OWL("DatatypeProperty")],["relationships",n["c"].OWL("ObjectProperty")],["unknown",n["c"].RDF("Property")]],s=f.getTypes(t);return p.map(o,(function(e){p.map(s,(function(t){a||e[1].value!==t||(a=e)}))})),a||["unknown",n["c"].RDF("Property")]}},cleanURI:function(e){if(e=i["a"].getURI(e),e){"/"===e.substr(e.length-1)&&(e=e.substr(0,e.length-1));var t=/[^:]\/{2}/g;return e.replace(t,e.substr(e.search(t),1)+"/")}},superCleanURI:function(e){var t=f.cleanURI(e);if(t)return t.replace(/[^\w\s]/gi,"")},triplesToTable:function(e){if(e){var t={},a={};p.map(e,(function(e){var o=e.subject,s=t[o.value];t[o.value]=s?s.concat([e]):[e];var r=e.predicate;a[r.value]||(a[r.value]=r)}));var o=[],s=[];return p.each(t,(function(e,t){var a={};p.map(t,(function(e){var t=e.predicate.value;a[t]=f.renderObj(e),t===n["c"].RDF("type").uri&&(a.type=e.object.value)})),s.push(a)})),p.each(a,(function(e,t){var a={};a.key=e,a.label=f.getLabel(e),a.sortable=!0,e===n["c"].RDF("type").uri&&(a.class="typeClass"),e===n["c"].FOAF("name").uri&&(a.class="nameClass"),o.push(a)})),{fields:o,items:s}}},renderObj:function(e){if(e&&"object"===p.type(e)){var t=e.predicate,a=e.object;if(e.inverse&&(a=e.subject),a&&"object"===p.type(a)){if("NamedNode"===a.termType)return f.getLabel(a.value);if(f.htmlP(t)){var o=a.value.replace(/<(?:.|\n)*?>/gm,"");return o.length>65&&(o=o.substr(0,40)+"..."),o}return a.value}}},htmlP:function(e){return"string"===p.type(e)&&(e=i["a"].getURI(e),e&&(e=h.sym(e))),"object"===p.type(e)&&p.inArray(n["c"].RDF("HTML").value,f.getRange(e))>-1},getStatements:function(e,t,a){var o=i["a"].getURI(e);return i["a"].unique(g.match(h.sym(o),n["c"][t](a),null,"statements"))},dataHeadCheck:async function(e,t,a,o){if(-1!==p.inArray(e,s["a"].state.headLoad)&&-1!==p.inArray(t,s["a"].state.headLoad)&&!o)return{};var r,n,i,l,c,d,h,g,m;s["a"].commit("queueHead",e);var f=s["a"].state.lastHead[e];if(f&&(g=Date.now()-f>7e3),f&&!0!==g&&!o){s["a"].commit("dequeueHead",e);v={current:!0,redirectUri:r,redirectDs:n,dsHead:b,eTag:c,notFound:h,xPoweredBy:m};return v}try{s["a"].commit("queueDataSet",t),s["a"].commit("lastHead",e);var b=await window.solid.session.fetch(e,{credentials:"include",method:"HEAD"});b?(c=b.headers.get("eTag"),m=b.headers.get("x-powered-by"),d=b.status,u["debug"]("dsHead",b,c),i=b.headers.get("App-Authorization-Required"),m&&s["a"].commit("xPoweredBy",m),b.redirected?(r=b.url,n=s["a"].state.dataSets[r],s["a"].commit("dataRedirect",{from:t,to:r}),s["a"].commit("heads",{eTag:c,uri:r})):s["a"].commit("heads",{eTag:c,uri:e}),401===d&&i?window.location.href=i+"&redirect_uri="+window.location.href:401!==d&&(l=a&&c===a||n===c,l?s["a"].commit("dequeueDataSet",t):u["debug"]("Updating out of sync ds",c))):(h=!0,s["a"].commit("dataNotFound",t));var v={current:l,redirectUri:r,redirectDs:n,dsHead:b,eTag:c,notFound:h,xPoweredBy:m,status:d,appAuthReq:i};return v}catch(y){u["error"](y),u["debug"]("Head not found - dequeueing"),s["a"].commit("dataNotFound",t),s["a"].commit("dequeueDataSet",t),s["a"].commit("dequeueHead",e);var v={current:l,redirectUri:r,redirectDs:n,dsHead:b,eTag:c,notFound:!0,xPoweredBy:m};return v}},getNodeColor:function(e){var t="#6c757d",a=f.getCID(e);if(a){var o=a.charAt(0);"p_process"===a&&(o="e");var r=s["a"].state.nodeColors[o];t=r||"#003b00"}return t},getWebId:function(e){e=i["a"].getURI(e);if(e){var t=i["a"].getCard(e);if(t){var a=g.match(h.sym(t),n["c"].FOAF("primaryTopic"));if(Array.isArray(a)&&a.length>0){var o=a[0];if("object"===p.type(o)&&o.object)return o.object.value}}}},isWebId:function(e){var t=f.getWebId(e);return!(!t||t!==e)},maybeWebId:function(e){e=i["a"].getURI(e);var t=!1;return e&&(f.isWebId(e)||e.search("/i$|/profile/card#.*")>0)&&(t=!0),t},guessWebId:function(e){var t=f.getWebId(e);if(t)return t;var a=i["a"].getBaseURI(e);return a?a+"/i":void 0},maybeWebIdSysRelation:function(e){e=i["a"].getURI(e);if(e&&f.maybeWebId(e))return!0},loadWebId:async function(e){return f.fetchWebId(e)},validateWebId:async function(e){var t=i["a"].getURI(e),a=!1;if(t){var o=i["a"].getCard(t),s=f.getWebId(o);if(s&&(s=h.sym(t),g.anyStatementMatching(s,n["c"].LDP("inbox"))&&g.anyStatementMatching(s,n["c"].SOLID("oidcIssuer"))&&g.anyStatementMatching(s,n["c"].SPACE("storage"))&&(a=!0)),!a)try{var r=new h.graph,l=await fetch(o,{headers:{accept:"text/turtle"}}),c=await l.text();if("string"===typeof c){if(await h.parse(c,r,o),!s){var d=r.anyStatementMatching(h.sym(o),n["c"].FOAF("primaryTopic"));d&&(s=d.object)}s&&r.anyStatementMatching(s,n["c"].LDP("inbox"))&&r.anyStatementMatching(s,n["c"].SOLID("oidcIssuer"))&&r.anyStatementMatching(s,n["c"].SPACE("storage"))?(r.removeMatches(),a=!0):r.removeMatches()}else r.removeMatches()}catch(m){return u["debug"](m),!1}}return a},getParentWebId:function(e){e=i["a"].getURI(e);if(e){var t=f.getWebId(e);if(f.isParentPod(e)||!f.isChildPod(e))return f.getWebId(e);if(i["a"].checkURL(t)){const e=i["a"].unique(g.match(h.sym(t),n["c"].ACL("owner"),null));if(Array.isArray(e)&&e.length>=1)return e[0].object.value}}},getChildWebId:function(e){e=i["a"].getURI(e);if(e){var t=f.getWebId(e);return f.isChildPod(t)?t:null}},getPodChildren:function(e){var t=[],a=f.getPodOwners(e);a&&Array.isArray(a)&&a.forEach(e=>{"object"===p.type(e)&&"object"===p.type(e.subject)&&t.push(e.subject.value)});var o=f.getPodMembers(e);return o&&Array.isArray(o)&&o.forEach(e=>{if("object"===p.type(e)&&"object"===p.type(e.object)){var a=e.object.value;f.isChildPod(a)&&t.push(a)}}),i["a"].unique(t)},getPodParents:function(e){var t=[],a=f.getWebId(e);a&&f.isParentPodCapable(a)&&t.push(a);var o=f.getPodOwners(e);o&&Array.isArray(o)&&o.forEach(e=>{"object"===p.type(e)&&"object"===p.type(e.object)&&t.push(e.object.value)});var s=f.getPodMembers(e);return s&&Array.isArray(s)&&s.forEach(e=>{if("object"===p.type(e)&&"object"===p.type(e.subject)){var a=e.subject.value;t.push(a)}}),i["a"].unique(t)},getPodOwners:function(e){var t,a=i["a"].getURI(e),o=[];a&&(t=h.sym(a));var s=i["a"].unique(g.match(t,n["c"].ACL("owner"))),r=i["a"].unique(g.match(null,n["c"].ACL("owner"),t)),l=i["a"].unique(s.concat(r));return l&&Array.isArray(l)&&l.forEach(e=>{o.push(e)}),i["a"].unique(o)},getPodMembers:function(e){var t,a=i["a"].getURI(e),o=[];a&&(t=h.sym(a));var s=i["a"].unique(g.match(t,n["c"].VCARD("hasMember"))),r=i["a"].unique(g.match(null,n["c"].VCARD("hasMember"),t)),l=i["a"].unique(s.concat(r));return l&&Array.isArray(l)&&l.forEach(e=>{o.push(e)}),i["a"].unique(o)},getSourceUrl:function(e){if(Array.isArray(e)){var t=e[0];if(t&&"object"===p.type(t)){var a=t.why;if(a&&"object"===p.type(a))return a.value}}},parseLinkHeader:function(e){var t={},a=i["a"].getURI(e);if(a){var o=f.getLinkHeader(a);if("string"===typeof o){var s=o.split(",");Array.isArray(s)&&s.forEach((function(e){var a=e.split(";");if(Array.isArray(a)){var o=a[0].trim(),s=i["a"].getURI(o);if(s){var r=a[1];"string"===typeof r&&(r=r.split("="),Array.isArray(r)&&(r=r[1],"string"===typeof r&&(r=r.replaceAll('"',""),t[r]?t[r].push(s):t[r]=[s])))}}}))}}return t},getPropValues:function(e,t){var a=i["a"].getURI(t),o=i["a"].getURI(e),r=[],l=i["a"].isTrinPod(),c=a===n["c"].RDF("type").value,d=s["a"].state.dataRedirect[o],m=i["a"].unique(g.match(h.sym(o)));if(m||(m=[]),c&&!d){var p=f.parseLinkHeader(o);p&&(p=p.type),Array.isArray(p)&&p.forEach(e=>{r.push(h.st(h.sym(o),n["c"].RDF("type"),h.sym(e)))})}return Array.isArray(m)&&m.forEach(e=>{i["a"].getURI(e.graph.value)&&e.predicate.value===a&&(c&&l&&f.quadToState(e)&&!d?r.push(e):c&&l&&!d||r.push(e))}),c&&u["debug"]("ur.getPropValues",a,o,r),i["a"].unique(r)},findPdfContainee:function(e){var t,a=i["a"].getURI(e);if(a)if(f.isPdf(a))t=a;else{var o=f.getContaineesNested(a);Array.isArray(o)&&(o=o.reverse(),o.some(e=>{var a=f.isPdf(e);if(a)return t=e,t}))}return t},isFile:function(e){var t=i["a"].getURI(e),a=!1;if(t){var o=f.getTypes(t);o&&Array.isArray(o)&&o.forEach(e=>{e.includes("www.w3.org/ns/iana/media-types/")&&(a=!0)})}return a},isPdf:function(e){var t=i["a"].getURI(e);if(t){var a=f.getTypes(t);if(a&&Array.isArray(a)&&a.includes("http://www.w3.org/ns/iana/media-types/application/pdf#Resource"))return!0;f.getTag(t);return!!t.match(new RegExp("^.+\\.pdf","i"))}return!1},isIntelligentPdf:function(e){var t=i["a"].getURI(e),a=f.getTag(r)||t&&t.split("/").reverse()[0];if("string"===typeof a)var o=a.toLowerCase();var s=f.getTypes(t),r=h.sym(t),l=g.anyStatementMatching(r,n["c"].SIO("SIO_000202"),null);l=l&&"object"===p.type(l)?l.object:null;var c=f.isPdf(l);return!(!c&&".pdf"!==o.substr(a.length-4)&&!f.isPdf(t))&&!!(g.anyStatementMatching(null,n["c"].SIO("SIO_000202"),r)||s&&s.includes(n["c"].NEO("s_pdf-intelligent").value)||g.anyStatementMatching(r,n["c"].NEO("c_crosslink"))||g.anyStatementMatching(r,n["c"].NEO("c_trinpod-read")))},vectorUpContainers:function(e,t){var a,o,s=i["a"].getURI(e);"Documents"===t&&(o=f.getContaineesNested(s));var r,n=Array.isArray(o);r=n?o[0]:s;var l=f.getLdpContaineesNested(r);return n?(l.pop(),a=l.concat(o)):a=l,Array.isArray(a)&&(a=i["a"].getURIs(a)),a},vectorUpSystem:function(e,t){var a=[];t&&a.push(e);var o=f.getSystemUp(e);while(o)a.includes(o)?o=null:(a.push(o),o=f.getSystemUp(o));return u["debug"]("ups",a),f.isSystemObj(a[a.length-1])?a:null},vectorUpTree:function(e,t){if("object"===p.type(e)&&"object"===p.type(t)&&e.path){var a=e.path,o=[];if(Array.isArray(a)&&a.length>0){a=a.slice(),a.pop();while(a.length>0){e=t.getNode(a);"object"===p.type(e)&&e.data&&e.data.uri&&o.push(e.data.uri),a.pop()}return o}}},getAllTreeURIs:function(e){var t=[];return i["a"].isTree(e)&&e.traverse(e=>{t.push(e.data.uri)}),t},getTreeNodeParent:function(e,t,a){e=i["a"].getURI(e);var o,s=i["a"].isTree(t);if(e&&s){var r=i["a"].findTreeNode(e,t);if(u["debug"]("node",r,e),i["a"].isTreeNode(r)&&r.path.length>1){var l=r.path.slice();l.pop(),o=t.getNode(l)}else{var c=[],d=f.getAllTreeURIs(t);if(d.includes(e)||d.push(e),Array.isArray(d)||(d=[]),f.isObjectPort(e)){var h=f.getPortTo(e);h&&h.forEach(e=>{d.includes(e)||c.includes(e)||(c.push(e),d.push(e))})}var g=f.getPortFrom(e);if(g&&g.forEach(e=>{d.includes(e)||c.includes(e)||c.push(e)}),"Documents"===a||"Files"===a){var m=i["a"].getURIs(f.getInherit(e,n["c"].LDP("contains"),!0));Array.isArray(m)&&m.length>0&&(c=i["a"].unique(c.concat(m)));var p=f.getInherit(e,n["c"].SIO("SIO_000202"),!0);p&&(c=Array.isArray(c)?c.concat(p):p)}else if("Projects"===a){var b=i["a"].getURI(f.getParentPod(e));if(b&&(b===e||d.includes(b)||(u["debug"]("wow1",b),o=i["a"].findTreeNode(b,t))),!o){var v=f.getCollaborators(e,"appContents");v&&v.forEach(e=>{var t=f.getParentPodNested(e);if(Array.isArray(t)&&t.length>0){var a=i["a"].getURI(t[0]);d.includes(a)||(c.push(a),d.push(a))}else d.includes(e)||(c.push(e),d.push(e))})}}!o&&Array.isArray(c)&&c.length>0&&(u["debug"]("wow2",c),o=i["a"].findTreeNode(c[0],t))}return u["debug"]("getTreeNodeParent",e,o,t),o}},getTreeContents:function(e,t,a,o){e=i["a"].getURI(e);if(e&&i["a"].isTree(t)){var s=[],r=f.getSystemDown(e);if(r&&(s=r),f.isSystemObj(e)||"Documents"!==a&&"Files"!==a){if("Projects"===a){var n=i["a"].getURIs(f.getChildPod(e));Array.isArray(n)&&n.length>0&&n.forEach(t=>{t!==e&&s.push(t)});var l=f.getCollaborators(e,"appContents");l&&l.forEach(e=>{var t=f.getParentPodNested(e);if(Array.isArray(t)&&t.length>0){var a=i["a"].getURI(t[0]);s.push(a)}else s.push(e)});var c=[];s.length>0&&s.forEach(e=>{f.maybeWebIdSysRelation(e)&&c.push(e)}),s=c}}else{var d=f.getContents(e);Array.isArray(d)&&d.length>0&&(s=s.concat(d))}c=i["a"].unique(i["a"].deNullify(i["a"].getURIs(s)));return Array.isArray(c)?c:[]}},updateTree:function(e,t,a){if(u["debug"]("ur.updateTree",e,t,a),i["a"].isTree(t)&&"Projects"===a){var o=f.getAllTreeURIs(t),r=(t.getNode([0]),f.getJustTopParents(e)),n=i["a"].getURIs(t.nodes);if(u["debug"]("roots",r),Array.isArray(r)){r.forEach((e,s)=>{if(!n.includes(e)){var r=s-1;f.insertNode(e,t,t.getNode([r]),a,"after",{treeUris:o})}});var l=[];t.nodes.forEach(e=>{r.includes(e.data.uri)?(e.children.length>0&&e.isLeaf?t.updateNode(e.path,{isLeaf:!1,isExpanded:!0}):0===e.children.length&&t.updateNode(e.path,{isLeaf:!0,isExpanded:!1}),f.getRequestNodes(e.data.uri)||s["a"].dispatch("loadDataSet",{uri:e.data.uri,sentFrom:"ur.updateTree",force:!0})):l.push(e.path)}),l.length>0&&t.remove(l)}Array.isArray(o)&&o.length>0&&o.forEach(e=>{f.getRequestNodes(e)||s["a"].dispatch("loadDataSet",{uri:e,sentFrom:"ur.initializeTree"});var t=f.getCollabObjects(e);Array.isArray(t)&&t.length>0&&t.forEach((async function(e){u["debug"]("collab",e);const t=await f.fetchWebId(e);t&&!f.getRequestNodes(t)&&s["a"].dispatch("loadDataSet",{uri:t,sentFrom:"ur.initializeTree.collab",force:!0})}))})}},initializeTree:function(e,t,a,o){if(i["a"].isTree(t)&&t.nodes&&t.nodes.length>0){var r=t.getNode([0]),n=[];t.nodes.forEach(e=>{e.data.uri!==r.data.uri&&n.push(e.path)}),t.remove(n),"Projects"===a&&(e=s["a"].state.webId),o||(o={}),o.sentFrom="ur.initializeTree "+o.sentFrom;var l=f.makeTreeNode(e,t,a,o);if(i["a"].isTreeNode(r)&&i["a"].isTreeNode(l)){if(l.children&&0!==l.children.length?(l.isExpanded=!0,l.isLeaf=!1):(l.isExpanded=!1,l.isLeaf=!0),u["debug"]("root",r,"update",l),t.insert({node:r,placement:"after"},l),t.remove([[0]]),"Documents"===a&&(t.traverse(e=>{t.updateNode(e.path,{isExpanded:!1,isSelected:!1})}),t.updateNode([0],{isExpanded:!0,isSelected:!0}),f.getRequestNodes(e)||s["a"].dispatch("loadDataSet",{uri:e,sentFrom:"ur.initializeTree",force:!0})),"Projects"===a){var c=f.getJustTopParents(e);u["debug"]("roots",c),Array.isArray(c)&&(o.treeUris=[e],c.forEach((s,r)=>{if(s!==e){var n=r-1;f.insertNode(s,t,t.getNode([n]),a,"after",o)}})),f.updateTree(e,t,a),t.traverse(e=>{e.children.length>0&&t.updateNode(e.path,{isExpanded:!0})})}return u["debug"]("initializeTree",e,t,a,o),t.nodes}}},getTreeNodeChildren:function(e,t,a,o,s){"object"!==p.type(o)&&(o={}),o.sentFrom=o.sentFrom+" ur.getTreeNodeChildren";var r=o.treeUris;Array.isArray(r)||(r=[]);var n;e=i["a"].getURI(e);e&&(n=f.getTreeContents(e,t,a,s),n&&(n=f.makeTreeNode(n,t,a,o,e),Array.isArray(n)&&n.length>1&&(n=n.sort((function(e,t){var a=f.getFTag(e)||f.getLabel(e),o=f.getFTag(t)||f.getLabel(t);if(a&&o&&!r.includes(e)&&!r.includes(t))return a.toLowerCase().localeCompare(o.toLowerCase())})))));var l=[];return Array.isArray(n)&&n.forEach(e=>{i["a"].isTreeNode(e)&&l.push(e)}),l},makeTreeNode:function(e,t,a,o,r){u["debug"]("ur.makeTreeNode",e,t,a,o),o||(o={}),o.sentFrom=o.sentFrom+" ur.makeTreeNode";var n=o.treeUris;if(Array.isArray(e)&&e.length>0){var l=[];return e.forEach(e=>{var c=i["a"].getURI(e);if(c){o.treeUris=n;var d=i["a"].findTreeNode(c,t);d||(d=f.makeTreeNode(c,t,a,o,r)),i["a"].isTreeNode(d)&&("Projects"!==a||f.getRequestNodes(c)||s["a"].dispatch("loadDataSet",{uri:c,sentFrom:"ur.makeTreeNode.child"}),l.push(d))}}),l}e=i["a"].getURI(e);if(e){"Projects"===a&&(f.getRequestNodes(e)||s["a"].dispatch("loadDataSet",{uri:e,sentFrom:"ur.makeTreeNode"}));var c=f.getTreeNodeChildren(e,t,a,o,r);Array.isArray(c)||(c=[]);var d,h=i["a"].findTreeNode(e,t),g=i["a"].isTreeNode(h),m=o.isExpanded;"boolean"===typeof m||g?g&&(m=h.isExpanded):m=!1,g&&(d=h.path);var p=f.isContainer(e)||f.isIntelligentPdf(e)||c.length>0||f.isSystemObj(e);if(h={title:f.getLabel(e),children:c,isLeaf:!p,isExpanded:m,data:{uri:e}},i["a"].isTreeNode(h))return d&&(u["debug"]("update",h),c.length>0&&c.forEach(e=>{"Projects"!==a&&f.makeTreeNode(e.data.uri,t,a,o,h),e.children=[]}),t.updateNode(d,h)),h}},sortTreeContents:function(e,t){return Array.isArray(e)&&e.length>0?(e=i["a"].getURIs(e),e.sort((function(e,t){var a=f.getLabel(e),o=f.getLabel(t);if(a&&o)return o.toLowerCase().localeCompare(a.toLowerCase())}))):e},insertNode:function(e,t,a,o,r,n){n||(n={}),n.sentFrom=n.sentFrom+" ur.insertNode";var l=n.treeUris;Array.isArray(l)||(l=[]);e=i["a"].getURI(e),f.isContainer(e)||f.isIntelligentPdf(e)||f.isPort(e);if("Projects"!==o||f.getRequestNodes(e)||s["a"].dispatch("loadDataSet",{uri:e,sentFrom:"ur.insertNode"}),r||(r="inside"),e&&i["a"].isTree(t)&&i["a"].isTreeNode(a)&&!l.includes(e)){n.treeUris=l;var c=f.makeTreeNode(e,t,o,n,i["a"].getURI(a));if(i["a"].isTreeNode(c)&&(u["debug"]("insertNode node",c,a),a&&!i["a"].getURIs(a.children).includes(e))){try{t.insert({node:a,placement:r},c)}catch(d){u["debug"](d)}return a.isLeaf&&"inside"===r&&t.updateNode(a.path,{isLeaf:!1}),i["a"].findTreeNode(e,t)}}},getLinkHeader:function(e){var t=f.getResponseNodes(e);if(Array.isArray(t)&&t.length>0){var a=g.anyStatementMatching(t[0],h.sym("http://www.w3.org/2007/ont/httph#link"));if(a)return a.object.value}},getWacAllow:function(e){var t=[],a=f.getResponseNodes(e);if(a&&a.forEach(e=>{var a=g.anyStatementMatching(e,h.sym("http://www.w3.org/2007/ont/httph#wac-allow"));a&&t.push(a.object.value)}),1===t.length)return t[0]},getEtag:function(e){e=i["a"].getURI(e);var t=[];if(e){var a=f.getResponseNodes(e);a&&a.forEach(e=>{var a=g.anyStatementMatching(e,h.sym("http://www.w3.org/2007/ont/httph#etag"));a&&t.push(a.object.value)})}if(1===t.length)return t[0]},getFileVersion:function(e){e=i["a"].getURI(e);if(f.isFile(e)){var t=g.anyStatementMatching(h.sym(e),n["c"].DCTERMS("hasVersion"));if(t)return t.object.value}},eTagToResponseNodes:function(e){if("string"===typeof e){var t=[],a=g.match(null,h.sym("http://www.w3.org/2007/ont/httph#etag"),h.lit(e));if(Array.isArray(a)&&a.length>0)return a.forEach(e=>{t.push(e.subject)}),t}},getRequestNodes:function(e){e=i["a"].getURI(e);var t=[];if(e){var a=s["a"].state.eTags[e];if(a){var o=f.eTagToResponseNodes(a);return Array.isArray(o)&&o.length>0&&o.forEach(e=>{var a=g.anyStatementMatching(null,h.sym("http://www.w3.org/2007/ont/link#response"),e);a&&t.push(a.subject)}),t}var r=g.match(null,h.sym("http://www.w3.org/2007/ont/link#requestedURI"),h.literal(e));if(Array.isArray(r)&&r.length>0&&r.forEach(e=>{t.push(e.subject)}),t.length>0)return t}},getResponseNodes:function(e){var t=[];e=i["a"].getURI(e);if(e){var a=f.getRequestNodes(e);if(Array.isArray(a)&&a.length>0&&(a.forEach(e=>{var a=g.anyStatementMatching(e,h.sym("http://www.w3.org/2007/ont/link#response"));a&&t.push(a.object)}),t.length>0))return t}},getAuthRedirect:function(e){var t=f.getResponseNodes(e);if(t){var a=g.anyStatementMatching(t[0],h.sym("http://www.w3.org/2007/ont/httph#app-authorization-required"));if(a)return a.object.value}},isTrinPod:function(e){e=i["a"].getURI(e);var t=!1;if(e){var a=f.getResponseNodes(e);a&&a.forEach(e=>{var a=g.anyStatementMatching(e,h.sym("http://www.w3.org/2007/ont/httph#x-powered-by"));if(a){var o=a.object.value;"string"===typeof o&&o.match("TrinPod")&&(t=!0)}})}return t},fetchWebId:async function(e){var t=i["a"].getCard(e),a=f.getWebId(t);if(a)return a;var o=new h.graph;try{var s=await fetch(t,{headers:{accept:"text/turtle"}}),r=await s.text();if("string"===typeof r){await h.parse(r,o,t);var l=o.anyStatementMatching(h.sym(t),n["c"].FOAF("primaryTopic"));if(o.removeMatches(),l)return l.object.value}}catch(c){u["error"](c)}},fetchAndSaveTurtle:async function(e,t){return new Promise(a=>{!s["a"].state.rs.urisFetched.includes(e)||t?f.aLoadURI(e,null,{force:t}).then(t=>{t?(t.forEach(e=>{s["a"].state.rs.rdfStore.add(e)}),s["a"].state.rs.urisFetched.push(e),a(!0)):(console.log("Error: Problems with fetching URI!!!"),a(!1))}):a(!0)})}};f.aLoadURI=async function(e,t,a){if(console.log("aLoadURI",e,t),a||(a={}),a.fetch=window.solid.hyperFetch,a.headers={hypergraph:"U2FsdGVkX1/S0rANmPZVe3xCIXvlGoGnGudwlp4wFSMFtte++kYYPt0l4B4407c+"},a.timeout=25e3,e)try{await m.load(e,a);var o=i["a"].unique(g.match(null,null,null,h.sym(e)));return o}catch(s){console.log("Cant load URI: ",e,s),f.checkIfAppAuthorizationRequired(e)}else console.log("ERROR: bad URI to loadURIa")},f.checkIfAppAuthorizationRequired=async function(e){let t=[];try{t=await window.solid.session.fetch(e,{method:"GET",credentials:"include",headers:{Accept:"text/turtle"}}).then(t),console.log("Response headers:");let a=t.headers.get("App-Authorization-Required");return a&&(console.log("App Authorization required"),console.log("URI: "+a),window.location.href=a+"&redirect_uri="+window.location.href),t}catch(a){console.log(a)}},f.uploadTurtle=async function(e,t,a){let o=!1;if(!a)try{await window.solid.session.fetch(e.replace("/i","/node/Substance"),{method:"PATCH",credentials:"include",body:t,headers:{"Content-Type":"text/turtle"}}).then(e=>{if(200===e.status)console.log("Successful fetch, got response 200"),o=!0;else if(201===e.status)console.log("Created successfully, response 201"),o=!0;else if(401===e.status){console.log("Error 401: The app is not authorized by this Trinpod, rederecting..");id.checkIfAppAuthenticated(containerName);o=!1}else console.log("Error running fetch, got response ",e.status),o=!1})}catch(s){console.log("-- Error message below --"),console.log(s),o=!1}return o},f.runSparqlQuery=function(e="SELECT ?s ?p ?o WHERE { ?s ?p ?o } ."){const t=h.SPARQLToQuery(e,!1,s["a"].state.rs.rdfStore);s["a"].state.rs.rdfStore.query(t,(function(e){return console.log("Query ran"),console.log(e),e}))},f.getInheritNested=function(e,t,a,o){if(Array.isArray(o)&&o.includes(e))return o;var s=t(e);return o?o.push(e):o=[e],s&&0!==s.length?(a=Array.isArray(a)&&a.length>0?a.concat(s):s,f.getInheritNested(a.pop(),t,a,o)):Array.isArray(a)&&a.length>0?f.getInheritNested(a.pop(),t,a,o):o},f.addToStores=function(e,t,a,o){s["a"].state.rs.tempRdfStore.add(e,t,a,h.default),s["a"].state.rs.rdfStore.add(e,t,a,h.default)},f.getInherit=function(e,t,a){var o=[];if(e&&"object"===typeof t&&"NamedNode"===t.termType){var s=[];return s=a?g.match(null,t,h.sym(e)):g.match(h.sym(e),t,null),s&&s.length>0?(s.forEach((function(e){a?o.push(e.subject.value):o.push(e.object.value)})),o):[]}},f.getContainees=function(e){if(e)return f.getInherit(e,n["c"].SIO("SIO_000202"),!0)},f.getParts=function(e){if(e)return f.getInherit(e,n["c"].DUL("hasPart"),!0)},f.getContaineesNested=function(e){var t=f.getInheritNested(e,f.getContainees);return Array.isArray(t)&&t.length>0?t.reverse():[]},f.getPartsNested=function(e){var t=f.getInheritNested(e,f.getParts);return Array.isArray(t)&&t.length>0?t.reverse():[]},f.getWholesNested=function(e){var t=f.getContaineesNested(e),a=f.getPartsNested(e),o=!1;const s=e=>e.filter((t,a)=>e.indexOf(t)!==a),r=s(t);r.length>0&&(console.log("WARNING, duplicates in contain found!!!"),o=!0);const n=e=>e.filter((t,a)=>e.indexOf(t)!==a),i=n(a);i.length>0&&(console.log("WARNING, duplicates in part found!!!"),o=!0),t.push("hasPart:");for(var l=0;l<a.length;l++)t.push(a[l]);return console.log(t),f.getDuplicatePartChild(e)&&(o=!0),o},f.getDuplicatePartChild=function(e){var t=[];if(t=g.match(null,n["c"].DUL("hasPart"),h.sym(e)),t.length>=2){console.log("WARNING, duplicates part child found!!!");for(var a=0;a<t.length;a++)console.log(t[a].subject.value+" hasPart "+t[a].object.value);return!0}return!1},f.getTypes=function(e,t){var a,o=[],s=[],r=i["a"].isBlankNode(e);if("array"===p.type(e))return e.forEach(e=>f.getTypes(e));if(a=i["a"].getURI(e),"string"===typeof a||r){var l;l=r?a:h.sym(a);var c=i["a"].unique(g.match(l,n["c"].RDF("type")));if(c&&c.length>0){var d=p.map(c,(function(e){if(i["a"].getURI(e.graph))return e.object.value}));if(d&&(o=o.concat(d)),!t&&!r)s=f.parseLinkHeader(a).type;return o=o.concat(s),i["a"].unique(o)}}},f.parseLinkHeader=function(e){var t={},a=i["a"].getURI(e);if(a){var o=m.getHeader(h.sym(a),"Link");if(Array.isArray(o)&&(o=o[0],"string"===typeof o)){var s=o.split(",");Array.isArray(s)&&s.forEach((function(e){var a=e.split(";");if(Array.isArray(a)){var o=a[0].trim(),s=i["a"].getURI(o);if(s){var r=a[1];"string"===typeof r&&(r=r.split("="),Array.isArray(r)&&(r=r[1],"string"===typeof r&&(r=r.replaceAll('"',""),t[r]?t[r].push(s):t[r]=[s])))}}}))}}return t},f.checkIfContainLoopInStore=function(e,t){const a=[],o=[];let s=e.match(null,n["c"].SIO("SIO_000202"),null),r=e.match(null,n["c"].DUL("hasPart"),null),i=e.match(null,n["c"].LDP("contains"),null),l=e.match(null,n["c"].NEO("t_1pr4n"),null);for(var c=0;c<20;c++){let e=!1;if(s.concat(r).concat(i).concat(l).forEach(t=>{const s=t.subject.value,r=t.object.value;let i="sio:SIO_000202";t.predicate.value==n["c"].DUL("hasPart").value&&(i="dul:hasPart"),t.predicate.value==n["c"].LDP("contains").value&&(i="ldp:contains"),t.predicate.value==n["c"].NEO("t_1pr4n").value&&(i="neo:t_1pr4n");let l=s+" "+i+" "+r+"##",d=!1,u=" "+i+" "+r+"##";if(a)for(var h=0;h<a.length;h++)if(a[h].includes(s+"##")&&!a.includes(a[h].replace("##",u))){if(d=!0,e=!0,a[h]==r)return console.log("Error. Loop found!!!!!"),o.push(a[h].replace("##",u)),console.log(o),h=a.length+1,c=20,!0;a[h]=a[h].replace("##",u),a.push(a[h])}d||a.push(l)}),!e)return}if(t)for(var d=0;d<a.length;d++){let e=a[d].split(" ")[0],t=a[d].split(" ").pop().replace("##","");for(var u=0;u<a.length;u++)if(a[u]!=a[d]){let s=a[u].split(" ")[0],r=a[u].split(" ").pop().replace("##","");if(e==s&&t==r)return console.log("Error. Loop found in paralell hierarchy!!!!!"),o.push(a[u]),o.push(a[d]),console.log(o),u=a.length+1,d=a.length+1,!0}}return o.length>0},f.checkIfmPortLoopInStore=function(e){const t=[],a=[];let o=e.match(null,n["c"].NEO("m_port"),null);for(var s=0;s<20;s++){let e=!1;if(o.forEach(o=>{const r=o.subject.value,n=o.object.value;let i="neo:m_port",l=r+" "+i+" "+n+"##",c=!1,d=" "+i+" "+n+"##";if(t)for(var u=0;u<t.length;u++)if(t[u].includes(r+"##")&&!t.includes(t[u].replace("##",d))){if(c=!0,e=!0,t[u]==n)return console.log("Error. Loop found!!!!!"),a.push(t[u].replace("##",d)),console.log(a),u=t.length+1,s=20,!0;t[u]=t[u].replace("##",d),t.push(t[u])}c||t.push(l)}),!e)return}for(var r=0;r<t.length;r++){let e=t[r].split(" ")[0],o=t[r].split(" ").pop().replace("##","");for(var i=0;i<t.length;i++)if(t[i]!=t[r]){let s=t[i].split(" ")[0],n=t[i].split(" ").pop().replace("##","");if(e==s&&o==n)return console.log("Error. Loop found in paralell hierarchy!!!!!"),a.push(t[i]),a.push(t[r]),console.log(a),i=t.length+1,r=t.length+1,!0}}return a.length>0},f.getParentsNested=function(e,t){let a=[[e]],s=!1,r=[e],n=[];for(var i=0;i<50;i++)if(s=!1,r.forEach(e=>{let r=1;t.forEach(t=>{g.match(null,t,h.sym(e)).forEach((t,i)=>{for(var l=0;l<a.length;l++)if(i>=1&&o["a"].getSecondLastElement(a[l])==e&&r==i&&(a.push(o["a"].removeLastElement(a[l])),r=i+1),o["a"].getLastElement(a[l])==e){if(a[l].includes(t.subject.value))return console.log("Loop found!!"),a[l].push(t.subject.value),o["a"].reverseSubArrays(a);a[l].push(t.subject.value)}n.push(t.subject.value),s=!0})})}),r=n,n=[],!s)return o["a"].reverseSubArrays(a);return o["a"].reverseSubArrays(a)},f.getChildrenNested=function(e,t){let a=e,s=!1,r=[];e.forEach(e=>{let t=e[e.length-1];r.includes(t)||r.push(t)});let n=[];for(var i=0;i<50;i++)if(s=!1,r.forEach(e=>{let r=1;t.forEach(t=>{g.match(h.sym(e),t,null).forEach((t,i)=>{for(var l=0;l<a.length;l++)if(i>=1&&o["a"].getSecondLastElement(a[l])==e&&r==i&&(a.push(o["a"].removeLastElement(a[l])),r=i+1),o["a"].getLastElement(a[l])==e){if(a[l].includes(t.object.value))return console.log("Loop found!!"),a[l].push(t.object.value),a;a[l].push(t.object.value)}n.push(t.object.value),s=!0})})}),r=n,n=[],!s)return a;return a},f.checkIfContainLoop=function(e,t){let a=!1,s=f.getParentsNested(e,t);s=o["a"].removeDuplicates(s),console.log("Parent Array below:"),console.log(s),s.forEach(e=>{if(o["a"].checkIfDuplicateExists(e))throw console.log("Found loop!!!!!"),console.log(e),a=!0,console.error("Found loop!!!.")});let r=f.getChildrenNested(s,t);return r=o["a"].removeDuplicates(r),console.log("Full Array below:"),console.log(r),r.forEach(e=>{if(o["a"].checkIfDuplicateExists(e))throw console.log("Found loop!!!!!"),console.log(e),a=!0,console.error("Found loop!!!.")}),a},f.modifyTurtle=function(e){return e=f.checkPrefixes(e),e=e.replaceAll("@prefix : <#>.\n",""),e=e.replace(/(>)\n/g,"$1 "),e=e.replace(/(>\s)\s+/g,"$1"),e=e.replace(/([^\s])([;.])\n/g,"$1 $2\n"),e=e.replace(/<(_:\w+)>/g,"$1"),e=e.replaceAll('^^neo:a_matrix-3m"','"^^neo:a_matrix-3m'),e=e.replace(/(\n)\n/g,"$1"),e},f.checkPrefixes=function(e){try{let a=e.split(/\r\n|\n/);for(var t=1;t<a.length;t++)if(a[t].includes("@prefix")){let o=a[t].replace("@prefix ","");o=o.substring(0,o.indexOf(":")+1);let s=a[t].substring(a[t].indexOf("<")+1,a[t].indexOf(">"));a[t]={prefix:o,uri:s},e=e.replaceAll(a[t].prefix+"i","<"+a[t].uri+"i>"),e=e.replaceAll(a[t].prefix+"y_system","<"+a[t].uri+"y_system>"),e=e.replaceAll(a[t].prefix+"tag","<"+a[t].uri+"tag>")}return e}catch(a){console.log(a)}},t["a"]=f},7084:function(e,t,a){},"71b0":function(e,t,a){"use strict";a("d0f8")},"737e":function(e,t,a){e.exports=a.p+"img/document.11e15e4d.png"},"78f0":function(e,t,a){"use strict"},"79b3":function(e,t,a){e.exports=a.p+"img/person2.dd98b742.png"},"7a13":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAeCAYAAABNChwpAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEHklEQVRIia1XXWgcVRT+vruzaboLsguCSEEsFavVBIRYiIm67uxOSRGLD4u+9EFKpdZWRaqVFiHSVgk+WEVE+xOKoFD8e8jDmtkZtbRL1bxoHwJVi+1Dkaq4aZMm1t3czwd3yzSmSSbN93TnzDnn+zhzz71nKAkksYRgoVDYDGBjIpHYNjw8/OP1HCXBWUpmz/NWWmsPAnABYHp6+g4A1xUAAGaJuOl53rOSTjXJfyf5RBAEn80XeMMVyOfzq4wxh621DwMAyaOO42wvl8t/LCR+0QL6+/tNtVrdLul1ACmSF0g+4/v+F3HycDGbsFAo3AlgEEAPAJD8yBjz3PDw8F9x8sTehKVSKTE2NvYCgD2SlgO4AmCwUqlsjZMnigVXYN26dXdZawcldTdN/5BMSrIAckEQnIhLLml+AblczkkkEi8aY16T1E7yvCRDcltTzA6SZ9rb2zuHhoYm4wqYsw3z+fw9yWSySnIAwDIAhyQdBnCiUql8ns1md5M8JWnV1NTU83HIW5i1ArlczkkmkzslvQpgGclzJJ8eHx8/nk6nz5LsrVQqPwOA67qPkPyK5J8TExO3nTx5cmqh5LNWwHXdzmQy+Z2kvSTbALw/OTnZ4fu+n06nHwcw0iIHgDAMvwHwm6Sbm+9j4WoXdHV1JbPZ7C5JuyS1AfjVWrspDMOvWz4k11trr+lzz/Metdbe2noP4OM4AgwA5PP51ZlMZkRSP8kkgHeNMR1R8ibuJ3k8arDWbmytJT0QhxxoVsAY8wmADpJnAGwKguDYbM6SVmSz2bMzzL2R9YpFCSC5UhIkHWk0GtWYOW6JrOsAUCgUBABBEHCuZwB0AEDSAIA9APY4jrPB87zNvu//MJOJ5PlarXY7gJ8i5gsAWnvgfJSohbmeTdOwV9J6kucAdEkaKRaLA93d3ctnaBiR9OAMUdGKjcwUPR+utmEYhuV6vX4vgLclGUkvp9PpU57n5Vs+ksokr2k1kh9G1l/GFTDrQeS67lpjzEFJnSQl6Ugikdhx6dKlqZkHked5eWttuGQHEQCEYfh9rVbrIrkbwN8AnrLWjqZSqQ0A9kvaBwClUqlN0lvNsP1xyOesQBTNu/8AgNbEUwaw2lq70xizVtJLAH65fPlyZ1wBC7oNW0KLxeImAG9KygCYBCCSKQANST1BEMTegPPehlHfSqVyqF6v303yUwApAGkAFyW9sxjyFhY1khWLxccAvCdpBf4bTAYcx9lXLpevxMkT5xP8D319fTc1Go03JG0BYEiettZuDsPw+LzBSyGgBc/zeiQdkLSm2bIfAHglCIKLCxFwwz8mvu9XM5nMfST7JdUBbAEw6nnegmaDG65AFK7rriF5AM1xHcCTQRAcvZ7/klQgijAMR3t7ex8CsBXAt8aY0/PF/AtSQxAe5cGxZwAAAABJRU5ErkJggg=="},"7a57":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-card",[o("v-toolbar",{attrs:{dark:"",color:"primary"}},[o("v-btn",{attrs:{icon:"",dark:""},on:{click:e.closeview}},[o("v-icon",[e._v("mdi-close")])],1),o("v-toolbar-title",[e._v(e._s(e.$t("text_building_details")))]),o("v-spacer"),o("v-toolbar-items",[e.loading?o("v-progress-circular",{key:e.loading,staticStyle:{width:"25px",height:"25px","margin-right":"15px","margin-top":"20px"},attrs:{indeterminate:"",color:"white"}}):e._e(),o("v-btn",{attrs:{dark:"",text:""},on:{click:e.reloadview}},[e._v(" Reload ")])],1)],1),o("v-container",{staticStyle:{"align-items":"left","background-color":"white",border:"0px",margin:"0px"},attrs:{fluid:""}},[o("v-row",{attrs:{"no-gutters":""}},[o("v-card",{staticClass:"pa-2",staticStyle:{"margin-bottom":"10px","margin-right":"10px"}},[o("v-list-item",{attrs:{"three-line":""}},[o("v-list-item-content",{staticStyle:{"max-width":"350px"}},[o("v-list-item-title",{staticClass:"title",domProps:{textContent:e._s(e.buildingName)}}),o("v-list-item-subtitle",{staticClass:"uri",domProps:{textContent:e._s(e.buildingURI)}}),o("v-simple-table",{staticClass:"simpletable",attrs:{dense:""},scopedSlots:e._u([{key:"default",fn:function(){return[o("tbody",[o("tr",[o("td",[o("b",[e._v("Matrikkelnr:")])]),o("td",[e._v(e._s(e.buildingNum))])]),o("tr",[o("td",[o("b",[e._v("Byggeår:")])]),o("td",[e._v(e._s(e.buildingYear))])]),o("tr",[o("td",[o("b",[e._v("Bygningstype:")])]),o("td",[e._v(e._s(e.buildingType))])]),o("tr",[o("td",[o("b",[e._v("Vernestatus:")])]),o("td",[e._v(e._s(e.buildingProtectionStatus))])]),o("tr",[o("td",[o("b",[e._v("Adresse:")])]),o("td",[e._v(e._s(e.buildingAddress))])]),o("tr",[o("td",[o("b",[e._v("Nettoareal:")])]),o("td",[e._v(e._s(e.buildingNetArea))])]),o("tr",[o("td",[o("b",[e._v("Bruttoareal:")])]),o("td",[e._v(e._s(e.buildingGrossArea))])]),o("tr",[o("td",[o("b",[e._v("Antall etasjer:")])]),o("td",[e._v(e._s(e.numberofstoreys))])]),o("tr",[o("td",[o("b",[e._v("Antall rom:")])]),o("td",[e._v(e._s(e.numberOfRooms))])]),o("tr",[o("td",[o("b",[e._v("Driftsansvarlig:")])]),o("td",[e._v(e._s(e.operationsManager))])])])]},proxy:!0}])})],1),o("v-list-item-avatar",{attrs:{tile:"",size:"100"}},[o("img",{attrs:{src:a("443f")}})])],1)],1),o("v-card",{staticClass:"pa-2",staticStyle:{"margin-bottom":"10px","margin-right":"0px"}},[o("v-img",{attrs:{src:e.buildingImage,height:"250","max-width":"495px"}}),o("div",{staticClass:"mapouter"},[o("div",{staticClass:"gmap_canvas"},[o("iframe",{attrs:{width:"495",height:"250",id:"gmap_canvas",src:"https://maps.google.com/maps?q=Helgelandsykehuset%20mo&t=&z=15&ie=UTF8&iwloc=&output=embed",frameborder:"0",scrolling:"no",marginheight:"0",marginwidth:"0"}})])])],1)],1)],1)],1)},s=[],r=a("4360"),n=(a("a18c"),a("fb26")),i=a("7fff"),l=a("d8d8");a("575c"),a("706e");const c=a("dae0"),d=(new c.Store,a("592d"));a("c8c8");const u={};var h={id:u,name:"BuildingDetails",data(){return{documenturl:"",buildingURI:"",buildingName:"",buildingNum:"",buildingYear:"",buildingType:"",buildingImage:"",buildingProtectionStatus:"",buildingAddress:"",buildingNetArea:"",buildingGrossArea:"",numberofstoreys:"",numberOfRooms:"",operationsManager:"",loading:!1}},methods:{closeview(){console.log("Close view"),r["a"].state.cp.buildingDetailURI="",this.buildingURI="",this.buildingName="",this.buildingNum="",this.buildingYear="",this.buildingType="",this.buildingProtectionStatus="",this.buildingAddress="",this.buildingNetArea="",this.buildingGrossArea="",this.numberofstoreys="",this.numberOfRooms="",this.operationsManager=""},async getBuildingDetails(){this.loading=!0,this.buildingImage=await l["a"].downloadImagefromTrinpod(r["a"].state.cp.buildingDetailURI.replace("/i","/home/IFC/building.jpg"));const e=r["a"].state.cp.buildingDetailURI.replace("/i","/home/IFC/building.json"),t=await i["a"].getIFCmetaDataFromJson(e);this.buildingURI=r["a"].state.cp.buildingDetailURI,r["a"].state.rs.rdfStore.match(d.sym(this.buildingURI),n["c"].RDFS("label"),null).forEach(e=>{""==!e.object&&(this.buildingName=e.object)}),this.buildingNum=t.matrikkelnr,this.buildingYear=t.buildingYear,this.buildingType=t.buildingType,this.buildingProtectionStatus=t.buildingProtectionStatus,this.buildingAddress=t.buildingAddress,this.buildingNetArea=t.buildingNetArea,this.buildingGrossArea=t.buildingGrossArea,this.numberofstoreys=t.numberofstoreys,this.numberOfRooms=t.numberOfRooms,this.operationsManager=t.operationsManager,this.loading=!1},reloadview(){this.getBuildingDetails()}},computed:{},watch:{"$store.state.cp.buildingDetailURI":function(e){this.reloadview()}},mounted(){this.documenturl=this.$route.query.select,this.$route.query.location||this.$router.push({path:this.$route.path,query:{select:this.documenturl}}),this.getBuildingDetails()},created(){}},g=h,m=(a("f811"),a("2877")),p=a("6544"),f=a.n(p),b=a("8336"),v=a("b0af"),y=a("a523"),w=a("132d"),I=a("adda"),S=a("da13"),R=a("8270"),A=a("5d23"),E=a("490a"),x=a("0fd9"),_=a("1f4f"),j=a("2fa4"),T=a("71d9"),F=a("2a7f"),O=Object(m["a"])(g,o,s,!1,null,"08fd40eb",null);t["a"]=O.exports;f()(O,{VBtn:b["a"],VCard:v["a"],VContainer:y["a"],VIcon:w["a"],VImg:I["a"],VListItem:S["a"],VListItemAvatar:R["a"],VListItemContent:A["a"],VListItemSubtitle:A["b"],VListItemTitle:A["c"],VProgressCircular:E["a"],VRow:x["a"],VSimpleTable:_["a"],VSpacer:j["a"],VToolbar:T["a"],VToolbarItems:F["a"],VToolbarTitle:F["b"]})},"7fff":function(e,t,a){"use strict";var o=a("9e5c"),s=a("4360"),r=(a("706e"),a("575c"),a("0ee7"),a("d8d8"),a("8a76")),n=a.n(r),i=a("5a89"),l=a("ec14");const c={};a("592d");let d;c.getIFCpropertiesJson=async function(e){const t=e+"home/IFC/ifc.json";try{window.solid.session.fetch(t,{method:"GET",credentials:"include"}).then(e=>{e.arrayBuffer().then(e=>{let t=new Blob([e]);const a=new FileReader;a.onload=function(){let e=JSON.parse(this.result);return d=e,console.log("IFC json result:"),console.log(this.result),c.constructSpatialTree()},a.readAsText(t)})})}catch(a){console.log(a)}},c.getCirculationCSV=async function(e){let t=new Promise((t,a)=>{const o=e+"home/IFC/circulation.csv";try{window.solid.session.fetch(o,{method:"GET",credentials:"include"}).then(e=>{e.arrayBuffer().then(e=>{let a=new Blob([e]);const o=new FileReader;o.onload=function(){t(this.result)},o.readAsText(a)})})}catch(s){console.log(s),t("")}});return t};let u=[];c.clearContainValues=function(){u=[]},c.ContainsKeyValue=function(e,t,a){for(let o in e)if(null!=e[o]&&e[o][t]==a&&e[o][t]==a&&u.push(e[o]),"object"==typeof e[o]&&null!=e[o])c.checkNestedValues(e[o],t,a);return u},c.checkNestedValues=function(e,t,a){for(let o in e)if(null!=e[o]&&e[o][t],"object"==typeof e[o]&&null!=e[o]){c.ContainsKeyValue(e[o],t,a);e[o][t]===a&&u.push(e[o])}return u};var h=function(e,t,a,o,s){if(a=a||"",o=o||[],s=s||[],-1===s.indexOf(e)||e!==Object(e)){s.push(e),t(e)&&o.push({path:a,value:e});try{if(e===Object(e))for(var r in e)0!==r.indexOf("$")&&h(e[r],t,a+"."+r,o,s)}catch(n){throw console.log(e),n}return o}};function g(e){return Object.values(d).find(t=>t.type===e)}function m(e){return Object.values(d).filter(t=>t.type===e)}async function p(e,t,a){const o=a.filter(t=>t.RelatingStructure===e.expressID),s=t.filter(t=>t.RelatingObject===e.expressID),r=[];o.forEach(e=>r.push(...e.RelatedElements));const n=[];s.forEach(e=>n.push(...e.RelatedObjects));const i=[...r,...n],l=[];for(let u=0;u<i.length;u++){const e=i[u],o=d[e];let s={};const r=Object.keys(o),n=Object.values(o);for(var c=0;c<r.length;c++)s[r[c]]=n[c];await p(s,t,a),l.push(s)}e.children=l}c.getIFCmetaDataFromJson=async function(e){let t=new Promise((t,o)=>{if(window.solid.session.info.isLoggedIn)try{window.solid.session.fetch(e,{method:"GET",credentials:"include"}).then(e=>{e.arrayBuffer().then(e=>{let a=new Blob([e]);const o=new FileReader;o.onload=function(){try{let e=JSON.parse(this.result);console.log(e),t(e)}catch(e){console.log(e),t("")}},o.readAsText(a)})})}catch(s){console.log(s),t("")}else{const e=a("3e76");t(e)}});return t},c.getPropertySets=function(e){let t=h(s["a"].state.bv.IFCPropertyJson,(function(t){return null!=t&&void 0!=t&&t.expressID==e}));t=t[0].value,console.log("Name: "+t.Name),console.log("Type: "+t.type),console.log("Tag: "+t.Tag),console.log("GlobalId: "+t.GlobalId),console.log("OverallHeight: "+t.OverallHeight),console.log("OverallWidth: "+t.OverallWidth)},c.constructSpatialTree=async function(){const e=g("IFCPROJECT"),t={expressID:e.expressID,type:"IFCPROJECT",children:[]},a=m("IFCRELAGGREGATES"),o=m("IFCRELCONTAINEDINSPATIALSTRUCTURE");return await p(t,a,o),s["a"].state.bv.IFCPropertyJson=t,t},c.getAllSubsetMeshes=function(e,t,a){const o=[],s="temp-gltf-subset";for(const r of e){const e=[],n=[],l=[],c=new Map,d=a.ifcManager.createSubset({ids:[r],modelID:t,removePrevious:!0,customID:s});if(!d.geometry.index)throw new Error("Geometry must be indexed!");const u=d.geometry.attributes.position,h=d.geometry.attributes.expressID,g=d.geometry.groups.filter(e=>0!==e.count),m=[],p=d.material;let f=0;g.forEach(e=>{m.push(p[e.materialIndex]),e.materialIndex=f++});let b=0;for(let t=0;t<d.geometry.index.count;t++){const a=d.geometry.index.array[t];c.has(a)||(e.push(u.array[3*a]),e.push(u.array[3*a+1]),e.push(u.array[3*a+2]),n.push(h.getX(a)),c.set(a,b++));const o=c.get(a);l.push(o)}const v=new i["l"],y=new i["k"](Float32Array.from(e),3),w=new i["k"](Uint32Array.from(n),1);v.setAttribute("position",y),v.setAttribute("expressID",w),v.setIndex(l),v.groups=g,v.computeVertexNormals();const I=new i["lb"](v,m);o.push(I)}return a.ifcManager.removeSubset(t,void 0,s),o},c.createFloorplan=async function(e=1,t,a){s["a"].state.bv.scene.getObjectByName("buildingbox");const o=document.createElement("div");let r=new l["a"]({container:o,backgroundColor:new i["o"](16777215)});await r.IFC.loader.ifcManager.useWebWorkers(!0,"../IFCWorker.js"),await r.IFC.setWasmPath("../"),this.ifcloading=!0;try{const o=await window.solid.session.fetch(t,{method:"GET",credentials:"include"});console.log(o);let s=await o.arrayBuffer(),l=URL.createObjectURL(new Blob([s],{type:"application/x-step"}));const d=await r.IFC.loadIfcUrl(l);console.log("Model is loaded..");const u=r.context.ifcCamera.cameraControls;u.setPosition(7.6,4.3,24.8,!1),u.setTarget(-7.1,-.3,2.5,!1),console.log("Starting to generate all plans.."),await r.plans.computeAllPlanViews(d.modelID);const h=new i["W"]({color:0}),g=new i["mb"]({polygonOffset:!0,polygonOffsetFactor:1});console.log("Creating edges"),await r.edges.create("example",d.modelID,h,g);const m=r.plans.getAll(d.modelID);console.log("Printing the plan:"),r.dxf.initializeJSDXF(n.a);const p=await r.IFC.getSpatialStructure(d.modelID),f=p.children[0].children[0].children;for(let e of f)for(let t of e.children)t.children.length&&e.children.push(...t.children);let b=m[e];const v=r.plans.planLists[d.modelID][b];let y=a;const w=await c.getIFCmetaDataFromJson(t.replace(".ifc",".json"));for(const[e,t]of Object.entries(w.storeys))t==v.name&&(y=a+e);console.log(y);const I=f.find(e=>e.expressID===v.expressID);await c.drawProjectedFloorplanItems(I,v,d.modelID,r,0,y),r.dispose(),r=null,this.ifcloading=!1}catch(d){console.log(d)}},c.createPolygon=function(e){const t=new i["Wb"];var a=0;while(e.length>1){const o=e.splice(0,3),s=o[0],r=o[2];0==a?(t.moveTo(s,r,1),a+=1):t.lineTo(s,r,1)}t.autoClose=!0;var o=new i["Xb"](t),s=new i["mb"]({color:13421772});const r=new i["lb"](o,s);return r},c.drawProjectedFloorplanItems=async function(e,t,a,r,l=0,c){s["a"].state.bv.scene.getObjectByName("buildingbox");const d=new i["mb"]({visible:!1});r.dxf.drawings[t.name]||r.dxf.newDrawing(t.name);const u=e.children.map(e=>e.expressID);if(!u.length)return;const h=r.IFC.loader.ifcManager.createSubset({modelID:a,ids:u,removePrevious:!0,customID:"floor_plan_generation",material:d}),g=[],m=await r.edgesProjector.projectEdges(h),p=m.geometry.attributes.position.array,f=.01;for(let o=0;o<p.length-5;o+=6){const e=p[o]-p[o+3],t=-p[o+2]+p[o+5],a=Math.sqrt(e*e+t*t);a>f&&g.push([p[o],-p[o+2],p[o+3],-p[o+5]])}const b=[],v=new i["W"]({color:0,linewidth:3});for(let o=0;o<g.length;o++){const e=g[o],t=[];for(let o=0;o<e.length-3;o+=2)t.push(new i["uc"](e[o],l+10,-e[o+1])),t.push(new i["uc"](e[o+2],l+10,-e[o+3]));const a=(new i["l"]).setFromPoints(t),s=new i["U"](a,v);b.push(s)}r.dxf.drawEdges(t.name,g,"Projection",n.a.ACI.BLUE,"CONTINUOUS"),m.geometry.dispose(),r.dxf.drawNamedLayer(t.name,t,"thick","Section",n.a.ACI.RED,"CONTINUOUS"),r.dxf.drawNamedLayer(t.name,t,"thin","Section_Secondary",n.a.ACI.CYAN,"CONTINUOUS");const y=new i["W"]({color:4474111,linewidth:3}),w=new i["W"]({color:16733525,linewidth:3});console.log("Creating first Sections..");const I=[];r.dxf.drawings[t.name].layers["Section"].shapes.forEach(e=>{I.push(new i["uc"](e.x1,l+10,-e.y1)),I.push(new i["uc"](e.x2,l+10,-e.y2))});const S=(new i["l"]).setFromPoints(I),R=new i["ab"](S,y);b.push(R),console.log("Creating secondary Sections..");const A=[];r.dxf.drawings[t.name].layers["Section_Secondary"].shapes.forEach(e=>{A.push(new i["uc"](e.x1,l+10,-e.y1)),A.push(new i["uc"](e.x2,l+10,-e.y2))});const E=(new i["l"]).setFromPoints(A),x=new i["ab"](E,w);b.push(x),console.log("Adding to buildingbox..");const _=c+".FLOORPLAN.gltf",j=new o["a"],T={trs:!1,onlyVisible:!0,truncateDrawRange:!0,binary:!0,maxTextureSize:0,forceIndices:!1};j.parse(b,(function(e){console.log(e);const t=new File([new Blob([e])],_),a=document.createElement("a");document.body.appendChild(a),a.href=URL.createObjectURL(t),a.download=_,a.click()}),T);const F=r.dxf.exportDXF(t.name),O=document.createElement("a");O.download=c+".FLOORPLAN.dxf",O.href=URL.createObjectURL(F),document.body.appendChild(O),O.click(),O.remove()},c.rotateRadians=function(e,t,a,o,s){const r=Math.cos(s),n=Math.sin(s),i=r*(a-e)+n*(o-t)+e,l=r*(o-t)-n*(a-e)+t;return[i,l]},c.getAngleRadians=function(e,t,a,o){let s=e-a,r=t-o,n=Math.atan2(r,s);return n},c.v3cross=function(e,t){let a={x:0,y:0,z:0};return a.x=e.y*t.z-e.z*t.y,a.y=e.z*t.x-e.x*t.z,a.z=e.x*t.y-e.y*t.x,a},t["a"]=c},8:function(e,t){},"81a4":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAeCAYAAABNChwpAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAlUlEQVRIie2WQQ7AIAgEoenTeLZ/s3e7CFotTQpHA+64CpFrrRQZR6h6AiRAAnwB4ESLzExERCJym1KlFG7XUJ5W0w4+1QFtU0tstAYCWCIrIVxvANlu5XuvCr6BUcEeiOVWeBe4ANpTrHLIBbBT3ATYLd4FWCHuaVfYBU+BNGFUMzWIZkIDfqUNe25x/ooTIAF+D3ABTaRKnPCMoYYAAAAASUVORK5CYII="},"841b":function(e,t,a){},"86a8":function(e,t,a){e.exports=a.p+"img/osv-logo.13d5ae64.png"},"8ac4":function(e,t,a){},"8b7b":function(e,t,a){},9:function(e,t){},9479:function(e,t,a){},"9a6d":function(e,t,a){"use strict";a("5c34")},"9a79":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAeCAYAAABNChwpAAAACXBIWXMAAAsTAAALEwEAmpwYAAACI0lEQVRIie2Wv2sUQRzF3xt2uxBiI/5A0MI6zdmkOrJzgeMKGys9FIzgiY2VjT+K+KOwEguVQFJIcpWNIITszZ3XmMb8BTYKGnOVhGB1t+yzSSDZrJvbSw6be+XszHuPL58ZlhhQ1tqbJOckEcAj59ziID7Me6BSqZzodrvzkq7sMyLfG2Nur66u/h5aAWttEcA7AOcAbBtj7sZxLACvAYwD+AHgunOufawFCoWCPzExMQfgPgBDco1kNQzDbwAwMzNzQdKSpCkAMYAXW1tbj9fX13tHLlAqlS4CWJZ0iWQk6XkURU/a7Xa0d1+xWPQ8z3tI8oEkj+QXSVXn3NeBCwRBMGuMeSlpDMB3Y0w1DMPPWWemp6enjDHLAM6T/BPH8b1ms7mQq0AKaHXf9++srKxsZ4Xvqlwuj/d6vTcArgLZgB4okAZaGIZL/QSneF3DHkAl3Wg2m59SCxwG2qA6DFACqaA9i6LoaRK0QZUFKK21l0ku5QFtUCUBlVQ1AF7thNd9358cVjgAtFqtNd/3JwHUJY2RfMtSqfRT0tnkZudc7mc6S9ZaJddIbhhJNQCbxxnWpzYl1Tzn3EcAZ3ZX05oep5KTNcMM60dens1BEJRJLgA4nfadZEdSzTn3oV/PXBPICgcASacAzOfxzDWB3fB/3ZAdfk7mMfzvDIwKjAqMCowKpP2U/kLGc3ukMLLTaDT2eR+YAMlbJDtDCN8AMJtc/wu6SQrbwpZPHAAAAABJRU5ErkJggg=="},"9ce8":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAeCAYAAABNChwpAAAACXBIWXMAAAsTAAALEwEAmpwYAAADdElEQVRIie2XTWhcVRSAv/NynQSVJm1ApOqmUVeJyU4pilPefRmhULH4gz+1pS3FTRe6koIQEAouFEEXCqJSCagj+BND48x9wywSoRYhM6Yb0UIXIi3FppRJnMzMOy56R0MZZqbT1LjwbM7lnPPO+bjncO99oqpspgSbWv2/AGDaOa21u4IgOKGqfcDrzrn3gJ571qrd0m4GoigqA2PrTHGSJIcKhcK5jQJo2wIR2er1yyJyHgiDIChba48A0gvEdQGoatkvz9ZqtVHgc2AL8L61di6TydxzUwFEpORBHigWixedc8+IyNPABWCy0WgshWF46KYBqGrJg4w3bfl8PhsEwZiIfAFsEZEPoig6GYbhXRsOkCTJogeZWG/P5XIX8vn8U6r6rIhcVNXHROTM5OTkgQ0FGB4e/gVYAXak0+nbr/XHcfxpkiSjwJfAYJIkH1lrv42iaPuGAGSz2YaILAGBMWasVUwcx+edc3uBF4A/gN2quhRF0b4bBvCy6PVEuyDn3LQxZhT4BtiqqiestV+n0+k7bwhARMpej3eKnZub+90597iIvAhcAvYYY85Ya5/rGQC/A6raEaAp+Xz+E1UdA2aBbcC0tfaVngAqlUpZRBQYm5qa6vryiuP4t3q9foCrhxdAy5loexkBLCwsXImi6CwwMj8/fy/wc6u4dDptUqnUaJIkO4GHRORBVb2/6ReRUz0BwN8H0oifg5YAxph3kiR5ad03ABUROQ3ka7XaWz0DiEhJVff6Ocg27ZlMZlsqlfpzZmZmpb+//1i1Wt0DbAe+C4Lg1bW1taVisVhvl7urnrY6kgEajcabq6urxwFmZ2cvqeph73q4Xq9f6VS8awBjTMkvJ5q2MAx3ich+4GgYho8AxHF8EvgYuC0Igg+7Gdq2DxKRf658a+0yMNjX1zdcrVZXjDFl4D4f96uIjOdyuYq1dlBEllT1blV9Io7jr5o5rvtBco0s+iQTxpjXfPES8KOqjqjqcR+3g6v3ByJyR6ekXQ2hT1ZS1UdV9XkR2aeqDVU9IiKrwGngqLX2VhHZr6q3eODPOuXtegdU9ZTXB32Bd+M4/sE59xMwpaoCHPYP2LcrlcpO59zlTnm73oHl5eXs0NDQbuBJEckNDAwca/qcc29Yay+LyGij0ZguFArfd5u37RD+G7LpPyb/A/wF6++ANCz/dI4AAAAASUVORK5CYII="},a136:function(e,t,a){},a142:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAeCAYAAABNChwpAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFiElEQVRIieWXbUxTVxjH/+f2ZRQVpQRSJCECkolxGjZgmGIQdm4LncSkCQsDRRb9ypaYkPmypFfjJ0MWEpqZLPMDjsUPxMVsw5K2YGNtNnkxyAgqZBJxgBRSaBDK6OU++6CwCQwsZvPDnuR+uOee8z+/nOec/3kuIyK8yRDe6OwA1ADAGIt4oCiKFgAfAOgGkAnA7XK5bkSiQUTPATYSRPSNIAjpTqdzxmQyfa8oygCA7ZHqvE4KEonow9LSUi0RWQAkbkSEEVFEKSgpKYkOhUIGAL8t/ybLss7j8cy9qhYRrQ0gSZLg9XqNjLF8ALkAMrVa7fbY2FhlbGxsxepptVplfn5+CMBDAHcEQWjdunWrr6mpaSEiAM55MoBqxtjHaWlpSdnZ2di9ezdSU1ORkJAAABBFcYWgy+WC3+/Ho0eP0NfXh66uLurv7x8F8C0R1be2tg6vCZCVlaXZtm2bTafT1RQVFWkOHTqE5OTkJbpwOIzR0VE8ffqUzp49u2LZLl++jMTERGg0mqW2x48f48aNG4rD4fgjFAp9KcvyhcU0vQRgMpkSFEX5IS8v7/3q6mro9XoQEXp7e+H1eqmnpweDg4NzRDRIRE8AmJcDMMb6AKSlpKS8tW/fPhw4cAB79uwBYwyBQAB2ux1er7dLEASL0+n0LwEUFBREaTQaX0VFxbvHjh0DEaGtrQ1XrlxZGB0dvUdETYIguAKBQE9nZ2f4RZpWWKjb7WalpaWqqampTEVRChljHxkMhsyqqiqhsLAQjDE0NDRQY2PjPVmW99+8eXMORATO+SlJkhQiolAoRKdPnybO+S8mk8m42uZZBFj+rNbPZDIZOec/nzlzZiEUChERkSRJCuf8FBE99wHG2Cfl5eUMAOx2Ozo7OxtkWc5zOp2+fwJ41XA6nb7Y2Ni8jo6ORrvdrgBAeXk5Y4xVAX8ZUWpKSgoAwOfzQa1Wf+rxeOTXnXwxmpqaFsLh8Gcej4cAYMeOHQCQugRAROMTExMAgLS0NITD4aq1BIuLi2MihdBqtRXp6ekqABgfHweAsSUAANebm5sBACdPnkR8fHwd57zWaDRuWU1MluVrBQUF4JyvO7HRaNwiiuLF+Pj4+pqaGgCAw+EAEf0I4PlZLCoqSjSbzf6Ojg4iIpqcnKTa2loSRTHAOa8VRTFLkqQl5xNFcTYYDBIRkdvtJovFsmITiqKYwTn/ymw2T9XV1dH09DQREd29e5csFotfFMXtL/kA53y/RqP56cSJE/rDhw9DpVJhZGQELpcLt2/fxtDQUJCI2omoH4AlIyMjxWazIS4uDgMDA7DZbJiYmLhgNBptPp8vR6fT3bJarRqz2QyDwQAiQnNzMy5dujQpy3Kx0+m8s8IJX1jwdzt37sw7cuQIcnNzoVKpAADBYBADAwMYGRnB2NgYZmZmoNPpUFlZCZ1Oh2AwiHPnzqG3t/drIgocPXr0VGVlJYgI7e3taGxsxIMHD3yKohxva2t7uLj6q90FTBTFEgBf6PX67Pz8fGRmZmLv3r2Ijo5eM9/Pnj2D1WqdY4yZY2JiWnNyctTd3d3w+/2djLGLRqPxmiRJymL/dW/DwsLCt1UqVRkRiYIgvGcwGKKSkpKg1+sRFRWFmJgYWK1WbN68GbIso76+Hg6Ho8XlchVzzt8hohzGWLvb7f51Nf11Af4eBw8eVKvV6lQAyYyxz+Pi4rjNZsOuXbsQCARw/vx59PX1XZ+dna30+XzT6wq+AMBGqmLOeWB4eJiIiO7fv09lZWWLpyCi4vJ1asKHLS0tuZs2bUJDQwPC4fCSZqRCGwKQZbn06tWrTzYydnlsqCj1eDy/A5hf1rxq2fWvAAAAY+zWsnfvfwpARMcZY24AM4wx98LCQtVGdNj//t/wTw8Dv17hrYAZAAAAAElFTkSuQmCC"},a18c:function(e,t,a){"use strict";var o=a("a026"),s=a("8c4f"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login"},[a("TrinityLogin",{attrs:{msg:"Page with login button"}})],1)},n=[],i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"loginwrapper"},[o("div",{staticClass:"loginview"},[o("ul",[o("v-container",{attrs:{center:""}},[o("br"),o("v-img",{attrs:{contain:"","lazy-src":a("86a8"),"max-height":"80",src:a("1914")}}),o("br")],1),e.progressvisible?o("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}}):e._e(),o("div",[e.progressvisible?e._e():o("v-btn",{attrs:{color:"primary",levation:"2",large:"",name:" btnLogin"},on:{click:e.triggerlogin}},[e._v(e._s(e.loginButtonText))])],1)],1)])])},l=[],c=a("4360"),d=a("fb26"),u=a("c1df"),h=a.n(u),g=a("575c"),m=a("8522");const p=a("592d");window.solid={},window.solid.session=new m["Session"],window.solidFetcher=window.solid.session.fetch;var f="Login",b="";const v={};async function y(){window.solid.session.info.isLoggedIn||new URL(window.location.href).searchParams.get("code")||await window.solid.session.login({oidcIssuer:c["a"].state.server,clientName:"sykehusbygg-new",redirectUrl:window.location.href}).then(e=>{console.log("Logged in.."),c["a"].state.isLoggedIn=!0,w()})}async function w(){console.log("Handle redirect.."),await window.solid.session.handleIncomingRedirect({url:window.location.href,restorePreviousSession:!0}).then(e=>{v.checkIfLoggedIn(e)}).finally(()=>{console.log("Redirect finished do request here..")})}async function I(e){let t=[];try{return t=await window.solid.session.fetch(e,{method:"GET",credentials:"include",headers:{Accept:"text/turtle"}}).then(e=>e.text()),t}catch(a){console.log(a)}}v.checkIfLoggedIn=async function(e){if(console.log(e),!e)throw f="Login",c["a"].state.isLoggedIn=!1,console.error("Session object is not found!");e.isLoggedIn?(console.log("Is logged in"),f="Log out",c["a"].state.isLoggedIn=!0,c["a"].state.webId=e.webId,c["a"].state.webId.includes("https://espen")&&(c["a"].state.devMode=!0),c["a"].state.loginExpire=h()(e.expirationDate).format("MMMM Do YYYY, HH:mm:ss"),I(e.webId).then(t=>{var a=new p.IndexedFormula;p.parse(t,a,e.webId,"text/turtle",(t,a)=>{a.match(p.sym(e.webId),d["c"].FOAF("name"),null).forEach(e=>{console.log("Username: "+e.object.value),c["a"].state.loggedInName=e.object.value,c["a"].state.loggedInInitials=g["a"].getInitials(e.object.value)})})})):(console.log("Is logged out"),f="Login",c["a"].state.isLoggedIn=!1)};var S={l:v,name:"TrinityLogin",data(){return{progressvisible:!0,loggedin:!1,loginButtonText:f,userText:b}},watch:{loginButtonText(e,t){console.log(`new: ${e}, old: ${t}`)}},methods:{doRoute(){this.$router.push({path:"/podselect"})},triggerlogin(){this.loginButtonText="Logging in, please wait..",y()},checklogin(){console.log("SessionInfo:"),console.log(window.solid.session.info),window.solid.session.info.isLoggedIn?(console.log("Test logged in"),this.loginButtonText="Log out",this.doRoute()):(console.log("Test logged out"),this.progressvisible=!1,this.loginButtonText="Login")}},created(){},mounted(){w(),setTimeout(()=>this.checklogin(),5e3)}},R=S,A=(a("441e"),a("2877")),E=a("6544"),x=a.n(E),_=a("8336"),j=a("a523"),T=a("adda"),F=a("490a"),O=Object(A["a"])(R,i,l,!1,null,"273f54ad",null),C=O.exports;x()(O,{VBtn:_["a"],VContainer:j["a"],VImg:T["a"],VProgressCircular:F["a"]});var N={name:"TrinityLog",components:{TrinityLogin:C}},L=N,P=Object(A["a"])(L,r,n,!1,null,null,null),D=P.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"logout"},[a("TrinityLogout",{attrs:{msg:"Page for logging out"}})],1)},U=[],M=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"loginwrapper"},[o("div",{staticClass:"loginview"},[o("ul",[o("v-container",{attrs:{center:""}},[o("br"),o("v-img",{attrs:{contain:"","lazy-src":a("86a8"),"max-height":"80",src:a("1914")}}),o("br")],1),e.progressvisible?o("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}}):e._e()],1)])])},B=[];window.solid={},window.solid.session=new m["Session"],window.solidFetcher=window.solid.session.fetch;const V={};var G={lo:V,name:"TrinityLogout",data(){return{progressvisible:!0,loggedin:!1}},watch:{},methods:{doRoute(){this.$router.push({path:"/"})},logout(){Object(m["logout"])().then(()=>{window.solid.session.info.isLoggedIn=!1,this.doRoute()})}},created(){},mounted(){this.logout()}},z=G,W=(a("5711"),Object(A["a"])(z,M,B,!1,null,"6eee5d4f",null)),H=W.exports;x()(W,{VContainer:j["a"],VImg:T["a"],VProgressCircular:F["a"]});var q={name:"TrinityLogou",components:{TrinityLogout:H}},Y=q,K=Object(A["a"])(Y,k,U,!1,null,null,null),X=K.exports,Z=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},J=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"about"},[a("h1",[e._v("About")])])}],$={},Q=Object(A["a"])($,Z,J,!1,null,null,null),ee=Q.exports,te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"feedback"},[a("ImportData",{attrs:{msg:"Show import data form"}})],1)},ae=[],oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"inputwrapper",attrs:{align:"left"}},[a("br"),a("font",{attrs:{color:"#000000"}},[e._v("Import data into Hospital Pod")]),a("br"),a("br"),a("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("div",[a("h2",[e._v(e._s(e.$t("select_roomfile")))]),a("hr",{staticClass:"hr1"}),a("br"),a("v-file-input",{attrs:{"show-size":"",counter:"",multiple:"",accept:".csv",label:"Room file input"},model:{value:e.csvFile,callback:function(t){e.csvFile=t},expression:"csvFile"}})],1),a("div",[a("h2",[e._v(e._s(e.$t("select_circulationfile")))]),a("hr",{staticClass:"hr1"}),a("br"),a("v-file-input",{attrs:{"show-size":"",counter:"",multiple:"",accept:".csv",label:"Circulation file input"},model:{value:e.circulationFile,callback:function(t){e.circulationFile=t},expression:"circulationFile"}})],1),a("div",[a("h2",[e._v(e._s(e.$t("select_geometryfile")))]),a("hr",{staticClass:"hr1"}),a("br"),a("v-file-input",{attrs:{disabled:e.geometryExists,"show-size":"",counter:"",multiple:"",accept:".csv",label:"Geometry file input"},model:{value:e.geometryFile,callback:function(t){e.geometryFile=t},expression:"geometryFile"}})],1),a("v-btn",{staticClass:"mr-4",attrs:{disabled:!e.valid,color:"success"},on:{click:e.validateAndUpload}},[e._v(" Upload systems ")]),a("v-btn",{staticClass:"mr-4",attrs:{disabled:!e.valid,color:"success"},on:{click:e.getUris}},[e._v(" Get URIs ")]),a("v-btn",{staticClass:"mr-4",attrs:{disabled:!e.valid,color:"success"},on:{click:e.addRooms}},[e._v(" Upload rooms ")]),a("v-btn",{staticClass:"mr-4",attrs:{disabled:!e.valid,color:"success"},on:{click:e.addStoreyContains}},[e._v(" Add contains triples ")]),a("v-btn",{staticClass:"white--text",attrs:{to:{name:"ImportIFC"},color:"#3577cb"},on:{click:e.gotoIFCImport}},[e._v(" "+e._s(e.$t("button_importifc"))+" ")]),a("v-btn",{staticClass:"white--text",attrs:{color:"#3577cb"},on:{click:e.createPods}},[e._v(" Create pods ")])],1)],1)},se=[],re=a("706e"),ne=a("b33c"),ie=(a("11c1"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"inputwrapper",attrs:{align:"left"}},[o("v-form",{ref:"form1",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[o("v-expansion-panels",[o("v-expansion-panel",[o("v-expansion-panel-header",[e._v(" "+e._s(e.$t("select_region"))+" ")]),o("v-expansion-panel-content",[o("h2",[e._v(e._s(e.$t("select_region")))]),o("hr",{staticClass:"hr1"}),o("v-row",{attrs:{"no-gutters":""}},[o("v-col",[o("v-select",{attrs:{items:e.rhf,label:e.$t("text_all"),"return-object":"",multiple:"",chips:"",solo:""},model:{value:e.rhfselected,callback:function(t){e.rhfselected=t},expression:"rhfselected"}})],1),o("v-col",[o("img",{attrs:{src:"./img/"+e.hrimage,width:"300"}})])],1),""!=e.rhfselected?o("div",[o("h2",[e._v(e._s(e.$t("select_unit")))]),o("hr",{staticClass:"hr1"}),o("v-select",{attrs:{items:e.helseforetak,label:e.$t("text_all"),"return-object":"",multiple:"",chips:"",solo:""},model:{value:e.hfselected,callback:function(t){e.hfselected=t},expression:"hfselected"}})],1):e._e()],1)],1)],1),o("br"),""!=e.hfselected?o("div",[o("h2",[e._v(e._s(e.$t("select_location")))]),o("hr",{staticClass:"hr2"}),o("v-select",{attrs:{items:e.locationNames,label:e.$t("text_all"),multiple:"",chips:"",solo:""},model:{value:e.lokselected,callback:function(t){e.lokselected=t},expression:"lokselected"}})],1):e._e(),""!=e.lokselected?o("div",[o("h2",[e._v(e._s(e.$t("select_building")))]),o("hr",{staticClass:"hr2"}),o("v-select",{attrs:{items:e.buildingNames,label:e.$t("text_all"),multiple:"",chips:"",solo:""},model:{value:e.buildingSelected,callback:function(t){e.buildingSelected=t},expression:"buildingSelected"}}),o("v-btn",{staticClass:"mr-4",attrs:{color:"primary"},on:{click:e.showBuildingDetails}},[e._v(" "+e._s(e.$t("text_building_details"))+" ")])],1):e._e(),""!=e.buildingSelected?o("div",[o("h2",[e._v(e._s(e.$t("select_wings")))]),o("hr",{staticClass:"hr2"}),o("v-select",{attrs:{items:e.wings,label:e.$t("text_all"),multiple:"",chips:"",solo:""},model:{value:e.wingselected,callback:function(t){e.wingselected=t},expression:"wingselected"}})],1):e._e(),""!=e.wingselected?o("div",[o("h2",[e._v(e._s(e.$t("select_floors")))]),o("hr",{staticClass:"hr2"}),o("v-select",{attrs:{items:e.floors,label:e.$t("text_all"),multiple:!e.twodim,chips:"",solo:""},model:{value:e.floorselected,callback:function(t){e.floorselected=t},expression:"floorselected"}})],1):e._e(),e.loading?e._e():o("div",[o("h2",[e._v(e._s(e.$t("select_functions")))]),o("hr",{staticClass:"hr1"}),o("v-sheet",{staticClass:"pa-4 primary lighten-2"},[o("v-text-field",{attrs:{label:"Search",dark:"",flat:"","solo-inverted":"","hide-details":"",clearable:"","clear-icon":"mdi-close-circle-outline"},model:{value:e.csfsearch,callback:function(t){e.csfsearch=t},expression:"csfsearch"}}),o("v-checkbox",{attrs:{dark:"","hide-details":"",label:"Case sensitive search"},model:{value:e.caseSensitive,callback:function(t){e.caseSensitive=t},expression:"caseSensitive"}})],1),o("v-treeview",{attrs:{items:e.csfitems,search:e.csfsearch,filter:e.filter,transition:!0,"open-on-click":!0,rounded:!0,selectable:"","return-object":"",dense:""},scopedSlots:e._u([{key:"prepend",fn:function(t){var a=t.item;t.open;return[o("v-icon",{attrs:{color:a.color}},[e._v(" "+e._s("mdi-folder"))])]}}],null,!1,1680069583),model:{value:e.csfselection,callback:function(t){e.csfselection=t},expression:"csfselection"}})],1),o("v-btn",{staticClass:"white--text",attrs:{color:"#3577cb"},on:{click:function(t){return e.setAllFunctionsSelected()}}},[e._v(" Select all ")]),o("br"),o("br"),o("div",[o("h2",[e._v(e._s(e.$t("select_bedtypes")))]),o("hr",{staticClass:"hr2"}),o("v-select",{attrs:{items:e.sengeplasstyper,label:e.$t("text_all"),multiple:"",chips:"",solo:""},model:{value:e.sengeplass,callback:function(t){e.sengeplass=t},expression:"sengeplass"}})],1),o("div",[o("h2",[e._v(e._s(e.$t("select_capacity")))]),o("hr",{staticClass:"hr2"}),o("v-select",{attrs:{items:e.romkapasitet,label:e.$t("text_all"),multiple:"",chips:"",solo:""},model:{value:e.kapasitet,callback:function(t){e.kapasitet=t},expression:"kapasitet"}})],1),o("v-expansion-panels",[o("v-expansion-panel",[o("v-expansion-panel-header",[e._v(" "+e._s(e.$t("text_rent_contracts"))+" ")]),o("v-expansion-panel-content",[o("div",[o("h2",[e._v(e._s(e.$t("select_owner")))]),o("hr",{staticClass:"hr2"}),o("v-select",{attrs:{items:e.contractOwnerNames,label:e.$t("text_all"),multiple:"",chips:"",solo:""},model:{value:e.contractOwnerSelected,callback:function(t){e.contractOwnerSelected=t},expression:"contractOwnerSelected"}})],1),o("div",[o("h2",[e._v(e._s(e.$t("select_rent_contract_user")))]),o("hr",{staticClass:"hr2"}),o("v-select",{attrs:{items:e.contractUserNames,label:e.$t("text_all"),multiple:"",chips:"",solo:""},model:{value:e.contractUserSelected,callback:function(t){e.contractUserSelected=t},expression:"contractUserSelected"}})],1),o("div",[o("h2",[e._v(e._s(e.$t("select_rent_type")))]),o("hr",{staticClass:"hr2"}),o("v-select",{attrs:{items:e.contractTypeNames,label:e.$t("text_all"),multiple:"",chips:"",solo:""},model:{value:e.contractTypeSelected,callback:function(t){e.contractTypeSelected=t},expression:"contractTypeSelected"}})],1),o("div",[o("h2",[e._v(e._s(e.$t("select_rent_status")))]),o("hr",{staticClass:"hr2"}),o("v-select",{attrs:{items:e.contractStatusNames,label:e.$t("text_all"),multiple:"",chips:"",solo:""},model:{value:e.contractStatusSelected,callback:function(t){e.contractStatusSelected=t},expression:"contractStatusSelected"}})],1)])],1)],1),o("br"),o("br"),1==e.resultat?o("div",[o("h2",[e._v(e._s(e.$t("text_result")))]),o("hr",{staticClass:"hr2"}),o("h3",[e._v(e._s(this.lokselected[0]))]),o("h4",[e._v(e._s(this.rhfselected[0]+" - "+this.hfselected[0]))]),o("br"),o("br"),o("v-row",{attrs:{"margin-top":"10"}},[o("v-col",[o("WCartesian",{attrs:{dataset:e.values,height:200,bound:[0],margin:0}},[o("WBar",{attrs:{datakey:"one",width:45}}),o("WXAxis",{attrs:{datakey:"name",space:[0,35,35,35]}})],1)],1),o("v-col",[o("div",{staticStyle:{width:"230px"}},[o("b",[e._v(e._s(this.totalCalculatedCapacity+e.$t("text_report1")+this.totalCalculatedRooms+e.$t("text_report2")))]),o("br"),o("font",{attrs:{color:"#FF0000"}},[o("b",[e._v("2 area issues found")])])],1)])],1),o("br"),o("br"),o("v-card",[o("v-card-title",[o("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),o("v-data-table",{staticClass:"elevation-0",attrs:{headers:e.roomTableHeaders,items:e.roomTableList,search:e.search,flat:"","item-key":"roomname","show-select":""},model:{value:e.roomTableSelectedRow,callback:function(t){e.roomTableSelectedRow=t},expression:"roomTableSelectedRow"}})],1),o("br"),o("br"),o("v-btn",{staticClass:"mr-4",attrs:{color:"primary"},on:{click:e.calculate}},[e._v(" "+e._s(e.$t("button_exportxls"))+" ")]),o("v-btn",{staticClass:"mr-4",attrs:{color:"primary"},on:{click:e.loadHovedByggGeometry}},[e._v(" "+e._s(e.$t("button_exportpdf"))+" ")]),o("br"),o("br"),o("br"),o("v-img",{attrs:{"lazy-src":a("616f"),"max-width":"1000","max-height":"350",src:a("616f")}})],1):e._e()],1),o("v-row",{attrs:{justify:"center"}},[o("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:e.roomDetailsVisible,callback:function(t){e.roomDetailsVisible=t},expression:"roomDetailsVisible"}},[o("RoomDetails",{attrs:{dialog:e.roomDetailsVisible},on:{"update:dialog":function(t){e.roomDetailsVisible=t}}})],1),o("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:e.buildingDetailsVisible,callback:function(t){e.buildingDetailsVisible=t},expression:"buildingDetailsVisible"}},[o("BuildingDetails",{attrs:{dialog:e.buildingDetailsVisible},on:{"update:dialog":function(t){e.buildingDetailsVisible=t}}})],1)],1)],1)}),le=[],ce=a("635a"),de=ce["a"],ue=(a("0b1a"),a("b0af")),he=a("99d9"),ge=a("ac7c"),me=a("62ad"),pe=a("8fea"),fe=a("169a"),be=a("cd55"),ve=a("49e2"),ye=a("c865"),we=a("0393"),Ie=a("4bd4"),Se=a("132d"),Re=a("0fd9"),Ae=a("b974"),Ee=a("8dd9"),xe=a("8654"),_e=a("eb2a"),je=Object(A["a"])(de,ie,le,!1,null,"1425ad80",null),Te=je.exports;x()(je,{VBtn:_["a"],VCard:ue["a"],VCardTitle:he["d"],VCheckbox:ge["a"],VCol:me["a"],VDataTable:pe["a"],VDialog:fe["a"],VExpansionPanel:be["a"],VExpansionPanelContent:ve["a"],VExpansionPanelHeader:ye["a"],VExpansionPanels:we["a"],VForm:Ie["a"],VIcon:Se["a"],VImg:T["a"],VRow:Re["a"],VSelect:Ae["a"],VSheet:Ee["a"],VTextField:xe["a"],VTreeview:_e["a"]});var Fe=a("b827");const Oe=a("592d");a("dae0");new(a("c513").DataFactory),a("5189"),a("2f5f").toRdf;const Ce=[{id:"Opphold, somatikk",tag:"OPPH_SOM",sysid:"1A"},{id:"Opphold, psykiatri og rus",tag:"OPPH_SOM_PSYK",sysid:"1B"},{id:"Undersøkelse og behandling, somatikk",tag:"UNDE_BEH_SOM",sysid:"2A"},{id:"Undersøkelse og behandling, psykiatri og rus",tag:"UNDE_BEH_PSYK",sysid:"2B"},{id:"Medisinsk service",tag:"MED_SERV",sysid:"3"},{id:"Ikke-medisinsk service",tag:"IKKE_MED_SERV",sysid:"4"},{id:"Administrasjon",tag:"ADM",sysid:"5"},{id:"Personalservice",tag:"PERS_SERV",sysid:"6"},{id:"Pasientservice",tag:"PASI_SERV",sysid:"7"},{id:"Undervisning og forskning",tag:"UND_FORS",sysid:"8"},{id:"Tekniske arealer",tag:"TEK_AREA",sysid:"9"},{id:"Trafikkarealer",tag:"TRAF_AREA",sysid:"10"},{id:"Utomhus",tag:"UTOM_HUS",sysid:"11"},{id:"Ikke i bruk",tag:"IKKE_BRUK",sysid:"12"}],Ne=[{id:"Barnesengeområde",tag:"OPPH_SOM.POLI_KLI",sysid:"1A.1"},{id:"Barneintensiv",tag:"OPPH_SOM.BARN_INT",sysid:"1A.2"},{id:"Dagområde",tag:"OPPH_SOM.DAG_OMR",sysid:"1A.3"},{id:"Føde/barsel",tag:"OPPH_SOM.FOD_BARS",sysid:"1A.4"},{id:"Habilitering/Rehabilitering",tag:"OPPH_SOM.HAB_REHAB",sysid:"1A.5"},{id:"Intensiv",tag:"OPPH_SOM.INT",sysid:"1A.6"},{id:"Lettovervåking",tag:"OPPH_SOM.L_OVRV",sysid:"1A.7"},{id:"Neonatalintensiv",tag:"OPPH_SOM.NEO_INT",sysid:"1A.8"},{id:"Normalsengeområde",tag:"OPPH_SOM.NORM_SENG_OMR",sysid:"1A.9"},{id:"Observasjon",tag:"OPPH_SOM.OBSRV",sysid:"1A.10"},{id:"Pasienthotell",tag:"OPPH_SOM.PAS_HOT",sysid:"1A.11"},{id:"Tungovervåking",tag:"OPPH_SOM.TUNG_OVRV",sysid:"1A.12"},{id:"Barnesengeområde",tag:"OPPH_SOM_PSYK.BARN_SENG_OMR",sysid:"1B.1"},{id:"Dagområde",tag:"OPPH_SOM_PSYK.DAG_OMR",sysid:"1B.2"},{id:"Familieenhet",tag:"OPPH_SOM_PSYK.FAM_ENH",sysid:"1B.3"},{id:"Normalsengeområde",tag:"OPPH_SOM_PSYK.NORM_SENG_OMR",sysid:"1B.4"},{id:"Rehabilitering",tag:"OPPH_SOM_PSYK.REHAB",sysid:"1B.5"},{id:"Sikring",tag:"OPPH_SOM_PSYK.SIKRI",sysid:"1B.6"},{id:"Skjerming",tag:"OPPH_SOM_PSYK.SKJERM",sysid:"1B.7"},{id:"Akuttmottak",tag:"UNDE_BEH_SOM.AKUTT_MOT",sysid:"2A.1"},{id:"Ergo-ogFysioterapi",tag:"UNDE_BEH_SOM.ERGO_FYSI",sysid:"2A.3"},{id:"Kliniskespesiallaboratorier",tag:"UNDE_BEH_SOM.KLIN_SPES_LAB",sysid:"2A.4"},{id:"Kliniskestøttefunksjoner",tag:"UNDE_BEH_SOM.KLIN_ST_FUNK",sysid:"2A.5"},{id:"Legevakt",tag:"UNDE_BEH_SOM.LEGE_VAKT",sysid:"2A.6"},{id:"Oppvåkning",tag:"UNDE_BEH_SOM.OPPVA",sysid:"2A.7"},{id:"NukleærmedisinogPET",tag:"UNDE_BEH_SOM.NUKL_PET",sysid:"2A.8"},{id:"Operasjon",tag:"UNDE_BEH_SOM.OPERASJON",sysid:"2A.9"},{id:"Poliklinikk",tag:"UNDE_BEH_SOM.POLI_KLI",sysid:"2A.10"},{id:"Radiologi",tag:"UNDE_BEH_SOM.RADIO",sysid:"2A.11"},{id:"Akuttmottak",tag:"UNDE_BEH_PSYK.AKUTT_MOT",sysid:"2B.1"},{id:"Ergo-ogFysioterapi",tag:"UNDE_BEH_PSYK.ERGO_FYSI",sysid:"2B.2"},{id:"Familieterapi",tag:"UNDE_BEH_PSYK.FAM_TERA",sysid:"2B.3"},{id:"Kliniskestøttefunksjoner",tag:"UNDE_BEH_PSYK.KLIN_ST_FUNK",sysid:"2B.4"},{id:"Poliklinikk",tag:"UNDE_BEH_PSYK.POLI_KLI",sysid:"2B.5"},{id:"AMK-sentral",tag:"MED_SERV.AMK_SENT",sysid:"3.1"},{id:"Apotek",tag:"MED_SERV.APOTEK",sysid:"3.2"},{id:"Blodbank",tag:"MED_SERV.BLOD_BANK",sysid:"3.3"},{id:"Laboratoriemedisin",tag:"MED_SERV.LAB_MED",sysid:"3.4"},{id:"Ambulansetjeneste",tag:"MED_SERV.AMB_TJE",sysid:"3.7"},{id:"Avfallshåndtering",tag:"IKKE_MED_SERV.AVFA_HAND",sysid:"4.1"},{id:"Behandlingshjelpemidler",tag:"IKKE_MED_SERV.BEH_HJ_MIDL",sysid:"4.2"},{id:"Beredskap",tag:"IKKE_MED_SERV.BERED",sysid:"4.3"},{id:"FDVU",tag:"IKKE_MED_SERV.FDVU",sysid:"4.4"},{id:"IKTdrift",tag:"IKKE_MED_SERV.IKT_DRIFT",sysid:"4.5"},{id:"Journalarkiv",tag:"IKKE_MED_SERV.JOUR_ARK",sysid:"4.6"},{id:"Medisinskteknikk",tag:"IKKE_MED_SERV.MED_TEKN",sysid:"4.7"},{id:"Renhold",tag:"IKKE_MED_SERV.RENH",sysid:"4.8"},{id:"Sengehåndtering",tag:"IKKE_MED_SERV.SENG_HAND",sysid:"4.9"},{id:"Sentralkjøkken",tag:"IKKE_MED_SERV.SENT_KJOK",sysid:"4.10"},{id:"Sentrallager",tag:"IKKE_MED_SERV.SENT_LAGER",sysid:"4.11"},{id:"Sikkerhetstjeneste",tag:"IKKE_MED_SERV.SIKK_TJEN",sysid:"4.12"},{id:"Sterilsentral",tag:"IKKE_MED_SERV.STERIL_SENT",sysid:"4.13"},{id:"Transportogportør",tag:"IKKE_MED_SERV.TRANS_PORTO",sysid:"4.14"},{id:"Tøyhåndtering",tag:"IKKE_MED_SERV.TOY_HANDT",sysid:"4.15"},{id:"Administrativekontorfunksjoner",tag:"ADM.ADM_KONT",sysid:"5.1"},{id:"Museum",tag:"ADM.MUSEUM",sysid:"5.2"},{id:"Trykkeri",tag:"ADM.TRYKK",sysid:"5.3"},{id:"Sentraladministrativkontorfunksjon",tag:"ADM.SENT_ADM_KONT",sysid:"5.4"},{id:"Merkantilekontorfunksjoner",tag:"ADM.MERK_KONT",sysid:"5.5"},{id:"Kliniskekontorfunksjoner",tag:"ADM.KLIN_KONT",sysid:"5.6"},{id:"Barnehage",tag:"PERS_SERV.B_HAGE",sysid:"6.1"},{id:"Bedriftshelsetjeneste",tag:"PERS_SERV.BEDR_HELS_TJ",sysid:"6.2"},{id:"Garderobe",tag:"PERS_SERV.GARDR",sysid:"6.4"},{id:"Kantine",tag:"PERS_SERV.KANTINE",sysid:"6.5"},{id:"Overnatting",tag:"PERS_SERV.OVERNATTING",sysid:"6.6"},{id:"Rekreasjon",tag:"PERS_SERV.REKREASJON",sysid:"6.7"},{id:"Sanitærrom",tag:"PERS_SERV.SANITAER",sysid:"6.8"},{id:"Kulturvirksomhet",tag:"PASI_SERV.KULT_VIRK",sysid:"7.1"},{id:"Lærings-ogmestringssenter",tag:"PASI_SERV.LAER_MESTR_SENT",sysid:"7.2"},{id:"Næringsvirksomhet",tag:"PASI_SERV.NAERI_VIRK",sysid:"7.3"},{id:"Overnatting",tag:"PASI_SERV.OVERNATTING",sysid:"7.4"},{id:"Pasientbibliotek",tag:"PASI_SERV.PAS_BIB",sysid:"7.5"},{id:"Pasientinformasjon",tag:"PASI_SERV.PASIENT_INFO",sysid:"7.6"},{id:"Prestetjeneste",tag:"PASI_SERV.PREST_TJ",sysid:"7.7"},{id:"Sanitærrom",tag:"PASI_SERV.SANITAERR",sysid:"7.8"},{id:"Skoleogbarnehage",tag:"PASI_SERV.SKOLE_BARNEH",sysid:"7.9"},{id:"Rekreasjon",tag:"PASI_SERV.REKREASJON",sysid:"7.10"},{id:"Dyrestall",tag:"UND_FORS.DYRE_STALL",sysid:"8.1"},{id:"Forskning",tag:"UND_FORS.FORSK",sysid:"8.2"},{id:"Medisinskbibliotek",tag:"UND_FORS.MED_BIB",sysid:"8.3"},{id:"Simuleringsenhet",tag:"UND_FORS.SIM_ENHET",sysid:"8.4"},{id:"Undervisning",tag:"UND_FORS.UNDERV",sysid:"8.5"},{id:"Tekniskerom",tag:"TEK_AREA.TEK_ROM",sysid:"9.1"},{id:"Tekniskesjakter",tag:"TEK_AREA.TEK_SJAKT",sysid:"9.2"},{id:"Tekniskmellometasje",tag:"TEK_AREA.TEK_MEL_ETJ",sysid:"9.3"},{id:"Internttrafikkareal",tag:"TRAF_AREA.INT_TRAF_AREAL",sysid:"10.1"},{id:"Tverrgående trafikkareal",tag:"TRAF_AREA.TV_TRAF_AREAL",sysid:"10.2"},{id:"Trafikkarealmellombygg",tag:"TRAF_AREA.TRAF_AREAL_MEL_BYG",sysid:"10.3"},{id:"Garasje",tag:"UTOM_HUS.GARASJE",sysid:"11.1"},{id:"Hage/Parkanlegg",tag:"UTOM_HUS.HAGE_PARK",sysid:"11.2"},{id:"Landingsplass",tag:"UTOM_HUS.LANDINGSPLASS",sysid:"11.3"},{id:"Parkering",tag:"UTOM_HUS.PARKERING",sysid:"11.4"},{id:"Utomhusopphold",tag:"UTOM_HUS.UTOMHUS",sysid:"11.5"},{id:"Ferdigbygg",tag:"IKKE_BRUK.FERD_BYGG",sysid:"12.1"},{id:"Råbygg",tag:"IKKE_BRUK.RABYGG",sysid:"12.2"},{id:"Utgravd",tag:"IKKE_BRUK.UTGRAVD",sysid:"12.3"}],Le={};let Pe=Oe.graph(),De=!1;const ke=c["a"].state.serverPath,Ue="https://helsenorge"+c["a"].state.testNum+"."+ke,Me="https://helsenorge-helsenord"+c["a"].state.testNum+"."+ke,Be="https://helsenorge-helsenord-helgeland"+c["a"].state.testNum+"."+ke,Ve="https://helsenorge-helsenord-helgeland-moirana"+c["a"].state.testNum+"."+ke,Ge="https://sjoforsgata36"+c["a"].state.testNum+"."+ke,ze="https://hovedbygg111"+c["a"].state.testNum+"."+ke,We=Ze(Ue+"/i"),He=(Ze(Me+"/i"),Ze(Be+"/i"),Ze(Ve+"/i"),Ze(Ge+"/i")),qe=Ze(ze+"/i"),Ye=[d["c"].SIO("SIO_000202"),d["c"].DUL("hasPart"),d["c"].LDP("contains"),d["c"].NEO("t_1pr4n")],Ke=[d["c"].SIO("SIO_000202"),d["c"].DUL("hasPart"),d["c"].LDP("contains"),d["c"].NEO("t_1pr4n"),d["c"].NEO("m_port")];let Xe=[];function Ze(e){let t=e.replace(/\s/g,"");return encodeURI(t)}function Je(e,t){return e.some(e=>e.includes(t))}function $e(e,t,a){Pe.add(e,t,a,Oe.default),c["a"].state.rs.rdfStore.add(e,t,a,Oe.default)}function Qe(e,t,a){let o="";e.forEach((e,t)=>{e.split(":",2)});let s=ne["a"].getBlankNode("Site circulation "+o);return c["a"].state.blankExisted||($e(s,d["c"].RDF("type"),d["c"].NEO("y_system")),$e(s,d["c"].TAG("tag"),"SiteCirculationSystem"),$e(s,d["c"].RDFS("label"),Oe.literal("Site circulation "+o,"en")),$e(s,d["c"].RDFS("label"),Oe.literal("Område sirkulasjon "+o,"no")),$e(s,d["c"].RDFS("comment"),"Circulation system for the Site: "+o),$e(Oe.sym(He),d["c"].SIO("SIO_000202"),s),re["a"].checkIfContainLoop(s.value,Ye)),Je(Xe,"SiteCirculationSystem")||Xe.push(["SiteCirculationSystem",""]),!0}function et(e,t,a){let o="",s="",r="",n="",i="",l="";e.forEach((e,t)=>{let a=e.split(":",2);"RHF"==a[0]&&(o=a[1]),"HF"==a[0]&&(s=a[1]),"Lokasjon"==a[0]&&(r=a[1]),"Bygg"==a[0]&&(n=a[1]),"Etasje"==a[0]&&(i=a[1]),"Fløy"==a[0]&&(l=a[1])});let u="NMH.Y.SYKEHUS.HN.H.MOIRANA.SJOFORSGATA.HOVEDBYGG",h=".FLOY_"+g["a"].getCharactersBefore(l," - "),m=".E"+g["a"].getCharactersBefore(i," - "),p=ne["a"].getBlankNode("Building circulation "+n);c["a"].state.blankExisted||($e(p,d["c"].RDF("type"),d["c"].NEO("y_system")),$e(p,d["c"].TAG("tag"),"BuildingCirculationSystem"),$e(p,d["c"].RDFS("label"),Oe.literal("Building circulation "+n,"en")),$e(p,d["c"].RDFS("label"),Oe.literal("Bygning sirkulasjon "+n,"no")),$e(p,d["c"].RDFS("comment"),"Circulation system for the Building: "+n)),Je(Xe,"BuildingCirculationSystem")||Xe.push(["BuildingCirculationSystem",""]);let f=ne["a"].getBlankNode(l),b=ne["a"].prettyTAG(u+h);c["a"].state.blankExisted||(""===l&&(l="Ingen"),$e(f,d["c"].RDF("type"),d["c"].NEO("y_wing")),$e(f,d["c"].TAG("tag"),b),$e(f,d["c"].RDFS("label"),Oe.literal(l,"en"))),Je(Xe,b)||Xe.push([b,""]);let v=ne["a"].getBlankNode(i+h),y=ne["a"].prettyTAG(u+h+m);return c["a"].state.blankExisted||($e(v,d["c"].RDF("type"),d["c"].BOT("Storey")),$e(v,d["c"].TAG("tag"),y),$e(v,d["c"].RDFS("label"),Oe.literal(i,"en")),$e(f,d["c"].SIO("SIO_000202"),v),re["a"].checkIfContainLoop(v.value,Ye),console.log("Storey: "+i)),Je(Xe,y)||Xe.push([y,""]),!0}function tt(e,t){for(var a=0;a<e.length;a++)if(e[a].sysid===t)return console.log("Did successfully find: "+t),e[a].tag;return console.log("Did not find: "+t),"UNDEFINED"}function at(){let e="NMH.F.SYKEHUS.",t=ne["a"].getBlankNode("HospitalRoomFunctions");c["a"].state.blankExisted||($e(t,d["c"].NEO("t_genus"),d["c"].NEO("f_hospital")),$e(t,d["c"].TAG("tag"),"HospitalRoomFunctions"),$e(t,d["c"].RDFS("label"),Oe.literal("Hospital functions","en")),$e(t,d["c"].RDFS("label"),Oe.literal("Sykehus funksjoner","no"))),Je(Xe,"HospitalRoomFunctions")||Xe.push(["HospitalRoomFunctions",""]),Ce.forEach(a=>{const o=ne["a"].getBlankNode("System: "+a.tag),s=ne["a"].prettyTAG(e+a.tag);c["a"].state.blankExisted||($e(o,d["c"].TAG("tag"),s),$e(o,d["c"].RDFS("label"),Oe.literal("Hovedfunksjon: "+a.sysid+" - "+a.id,"en")),$e(o,d["c"].NEO("t_genus"),t)),Je(Xe,s)||Xe.push([s,""])}),Ne.forEach(t=>{const a=ne["a"].getBlankNode("System: "+g["a"].getCharactersBefore(t.tag,".")),o=ne["a"].getBlankNode("System: "+t.tag),s=ne["a"].prettyTAG(e+t.tag);c["a"].state.blankExisted||($e(o,d["c"].TAG("tag"),s),$e(o,d["c"].RDFS("label"),Oe.literal("Delfunksjon: "+t.sysid+" - "+t.id,"en")),$e(o,d["c"].NEO("t_genus"),a)),Je(Xe,s)||Xe.push([s,""])})}async function ot(){let e="NMH.Y.SYKEHUS.HN.H.MOIRANA.SJOFORSGATA.HOVEDBYGG";await Fe["a"].searchAndGetURIs("#"+e+".FLOY*");const t=[];c["a"].state.rs.rdfStore.match(null,d["c"].RDF("type"),d["c"].BOT("Storey")).forEach(e=>{t.includes(e.subject.value)||(console.log("Found storey: "+e.subject.value),t.push(e.subject.value))});for(let a=0;a<t.length;a++){await re["a"].fetchAndSaveTurtle(t[a],!1).then(e=>{})}return t}async function st(e){let t=await ot();t&&console.log("Storeys fetched.");for(var a=0;a<t.length;a++){for(var o=0;o<e.length;o++){let s="",r="",n="";e[o].forEach((e,t)=>{let a=e.split(":",2);"Etasje"==a[0]&&(s=a[1]),"Rom ID"==a[0]&&(n=a[1]),"Fløy"==a[0]&&(r=a[1])});let i="NMH.Y.SYKEHUS.HN.H.MOIRANA.SJOFORSGATA.HOVEDBYGG",l=".F"+g["a"].getCharactersBefore(r," - "),u=".FLOY_"+g["a"].getCharactersBefore(r," - "),h=".E"+g["a"].getCharactersBefore(s," - "),m=ne["a"].prettyTAG(i+l+h+"."+encodeURI(n)),p=ne["a"].prettyTAG(i+u+h),f="",b="",v=c["a"].state.rs.rdfStore.match(null,d["c"].TAG("tag"),p)[0];if(v?f=v.subject.value:console.log("Warning, did not find Storey URI for tag: "+p),!f)continue;if(f!=t[a])continue;await Le.searchAndGetURIs(m);let y=c["a"].state.rs.rdfStore.match(null,d["c"].TAG("tag"),m)[0];y&&(console.log("Room URI for tag: "+m),console.log(y.subject.value),b=y.subject.value,c["a"].state.rs.rdfStore.match(Oe.sym(f),d["c"].SIO("SIO_000202"),Oe.sym(b))[0]||Pe.add(Oe.sym(f),d["c"].SIO("SIO_000202"),Oe.sym(b),Oe.default))}let s=ne["a"].storeToTurtle(Pe,ze);if(s=re["a"].modifyTurtle(s),console.log(s),window.solid.session.info.isLoggedIn&&""!=s){let e=await re["a"].uploadTurtle(qe,s,De);e&&console.log("Turtle should have been uploaded..."),Pe=Oe.graph()}else console.log("Is logged out")}}async function rt(e,t,a){let o="",s="",r="",n="",i="",l="",u="",h="",m="",p="",f="",b="",v="",y="",w="",I="",S="",R="",A="",E="",x="",_="",j="";e.forEach((e,t)=>{let a=e.split(":",2);"RHF"==a[0]&&(o=a[1]),"HF"==a[0]&&(s=a[1]),"Lokasjon"==a[0]&&(r=a[1]),"Bygg"==a[0]&&(n=a[1]),"Etasje"==a[0]&&(i=a[1]),"Fløy"==a[0]&&(l=a[1]),"Rom ID"==a[0]&&(u=a[1]),"Navn"==a[0]&&(h=a[1]),"Hovedfunksjon"==a[0]&&(m=a[1]),"Delfunksjon"==a[0]&&(p=a[1]),"Romnavn"==a[0]&&(f=a[1]),"Romspesifikasjon"==a[0]&&(b=a[1]),"Kapasitet, dagens"==a[0]&&(v=a[1]),"Netto areal"==a[0]&&(y=a[1]),"Brutto areal"==a[0]&&(w=a[1]),"Eie/leie"==a[0]&&(I=a[1]),"Org.-nivå 1"==a[0]&&(S=a[1])});let T="NMH.F.SYKEHUS.",F="NMH.Y.SYKEHUS.HN.H.MOIRANA.SJOFORSGATA.HOVEDBYGG",O=".F"+g["a"].getCharactersBefore(l," - "),C=".FLOY_"+g["a"].getCharactersBefore(l," - "),N=".E"+g["a"].getCharactersBefore(i," - ");x=n.substring(n.indexOf(" - ")-1),_=f.substring(f.indexOf(" - ")-1),j=b.substring(b.indexOf(" - ")-1),A=g["a"].getCharactersBefore(m," - "),E=g["a"].getCharactersBefore(p," - "),R=g["a"].getCharactersBefore(I," - "),I=g["a"].getCharactersAfter(I," - ");try{y=parseFloat(y.replace(",","."))}catch(B){console.log("Failed to parse Net Area!")}try{w=parseFloat(w.replace(",","."))}catch(B){console.log("Failed to parse Gross Area!")}isNaN(y)&&(y=0),isNaN(w)&&(w=0);tt(Ce,A);console.log("Part function code: "+E);let L=tt(Ne,E);console.log("Part function tag: "+L);let P,D,k,U="";for(var M=0;M<Xe.length;M++)Xe[M][0]===ne["a"].prettyTAG(F+C)&&(P=Oe.sym(Xe[M][1])),Xe[M][0]===ne["a"].prettyTAG(F+C+N)&&(D=Oe.sym(Xe[M][1])),Xe[M][0]===ne["a"].prettyTAG(T+L)&&(U=Oe.sym(Xe[M][1])),"SiteCirculationSystem"===Xe[M][0]&&(k=Oe.sym(Xe[M][1]));if(m.includes("Trafikkarealer")){let e=ne["a"].getBlankNode("Hall "+u);if(!c["a"].state.blankExisted){let t=ne["a"].prettyTAG(F+O+N+"."+encodeURI(u));$e(e,d["c"].RDF("type"),d["c"].BOT("Space")),$e(e,d["c"].TAG("tag"),t),$e(e,d["c"].RDFS("label"),Oe.literal("Hall "+u,"en")),$e(e,d["c"].RDFS("label"),Oe.literal("Gang "+u,"no")),$e(e,d["c"].NEO("m_area-net"),Oe.literal(y+"",void 0,d["c"].XSD("decimal"))),$e(e,d["c"].NEO("m_area-gross"),Oe.literal(w+"",void 0,d["c"].XSD("decimal"))),$e(Oe.sym(D),d["c"].SIO("SIO_000202"),e),re["a"].checkIfContainLoop(e.value,Ye)}a.forEach((t,a)=>{var o=t.split(";");decodeURI(o[1])==u&&$e(e,d["c"].IFOUR("m_polyline"),t)})}else{let e=ne["a"].getBlankNode(u);if(!c["a"].state.blankExisted){let t=ne["a"].prettyTAG(F+O+N+"."+encodeURI(u));$e(e,d["c"].RDF("type"),d["c"].BOT("Space")),$e(e,d["c"].RDFS("label"),Oe.literal("Room "+u,"en")),$e(e,d["c"].RDFS("label"),Oe.literal("Rom "+u,"no")),$e(e,d["c"].TAG("tag"),t),$e(e,d["c"].NEO("m_area-net"),Oe.literal(y+"",void 0,d["c"].XSD("decimal"))),$e(e,d["c"].NEO("m_area-gross"),Oe.literal(w+"",void 0,d["c"].XSD("decimal"))),$e(Oe.sym(D),d["c"].SIO("SIO_000202"),e),""!=U&&$e(e,d["c"].NEO("b_capable"),Oe.sym(U)),re["a"].checkIfContainLoop(e.value,Ye)}for(let t=1;t<=parseInt(v);t++){let a=ne["a"].getBlankNode("Bedport:"+t+u);c["a"].state.blankExisted||($e(a,d["c"].RDF("type"),d["c"].NEO("y_port")),$e(e,d["c"].NEO("m_port"),a),re["a"].checkIfContainLoop(a.value,Ke))}a.forEach((t,a)=>{var o=t.split(";");decodeURI(o[1])==u&&$e(e,d["c"].IFOUR("m_polyline"),t)})}return!1}async function nt(e,t,a){for(var o=e.split(/\r\n|\n/),s=o[0].split(";"),r=[],n=1;n<o.length;n++){var i=o[n].split(";");if(i.length==s.length){for(var l=[],c=0;c<s.length;c++)l.push(s[c]+":"+i[c]);r.push(l)}}let d=await re["a"].fetchAndSaveTurtle(He),u=await re["a"].fetchAndSaveTurtle(qe),h=await re["a"].fetchAndSaveTurtle(We);console.log(d+u+h);for(n=0;n<r.length;n++)Qe(r[n],t,a);var g=ne["a"].storeToTurtle(Pe,ze);g=re["a"].modifyTurtle(g),console.log(g),window.solid.session.info.isLoggedIn?re["a"].uploadTurtle(He,g,De).then(e=>{Pe=Oe.graph();for(var o=0;o<r.length;o++)et(r[o],t,a);g=ne["a"].storeToTurtle(Pe,ze),g=re["a"].modifyTurtle(g),console.log(g),re["a"].uploadTurtle(qe,g,De).then(e=>{Pe=Oe.graph(),at();let t=ne["a"].storeToTurtle(Pe,ze);t=re["a"].modifyTurtle(t),console.log(t),re["a"].uploadTurtle(We,t,De).then(e=>{Pe=Oe.graph(),console.log("System triples should be uploaded, go to next operation if success...")})})}):console.log("Is logged out")}Le.quadsToTurtle=function(e){var t;if(e&&Array.isArray(e))return Oe.serialize(void 0,Pe,ze,"text/turtle",(function(e,a){console.log("Turtle serialize error: ",e),t=a})),t;console.log("Error: quads array does not exist")},Le.searchAndGetURIs=async function(e){let t=c["a"].state.webId.replace("/i","/search/")+encodeURIComponent(e);try{let e=await window.solid.session.fetch(t,{method:"GET",credentials:"include",headers:{Accept:"text/turtle"}}).then(e=>e.text());return Oe.parse(e,c["a"].state.rs.rdfStore,t,"text/turtle"),c["a"].state.rs.rdfStore.match(null,d["c"].TAG("tag"),null).forEach(e=>{for(var t=0;t<Xe.length;t++)Xe[t][0]==e.object.value&&(Xe[t][1]=e.subject.value)}),e}catch(a){console.log(a),console.log("Search failed")}},Le.getSystemURIsFromTrinpod=async function(){await Le.searchAndGetURIs("SiteCirculationSystem"),await Le.searchAndGetURIs("BuildingCirculationSystem"),await Le.searchAndGetURIs("HospitalRoomFunctions"),await Le.searchAndGetURIs("#NMH.F.SYKEHUS.*"),await Le.searchAndGetURIs("#NMH.Y.SYKEHUS.*"),await Le.searchAndGetURIs("#NMH.F.SYKEHUS.IKKE_MED_SERV.*"),await Le.searchAndGetURIs("#NMH.F.SYKEHUS.PASI_SERV.*"),await Le.searchAndGetURIs("#NMH.F.SYKEHUS.ADM.*");for(var e=0;e<Xe.length;e++){if("SiteCirculationSystem"==Xe[e][0]){await re["a"].fetchAndSaveTurtle(Xe[e][1],!0).then(e=>{})}if("HospitalRoomFunctions"==Xe[e][0]){await re["a"].fetchAndSaveTurtle(Xe[e][1],!0).then(e=>{})}}await re["a"].fetchAndSaveTurtle(We,!0).then(e=>{});return c["a"].state.rs.rdfStore.match(null,d["c"].TAG("tag"),null).forEach(e=>{for(var t=0;t<Xe.length;t++)decodeURI(Xe[t][0])===decodeURI(e.object.value)&&(console.log(Xe[t][0]+" found, setting uri: "+e.subject.value),Xe[t][1]=e.subject.value)}),c["a"].state.rs.systemURIs=Xe,console.log(c["a"].state.rs.systemURIs),!0},Le.uploadBatch=async function(e,t,a,o,s,r){Pe=Oe.graph();let n=[];console.log("Uploading rooms "+o+"-"+(o+s)+"!");let i=o+s;i>=e.length&&(i=e.length);for(var l=o;l<i;l++){await rt(e[l],t,a)}var c=Le.quadsToTurtle(n);c=re["a"].modifyTurtle(c),console.log(c),window.solid.session.info.isLoggedIn?re["a"].uploadTurtle(qe,c,De).then(n=>{o+=s,console.log(o+" rooms should be uploaded.."),o<=r&&n&&Le.uploadBatch(e,t,a,o,s,r)}):console.log("Is logged out")},Le.checkIfAppAuthenticated=async function(e){encodeURI(e);try{let e=await window.solid.session.fetch(ze,{method:"HEAD",credentials:"include"});console.log("-- Auth response below --"),console.log(e);var t=e.headers.get("App-Authorization-Required"),a=e.status;401===a&&t&&(console.log("Redirecting.."),window.location.href=t+"&redirect_uri="+window.location.href)}catch(o){console.log(o)}};var it={id:Le,name:"ImportData",data(){return{selectedItem:0,valid:!0,geometryExists:!0,csvFile:"",circulationFile:"",geometryFile:"",circulationArray:[],customerarray:[{name:"Loading...",icon:"mdi-clock  "}]}},methods:{checklogin(){console.log(window.solid.session.info),window.solid.session.info.isLoggedIn?console.log("Test logged in"):(console.log("Is logged out, reroute"),this.$router.push({path:"/"}))},createPods(){},createInput(e){let t=new Promise((t,a)=>{var o=new FileReader,s=this;o.onload=e=>{t(s.fileinput=o.result)},o.readAsText(e[0])});t.then(e=>{nt(this.fileinput,this.circulationArray,c["a"].state.rs.geometryArray)},e=>{console.log(e)})},validateAndUpload(){this.$refs.form.validate(),this.createInput(this.csvFile)},getUris(){let e=new Promise((e,t)=>{var a=new FileReader,o=this;a.onload=t=>{e(o.fileinput=a.result)},a.readAsText(this.csvFile[0])});e.then(e=>{for(var t=this.fileinput.split(/\r\n|\n/),a=t[0].split(";"),o=[],s=1;s<t.length;s++){var r=t[s].split(";");if(r.length==a.length){for(var n=[],i=0;i<a.length;i++)n.push(a[i]+":"+r[i]);o.push(n)}}for(s=0;s<o.length;s++)Qe(o[s],this.circulationArray,c["a"].state.rs.geometryArray),et(o[s],this.circulationArray,c["a"].state.rs.geometryArray),at();c["a"].state.rs.rdfStore=Oe.graph(),console.log("Getting URIs"),Le.getSystemURIsFromTrinpod().then(e=>{console.log("System uris should have been obtained...")})},e=>{console.log(e)})},addRooms(){c["a"].state.rs.bIndex=[],Xe=c["a"].state.rs.systemURIs;let e=this.csvFile,t=new Promise((t,a)=>{var o=new FileReader,s=this;o.onload=e=>{t(s.fileinput=o.result)},o.readAsText(e[0])});t.then(e=>{let t=0,a=40,o=920;for(var s=this.fileinput.split(/\r\n|\n/),r=s[0].split(";"),n=[],i=1;i<s.length;i++){var l=s[i].split(";");if(l.length==r.length){for(var d=[],u=0;u<r.length;u++)d.push(r[u]+":"+l[u]);n.push(d)}}Le.uploadBatch(n,this.circulationArray,c["a"].state.rs.geometryArray,t,a,o)},e=>{console.log(e)})},addStoreyContains(){let e=this.csvFile,t=new Promise((t,a)=>{var o=new FileReader,s=this;o.onload=e=>{t(s.fileinput=o.result)},o.readAsText(e[0])});t.then(e=>{for(var t=this.fileinput.split(/\r\n|\n/),a=t[0].split(";"),o=[],s=1;s<t.length;s++){var r=t[s].split(";");if(r.length==a.length){for(var n=[],i=0;i<a.length;i++)n.push(a[i]+":"+r[i]);o.push(n)}}st(o)},e=>{console.log(e)})},reset(){this.$refs.form.reset()},resetValidation(){this.$refs.form.resetValidation()},gotoIFCImport(){}},computed:{sItem(){return this.selectedItem}},watch:{csvFile:function(e){console.log("Filename: ",e)},circulationFile:function(e){let t=new Promise((t,a)=>{var o=new FileReader,s=this;o.onload=e=>{t(s.fileinput=o.result)},o.readAsText(e[0])});t.then(e=>{for(var t=this.fileinput.split(/\r\n|\n/),a=t[0].split(";"),o=[],s=1;s<t.length;s++){var r=t[s].split(";");if(r.length==a.length){for(var n=[],i=0;i<a.length;i++)n.push(r[i]);o.push(n)}}this.circulationArray=o},e=>{console.log(e)})},geometryFile:function(e){let t=new Promise((t,a)=>{var o=new FileReader,s=this;o.onload=e=>{t(s.fileinput=o.result)},o.readAsText(e[0])});t.then(e=>{var t=this.fileinput.split(/\r\n|\n/);t.shift(),c["a"].state.rs.geometryArray=t},e=>{console.log(e)})}},mounted(){this.checklogin(),c["a"].state.rs.geometryArray.length>=1?this.geometryExists=!0:this.geometryExists=!1},created(){}},lt=it,ct=(a("da1a"),a("23a7")),dt=Object(A["a"])(lt,oe,se,!1,null,"dbba2baa",null),ut=dt.exports;x()(dt,{VBtn:_["a"],VFileInput:ct["a"],VForm:Ie["a"]});a("bf40");var ht={name:"ImportDataV",components:{ImportData:ut}},gt=ht,mt=Object(A["a"])(gt,te,ae,!1,null,null,null),pt=mt.exports,ft=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"feedback"},[a("BIMviewer",{attrs:{msg:"Show bimviewer form"}})],1)},bt=[],vt=a("34d2"),yt={name:"BIMviewerV",components:{BIMviewer:vt["a"]}},wt=yt,It=Object(A["a"])(wt,ft,bt,!1,null,null,null),St=It.exports,Rt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrapper",style:{height:e.viewHeight+"px"}},[a("v-btn",{staticClass:"white--text",staticStyle:{position:"absolute","z-index":"3",top:"28px",right:"8px"},attrs:{color:"#3577cb"},on:{click:e.toggleViews}},[a("v-icon",[e._v("mdi-arrow-split-vertical")])],1),a("Multipane",{staticClass:"vertical-panes",style:{height:e.viewHeight+"px"},attrs:{scroll:"no",id:"resizer",layout:"vertical"},on:{paneResizeStart:function(t){return e.paneresizestarted(t)},paneResizeStop:function(t){return e.paneresizestopped(t)}}},[a("div",{ref:"leftpane",staticClass:"vertical",staticStyle:{overflow:"scroll"},style:{height:e.viewHeight+"px"}},[a("BMviewer",{attrs:{msg:"Show BMViewer form"}})],1),a("multipane-resizer",{staticClass:"resizer",style:{height:e.viewHeight+"px"}},[e._v("R")]),a("div",{ref:"rightpane",staticClass:"verticalflex",staticStyle:{overflow:"scroll"},style:{height:e.viewHeight+"px"}},[a("BMDetails",{attrs:{msg:"Show details form"}})],1)],1)],1)},At=[],Et=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"inputwrapper"},[a("v-btn",{staticClass:"buttonclass",on:{click:e.changeURL}},[e._v("Change URL")]),a("br"),e._v("Dette er en test."),a("br"),a("br"),a("v-btn",{on:{click:e.selectWindow}},[e._v("Window")]),a("br"),a("v-btn",{on:{click:e.selectWalls}},[e._v("Walls")]),a("br"),a("v-btn",{on:{click:e.selectRoof}},[e._v("Roof")]),a("br"),a("v-btn",{on:{click:e.selectBUP}},[e._v("BUP")]),a("br"),a("v-btn",{on:{click:e.selectRIV}},[e._v("RIV")]),a("br"),a("v-btn",{on:{click:e.selectNTNU}},[e._v("NTNU")]),a("br"),a("v-btn",{on:{click:e.selectSpace}},[e._v("Space")]),a("br"),a("v-btn",{on:{click:e.selectSpaceAndDoor}},[e._v("Space and door")]),a("br"),a("v-btn",{on:{click:e.selectSpaceAndWindow}},[e._v("Space and window")]),a("br")],1)},xt=[],_t=(a("0ee7"),a("faa9")),jt=a("21cc");a("592d"),c["a"].state.serverPath;const Tt={};var Ft={id:Tt,name:"BWDetails",data(){return{valid:!0,loading:!1}},methods:{changeURL(){c["a"].state.bmurl=c["a"].state.bmurl.replace("33316","33318")},selectBUP(){c["a"].state.bmurl='{ "select": "[1946]", "location": "%252Fassets%252Fbup.scs", "twodim": "right"}'},selectRIV(){c["a"].state.bmurl='{ "select": "[443,442,337]", "location": "%252Fassets%252Fpowerhouse_riv.scs", "twodim": "none"}'},selectNTNU(){c["a"].state.bmurl='{ "select": "[9264,9265,9263]", "location": "%252Fassets%252Fsb.scs", "twodim": "right"}'},selectWindow(){c["a"].state.bmurl='{ "select": "[1946,1946,1946]", "location": "%252Fassets%252Fbup.scs", "twodim": "right"}'},selectWalls(){c["a"].state.bmurl='{ "select": "[443,442,337]", "location": "%252Fassets%252Fbup.scs", "twodim": "right"}'},selectRoof(){c["a"].state.bmurl='{ "select": "[9264,9265,9263]", "location": "%252Fassets%252Fbup.scs", "twodim": "right"}'},selectSpace(){c["a"].state.bmurl='{ "select": "[45]", "location": "%252Fassets%252Fbup.scs", "twodim": "right"}'},selectSpaceAndDoor(){c["a"].state.bmurl='{ "select": "[5995]", "location": "45", "twodim": "right"}'},selectSpaceAndWindow(){c["a"].state.bmurl='{ "select": "[1949]", "location": "45", "twodim": "right"}'}},computed:{},watch:{},mounted(){},created(){},beforeDestroy(){}},Ot=Ft,Ct=(a("6bbc"),Object(A["a"])(Ot,Et,xt,!1,null,"7829fb3a",null)),Nt=Ct.exports;x()(Ct,{VBtn:_["a"]});var Lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tsviewer",attrs:{id:"tsviewer"}},[a("iframe",{ref:"iframeRef",attrs:{src:e.currentURL}}),a("div",{staticStyle:{position:"absolute",top:"90px",right:"5px"}})])},Pt=[],Dt=(a("78f0"),a("0d9d"),a("d8d8")),kt=a("7fff");a("b91f");const Ut={};a("592d");var Mt={tsv:Ut,name:"BMViewer",data(){return{loading:!1,employeeNameList:["https://espen.trinpod.us/i"],employeeList:["Espen Marthiniussen"],progress:null,currentURL:"http://localhost:8081/?location=%252Fassets%252Fbup.scs&select=33316&twodim=none"}},methods:{async loadView(){c["a"].state.bmurl='{ "select": "[100]", "location": "%252Fassets%252Fbup.scs", "twodim": "none"}'},selectWindow(){c["a"].state.bmurl='{ "select": "[1946]", "location": "%252Fassets%252Fbup.scs", "twodim": "right"}'},selectWalls(){c["a"].state.bmurl='{ "select": "[443,442,337]", "location": "%252Fassets%252Fbup.scs", "twodim": "right"}'},selectSpace(){c["a"].state.bmurl='{ "select": "[45]", "location": "%252Fassets%252Fbup.scs", "twodim": "right"}'},selectRoof(){c["a"].state.bmurl='{ "select": "[9264,9265,9263]", "location": "%252Fassets%252Fbup.scs", "twodim": "right"}'},async contentListener(e){if("string"!=typeof e.data)return;const t=e.data+"";console.log("Did receive message: "+t);const a=JSON.parse(t);console.log("Select: "+a.select),a.location&&this.$router.push({path:this.$route.path,query:{location:a.location}}),a.select&&this.$router.push({path:this.$route.path,query:{select:a.select}})}},computed:{},watch:{"$store.state.bmurl":function(e){this.$refs.iframeRef.contentWindow.postMessage(e,"http://localhost:8081")},currentURL:function(e){console.log("URL reported: "+e)}},mounted(){this.loadView()},beforeMount(){console.log("before mounted.."),window.addEventListener("message",this.contentListener)},beforeDestroy(){console.log("before destroy.."),window.removeEventListener("message",this.contentListener)},created(){}},Bt=Mt,Vt=(a("b6f0"),Object(A["a"])(Bt,Lt,Pt,!1,null,"7b6ac88c",null)),Gt=Vt.exports,zt=a("8828"),Wt={name:"TSviewerV",components:{BMDetails:Nt,BMviewer:Gt,Multipane:zt["a"],MultipaneResizer:zt["b"]},data:function(){return{bimVisible:!0,viewHeight:600}},mounted:function(){},methods:{updateCanvasSize(){const e=this.$refs.rightpane;console.log(e);const t=window.innerHeight-60;this.viewHeight=t},toggleViews(){const e=this.$refs.leftpane;this.$refs.rightpane;console.log(e),"70vw"==e.style.width?e.style.width="100vw":e.style.width="70vw",this.updateCanvasSize()},windowResize(){this.updateCanvasSize()},paneresizestarted:function(e){console.log("resize start...")},paneresizestopped:function(e){console.log("resize stop..."),this.updateCanvasSize(),window.dispatchEvent(new Event("resize"))}},mounted(){this.windowResize()},created(){window.addEventListener("resize",this.windowResize)},destroyed(){window.removeEventListener("resize",this.windowResize)}},Ht=Wt,qt=(a("27e7"),Object(A["a"])(Ht,Rt,At,!1,null,"f96e88c6",null)),Yt=qt.exports;x()(qt,{VBtn:_["a"],VIcon:Se["a"]});var Kt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrapper",style:{height:e.viewHeight+"px"},attrs:{scroll:"no"}},[a("v-btn",{staticClass:"white--text",staticStyle:{position:"absolute","z-index":"3",top:"28px",right:"8px"},attrs:{color:"#3577cb"},on:{click:e.toggleViews}},[a("v-icon",[e._v("mdi-arrow-split-vertical")])],1),a("Multipane",{staticClass:"vertical-panes",style:{height:e.viewHeight+"px"},attrs:{scroll:"no",id:"resizer",layout:"vertical"},on:{paneResizeStart:function(t){return e.paneresizestarted(t)},paneResizeStop:function(t){return e.paneresizestopped(t)}}},[a("div",{ref:"leftpane",staticClass:"vertical",staticStyle:{overflow:"scroll"},style:{height:e.viewHeight+"px"}},[a("AssetsList",{attrs:{msg:"Show assets list form"}})],1),a("multipane-resizer",{staticClass:"resizer",style:{height:e.viewHeight+"px"}},[e._v("-")]),a("div",{staticClass:"verticalflex",style:{height:e.viewHeight+"px","z-index":1}},[e.moving?a("div",{staticClass:"overlay1"}):e._e(),a("BMviewer",{ref:"myviewer",staticClass:"viewer",attrs:{msg:"Show asset viewer form"}})],1)],1)],1)},Xt=[],Zt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"inputwrapper",attrs:{align:"left"}},[a("div",[a("h2",[e._v("Select assets")]),a("hr",{staticClass:"hr1"}),a("v-sheet",{staticClass:"pa-4 primary lighten-2"},[a("v-text-field",{attrs:{label:"Search",dark:"",flat:"","solo-inverted":"","hide-details":"",clearable:"","clear-icon":"mdi-close-circle-outline"},model:{value:e.assetsearch,callback:function(t){e.assetsearch=t},expression:"assetsearch"}}),a("v-checkbox",{attrs:{dark:"","hide-details":"",label:"Case sensitive search"},model:{value:e.caseSensitive,callback:function(t){e.caseSensitive=t},expression:"caseSensitive"}})],1),a("v-treeview",{attrs:{items:e.assetitems,search:e.assetsearch,filter:e.filter,transition:!0,"open-on-click":!0,rounded:!0,selectable:"","return-object":"",dense:""},scopedSlots:e._u([{key:"prepend",fn:function(t){var o=t.item;t.open;return[a("v-icon",{attrs:{color:o.color}},[e._v(" "+e._s("mdi-folder"))])]}}]),model:{value:e.assetselection,callback:function(t){e.assetselection=t},expression:"assetselection"}})],1),a("br"),a("div",[a("h2",[e._v("Select items")]),a("hr",{staticClass:"hr1"}),a("br"),a("br"),a("v-btn",{staticClass:"buttonclass",on:{click:e.changeURL}},[e._v("Change URL")]),a("br"),e._v("Dette er en test."),a("br"),a("br"),a("v-btn",{on:{click:e.selectWindow}},[e._v("Window")]),a("br"),a("v-btn",{on:{click:e.selectWalls}},[e._v("Walls")]),a("br"),a("v-btn",{on:{click:e.selectWallsXray}},[e._v("Walls focus")]),a("br"),a("v-btn",{on:{click:e.selectRoof}},[e._v("Roof")]),a("br"),a("v-btn",{on:{click:e.selectSpace}},[e._v("Space")]),a("br"),a("v-btn",{on:{click:e.selectSpaceAndDoor}},[e._v("Space and door")]),a("br"),a("v-btn",{on:{click:e.selectSpaceAndWindow}},[e._v("Space and window")]),a("br"),a("v-btn",{on:{click:e.selectSpaceAndDoorXray}},[e._v("Space and door focus")]),a("br"),a("v-btn",{on:{click:e.selectSpaceAndWindowXray}},[e._v("Space and window focus")]),a("br"),a("v-btn",{on:{click:e.selectSensor}},[e._v("Sensor")]),a("br"),a("v-btn",{on:{click:e.selectSpaceAndSensor}},[e._v("Space and sensor")]),a("br"),a("v-btn",{on:{click:e.selectSpaceAndSensorXray}},[e._v("Space and sensor focus")]),a("br"),a("v-btn",{on:{click:e.selectSensorIsolate}},[e._v("Sensor Isolate")]),a("br"),a("v-btn",{on:{click:e.sendBimID}},[e._v("BIM ID")]),a("br"),a("v-btn",{on:{click:e.sendLocationTwo}},[e._v("Show location")]),a("br"),a("v-btn",{on:{click:e.sendDoubleBimID}},[e._v("BIM ID location and select")]),a("br")],1)])},Jt=[];a("592d"),c["a"].state.serverPath;const $t={};var Qt={id:$t,name:"BWDetails",data(){return{valid:!0,loading:!1,assetselection:[],assetsearch:null,caseSensitive:!1,colorlist:["#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080"],assetitems:[{id:1,name:"Building",color:"#FF0000",children:[{id:2,name:"1. etasje",color:"#0000FF"},{id:3,name:"2. etasje",color:"#00FF00"},{id:4,name:"3. etasje",color:"#0000FF"}]}]}},methods:{changeURL(){c["a"].state.bmurl=c["a"].state.bmurl.replace("33316","33318")},selectWindow(){c["a"].state.bmurl='{ "select": "[1946,1946,1946]", "location": "%252Fassets%252Fbup.scs", "viewtype": "1", "twodim": "hidden" }'},selectWalls(){c["a"].state.bmurl='{ "select": "[544,545,508]", "location": "%252Fassets%252Fbup.scs", "viewtype": "1", "twodim": "hidden" }'},selectWallsXray(){c["a"].state.bmurl='{ "select": "[544,545,508]", "location": "%252Fassets%252Fbup.scs", "viewtype": "2", "twodim": "hidden" }'},selectRoof(){c["a"].state.bmurl='{ "select": "[10674,10675,10673]", "location": "%252Fassets%252Fbup.scs", "viewtype": "1", "twodim": "hidden" }'},selectSpace(){c["a"].state.bmurl='{ "select": "[45]", "location": "%252Fassets%252Fbup.scs", "viewtype": "1", "twodim": "hidden" }'},selectSpaceAndDoor(){c["a"].state.bmurl='{ "select": "[6876]", "location": "45", "viewtype": "1", "twodim": "hidden" }'},selectSpaceAndWindow(){c["a"].state.bmurl='{ "select": "[1946]", "location": "45", "viewtype": "1", "twodim": "hidden" }'},selectSpaceAndDoorXray(){c["a"].state.bmurl='{ "select": "[6876]", "location": "45", "viewtype": "2", "twodim": "hidden" }'},selectSpaceAndWindowXray(){c["a"].state.bmurl='{ "select": "[1946]", "location": "45", "viewtype": "2", "twodim": "hidden" }'},selectSensor(){c["a"].state.bmurl='{ "select": "[10305]", "location": "%252Fassets%252Fbup.scs", "viewtype": "2", "twodim": "hidden" }'},selectSpaceAndSensor(){c["a"].state.bmurl='{ "select": "[10305]", "location": "45", "viewtype": "1", "twodim": "hidden" }'},selectSpaceAndSensorXray(){c["a"].state.bmurl='{ "select": "[10305]", "location": "45", "viewtype": "2", "twodim": "hidden" }'},selectSensorIsolate(){c["a"].state.bmurl='{ "select": "[10305]", "location": "%252Fassets%252Fbup.scs", "viewtype": "3", "twodim": "hidden" }'},sendBimID(){c["a"].state.bmurl='{ "select": "[0T0RBcoDbD4RWUd9JIq73Y]", "location": "%252Fassets%252Fbup.scs", "viewtype": "3", "twodim": "hidden" }'},sendLocationTwo(){c["a"].state.bmurl='{ "select": "[0T0RBcoDbD4RWUd9JIq73Y]", "location": "45", "viewtype": "1", "twodim": "full" }'},sendDoubleBimID(){c["a"].state.bmurl='{ "select": "[0T0RBcoDbD4RWUd9JIq73Y]", "location": "315dfX8sP6svqKOMzcCGRn", "viewtype": "1", "twodim": "hidden" }'}},computed:{filter(){return this.caseSensitive?(e,t,a)=>e[a].indexOf(t)>-1:void 0}},watch:{},mounted(){},created(){},beforeDestroy(){}},ea=Qt,ta=(a("4b02"),Object(A["a"])(ea,Zt,Jt,!1,null,"3799bb6e",null)),aa=ta.exports;x()(ta,{VBtn:_["a"],VCheckbox:ge["a"],VIcon:Se["a"],VSheet:Ee["a"],VTextField:xe["a"],VTreeview:_e["a"]});var oa=a("2f62"),sa={name:"AssetslistV",components:{AssetsList:aa,BMviewer:Gt,Multipane:zt["a"],MultipaneResizer:zt["b"]},data:function(){return{bimVisible:!0,viewHeight:600,moving:!1}},methods:{...Object(oa["c"])("bv",["RESIZE"]),updateCanvasSize(){const e=this.$refs.myviewer;console.log(e);const t=window.innerHeight-60;this.viewHeight=t;const a=e.$el.clientWidth+10;console.log("Width is: "+a)},toggleViews(){const e=this.$refs.leftpane;console.log(e),e.clientWidth>0?e.style.width="0vw":e.style.width="100vw",this.updateCanvasSize()},windowResize(){this.updateCanvasSize()},paneresizestarted:function(e){console.log("resize start..."),this.moving=!0},paneresizestopped:function(e){console.log("resize stop..."),this.updateCanvasSize(),window.dispatchEvent(new Event("resize")),this.moving=!1}},mounted(){this.windowResize()},created(){window.addEventListener("resize",this.windowResize)},destroyed(){window.removeEventListener("resize",this.windowResize)}},ra=sa,na=(a("daa1"),Object(A["a"])(ra,Kt,Xt,!1,null,"9bd36606",null)),ia=na.exports;x()(na,{VBtn:_["a"],VIcon:Se["a"]});var la=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrapper",style:{height:e.viewHeight+"px"},attrs:{scroll:"no"}},[a("v-btn",{staticClass:"white--text",staticStyle:{position:"absolute","z-index":"3",top:"28px",right:"8px"},attrs:{color:"#3577cb"},on:{click:e.toggleViews}},[a("v-icon",[e._v("mdi-arrow-split-vertical")])],1),a("Multipane",{staticClass:"vertical-panes",style:{height:e.viewHeight+"px"},attrs:{scroll:"no",id:"resizer",layout:"vertical"},on:{paneResizeStart:function(t){return e.paneresizestarted(t)},paneResizeStop:function(t){return e.paneresizestopped(t)}}},[a("div",{ref:"leftpane",staticClass:"vertical",staticStyle:{overflow:"scroll"},style:{height:e.viewHeight+"px"}},[a("Capacity",{attrs:{msg:"Show capacity form"}})],1),a("multipane-resizer",{staticClass:"resizer",style:{height:e.viewHeight+"px"}},[e._v("-")]),a("BIMviewer",{ref:"myviewer",staticClass:"verticalflex",style:{height:e.viewHeight+"px"},attrs:{msg:"Show bimviewer form"}})],1)],1)},ca=[],da={name:"CapacityV",components:{Capacity:Te,BIMviewer:vt["a"],Multipane:zt["a"],MultipaneResizer:zt["b"]},data:function(){return{bimVisible:!0,viewHeight:600}},methods:{...Object(oa["c"])("bv",["RESIZE"]),updateCanvasSize(){const e=this.$refs.myviewer;console.log(e);const t=window.innerHeight-60;this.viewHeight=t;const a=e.$el.clientWidth+10;console.log("Width is: "+a),c["a"].state.bv.renderer.setSize(a,t),c["a"].state.bv.twodim?(c["a"].state.bv.labelrenderer.setSize(a,t),c["a"].state.bv.twodimcamera.left=a/-2,c["a"].state.bv.twodimcamera.right=a/2,c["a"].state.bv.twodimcamera.top=t/2,c["a"].state.bv.twodimcamera.bottom=t/-2,c["a"].state.bv.twodimcamera.updateProjectionMatrix()):c["a"].state.bv.thirdperson?(c["a"].state.bv.thirdpersoncamera.aspect=a/t,c["a"].state.bv.thirdpersoncamera.updateProjectionMatrix()):(c["a"].state.bv.labelrenderer.setSize(a,t),c["a"].state.bv.camera.aspect=a/t,c["a"].state.bv.camera.updateProjectionMatrix())},toggleViews(){const e=this.$refs.leftpane;console.log(e),e.clientWidth>0?e.style.width="0vw":e.style.width="100vw",this.updateCanvasSize()},windowResize(){this.updateCanvasSize()},paneresizestarted:function(e){console.log("resize start...")},paneresizestopped:function(e){console.log("resize stop..."),this.updateCanvasSize(),window.dispatchEvent(new Event("resize"))}},mounted(){this.windowResize()},created(){window.addEventListener("resize",this.windowResize)},destroyed(){window.removeEventListener("resize",this.windowResize)}},ua=da,ha=(a("40d5"),Object(A["a"])(ua,la,ca,!1,null,"60483d9c",null)),ga=ha.exports;x()(ha,{VBtn:_["a"],VIcon:Se["a"]});var ma=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"feedback"},[a("FilesLib",{attrs:{msg:"Show files library form"}})],1)},pa=[],fa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"wrapper"},on:{drop:function(t){return t.preventDefault(),e.addFile.apply(null,arguments)},dragover:function(e){e.preventDefault()}}},[a("div",{staticClass:"left",attrs:{align:"left"}},[e.files.length>0?a("v-card",{staticClass:"mx-auto",staticStyle:{"margin-bottom":"10px"}},[a("div",{staticStyle:{"margin-bottom":"20px"}},[a("v-subheader",[e._v("Upload files (drag files in here..)")]),e._l(e.files,(function(t){return a("v-list-item",{key:t.name,on:{click:function(e){}}},[a("div",{staticClass:"icon",domProps:{innerHTML:e._s(e.svgFile(t.name))}}),a("v-list-item-content",[a("v-list-item-title",{key:e.currentUploading,domProps:{textContent:e._s(t.name)}}),a("v-list-item-subtitle",[e._v(e._s(e._f("kb")(t.size))+" kb")])],1),e.currentUploading==t.name?a("v-progress-circular",{key:e.currentUploading,staticStyle:{width:"20px",height:"20px","margin-left":"5px","margin-right":"5px"},attrs:{indeterminate:"",color:"primary"}}):e._e(),a("v-list-item-action",[a("button",{attrs:{title:"Remove"},on:{click:function(a){return e.removeFile(t)}}},[e._v("X")])])],1)})),a("v-btn",{staticClass:"mr-4",staticStyle:{"margin-bottom":"10px","margin-left":"10px"},attrs:{disabled:e.uploadDisabled,color:"success"},on:{click:e.startUpload}},[e._v(" Upload ")])],2)]):e._e(),a("v-card",{staticClass:"mx-auto",attrs:{width:"100%"}},[a("div",{staticClass:"filemenu",staticStyle:{width:"100%","text-align":"right","background-color":"#3577cb"}},[a("span",[""!=e.parentContainer?a("v-btn",{staticStyle:{"margin-left":"0px","margin-right":"auto"},attrs:{icon:""},on:{click:e.goToParentContainer}},[a("v-icon",{staticStyle:{color:"white"}},[e._v("mdi-arrow-left")])],1):e._e()],1),a("span",[e.loading?a("v-progress-circular",{key:e.loading,staticStyle:{width:"20px",height:"20px","margin-right":"15px"},attrs:{indeterminate:"",color:"white"}}):e._e(),a("v-btn",{staticStyle:{"margin-left":"auto","margin-right":"10px"},attrs:{icon:""},on:{click:function(t){return e.goToPodSelect()}}},[a("v-icon",{staticStyle:{color:"white"}},[e._v("mdi-database-marker")])],1),a("v-btn",{staticStyle:{"margin-left":"auto","margin-right":"10px"},attrs:{icon:""},on:{click:function(t){e.dialog=!0}}},[a("v-icon",{staticStyle:{color:"white"}},[e._v("mdi-folder-plus-outline")])],1),a("v-btn",{staticStyle:{"margin-left":"auto","margin-right":"10px"},attrs:{icon:""},on:{click:function(t){return e.reloadData()}}},[a("v-icon",{staticStyle:{color:"white"}},[e._v("mdi-reload")])],1)],1)]),a("v-divider",{staticStyle:{"background-color":"lightgray"},attrs:{dark:""}}),a("v-list",{attrs:{"two-line":"",subheader:""}},[a("v-subheader",[e._v(e._s(e.$t("text_folders")))]),e._l(e.items,(function(t){return a("v-list-item",{key:t.title,style:{"background-color":t.uri==e.currentContainer?"lightgray":"white"},on:{click:function(a){return e.containerSelected(t.uri)}}},[a("div",{staticClass:"icon",domProps:{innerHTML:e._s(e.svgFile(t.name))}}),a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:e._s(t.title)}}),a("v-list-item-subtitle",{domProps:{textContent:e._s(t.subtitle)}})],1),a("v-list-item-action",[a("v-btn",{attrs:{icon:""}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[e._v("mdi-information")])],1)],1)],1)})),a("v-divider",{staticStyle:{"background-color":"lightgray"},attrs:{dark:""}}),a("v-subheader",[e._v(e._s(e.$t("text_files")))]),e._l(e.filelistitems,(function(t){return a("v-list-item",{key:t.title,on:{click:function(a){return e.fileSelected(t.uri)}}},[a("div",{staticClass:"icon",domProps:{innerHTML:e._s(e.svgFile(t.filename))}}),a("v-list-item-content",[a("v-list-item-title",{domProps:{textContent:e._s(t.title)}}),a("v-list-item-subtitle",{domProps:{textContent:e._s(t.subtitle)}})],1),a("v-list-item-action",["unstarted"===t.crossLinkStatus?a("v-tooltip",{attrs:{left:""},scopedSlots:e._u([{key:"activator",fn:function(o){var s=o.on,r=o.attrs;return[a("v-btn",e._g(e._b({attrs:{icon:"",alt:"Start crosslink"},on:{click:function(a){return e.startCrossLink(t.uri)}}},"v-btn",r,!1),s),[a("v-icon",{attrs:{color:"blue lighten-1"}},[e._v("mdi-vector-polyline-plus")])],1)]}}],null,!0)},[a("span",[e._v("Start linking file")])]):e._e(),"processing"===t.crossLinkStatus?a("v-btn",{attrs:{icon:""}},[a("v-icon",{attrs:{color:"red lighten-1"}},[e._v("mdi-cog-play")])],1):e._e(),"linked"===t.crossLinkStatus?a("v-btn",{attrs:{icon:""}},[a("v-icon",{attrs:{color:"green lighten-1"}},[e._v("mdi-vector-polyline")])],1):e._e()],1),t.loading?a("v-progress-circular",{key:t.loading,staticStyle:{width:"20px",height:"20px","margin-right":"0px"},attrs:{indeterminate:"",color:"blue"}}):e._e()],1)}))],2)],1)],1),a("div",{ref:"filedetails",staticClass:"right",attrs:{align:"left"}},[a("v-card",{staticClass:"mx-auto"},[a("div",{staticStyle:{"margin-bottom":"20px"}},[a("v-list-item",{attrs:{"three-line":""}},[a("v-list-item-content",[a("div",{staticClass:"overline mb-4"},[e._v(e._s(e.$t("text_file_details")))]),a("v-list-item-title",{staticClass:"headline mb-1",domProps:{textContent:e._s(e.selectedFileName)}}),a("v-list-item-subtitle",{domProps:{textContent:e._s(decodeURI(e.selectedFileURI))}})],1),a("v-list-item-avatar",{attrs:{tile:"",size:"80"}},[a("div",{staticClass:"iconlarge",domProps:{innerHTML:e._s(e.svgFile(e.selectedFileName))}})])],1),a("br"),e.selectedFileURI.length>=1?a("div",[a("v-divider",{staticStyle:{"background-color":"lightgray"},attrs:{dark:""}}),a("v-list-item",[a("v-list-item-content",[a("span",{domProps:{textContent:e._s(e.$t("text_last_changed")+" "+e.selectedFileChange)}})])],1),a("v-divider",{staticStyle:{"background-color":"lightgray"},attrs:{dark:""}}),a("v-list-item-action",[a("span",[e._v(e._s(e.$t("text_download"))+" "),a("v-btn",{attrs:{icon:""},on:{click:function(t){return e.download(e.selectedFileURI,e.selectedFileName)}}},[a("v-icon",{attrs:{color:"blue lighten-1"}},[e._v("mdi-download")])],1),e.downloading?a("v-progress-circular",{staticStyle:{width:"20px",height:"20px","margin-left":"5px","margin-right":"5px"},attrs:{indeterminate:"",color:"primary"}}):e._e(),e._v("   Open file:   "),e.selectedFileURI.includes(".docx")||e.selectedFileURI.includes(".xls")?a("v-btn",{attrs:{icon:""},on:{click:function(t){return e.openDocumentInZoho(e.selectedFileURI,e.selectedFileName)}}},[a("v-icon",{attrs:{color:"blue lighten-1"}},[e._v("mdi-file")])],1):e._e(),e.selectedFileURI.includes(".pdf")?a("v-btn",{attrs:{icon:""},on:{click:function(t){return e.goToPDFviewer(e.selectedFileURI)}}},[a("v-icon",{attrs:{color:"red lighten-1"}},[e._v("mdi-file")])],1):e._e(),e._v("   Delete:   "),a("v-btn",{attrs:{icon:""},on:{click:function(t){return e.deleteFile(e.selectedFileURI,e.selectedFileName)}}},[a("v-icon",{attrs:{color:"red lighten-1"}},[e._v("mdi-trash-can-outline")])],1)],1)])],1):e._e()],1),a("div")])],1),a("v-row",{attrs:{justify:"center"}},[a("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v(e._s(e.$t("text_create_container")))])]),a("div",{staticStyle:{"margin-left":"25px","text-align":"left"},domProps:{innerHTML:e._s(e.currentContainer)}}),a("v-card-text",[a("v-container",{staticStyle:{"background-color":"white"}},[a("v-row",[a("v-text-field",{attrs:{label:e.$t("text_container_name")},model:{value:e.createContainerName,callback:function(t){e.createContainerName=t},expression:"createContainerName"}})],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialog=!1}}},[e._v(e._s(e.$t("text_cancel")))]),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){return e.createContainer(e.createContainerName)}}},[e._v(e._s(e.$t("text_create")))]),e.loading?a("v-progress-circular",{staticStyle:{width:"20px",height:"20px","margin-left":"5px","margin-right":"5px"},attrs:{indeterminate:"",color:"primary"}}):e._e()],1)],1)],1)],1),a("v-row",{attrs:{justify:"center"}},[a("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.alertBox,callback:function(t){e.alertBox=t},expression:"alertBox"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[e._v(e._s(e.alertTitle))])]),a("div",{staticStyle:{"margin-left":"25px","text-align":"left"},domProps:{innerHTML:e._s(e.alertText)}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.alertBox=!1}}},[e._v(e._s(e.$t("text_dismiss")))])],1)],1)],1)],1)],1)},ba=[],va=a("3e73");a("bc3a");const ya=a("dae0"),wa=(new ya.Store,a("592d")),Ia=a("3717");a("d2b7"),new(a("c513").DataFactory),a("5189"),a("2f5f").toRdf;let Sa=Ea();const Ra={};function Aa(e,t){let a=!1;setTimeout((function(){e.readyState===WebSocket.OPEN?(console.log("Connection is made"),null!=t&&setTimeout((function(){t()}),500)):(console.log("wait for connection..."),a||(e=Ea()),Aa(e,t))}),1e3)}function Ea(){let e=new WebSocket("ws://localhost:8003");return e.onopen=function(e){console.log("[open] Connection established")},e.onmessage=function(e){console.log(e.data),e.data.includes("http")&&tn.push({path:"/fileedit",query:{location:"",select:e.data}})},e.onclose=function(e){e.wasClean?console.log(`[close] Connection closed cleanly, code=${e.code} reason=${e.reason}`):console.log("[close] Connection died")},e.onerror=function(e){console.log("[error] "+e.message)},e}function xa(e,t,a){c["a"].state.rs.rdfStore.add(e,t,a,wa.default)}function _a(e){return[...new Uint8Array(e)].map(e=>e.toString(16).padStart(2,"0")).join("")}var ja={id:Ra,name:"FilesLib",data(){return{valid:!0,currentPOD:this.$route.query.location,currentContainer:"",uploadDisabled:!0,files:[],currentUploading:"",uploadPercentage:0,fileDetails:{},selectedFileURI:"",selectedFileName:"",selectedFileChange:"",createContainerName:"",crosslinkFunctionURI:"",parentContainer:"",loading:!1,downloading:!1,dialog:!1,alertBox:!1,alertTitle:"",alertText:"",items:[{uri:this.$route.query.location,filename:"folder",title:"Home",subtitle:""}],filelistitems:[]}},methods:{scrollMeTo(e){var t=this.$refs[e],a=t.offsetTop;window.scrollTo(0,a)},checklogin(){console.log(window.solid.session.info),window.solid.session.info.isLoggedIn?console.log("Test logged in"):(console.log("Is logged out, reroute"),this.$router.push({path:"/"}))},addFile(e){let t=e.dataTransfer.files;t&&([...t].forEach(e=>{this.files.push(e)}),this.uploadDisabled=!1)},removeFile(e){this.files=this.files.filter(t=>t!=e)},goToPodSelect(){this.$router.push({path:"PodSelect",query:{location:this.$route.query.location,select:this.$route.query.select}})},goToPDFviewer(e){this.$router.push({path:"PDFviewer",query:{location:this.$route.query.location,select:e}})},async openDocumentInZoho(e,t){Sa=Ea(),Aa(Sa,(function(){Sa.send("filename:"+t)})),this.downloading=!0;try{const a=await window.solid.session.fetch(e,{method:"GET",credentials:"include"});console.log(a),console.log("Sending to server"),Sa.binaryData="hex";const o=Ia.createWriteStream(t),s=o.getWriter(),r=a.body.getReader();Sa=Ea();const n=()=>r.read().then(({value:e,done:t})=>{if(!t)return Aa(Sa,(function(){Sa.send(_a(e))})),s.write(e),s.ready.then(n);Aa(Sa,(function(){Sa.send("done:")})),s.close()});await n().then(()=>console.log("Closed the stream, Done writing")).catch(e=>console.log(e))}catch(a){console.log(a)}},async download(e,t){this.downloading=!0;try{const a=await window.solid.session.fetch(e,{method:"GET",credentials:"include"});console.log(a);const o=Ia.createWriteStream(t),s=o.getWriter(),r=a.body.getReader(),n=()=>r.read().then(({value:e,done:t})=>{if(!t)return s.write(e),s.ready.then(n);s.close()});await n().then(()=>console.log("Closed the stream, Done writing")).catch(e=>console.log(e)),this.downloading=!1}catch(a){console.log(a)}},async deleteFile(e,t){this.loading=!0;try{c["a"].state.rs.rdfStore.match(null,null,wa.sym(e)).forEach(e=>{console.log("Removing triple..."),c["a"].state.rs.rdfStore.removeStatement(e)}),c["a"].state.rs.rdfStore.match(wa.sym(e),null,null).forEach(e=>{console.log("Removing triple..."),c["a"].state.rs.rdfStore.removeStatement(e)});const a=await window.solid.session.fetch(e,{method:"DELETE",credentials:"include"});console.log(a),404!=a.status?(this.alertTitle="DELETED",this.alertText="File: "+t+" has been deleted!",this.alertBox=!0,this.loading=!1):(this.alertTitle="ERROR",this.alertText="File: "+t+" not found!",this.alertBox=!0,this.loading=!1),this.reloadData()}catch(a){console.log(a)}},startUpload(){this.uploadDisabled=!0;let e=new FormData;this.files.forEach((t,a)=>{e.append("file"+(a+1),t)}),this.files.length>0&&this.uploadFile(this.files[0],0)},async uploadFile(e,t){this.currentUploading=this.files[t].name,console.log("Uploading: "+this.currentUploading),this.files[t].name.includes(".zip")?(console.log("Trying to bulk upload zip."),window.solid.session.fetch(this.currentContainer+e.name,{method:"PUT",credentials:"include",body:e,headers:{link:'<https://trinity.graphmetrix.net/node/t_2qv>; rel="type"'}}).then(t=>{console.log("done uploading",t),this.removeFile(e),this.files.length>0&&this.uploadFile(this.files[0],0),0==this.files.length&&this.reloadData()}).catch(e=>{console.error(JSON.stringify(e.message))})):window.solid.session.fetch(this.currentContainer+e.name,{method:"PUT",credentials:"include",body:e,headers:{"Content-Type":""},onUploadProgress:function(e){this.uploadPercentage=parseInt(Math.round(e.loaded/e.total*100)),console.log(this.uploadPercentage)}.bind(this)}).then(t=>{console.log("done uploading",t),this.removeFile(e),this.files.length>0&&this.uploadFile(this.files[0],0),0==this.files.length&&this.reloadData()}).catch(e=>{console.error(JSON.stringify(e.message))})},fileSelected(e){this.$route.query.select!=e&&this.$router.push({path:this.$route.path,query:{location:this.$route.query.location,select:e}}),this.scrollMeTo("filedetails"),console.log("Selected file URI: ",e);const t=this.filelistitems.find(t=>t.uri===e);this.selectedFileName=t.filename,this.selectedFileURI=t.uri,this.selectedFileChange=t.subtitle,console.log(t),this.filelDetails=t},containerSelected(e){this.currentContainer!=e&&(this.parentContainer="",this.currentContainer=e,this.filelistitems=[],console.log("Selected file URI: ",e),this.reloadData())},goToParentContainer(){this.currentContainer=this.parentContainer,this.parentContainer="",this.filelistitems=[],this.reloadData()},reloadData(){console.log("Trying to reload!"),this.getContainersFromURI(this.currentContainer),this.getFilesFromURI(this.currentContainer)},getTripleMatches(e,t){let a=[];return e.forEach((o,s)=>{0==s?t.match(e[s].subject,e[s].predicate,e[s].object).forEach(e=>{a.push(e)}):t.match(e[s].subject,e[s].predicate,e[s].object).forEach(e=>{a.includes(e)?(a=this.arrayRemove(a,e),a.push(e)):a.push(e)})}),a},arrayRemove(e,t){return e.filter((function(e){return e!=t}))},getFilesFromURI(e){this.loading=!0;var t=performance.now();re["a"].fetchAndSaveTurtle(e,!0).then(a=>{var o=performance.now();console.log(`Fetch URI took: ${o-t} milliseconds`),console.log(a),this.filelistitems=[];let s=[],r=[],n=c["a"].state.rs.rdfStore.match(wa.sym(this.currentContainer),d["c"].LDP("contains"),null);n.forEach(e=>{s.includes(e.object.value)||s.push(e.object.value)});let i=c["a"].state.rs.rdfStore.match(null,d["c"].RDF("type"),d["c"].REG("file"));return i.forEach(e=>{!r.includes(e.subject.value)&&s.includes(e.subject.value)&&r.push(e.subject.value)}),n=c["a"].state.rs.rdfStore.match(null,d["c"].RDF("type"),null),n.forEach(e=>{r.includes(e.subject.value)||!s.includes(e.subject.value)||!e.object.value.includes("http://www.w3.org/ns/iana/")&&e.object.value!=d["c"].REG("file")||r.push(e.subject.value)}),n=c["a"].state.rs.rdfStore.match(null,d["c"].NEO("i_function"),d["c"].RDFS("label")),this.crosslinkFunctionURI="",n.forEach(t=>{let a=e.slice(0,-1).substring(e.slice(0,-1).lastIndexOf("/")+1),o=c["a"].state.rs.rdfStore.match(wa.sym(t.subject.value),d["c"].NEO("o_result"),null);o[0].object.value.toLowerCase().includes(a)?(console.log("Did find URI for Crosslink function: "+t.subject.value),this.crosslinkFunctionURI=t.subject.value.substring(t.subject.value.lastIndexOf("/")+1),console.log(this.crosslinkFunctionURI)):console.log("Did NOT find URI for Crosslink function: "+t.subject.value)}),r.forEach((e,t)=>{let a=c["a"].state.rs.rdfStore.match(wa.sym(e),d["c"].RDFS("label"),null);a.forEach(t=>{console.log("File: ",t.object.value);let a=!1;this.filelistitems.forEach((e,o)=>{e.title===t.object.value&&(a=!0)});let o="",s=c["a"].state.rs.rdfStore.match(wa.sym(e),d["c"].NEO("m_last-change"),null);if(s[0]){let e=s[0].object.value;if(e){let t=c["a"].state.rs.rdfStore.match(wa.sym(e),d["c"].NEO("t_start"),null),a=t[0].object.value;if(a){let e=c["a"].state.rs.rdfStore.match(wa.sym(a),d["c"].NEO("o_result"),null);o=e[0].object.value}}o=h()(o).format("MMMM Do YYYY, HH:mm:ss")}let r=!1;".pdf"===e.substr(e.length-4)&&(r=!0);let n=c["a"].state.rs.rdfStore.match(wa.sym(t.subject.value),d["c"].RDF("type"),d["c"].LDP("BasicContainer"))[0];a||n||this.filelistitems.push({uri:t.subject.value,filename:t.object.value,title:t.object.value,subtitle:o,crossLinkStatus:"none",loading:r})})}),r.forEach((e,t)=>{var a="unstarted";if(".pdf"===e.substr(e.length-4)){re["a"].fetchAndSaveTurtle(wa.sym(e),!0).then(t=>{let o=this.filelistitems.find(t=>t.uri===e),s=c["a"].state.rs.rdfStore.match(wa.sym(e),d["c"].NEO("c_trinpod-processing"),null);console.log(s),s[0]&&(a="processing"),s=c["a"].state.rs.rdfStore.match(wa.sym(e),d["c"].NEO("c_trinpod-read"),null),console.log(s),s[0]&&(a="linked"),s=c["a"].state.rs.rdfStore.match(wa.sym(e),d["c"].NEO("c_crosslink"),null),s[0]&&(a="linked"),console.log("cStatus: "+a),o.crossLinkStatus=a,o.loading=!1})}}),this.loading=!1,a})},getContainersFromURI(e){this.checkIfParentFolder(e);re["a"].fetchAndSaveTurtle(e,!0).then(e=>{this.items=[];let t=[],a=[];t.push(this.currentContainer);let o=c["a"].state.rs.rdfStore.match(wa.sym(this.currentContainer),d["c"].LDP("contains"),null);return o.forEach(e=>{t.includes(e.object.value)||t.push(e.object.value)}),o=c["a"].state.rs.rdfStore.match(null,d["c"].RDF("type"),d["c"].LDP("BasicContainer")),o.forEach(e=>{!a.includes(e.subject.value)&&t.includes(e.subject.value)&&a.push(e.subject.value)}),a.forEach((e,t)=>{console.log(e);let a=c["a"].state.rs.rdfStore.match(wa.sym(e),d["c"].RDFS("label"),null);if(a.forEach(t=>{console.log("Container: ",t.object.value);let a=!1;this.items.forEach((e,o)=>{e.title===decodeURI(t.object.value)&&(a=!0)});let o=this.getLastChangedTime(e);a||this.items.push({uri:t.subject.value,name:decodeURI(t.object.value),title:decodeURI(t.object.value),subtitle:o})}),0===a.length){let t=this.getLastChangedTime(e);this.items.push({uri:e,name:decodeURI(g["a"].getCharactersAfter(g["a"].removeLastCharacter(e),"/")),title:decodeURI(g["a"].getCharactersAfter(g["a"].removeLastCharacter(e),"/")),subtitle:t})}}),e})},getLastChangedTime(e){let t="",a=c["a"].state.rs.rdfStore.match(wa.sym(e),d["c"].NEO("m_last-change"),null),o=a[0]?a[0].object.value:null;if(o){let e=c["a"].state.rs.rdfStore.match(wa.sym(o),d["c"].NEO("t_start"),null);if(e[0])return"";let a=e[0].object.value;if(a){let e=c["a"].state.rs.rdfStore.match(wa.sym(a),d["c"].NEO("o_result"),null);t=e[0].object.value}}return h()(t).format("MMMM Do YYYY, HH:mm:ss")},checkIfParentFolder(e){let t=c["a"].state.rs.rdfStore.match(null,d["c"].LDP("contains"),wa.sym(e));t.forEach(e=>{console.log("Parent found:",e.subject.value),e.subject.value!=this.currentPOD?this.parentContainer=e.subject.value:this.parentContainer=""})},async createContainer(e){let t=this.currentContainer+encodeURI(e)+"/";if(e.length>=3){this.loading=!0;try{console.log("Trying to create container.."),await window.solid.session.fetch(t,{method:"PUT",credentials:"include",body:'<> <http://www.w3.org/2000/01/rdf-schema#label> "'+encodeURI(e)+'" .',headers:{"Content-Type":"text/turtle",link:'<http://www.w3.org/ns/ldp#Container>; rel="type", <http://www.w3.org/ns/ldp#BasicContainer>; rel="type"'}}).then(e=>{console.log("Container response:"),console.log(e),this.dialog=!1,this.loading=!1,this.reloadData(),this.createContainerName=""})}catch(a){console.log(a)}}else console.log("Containername is too short.")},async startCrossLink(e){const t=new Date,a=new Date(t);this.filelistitems.forEach((t,a)=>{t.uri===e&&(t.loading=!0)});let o="INSERT DATA {@prefix u1: <"+c["a"].state.webId.slice(0,-1)+'node/>.\n@prefix solid: <http://www.w3.org/ns/solid/terms#>.\n@prefix neo: <https://neo.graphmetrix.net/node/>.\n@prefix ldp: <http://www.w3.org/ns/ldp#>.\n@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.\n@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.\n@prefix sio: <http://semanticscience.org/resource/>.\n@prefix acl: <http://www.w3.org/ns/auth/acl#>.\n@prefix vcard: <http://www.w3.org/2006/vcard/ns#>.\n\n_:13 neo:i_function <http://purl.org/NET/c4dm/timeline.owl#at>;\n    neo:o_result "'+a.toISOString()+'"^^<http://www.w3.org/2001/XMLSchema#dateTime>.\n_:12 neo:t_start _:13;\n    <http://purl.obolibrary.org/obo/OBI_0000308> u1:'+this.crosslinkFunctionURI+".\n<"+e+"> sio:SIO_000230 _:12.\n}";if(console.log(o),this.crosslinkFunctionURI.length>=1){let t=await window.solid.session.fetch(this.currentPOD+"node/Substance",{method:"PATCH",credentials:"include",body:o,headers:{"Content-Type":"application/sparql-update"}});console.log(t),xa(wa.sym(e),d["c"].NEO("c_trinpod-processing"),a.toISOString()),this.reloadData()}else alert("Unable to get required function for crosslink!!")}},computed:{svgFile(){return e=>Object(va["getIcon"])(e).svg},checkCurrentUploading(){return e=>e==this.currentUploading}},watch:{files(){console.log(this.files)},currentUploading(){console.log(this.currentUploading)}},mounted(){this.checklogin(),this.currentPOD=this.$route.query.location,this.currentContainer=this.$route.query.location+"home/",this.$route.query.location||this.goToPodSelect(),this.reloadData();document.getElementById("form")},created(){console.log("connecting.."),Sa=Ea()}},Ta=ja,Fa=(a("15b3"),a("ce7e")),Oa=a("8860"),Ca=a("da13"),Na=a("1800"),La=a("8270"),Pa=a("5d23"),Da=a("2fa4"),ka=a("e0c7"),Ua=a("3a2f"),Ma=Object(A["a"])(Ta,fa,ba,!1,null,"181dfa8c",null),Ba=Ma.exports;x()(Ma,{VBtn:_["a"],VCard:ue["a"],VCardActions:he["a"],VCardText:he["c"],VCardTitle:he["d"],VContainer:j["a"],VDialog:fe["a"],VDivider:Fa["a"],VIcon:Se["a"],VList:Oa["a"],VListItem:Ca["a"],VListItemAction:Na["a"],VListItemAvatar:La["a"],VListItemContent:Pa["a"],VListItemSubtitle:Pa["b"],VListItemTitle:Pa["c"],VProgressCircular:F["a"],VRow:Re["a"],VSpacer:Da["a"],VSubheader:ka["a"],VTextField:xe["a"],VTooltip:Ua["a"]});var Va={name:"FilesLibV",components:{FilesLib:Ba}},Ga=Va,za=Object(A["a"])(Ga,ma,pa,!1,null,null,null),Wa=za.exports,Ha=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"feedback"},[a("PodSelect",{attrs:{msg:"Show files library form"}})],1)},qa=[],Ya=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"wrapper",attrs:{id:"wrapper"},on:{drop:function(t){return t.preventDefault(),e.addFile.apply(null,arguments)},dragover:function(e){e.preventDefault()}}},[o("div",{staticClass:"left",attrs:{align:"left"}},[o("v-card",{staticClass:"wrapper",attrs:{width:"100%"}},[o("div",{staticClass:"filemenu",staticStyle:{width:"100%","text-align":"right","background-color":"#3577cb"}},[o("span",[o("v-btn",{staticStyle:{"margin-left":"0px","margin-right":"auto"},attrs:{icon:""},on:{click:e.goBack}},[o("v-icon",{staticStyle:{color:"white"}},[e._v("mdi-arrow-left")])],1)],1),o("span",[e.loading?o("v-progress-circular",{key:e.loading,staticStyle:{width:"20px",height:"20px","margin-right":"15px"},attrs:{indeterminate:"",color:"white"}}):e._e(),o("v-btn",{staticStyle:{"margin-left":"auto","margin-right":"10px"},attrs:{icon:""},on:{click:function(t){return e.reloadData(!0)}}},[o("v-icon",{staticStyle:{color:"white"}},[e._v("mdi-reload")])],1)],1)]),o("v-divider",{staticStyle:{"background-color":"lightgray"},attrs:{dark:""}}),o("v-list",{attrs:{"two-line":"",subheader:""}},[o("v-subheader",[e._v(e._s(e.$t("text_pods")))]),e._l(e.podlist,(function(t){return o("v-list-item",{key:t.subtitle,class:{container:t.subtitle.substring(0,t.subtitle.length-1)==e.currentPod},on:{click:function(a){return e.podSelected(t.subtitle)}}},[e._l(t.podlevel,(function(e){return[o("span",{staticStyle:{width:"10px"}})]})),"Building"==t.podtype?o("img",{staticClass:"icon",attrs:{src:a("443f")}}):"Site"==t.podtype?o("img",{staticClass:"icon",attrs:{src:a("c296")}}):"Personal"==t.podtype?o("img",{staticClass:"icon",attrs:{src:a("79b3")}}):"Organization"==t.podtype?o("img",{staticClass:"icon",attrs:{src:a("114b")}}):e._e(),o("v-list-item-content",[o("v-list-item-title",{domProps:{textContent:e._s(t.title)}}),o("v-list-item-subtitle",{domProps:{textContent:e._s(t.subtitle)}})],1),o("v-list-item-action",[o("v-btn",{attrs:{icon:""}},[o("v-icon",{attrs:{color:"grey lighten-1"}},[e._v("mdi-information")])],1)],1)],2)}))],2)],1)],1),o("div",{ref:"filedetails",staticClass:"right",attrs:{align:"left"}},[""!=e.selectedPod.title?o("v-card",{staticClass:"mx-auto"},[o("div",{staticStyle:{"margin-bottom":"20px"}},[o("v-list-item",{attrs:{"three-line":""}},[o("v-list-item-content",[o("div",{staticClass:"overline mb-4"},[e._v(e._s(e.$t("text_pod_details")))]),o("v-list-item-title",{staticClass:"headline mb-1",domProps:{textContent:e._s(e.selectedPod.title)}}),o("v-list-item-subtitle",{domProps:{textContent:e._s(e.selectedPod.subtitle)}}),o("br"),e._v(" "+e._s(e.selectedPod.podtype+" POD")+" ")],1),"Building"==e.selectedPod.podtype?o("img",{staticClass:"iconbig",attrs:{src:a("443f")}}):"Site"==e.selectedPod.podtype?o("img",{staticClass:"iconbig",attrs:{src:a("c296")}}):"Personal"==e.selectedPod.podtype?o("img",{staticClass:"iconbig",attrs:{src:a("79b3")}}):"Organization"==e.selectedPod.podtype?o("img",{staticClass:"iconbig",attrs:{src:a("114b")}}):e._e()],1),e.organizationpodSelected?o("div",[o("v-divider",{staticStyle:{"background-color":"lightgray"},attrs:{dark:""}}),o("v-subheader",[e._v(e._s(e.$t("text_employees")))]),e._l(e.employeeList,(function(t){return o("v-list-item",{key:t.subtitle,class:{container:t.subtitle.substring(0,t.subtitle.length-1)==e.currentPod},on:{click:function(a){return e.podSelected(t.subtitle)}}},[o("v-list-item-avatar",{attrs:{color:t.color||"#FF0000",size:"48"}},[o("span",{staticClass:"white--text text-h5"},[e._v(e._s(t.initials))])]),o("v-list-item-content",[o("v-list-item-title",{domProps:{textContent:e._s(t.title)}}),o("v-list-item-subtitle",{domProps:{textContent:e._s(t.subtitle)}})],1),o("v-list-item-action",[o("v-btn",{attrs:{icon:""}},[o("v-icon",{attrs:{color:"grey lighten-1"}},[e._v("mdi-information")])],1)],1)],1)})),o("br"),o("v-divider",{staticStyle:{"background-color":"lightgray"},attrs:{dark:""}}),o("v-subheader",[e._v(e._s(e.$t("text_employee_new")))]),o("div",{staticClass:"inputwrapper"},[o("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[o("v-text-field",{attrs:{label:"Employee URI",required:""},model:{value:e.newEmployeeURI,callback:function(t){e.newEmployeeURI=t},expression:"newEmployeeURI"}}),o("v-btn",{staticClass:"mr-4",attrs:{disabled:!e.valid,color:"success"},on:{click:e.addEmployee}},[e._v(" "+e._s(e.$t("text_add"))+" ")])],1)],1),o("br")],2):e._e()],1),o("div")]):e._e()],1),o("v-row",{attrs:{justify:"center"}},[o("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:e.whatToDoVisible,callback:function(t){e.whatToDoVisible=t},expression:"whatToDoVisible"}},[o("WhatToDo",{attrs:{dialog:e.whatToDoVisible},on:{"update:dialog":function(t){e.whatToDoVisible=t}}})],1)],1)],1)},Ka=[],Xa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-toolbar",{attrs:{dark:"",color:"primary"}},[a("v-btn",{attrs:{icon:"",dark:""},on:{click:e.closeview}},[a("v-icon",[e._v("mdi-close")])],1),a("v-toolbar-title",[e._v(e._s(e.$t("text_what_to_do")))]),a("v-spacer"),a("v-toolbar-items",[a("v-btn",{attrs:{dark:"",text:""},on:{click:function(e){}}},[e._v(" Reload ")])],1)],1),a("v-container",{staticClass:"container"},[a("v-row",[a("v-col",[a("div",{staticClass:"title"},[e._v("Where do you want to start?")]),a("hr",{staticClass:"hr1"})])],1),a("v-row",[a("v-col",[a("v-card",{attrs:{color:"#3577cb",dark:""}},[a("v-card-title",{staticClass:"text-h5"},[e._v(" Get overview of bed capacity for rooms ")]),a("v-card-subtitle",{staticStyle:{"text-align":"left"}},[e._v("You will be sent to the capacity app, where you can select building or site to focus on. You will here be able to look at room bed capacities.")]),a("v-card-actions",[a("v-btn",{attrs:{text:""},on:{click:function(t){return e.followLink("Capacity")}}},[e._v(" START NOW ")])],1)],1)],1)],1),a("v-row",[a("v-col",[a("v-card",{attrs:{color:"#5597eb",dark:""}},[a("v-card-title",{staticClass:"text-h5"},[e._v(" Search for information in all files and data ")]),a("v-card-subtitle",{staticStyle:{"text-align":"left"}},[e._v("You will be sent to search app, where you can search for things located anywhere in your available data. You can find paragraphs, rooms, and building objects.")]),a("v-card-actions",[a("v-btn",{attrs:{text:""},on:{click:function(t){return e.followLink("Search")}}},[e._v(" SEARCH NOW ")])],1)],1)],1)],1),a("v-row",[a("v-col",[a("v-card",{attrs:{color:"#1566ab",dark:""}},[a("v-card-title",{staticClass:"text-h5"},[e._v(" Advanced: Select POD to work on ")]),a("v-card-subtitle",{staticStyle:{"text-align":"left"}},[e._v("You will be sent to the POD selector app, where you will need to select between organization, site and building pods. From there you will have to use the menu to navigate to other apps. The other apps will then use the selected POD as source for data.")]),a("v-card-actions",[a("v-btn",{attrs:{text:""},on:{click:e.closeview}},[e._v(" START NOW ")])],1)],1)],1)],1)],1)],1)},Za=[];const Ja=a("dae0"),$a=(new Ja.Store,a("592d"),{});var Qa={id:$a,name:"WhatToDo",data(){return{documenturl:""}},methods:{closeview(){console.log("Close view"),c["a"].state.whatToDoVisible=!1},reloadview(){},followLink(e){this.$route.path.includes(e)||this.$router.push({path:e,query:{location:this.$route.query.location,select:this.$route.query.select}})}},computed:{},watch:{},mounted(){this.documenturl=this.$route.query.select,this.$route.query.location||this.$router.push({path:this.$route.path,query:{select:this.documenturl}})},created(){}},eo=Qa,to=(a("5300"),a("71d9")),ao=a("2a7f"),oo=Object(A["a"])(eo,Xa,Za,!1,null,"797cdef6",null),so=oo.exports;x()(oo,{VBtn:_["a"],VCard:ue["a"],VCardActions:he["a"],VCardSubtitle:he["b"],VCardTitle:he["d"],VCol:me["a"],VContainer:j["a"],VIcon:Se["a"],VRow:Re["a"],VSpacer:Da["a"],VToolbar:to["a"],VToolbarItems:ao["a"],VToolbarTitle:ao["b"]});const ro=a("dae0"),no=(new ro.Store,a("592d")),io={};var lo={id:io,name:"PodSelect",components:{WhatToDo:so},data(){return{valid:!0,currentPOD:"",currentPod:this.$route.query.location,selectedPod:{filename:"pod",title:"",subtitle:"",parentpod:"",podlevel:0},files:[],fileDetails:{},createContainerName:"",loading:!1,employeeList:[],podlist:[],newEmployeeURI:"",organizationpodSelected:!1,whatToDoVisible:!1}},methods:{checklogin(){console.log(window.solid.session.info),window.solid.session.info.isLoggedIn?console.log("Test logged in"):(console.log("Is logged out, reroute"),this.$router.push({path:"/"}))},goBack(){history.back()},podSelected(e){this.employeeList=[],e="/i"===e.substr(e.length-2)?e.substring(0,e.length-1):e,this.currentPod=e,this.$route.query.location!==e&&this.$router.push({path:this.$route.path,query:{location:e,select:this.$route.query.select}}),console.log("Selected Pod: ",e),this.podlist.filter(t=>t.subtitle==e+"i").forEach((e,t)=>{this.selectedPod=e,e.podtype.includes("Organization")?this.organizationpodSelected=!0:this.organizationpodSelected=!1}),this.getEmployees(e+"i")},reloadData(e){console.log("Trying to reload: "+c["a"].state.webId),this.getPodsFromURI(c["a"].state.webId,e)},getTripleMatches(e,t){let a=[];return e.forEach((o,s)=>{0==s?t.match(e[s].subject,e[s].predicate,e[s].object).forEach(e=>{a.push(e)}):t.match(e[s].subject,e[s].predicate,e[s].object).forEach(e=>{a.includes(e)?(a=this.arrayRemove(a,e),a.push(e)):a.push(e)})}),a},arrayRemove(e,t){return e.filter((function(e){return e!=t}))},async getPodsFromURI(e,t){this.podlist=[],this.loading=!0;let a=[],o=await re["a"].fetchAndSaveTurtle(e,t);console.log(o),a.push(e);let s=!0;while(s){s=!1;let e=c["a"].state.rs.rdfStore.match(null,d["c"].FOAF("maker"),null),o=c["a"].state.rs.rdfStore.match(null,d["c"].RDF("type"),d["c"].ORG("Organization")),r=c["a"].state.rs.rdfStore.match(null,d["c"].ACL("owner"),null),n=c["a"].state.rs.rdfStore.match(null,d["c"].ORG("hasMember"),null),i=c["a"].state.rs.rdfStore.match(null,d["c"].DCTERMS("contributor"),null);o.forEach(t=>{e.push(t)}),r.forEach(t=>{e.push(t)}),n.forEach(t=>{e.push(t)}),i.forEach(t=>{e.push(t)});for(let l=0;l<e.length;l++){const o=e[l].subject.value,r=e[l].object.value;if(o.slice(-2).includes("/i")&&!a.includes(o.substring(0,o.length-2))&&!a.includes(o)){a.push(o);let e=await re["a"].fetchAndSaveTurtle(o,t);e&&(s=!0)}if(r.slice(-2).includes("/i")&&!a.includes(r.substring(0,r.length-2))&&!a.includes(r)){a.push(r);let e=await re["a"].fetchAndSaveTurtle(r,t);e&&(s=!0)}}}console.log(a);for(let r=0;r<a.length;r++)this.podlist.filter(e=>e.subtitle==a[r]).forEach(e=>{try{e.title=c["a"].state.rs.rdfStore.match(no.sym(e.subtitle),d["c"].FOAF("name"),null)[0].object||""}catch(a){console.log(a)}let t=re["a"].parseLinkHeader(e.subtitle);t.type&&(t.type.includes("http://xmlns.com/foaf/0.1/PersonalProfileDocument")||this.podlist.splice(e,1))}),a.forEach((e,t)=>{""==e&&a.splice(t,1)}),r==a.length-1&&(console.log("Listing pods.."),this.setPodNames(a,e))},setPodNames(e,t){let a=[];e.forEach((e,t)=>{e="/i"===e.substr(e.length-2)?e:e+"/i",this.podlist.push({filename:"pod",title:"POD",subtitle:e,parentpod:"",podlevel:0})});let o=0;a.push({filename:"pod",title:"POD",subtitle:t,parentpod:"",podlevel:o,podtype:"Personal"});for(let s=0;s<=20;s++){console.log("Looping round: "+s);let t=!1;if(a.filter(e=>e.podlevel==s).forEach((o,r)=>{const n=[];c["a"].state.rs.rdfStore.match(null,d["c"].FOAF("maker"),no.sym(o.subtitle)).forEach(e=>{n.includes(e)||n.push(e)}),c["a"].state.rs.rdfStore.match(null,d["c"].ORG("hasMember"),no.sym(o.subtitle)).forEach(e=>{n.includes(e)||n.push(e)}),n.forEach(n=>{if(e.includes(n.subject.value)&&n.subject.value!=o.subtitle){console.log("Found child pod: "+n.subject.value);let e="",i=a.some(e=>e["subtitle"]===n.subject.value);c["a"].state.rs.rdfStore.match(no.sym(n.subject.value),d["c"].ACL("owner"),null).length>=1&&(i=!0),c["a"].state.rs.rdfStore.match(no.sym(n.subject.value),d["c"].RDF("type"),d["c"].ORG("Organization")).length>=1&&(e="Organization"),i||a.splice(r+1,0,{filename:"pod",title:"POD",subtitle:n.subject.value,podtype:e,parentpod:o.subtitle,podlevel:s+1}),i||(t=!0)}}),c["a"].state.rs.rdfStore.match(no.sym(o.subtitle),d["c"].ORG("hasSubOrganization"),null).forEach(r=>{if(e.includes(r.object.value)&&r.object.value!=o.subtitle){let e=a.some(e=>e["subtitle"]===r.object.value);e||a.push({filename:"pod",title:"POD",subtitle:r.object.value,podtype:"Organization",parentpod:o.subtitle,podlevel:s+1}),e||(t=!0)}}),c["a"].state.rs.rdfStore.match(null,d["c"].FRBR("owner"),no.sym(o.subtitle)).forEach(r=>{if(e.includes(r.subject.value)&&r.subject.value!=o.subtitle){let e=a.some(e=>e["subtitle"]===r.subject.value);if(e)a.filter(e=>e["subtitle"]==r.subject.value).forEach(e=>{e.parentpod=o.subtitle,e.podlevel=s+1,0==c["a"].state.rs.rdfStore.match(no.sym(r.subject.value),d["c"].RDF("type"),d["c"].BOT("Site")).length&&(e.podtype="Site"),c["a"].state.rs.rdfStore.match(no.sym(r.subject.value),d["c"].RDF("type"),d["c"].BOT("Building")).length>=1&&(e.podtype="Building",c["a"].state.rs.rdfStore.match(null,d["c"].SIO("SIO_000202"),no.sym(r.subject.value))[0]&&(e.parentpod=c["a"].state.rs.rdfStore.match(null,d["c"].SIO("SIO_000202"),no.sym(r.subject.value))[0].subject.value),e.podlevel=s+2)});else{let e="Site",t=s+1;(0==c["a"].state.rs.rdfStore.match(no.sym(r.subject.value),d["c"].RDF("type"),d["c"].BOT("Site")).length||c["a"].state.rs.rdfStore.match(no.sym(r.subject.value),d["c"].RDF("type"),d["c"].BOT("Building")).length>=1)&&(e="Building",t=s+2),a.push({filename:"pod",title:"POD",subtitle:r.subject.value,podtype:e,parentpod:o.subtitle,podlevel:t})}e||(t=!0)}})}),t||(this.loading=!1),!t)break}for(let s=0;s<2;s++){let e=0;a.forEach((t,o)=>{t.podlevel<e&&(a=g["a"].arraymove(a,o,o-1)),e=t.podlevel})}for(let s=0;s<2;s++)for(let e=0;e<a.length;e++){let t=a[e].parentpod;for(let o=0;o<a.length;o++)a[o].subtitle==t&&g["a"].arraymove(a,e,o+1)}console.log(a),this.podlist=a,this.podlist.forEach((e,t)=>{console.log(e.podlevel),1==e.podlevel&&this.checkPodAuthorization(e.subtitle);try{e.title=c["a"].state.rs.rdfStore.match(no.sym(e.subtitle),d["c"].FOAF("name"),null)[0].object||""}catch(a){console.log(a)}})},checkPodAuthorization(e){re["a"].fetchAndSaveTurtle(e.replace("/i","/home/"))},getEmployees(e){if(""==e)return;re["a"].fetchAndSaveTurtle(e,!0).then(t=>{console.log("Get employees from: "+e),this.employeeList=[];let a=[],o=c["a"].state.rs.rdfStore.match(no.sym(e),d["c"].ORG("hasMember"),null);o.forEach(e=>{a.includes(e.object.value)||a.push(e.object.value)}),a.forEach((e,t)=>{this.employeeList.push({filename:"pod",personuri:e,title:"Personal",initials:"",subtitle:e,color:g["a"].makeRandomColor()})}),this.employeeList.forEach((e,a)=>{re["a"].fetchAndSaveTurtle(e.personuri,!0).then(t=>{try{let t=c["a"].state.rs.rdfStore.match(no.sym(e.subtitle),d["c"].FOAF("name"),null)[0].object.value||"";e.title=t,e.initials=g["a"].getInitials(t)}catch(a){console.log(a)}});return t})})},addEmployee(){console.log(this.newEmployeeURI);re["a"].fetchAndSaveTurtle(this.newEmployeeURI,!0).then(e=>{console.log(e)})},showWhatToDo(){}},computed:{svgFile(){return e=>Object(va["getIcon"])(e).svg}},watch:{"$store.state.whatToDoVisible":function(e){this.whatToDoVisible=c["a"].state.whatToDoVisible}},mounted(){this.checklogin(),this.$route.query.location||this.$router.push({path:this.$route.path,query:{location:this.currentPOD}}),this.getPodsFromURI(c["a"].state.webId,!1),this.currentPOD&&this.getEmployees(this.currentPOD+"i");document.getElementById("form");this.$route.query.location.length>=5&&kt["a"].getIFCmetaDataFromJson(this.$route.query.location+"home/IFC/building.json").then(e=>{c["a"].state.currentBuildingTag=e.tag})},created(){this.$route.query.location||(c["a"].state.whatToDoVisible=!0)}},co=lo,uo=(a("68cd"),Object(A["a"])(co,Ya,Ka,!1,null,"53bfdf54",null)),ho=uo.exports;x()(uo,{VBtn:_["a"],VCard:ue["a"],VDialog:fe["a"],VDivider:Fa["a"],VForm:Ie["a"],VIcon:Se["a"],VList:Oa["a"],VListItem:Ca["a"],VListItemAction:Na["a"],VListItemAvatar:La["a"],VListItemContent:Pa["a"],VListItemSubtitle:Pa["b"],VListItemTitle:Pa["c"],VProgressCircular:F["a"],VRow:Re["a"],VSubheader:ka["a"],VTextField:xe["a"]});var go={name:"PodSelectV",components:{PodSelect:ho}},mo=go,po=Object(A["a"])(mo,Ha,qa,!1,null,null,null),fo=po.exports,bo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"feedback"},[a("FileEdit",{attrs:{msg:"Show files library form"}})],1)},vo=[],yo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("iframe",{attrs:{id:"frame",src:this.$route.query.select}})},wo=[];const Io=a("dae0"),So=(new Io.Store,a("592d"),a("3717"),a("d2b7"),{});var Ro={id:So,name:"FileEdit",data(){return{documenturl:""}},methods:{checklogin(){console.log(window.solid.session.info),window.solid.session.info.isLoggedIn?console.log("Test logged in"):(console.log("Is logged out, reroute"),this.$router.push({path:"/"}))}},computed:{},watch:{},mounted(){this.checklogin(),this.documenturl=this.$route.query.select,this.$route.query.location||this.$router.push({path:this.$route.path,query:{select:this.documenturl}})},created(){}},Ao=Ro,Eo=(a("2994"),Object(A["a"])(Ao,yo,wo,!1,null,"d1f69328",null)),xo=Eo.exports,_o={name:"FileEditV",components:{FileEdit:xo}},jo=_o,To=Object(A["a"])(jo,bo,vo,!1,null,null,null),Fo=To.exports,Oo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"feedback"},[a("Search",{attrs:{msg:"Show files library form"}})],1)},Co=[],No=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"wrapper"},on:{drop:function(t){return t.preventDefault(),e.addFile.apply(null,arguments)},dragover:function(e){e.preventDefault()}}},[o("div",{staticClass:"left",attrs:{align:"left"}},[o("div",[o("v-card",{staticClass:"vcard-bottom-margin",attrs:{width:"100%"}},[o("div",{staticStyle:{width:"100%","text-align":"right","background-color":"#3577cb"}},[e.loading?o("v-progress-circular",{key:e.loading,staticStyle:{width:"20px",height:"20px","margin-right":"15px"},attrs:{indeterminate:"",color:"white"}}):e._e(),o("v-btn",{staticStyle:{"margin-left":"auto","margin-right":"10px"},attrs:{icon:""},on:{click:function(t){return e.getFilesFromURI("")}}},[o("v-icon",{staticStyle:{color:"white"}},[e._v("mdi-reload")])],1)],1),o("v-divider",{staticStyle:{"background-color":"lightgray"},attrs:{dark:""}}),o("div",{staticClass:"div-margins-left"},[o("v-form",{ref:"form",on:{submit:function(e){e.preventDefault()}}},[o("v-text-field",{attrs:{label:"Search",required:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.runSearch.apply(null,arguments)}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),o("div",{staticClass:"d-flex justify-content-start"},[o("v-btn",{staticClass:"mr-4",attrs:{color:"success"},on:{click:e.runSearch}},[e._v(" "+e._s(e.$t("text_search"))+" ")]),o("v-btn",{staticClass:"mr-4",attrs:{color:"normal"},on:{click:e.clearSearch}},[e._v(" "+e._s(e.$t("text_clear"))+" ")]),o("v-switch",{staticStyle:{"margin-top":"7px",padding:"0px"},attrs:{label:"Autosearch on select",color:"blue","hide-details":""},model:{value:e.autosearch,callback:function(t){e.autosearch=t},expression:"autosearch"}})],1)],1)],1),o("br")],1),!0===e.noResults?o("v-card",{staticClass:"vcard-bottom-margin"},[o("v-list",[o("v-list-item",{attrs:{"three-line":""}},[o("v-list-item-content",[o("div",{staticClass:"overline mb-4"},[e._v("No results found")]),o("v-list-item-title",{staticClass:"headline mb-1"},[e._v("Nothing found on: "),o("font",{attrs:{color:"#FF0000"}},[e._v(e._s(e.search))])],1)],1),o("v-list-item-avatar",{attrs:{tile:"",size:"80"}},[o("img",{attrs:{src:a("0390")}})])],1)],1)],1):e._e(),e._l(e.searchArrayOrdered,(function(t,s){return o("v-card",{key:s,staticClass:"vcard-bottom-margin"},["waiting"==t.type?o("v-list",[o("v-list-item",[o("v-list-item-content",[o("v-progress-circular",{staticStyle:{width:"20px",height:"20px","margin-left":"5px","margin-right":"5px"},attrs:{indeterminate:"",color:"primary"}})],1)],1)],1):"file"==t.type?o("v-list",{attrs:{color:t.selected}},[o("v-list-item",{attrs:{"three-line":""},on:{click:function(a){return e.getPDF(t.subjectURI,1)}}},[o("v-list-item-content",[o("div",{staticClass:"overline mb-4"},[e._v("FILE")]),o("v-list-item-title",{staticClass:"headline mb-1",domProps:{textContent:e._s(t.title)}}),o("v-list-item-subtitle",{domProps:{textContent:e._s(t.subjectURI)}})],1),o("v-list-item-avatar",{attrs:{tile:"",size:"80"}},[o("div",{staticClass:"iconlarge",domProps:{innerHTML:e._s(e.svgFile(t.subjectURI))}})])],1)],1):"paragraph"==t.type?o("v-list",{attrs:{color:t.selected}},[o("v-list-item",{attrs:{"three-line":""}},[o("v-list-item-content",[o("div",{staticClass:"overline mb-4"},[e._v("Paragraph")]),o("v-list-item-title",{staticClass:"headline mb-1",domProps:{textContent:e._s(t.title)}}),t.page?o("v-list-item-subtitle",{domProps:{textContent:e._s("Page "+t.page)}}):e._e(),o("br"),e._v(" "+e._s(t.text)),o("br"),o("br"),o("v-list-item-subtitle",{domProps:{textContent:e._s(decodeURI(t.fileURI))}})],1),o("div",{attrs:{align:"center"}},[o("v-list-item-avatar",{attrs:{tile:"",size:"80"}},[o("img",{attrs:{src:a("3a29")}})]),o("br"),""!=t.pageURI?o("v-btn",{on:{click:function(a){return e.getPDF(t.pageURI,1)}}},[e._v(" Page ")]):e._e(),o("br"),o("br"),""!=t.pageURI?o("v-btn",{on:{click:function(a){return e.goToPDFviewer(t.fileURI)}}},[e._v(" Document ")]):e._e()],1)],1)],1):"person"==t.type?o("v-list",[o("v-list-item",{attrs:{"three-line":""}},[o("v-list-item-content",[o("div",{staticClass:"overline mb-4"},[e._v("Person")]),o("v-list-item-title",{staticClass:"headline mb-1",domProps:{textContent:e._s(t.title)}}),e._v(" "+e._s(t.text)+" ")],1),o("v-list-item-avatar",{attrs:{tile:"",size:"80"}},[o("img",{attrs:{src:a("79b3")}})])],1)],1):"tag"==t.type?o("v-list",[o("v-list-item",{attrs:{"three-line":""}},[o("v-list-item-content",[o("div",{staticClass:"overline mb-4"},[e._v("TAG")]),e._v(" "+e._s(t.title)),o("br"),e._v(" "+e._s(t.text)+" ")])],1)],1):"instance"==t.type?o("v-list",[o("v-list-item",{attrs:{"three-line":""}},[o("v-list-item-content",[o("div",{staticClass:"overline mb-4"},[e._v("Instance")]),o("v-list-item-title",{staticClass:"headline mb-1",domProps:{textContent:e._s(t.title)}}),e._v(" "+e._s(t.text)+" ")],1)],1)],1):"room"==t.type?o("v-list",[o("v-list-item",{attrs:{"three-line":""}},[o("v-list-item-content",[o("div",{staticClass:"overline mb-4"},[e._v("Room")]),o("v-list-item-title",{staticClass:"headline mb-1",domProps:{textContent:e._s(t.title)}}),e._v(" "+e._s(t.text)+" ")],1),o("div",{attrs:{align:"center"}},[o("v-list-item-avatar",{attrs:{tile:"",size:"80"}},[o("img",{attrs:{src:a("6d2a")}})]),o("br"),""!=t.uri?o("v-btn",{on:{click:function(a){return e.showRoom(t.subjectURI)}}},[e._v(" View ")]):e._e()],1)],1)],1):"door"==t.type?o("v-list",[o("v-list-item",{attrs:{"three-line":""}},[o("v-list-item-content",[o("div",{staticClass:"overline mb-4"},[e._v("Door")]),o("v-list-item-title",{staticClass:"headline mb-1",domProps:{textContent:e._s(t.title)}}),e._v(" "+e._s(t.text)+" ")],1),o("div",{attrs:{align:"center"}},[o("v-list-item-avatar",{attrs:{tile:"",size:"80"}},[o("img",{attrs:{src:a("b2d7")}})]),o("br"),""!=t.uri?o("v-btn",{on:{click:function(a){return e.getPDF(t.uri,1)}}},[e._v(" View ")]):e._e()],1)],1)],1):"storey"==t.type?o("v-list",[o("v-list-item",{attrs:{"three-line":""}},[o("v-list-item-content",[o("div",{staticClass:"overline mb-4"},[e._v("Storey")]),o("v-list-item-title",{staticClass:"headline mb-1",domProps:{textContent:e._s(t.title)}}),e._v(" "+e._s(t.text)+" ")],1),o("div",{attrs:{align:"center"}},[o("v-list-item-avatar",{attrs:{tile:"",size:"80"}},[o("img",{attrs:{src:a("e829")}})]),o("br"),t.foundglobalid?o("v-btn",{on:{click:function(a){return e.showAsset(t.globalid,t.globalid,1,"full")}}},[e._v(" 2D ")]):e._e(),t.foundglobalid?o("v-btn",{on:{click:function(a){return e.showAsset(t.globalid,1,2,"hidden")}}},[e._v(" 3D ")]):e._e()],1)],1)],1):"page"==t.type?o("v-list",[o("v-list-item",{attrs:{"three-line":""}},[o("v-list-item-content",[o("div",{staticClass:"overline mb-4"},[e._v("Page")]),o("v-list-item-title",{staticClass:"headline mb-1",domProps:{textContent:e._s(t.title)}}),e._v(" "+e._s(t.text)+" ")],1),o("v-list-item-avatar",{attrs:{tile:"",size:"80"}},[o("img",{attrs:{src:a("737e")}})])],1)],1):e._e()],1)})),!0===e.debug?o("v-card",{staticClass:"mx-auto",attrs:{width:"100%"}},[o("v-list",{attrs:{dense:""}},e._l(e.searchArray,(function(t,a){return o("v-list-item",{key:a},[o("v-list-item-content",{domProps:{innerHTML:e._s(t)}})],1)})),1)],1):e._e()],2)]),e.pdfloaded?o("div",{ref:"filedetails",staticClass:"right",attrs:{align:"left"}},[o("v-card",{staticClass:"mx-auto"},[o("div",{staticStyle:{"margin-bottom":"20px"}},[o("pdf",{attrs:{src:e.pdfdata,page:1}},[o("template",{slot:"loading"},[e._v(" Loading PDF... ")])],2)],1)])],1):e._e(),e.bimviewerloaded?o("div",{ref:"bimviewer",staticClass:"right",attrs:{align:"left"}},[o("v-card",{staticClass:"mx-auto"},[o("div",{staticStyle:{"margin-bottom":"20px"}},[o("BIMviewer",{attrs:{msg:"Show bimviewer form"}})],1)])],1):e._e(),e.assetviewerloaded?o("div",{ref:"assetviewer",staticClass:"right",attrs:{align:"left"}},[o("v-card",{staticClass:"mx-auto"},[o("div",{staticClass:"assetviewerdiv"},[o("BMviewer",{attrs:{msg:"Show assetviewer form"}})],1)])],1):e._e()])},Lo=[],Po=a("10ee");const Do=a("dae0"),ko=(new Do.Store,a("592d"));new(a("c513").DataFactory),a("5189"),a("2f5f").toRdf;let Uo=ko.graph();const Mo={};var Bo={id:Mo,name:"Search",data(){return{valid:!0,search:"",pdfdata:void 0,pdfloaded:!1,bimviewerloaded:!1,assetviewerloaded:!0,pdfpage:1,searchResponse:"",searchArray:[],searchArrayOrdered:[],uploadDisabled:!0,noResults:!1,debug:!1,scale:void 0,loading:!1,selectedRoomURIs:[],selectedResult:void 0,autosearch:!1}},methods:{scrollMeTo(e){var t=this.$refs[e],a=t.offsetTop;window.scrollTo(0,a)},checklogin(){console.log(window.solid.session.info),window.solid.session.info.isLoggedIn?console.log("Test logged in"):(console.log("Is logged out, reroute"),this.$router.push({path:"/"}))},async runSearch(){this.loading=!0,this.noResults=!1,Uo=ko.graph(),this.searchArrayOrdered=[],console.log("Searched for: ",this.search);let e=c["a"].state.webId.replace("/i","/search/")+encodeURIComponent(this.search);try{let t=await window.solid.session.fetch(e,{method:"GET",credentials:"include",headers:{Accept:"text/turtle"}}).then(e=>e.text());return 0==t.length&&(this.noResults=!0),console.log("Response: "+t),ko.parse(t,Uo,e,"text/turtle"),Uo.statements.forEach((e,t)=>{this.searchArray.push(e.subject.value+" --\x3e "+e.predicate.value+" --\x3e "+e.object.value),e.predicate.value==d["c"].NEO("m_rank").value&&this.searchArrayOrdered.push({rank:e.object.value,type:"waiting",subjectURI:e.subject.value,title:"",subtitle:"",text:"",filename:"",page:"",pageURI:"",fileURI:"",selected:"#FFFFFF"})}),this.searchArrayOrdered=this.searchArrayOrdered.sort((function(e,t){return e.rank-t.rank})),console.log(this.searchArrayOrdered),this.requestSearchResults(),t}catch(t){console.log(t),console.log("Search failed")}},async requestSearchResults(){await this.searchArrayOrdered.forEach((e,t)=>{let a=Uo.match(ko.sym(e.subjectURI),d["c"].RDF("type"),null);a.forEach(t=>{if(console.log(t),t.object.value.includes(d["c"].SIO("SIO_000110").value)||t.object.value.includes(d["c"].SIO("SIO_000015").value))if(console.log("Found a paragraph!!!!"),e.text=Uo.match(ko.sym(e.subjectURI),d["c"].SCHEMA("text"),null)[0].object.value,e.text.length>=3){e.type="paragraph",0==Uo.match(null,d["c"].SIO("SIO_000202"),ko.sym(e.subjectURI)).length&&this.fetchSearchResultURI(e.subjectURI);try{let t=Uo.match(null,d["c"].SIO("SIO_000202"),ko.sym(e.subjectURI))[0].subject.value;if(e.pageURI=t,Uo.match(null,d["c"].SIO("SIO_000202"),ko.sym(t)).forEach(t=>{e.fileURI=t.subject.value}),Uo.match(ko.sym(t),d["c"].RDF("type"),d["c"].FABIO("Page"))[0].subject.value.length>=0){let a="";Uo.match(ko.sym(t),d["c"].RDFS("label"),null).forEach(t=>{a=t.object.value,e.filename=a,e.title=decodeURI(a.substring(0,a.lastIndexOf(".")))||decodeURI(a),e.page.includes("_")&&(e.page=e.page.substring(e.page.indexOf("_")+1)),e.title=e.title.substring(0,e.title.lastIndexOf("_"))||e.title}),""==a&&this.fetchSearchResultURI(e.subjectURI)}}catch(a){console.log(a)}}else e.type="word";else t.object.value.includes(d["c"].REG("file").value)||t.object.value.includes(d["c"].OPMV("Artifact").value)?(console.log("Found a file!!!!"),e.title=Uo.match(ko.sym(e.subjectURI),d["c"].RDFS("label"),null)[0].object.value,"."===t.subject.value.charAt(t.subject.value.length-4)||"."===t.subject.value.charAt(t.subject.value.length-5)?e.type="file":e.type="page"):t.object.value.includes(d["c"].FOAF("Person").value)?(console.log("Found a person!!!!"),e.title=Uo.match(ko.sym(e.subjectURI),d["c"].RDFS("label"),null)[0].object.value,e.type="person"):t.object.value.includes(d["c"].SIO("SIO_000114").value)?(e.type="word",e.text=Uo.match(ko.sym(e.subjectURI),d["c"].SCHEMA("text"),null)[0].object.value):t.object.value.includes(d["c"].NEO("a_titleblock").value)?e.type="titleblock":t.object.value.includes(d["c"].SIO("SIO_000135").value)?e.type="definition":t.object.value.includes(d["c"].FABIO("Page").value)?e.type="page":t.object.value.includes(d["c"].BOT("Storey").value)?(e.foundglobalid=!1,re["a"].fetchAndSaveTurtle(e.subjectURI,!0).then(()=>{c["a"].state.rs.rdfStore.match(ko.sym(e.subjectURI),d["c"].IFOUR("globalid"),null).forEach(t=>{console.log("Global ID:"+t.object.value),e.foundglobalid=!0,e.globalid=t.object.value+"",e.text="GlobalID: "+t.object.value})}),e.type="storey",e.title=Uo.match(ko.sym(e.subjectURI),d["c"].RDFS("label"),null)[0].object.value):t.object.value.includes(d["c"].BOT("Space").value)?(e.type="room",e.title=decodeURI(Uo.match(ko.sym(e.subjectURI),d["c"].RDFS("label"),null)[0].object.value),Uo.match(ko.sym(e.subjectURI),d["c"].TAG("tag"),null)[0]&&(e.text=Uo.match(ko.sym(e.subjectURI),d["c"].TAG("tag"),null)[0].object.value)):t.object.value.includes(d["c"].NEO("s_instance").value)?(re["a"].fetchAndSaveTurtle(e.subjectURI,!0).then(()=>{c["a"].state.rs.rdfStore.match(ko.sym(e.subjectURI),d["c"].RDF("type"),null).forEach(t=>{console.log(t.object.value),t.object.value==d["c"].BOT("Storey").value&&(e.type="storey"),t.object.value==d["c"].BOT("Space").value&&(e.type="room"),t.object.value==d["c"].NEO("x_door").value&&(e.type="door")})}),e.type="instance",e.title=decodeURI(Uo.match(ko.sym(e.subjectURI),d["c"].RDFS("label"),null)[0].object.value),Uo.match(ko.sym(e.subjectURI),d["c"].TAG("tag"),null)[0]&&(e.text=Uo.match(ko.sym(e.subjectURI),d["c"].TAG("tag"),null)[0].object.value)):t.object.value.includes(d["c"].NEO("s_tagged-object").value)?(e.title=Uo.match(ko.sym(e.subjectURI),d["c"].TAG("tag"),null)[0].object.value,e.text=e.subjectURI,e.type="tag"):t.object.value.includes(d["c"].SIO("SIO_000000").value)?e.type="entity":e.type="none"})});this.searchArrayOrdered.forEach((e,t)=>{if("waiting"==e.type){try{e.title=Uo.match(ko.sym(e.subjectURI),d["c"].RDFS("label"),null)[0].object.value}catch(a){console.log(a)}e.filename=e.subjectURI,e.type="other"}}),this.loading=!1},async fetchSearchResultURI(e){console.log("Result URI:",e);re["a"].fetchAndSaveTurtle(e,!0).then(t=>{try{let t=this.searchArrayOrdered.find(t=>t.subjectURI===e),a=c["a"].state.rs.rdfStore.match(null,d["c"].SIO("SIO_000202"),ko.sym(t.subjectURI))[0].subject.value;console.log(a);re["a"].fetchAndSaveTurtle(a,!0).then(e=>{t.page=c["a"].state.rs.rdfStore.match(ko.sym(a),d["c"].SIO("SIO_000787"),null)[0].object.value});if(c["a"].state.rs.rdfStore.match(ko.sym(a),d["c"].RDF("type"),d["c"].FABIO("Page"))[0].subject.value.length>=0){let e=c["a"].state.rs.rdfStore.match(ko.sym(a),d["c"].RDFS("label"),null)[0].object.value;t.filename=e,t.title=e.substring(0,e.lastIndexOf("."))||e,t.title=t.title.substring(0,t.title.lastIndexOf("_"))||t.title}c["a"].state.rs.rdfStore.match(null,d["c"].SIO("SIO_000202"),ko.sym(a))[0].subject.value.length>=0&&(t.fileURI=c["a"].state.rs.rdfStore.match(null,d["c"].SIO("SIO_000202"),ko.sym(a))[0].subject.value)}catch(a){console.log(a)}})},getTripleMatches(e,t){let a=[];return e.forEach((o,s)=>{0==s?t.match(e[s].subject,e[s].predicate,e[s].object).forEach(e=>{a.push(e)}):t.match(e[s].subject,e[s].predicate,e[s].object).forEach(e=>{a.includes(e)?(a=this.arrayRemove(a,e),a.push(e)):a.push(e)})}),a},showAsset(e,t="",a=1,o="hidden"){c["a"].state.bmurl='{ "select": "['+e+']", "location": "'+t+'", "viewtype": "'+a+'", "twodim": "'+o+'" }'},async getPDF(e,t){console.log("Opening PDF URI: "+e),this.loading=!0,this.pdfloaded=!1,this.pdfdata=void 0;try{this.pdfpage=parseInt(t)}catch(a){this.pdfpage=1}this.searchArrayOrdered.forEach((t,a)=>{t.subjectURI==e||t.pageURI==e?t.selected="#EEFEFF":t.selected="#FFFFFF"});try{console.log(e);const t=await window.solid.session.fetch(e,{method:"GET",credentials:"include"});let a=await t.arrayBuffer(),o=URL.createObjectURL(new Blob([a],{type:"application/pdf"}));this.pdfdata=Po["a"].createLoadingTask(o),this.pdfdata.then(e=>{this.pdfloaded=!0,this.bimviewerloaded=!1,this.loading=!1})}catch(a){console.log(a)}},goToPDFviewer(e){this.$router.push({path:"PDFviewer",query:{location:this.$route.query.location,select:e}})},showRoom(e){this.bimviewerloaded=!0,this.pdfloaded=!1,c["a"].state.bv.twodim=!1,c["a"].state.bv.gltfGeoVisible=!1,c["a"].state.bv.lockSelection=!0,Uo.match(ko.sym(e),d["c"].RDFS("label"),null).forEach(t=>{console.log("Found Label: "+t.object.value),c["a"].state.rs.rdfStore.match(null,d["c"].RDFS("label"),ko.literal(t.object.value,"en")).forEach(t=>{console.log("Found URI: "+t.subject.value),t.subject.value!=e&&(e=t.subject.value,console.log("Found other URI!!!"))})}),console.log("Room URI: ",e),c["a"].state.bv.selectedRoomURI=e,this.$route.query.select!=e&&this.$router.push({path:this.$route.path,query:{location:this.$route.query.location,select:e}}),this.bimviewerloaded||this.showAllRooms()},showAllRooms(){c["a"].state.rs.rdfStore.match(null,d["c"].RDF("type"),d["c"].BOT("Space")).forEach(e=>{this.selectedRoomURIs.includes(e.subject.value)||(console.log("Found room: "+e.subject.value),this.selectedRoomURIs.push(e.subject.value))}),this.drawRoomWithURIs(this.selectedRoomURIs)},drawRoomWithURIs(e){e.forEach((e,t)=>{c["a"].state.rs.rdfStore.match(ko.sym(e),d["c"].IFOUR("m_polyline"),null).forEach((t,a)=>{Dt["a"].addRoomMatrix(t,1789810,.9,e)})})},clearSearch(){this.searchArrayOrdered=[],this.searchArray=[],this.search=""},arrayRemove(e,t){return e.filter((function(e){return e!=t}))}},computed:{svgFile(){return e=>Object(va["getIcon"])(e).svg}},watch:{search(){this.noResults=!1},$route(e,t){console.log("URL select: "+e.query.select),this.autosearch&&e.query.select!=t.query.select&&(this.search.includes(t.query.select)&&(console.log("Found existing in search.."),this.search=this.search.replace(" "+t.query.select,""),this.search=this.search.replace(t.query.select,"")),e.query.select&&(this.search.length>=1?this.search=this.search+" "+e.query.select:this.search=this.search+e.query.select,this.runSearch()))}},mounted(){this.checklogin()},created(){},components:{pdf:Po["a"],BIMviewer:vt["a"],BMviewer:Gt}},Vo=Bo,Go=(a("9a6d"),a("b73d")),zo=Object(A["a"])(Vo,No,Lo,!1,null,"efa949b2",null),Wo=zo.exports;x()(zo,{VBtn:_["a"],VCard:ue["a"],VDivider:Fa["a"],VForm:Ie["a"],VIcon:Se["a"],VList:Oa["a"],VListItem:Ca["a"],VListItemAvatar:La["a"],VListItemContent:Pa["a"],VListItemSubtitle:Pa["b"],VListItemTitle:Pa["c"],VProgressCircular:F["a"],VSwitch:Go["a"],VTextField:xe["a"]});var Ho={name:"SearchV",components:{Search:Wo}},qo=Ho,Yo=Object(A["a"])(qo,Oo,Co,!1,null,null,null),Ko=Yo.exports,Xo=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"feedback"},[o("img",{attrs:{alt:"I4 logo",src:a("cf05"),width:"200px"}}),o("ImportIFC",{attrs:{msg:"Show import IFC data form"}})],1)},Zo=[],Jo=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"inputwrapper",attrs:{align:"left"}},[a("v-form",{ref:"form",attrs:{"lazy-validation":""}},[a("v-file-input",{attrs:{"truncate-length":"15"},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),a("v-btn",{staticClass:"white--text",attrs:{to:{name:"ImportData"},color:"#3577cb"}},[e._v(" "+e._s(e.$t("button_back"))+" ")])],1)],1)},$o=[];const Qo=a("e90a"),es=new Qo.IfcAPI;var ts={name:"ImportIFC",data(){return{file:""}},props:{msg:String},methods:{getCirculationData(e,t){for(var a=0;a<t.length;a++){t[a].substring(0,t[a].indexOf("="));let o=t[a].substring(t[a].indexOf("IFCDOOR(")+8);o=o.replace(");",""),o=o.replaceAll("'",""),console.log(o);const s=o.split(","),r=s[2];console.log(r);const n=es.GetLine(e,parseInt(s[5].substring(1))),i=es.GetLine(e,parseInt(n.RelativePlacement.value)),l=es.GetLine(e,i.Location.value),c=l.Coordinates[0].value;console.log(c);const d=s[8],u=s[9];console.log("Høyde: "+d+" Bredde:"+u)}},getPolyLineData(e,t,a,o,s,r){const n=es.GetLine(e,parseInt(t[s].substring(1))),i=(es.GetLine(e,parseInt(n.PlacementRelTo)),es.GetLine(e,n.RelativePlacement.value)),l=es.GetLine(e,i.Location.value),c=es.GetLine(e,i.Axis.value),d=es.GetLine(e,i.RefDirection.value),u=d.DirectionRatios,h=c.DirectionRatios,g=l.Coordinates,m=es.GetLine(e,parseInt(a[s].substring(1))),p=es.GetLine(e,parseInt(m.Representations[1].value)),f=es.GetLine(e,parseInt(p.Items[0].value)),b=es.GetLine(e,parseInt(f.Elements[0].value)),v={x:u[0].value,y:u[1].value,z:u[2].value},y={x:h[0].value,y:h[1].value,z:h[2].value},w=this.v3cross(v,y),I={x:0,y:-1,z:0};var S=this.getAngleRadians(w.x,w.y,v.x,v.y),R=this.getAngleRadians(y.x,y.y,I.x,I.y);S=R-S+Math.PI/4;const A=[];if(b.Points){for(var E=0;E<b.Points.length;E++){const t=es.GetLine(e,parseInt(b.Points[E].value));A.push(t.Coordinates)}var x="polyline;"+encodeURI(o[s])+";"+g[0].value/1e3+";"+g[1].value/1e3+";"+r+";2.9;[";for(E=0;E<A.length;E++){var _=A[E][0].value/1e3,j=A[E][1].value/1e3;const e=this.rotateRadians(0,0,_,j,S);_=e[0],j=e[1],x=""+x+_+","+j+",0",E<A.length-1&&(x+=",")}return x+="]",x}return""},rotateRadians(e,t,a,o,s){const r=Math.cos(s),n=Math.sin(s),i=r*(a-e)+n*(o-t)+e,l=r*(o-t)-n*(a-e)+t;return[i,l]},getAngleRadians(e,t,a,o){let s=e-a,r=t-o,n=Math.atan2(r,s);return n},v3cross(e,t){let a={x:0,y:0,z:0};return a.x=e.y*t.z-e.z*t.y,a.y=e.z*t.x-e.x*t.z,a.z=e.x*t.y-e.y*t.x,a}},watch:{file:function(e){let t=new FileReader;t.onload=e=>{var t=new TextEncoder("utf-8"),a=t.encode(e.target.result);es.SetWasmPath("../"),es.Init().then(t=>{const o=es.OpenModel(a),s=e.target.result.split(/\r\n|\n/);for(var r=[],n=[],i=[],l=[],d=0;d<s.length;d++)s[d].includes("IFCSPACE(")&&r.push(s[d]),s[d].includes("IFCRELAGGREGATES(")&&n.push(s[d]),s[d].includes("IFCBUILDINGSTOREY(")&&i.push(s[d]),s[d].includes("IFCDOOR(")&&l.push(s[d]);var u=[];for(d=0;d<n.length;d++){let e=n[d].substring(n[d].indexOf("IFCRELAGGREGATES(")+17);e=e.replace(");",""),e=e.replaceAll("'",""),e=e.replaceAll("(",""),e=e.replaceAll(")",""),u.push(e.split(","))}const h=[];for(d=0;d<i.length;d++){const e=i[d].substring(0,i[d].indexOf("="));let t=i[d].substring(i[d].indexOf("IFCBUILDINGSTOREY(")+17);t=t.replace(");",""),t=t.replaceAll("'","");const a=t.split(","),s=es.GetLine(o,parseInt(a[5].replace("#",""))),r=es.GetLine(o,parseInt(s.RelativePlacement.value)),n=es.GetLine(o,parseInt(r.Location.value)),l=n.Coordinates[2].value/1e3;for(var g=0;g<u.length;g++)for(var m=5;m<u[g].length;m++)u[g][4]==e&&h.push({roomid:u[g][m],height:l,id:e})}var p=[],f=[],b=[],v=[],y=[],w=[];for(d=0;d<r.length;d++){const e=r[d].substring(0,r[d].indexOf("="));let t=r[d].substring(r[d].indexOf("IFCSPACE(")+9);t=t.replace(");",""),t=t.replaceAll("'","");const a=t.split(",");if("$"!=a[2]){for(g=0;g<h.length;g++)h[g].roomid==e&&f.push(h[g].height);p.push(a[0]),b.push(ne["a"].formatString(a[2])),v.push(a[5]),y.push(a[6]),w.push(a[7])}}const I=[];let S="";for(d=0;d<b.length;d++){let e=this.getPolyLineData(o,v,y,b,d,f[d]);""!=e&&(I.push(e),S=S+e+"\n")}c["a"].state.rs.geometryArray=I,this.getCirculationData(o,l);var R=new Blob([S],{type:"text/plain"});let A=document.createElement("a");A.href=window.URL.createObjectURL(R),A.download="geometry-file.csv"})},t.readAsText(e)}}},as=ts,os=(a("c79f"),Object(A["a"])(as,Jo,$o,!1,null,"a9a1547e",null)),ss=os.exports;x()(os,{VBtn:_["a"],VFileInput:ct["a"],VForm:Ie["a"]});var rs={name:"ImportIFCV",components:{ImportIFC:ss}},ns=rs,is=Object(A["a"])(ns,Xo,Zo,!1,null,null,null),ls=is.exports,cs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"feedback"},[a("PDFviewer",{attrs:{msg:"Show files library form"}})],1)},ds=[],us=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"wrapper"},on:{drop:function(t){return t.preventDefault(),e.addFile.apply(null,arguments)},dragover:function(e){e.preventDefault()}}},[a("div",{staticClass:"card",staticStyle:{width:"96%"}},[a("v-card",{staticClass:"mx-auto"},[a("div",{staticClass:"filemenu",staticStyle:{width:"100%","text-align":"right","background-color":"#3577cb"}},[a("span",[a("v-btn",{staticStyle:{"margin-left":"0px","margin-right":"auto"},attrs:{icon:""},on:{click:e.goBack}},[a("v-icon",{staticStyle:{color:"white"}},[e._v("mdi-arrow-left")])],1)],1),a("span",[e.loading?a("v-progress-circular",{key:e.loading,staticStyle:{width:"20px",height:"20px","margin-right":"15px"},attrs:{indeterminate:"",color:"white"}}):e._e(),a("v-btn",{staticStyle:{"margin-left":"auto","margin-right":"10px"},attrs:{icon:""},on:{click:function(t){return e.getPDF(e.pdfURI,1)}}},[a("v-icon",{staticStyle:{color:"white"}},[e._v("mdi-reload")])],1)],1)]),e.pdfloaded?a("div",{staticStyle:{width:"100%"},attrs:{id:"pdfvuer"}},e._l(10,(function(t){return a("pdf",{key:t,staticStyle:{width:"100%",margin:"20px auto"},attrs:{src:e.pdfdata,id:e.startPage+t,page:e.startPage+t,scale:e.scale,annotation:!0,resize:!0},on:{"update:scale":function(t){e.scale=t},"link-clicked":e.handle_pdf_link}},[a("template",{slot:"loading"},[e._v(" Loading page... ")])],2)})),1):e._e()])],1),a("div",{staticClass:"bottommenu"},[e.pdfpage<e.totalNumPages?a("v-btn",{staticStyle:{"margin-left":"5px","margin-right":"5px"},attrs:{icon:""},on:{click:e.nextPage}},[a("v-icon",{staticStyle:{color:"white"}},[e._v("mdi-arrow-down")])],1):a("span",{staticStyle:{width:"50px",height:"25px"}}),a("font",{attrs:{color:"#FFFFF"}},[e._v("Page "+e._s(e.pdfpage)+" of "+e._s(e.totalNumPages))]),a("v-btn",{staticStyle:{"margin-left":"5px","margin-right":"5px"},attrs:{icon:""},on:{click:e.previousPage}},[a("v-icon",{staticStyle:{color:"white"}},[e._v("mdi-arrow-up")])],1)],1)])},hs=[];const gs=a("dae0"),ms=(new gs.Store,a("592d"));new(a("c513").DataFactory),a("5189"),a("2f5f").toRdf;ms.graph();const ps={};var fs={id:ps,name:"PDFviewer",data(){return{valid:!0,pdfURI:"",pdfdata:void 0,pdfloaded:!1,pdfpage:1,numPages:10,totalNumPages:10,pagePositions:[],scrolling:!1,scale:"page-width",debug:!1,loading:!1,startPage:0}},methods:{scrollMeTo(e){var t=this.$refs[e],a=t.offsetTop;window.scrollTo(0,a)},goBack(){history.back()},checklogin(){console.log(window.solid.session.info),window.solid.session.info.isLoggedIn?console.log("Test logged in"):(console.log("Is logged out, reroute"),this.$router.push({path:"/"}))},async getPDF(e,t){this.loading=!0,this.pdfloaded=!1,this.pdfdata=void 0,this.pagePositions=[];try{this.pdfpage=this.startPage+parseInt(t)}catch(a){this.pdfpage=this.startPage+1}try{const t=await window.solid.session.fetch(e,{method:"GET",credentials:"include"});console.log(t);let a=await t.arrayBuffer(),o=URL.createObjectURL(new Blob([a],{type:"application/pdf"}));this.pdfdata=Po["a"].createLoadingTask(o),this.pdfdata.then(e=>{console.log(o),setTimeout(()=>{let e=0;for(var t=1;t<100;t++){const a=this.findPos(document.getElementById(this.startPage+t));if(e==a)break;this.pagePositions.push(a),this.numPages=this.startPage+t,e=a}this.numPages--},1e3),this.pdfloaded=!0,this.loading=!1,this.totalNumPages=e.numPages})}catch(a){console.log(a)}},handle_pdf_link:function(e){var t=document.getElementById(String(e.pageNumber));t.scrollIntoView()},findPos(e){return e.offsetTop},arrayRemove(e,t){return e.filter((function(e){return e!=t}))},between(e,t,a){return e>=t&&e<=a},nextPage(){this.pdfpage<this.numPages?this.pdfpage++:0==String(this.pdfpage).charAt(String(this.pdfpage).length-1)&&(this.startPage=this.startPage+10,this.getPDF(this.pdfURI,1)),document.getElementById(this.pdfpage).scrollIntoView(),window.scrollBy(0,-120)},previousPage(){this.pdfpage>this.startPage+1?this.pdfpage--:this.pdfpage>1&&(this.startPage=this.startPage-10,this.getPDF(this.pdfURI,1)),document.getElementById(this.pdfpage).scrollIntoView(),window.scrollBy(0,-120)}},computed:{formattedZoom(){return Number.parseInt(100*this.scale)}},watch:{},mounted(){this.checklogin(),this.pdfURI=this.$route.query.select,this.getPDF(this.pdfURI,1)},created(){let e;window.addEventListener("scroll",()=>{this.scrolling=!0,window.clearTimeout(e),e=setTimeout(()=>{this.scrolling=!1,console.log(window.scrollY);for(var e=0;e<this.numPages+1;e++)this.between(window.scrollY,this.pagePositions[e]-120,this.pagePositions[e+1]-120)&&(this.pdfpage=this.startPage+e+1),window.scrollY<50&&(this.pdfpage=this.startPage+1),window.scrollY>this.pagePositions[this.pagePositions.length-1]&&(this.pdfpage=this.numPages)},400)},!1)},destroyed(){},components:{pdf:Po["a"]}},bs=fs,vs=(a("c233"),Object(A["a"])(bs,us,hs,!1,null,"1c7d9d7b",null)),ys=vs.exports;x()(vs,{VBtn:_["a"],VCard:ue["a"],VIcon:Se["a"],VProgressCircular:F["a"]});var ws={name:"PDFviewerV",components:{PDFviewer:ys}},Is=ws,Ss=Object(A["a"])(Is,cs,ds,!1,null,null,null),Rs=Ss.exports,As=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"feedback"},[a("WorkList",{attrs:{msg:"Show work list"}})],1)},Es=[],xs=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"wrapper"}},[a("v-card",{staticClass:"mx-auto"},[a("div",{staticClass:"flex justify-center"},[a("div",{staticClass:"min-h-screen flex overflow-x-scroll py-12"},e._l(e.columns,(function(t){return a("div",{key:t.title,staticClass:"bg-gray-100 rounded-lg px-3 py-3 column-width rounded mr-4"},[a("p",{staticClass:"text-gray-700 font-semibold font-sans tracking-wide text-sm"},[e._v(e._s(t.title))]),a("draggable",{attrs:{list:t.tasks,animation:200,"ghost-class":"ghost-card",group:"tasks"}},e._l(t.tasks,(function(e){return a("task-card",{key:e.uri,staticClass:"mt-3 cursor-move",attrs:{task:e}})})),1)],1)})),0)])])],1)},_s=[],js=a("5a89"),Ts=a("b76a"),Fs=a.n(Ts),Os=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"bg-white shadow rounded px-3 pt-3 pb-5 border border-white"},[o("div",{staticClass:"flex justify-between"},[o("div",{staticStyle:{"text-align":"left"}},[o("p",{staticClass:"text-gray-700 font-semibold font-sans tracking-wide text-sm"},[e._v(e._s(e.task.title))])]),o("img",{staticClass:"w-6 h-6 rounded-full ml-3",attrs:{src:a("6289"),alt:"Avatar"}})]),o("div",{staticClass:"flex mt-4 justify-between items-center"},[o("span",{staticClass:"text-sm text-gray-600"},[e._v(e._s(e.task.date))]),e.task.type?o("badge",{attrs:{color:e.badgeColor}},[e._v(e._s(e.task.type))]):e._e()],1),o("div",{staticStyle:{"text-align":"left"}},[o("p",{staticClass:"text-gray-500 font-narrow font-sans tracking-wide text-sm",staticStyle:{"margin-bottom":"-15px"}},[e._v(e._s(e.task.responsible))])])])},Cs=[],Ns=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"px-3 h-6 rounded-full text-xs font-semibold flex items-center",class:"bg-"+e.color+"-100 text-"+e.color+"-700"},[a("span",{staticClass:"w-2 h-2 rounded-full mr-1",class:"bg-"+e.color+"-400"}),a("span",[e._t("default")],2)])},Ls=[],Ps={props:{color:{type:String,default:"teal"}}},Ds=Ps,ks=Object(A["a"])(Ds,Ns,Ls,!1,null,null,null),Us=ks.exports,Ms={components:{Badge:Us},props:{task:{type:Object,default:()=>({})}},computed:{badgeColor(){const e={Design:"purple","Feature Request":"teal",Backend:"blue",QA:"green",default:"teal"};return e[this.task.type]||e.default}}},Bs=Ms,Vs=Object(A["a"])(Bs,Os,Cs,!1,null,null,null),Gs=Vs.exports;const zs=a("dae0"),Ws=(new zs.Store,a("592d"));a("3717"),a("d2b7"),a("3e8f");a("c8c8");new(a("c513").DataFactory),a("5189"),a("2f5f").toRdf;const Hs={};Hs.searchAndParseResult=async function(e){let t=c["a"].state.webId.replace("/i","/search/")+encodeURIComponent(e);try{let e=await window.solid.session.fetch(t,{method:"GET",credentials:"include",headers:{Accept:"text/turtle"}}).then(e=>e.text());return Ws.parse(e,c["a"].state.rs.rdfStore,t,"text/turtle"),e}catch(a){console.log(a),console.log("Search failed")}};var qs={id:Hs,name:"WorkList",components:{TaskCard:Gs,draggable:Fs.a},data(){return{columns:[{title:"Not started",tasks:[]},{title:"In Progress",tasks:[]},{title:"Resolved",tasks:[]},{title:"Closed",tasks:[]}]}},methods:{checklogin(){console.log(window.solid.session.info),window.solid.session.info.isLoggedIn?console.log("Test logged in"):(console.log("Is logged out, reroute"),this.$router.push({path:"/"}))},async getTasksFromServer(){await Hs.searchAndParseResult("#i4task*");let e=[];c["a"].state.rs.rdfStore.match(null,d["c"].TAG("tag"),null).forEach(t=>{t.object.value.includes("i4task")&&(e.includes(t.subject.value)||e.push(t.subject.value))});for(let t=0;t<e.length;t++){let a=await re["a"].fetchAndSaveTurtle(e[t]);a&&console.log("Done")}this.getTasksFromDatabase(),c["a"].state.tasks.forEach(e=>{this.columns.forEach((t,a)=>{e.state==t.title&&this.columns[a].tasks.push(e)})})},getTasksFromDatabase(){c["a"].state.rs.rdfStore.match(null,d["c"].TAG("tag"),null).forEach(e=>{if(e.object.value.includes("i4task")){console.log("Found item: "+e.object.value);let t="",a="",o="",s="",r="",n="Not started";c["a"].state.rs.rdfStore.match(e.subject,d["c"].IFOUR("taskStatus"),null).forEach(e=>{n=e.object.value}),c["a"].state.rs.rdfStore.match(e.subject,d["c"].RDFS("label"),null).forEach(e=>{t=e.object.value,console.log("Label",t)}),c["a"].state.rs.rdfStore.match(e.subject,d["c"].RDFS("comment"),null).forEach(e=>{a=e.object.value}),c["a"].state.rs.rdfStore.match(e.subject,d["c"].FOAF("image"),null).forEach(e=>{o=e.object.value}),c["a"].state.rs.rdfStore.match(e.subject,d["c"].FOAF("aimChatID"),null).forEach(e=>{s=e.object.value,c["a"].state.rs.rdfStore.match(Ws.sym(e.object.value),d["c"].FOAF("name"),null)[0]&&(r=c["a"].state.rs.rdfStore.match(Ws.sym(e.object.value),d["c"].FOAF("name"),null)[0].object.value)});let i="",l=new js["uc"](0,0,0);if(c["a"].state.rs.rdfStore.match(e.subject,d["c"].NEO("t_"),null).forEach(e=>{i=e.object.value}),i.length>=10){i=i.replace("]^^neo:a_matrix-3m",""),i=i.replace("[0,0,0,0,0,0,","");const e=i.split(",");l.x=parseInt(e[0]),l.y=parseInt(e[1]),l.z=parseInt(e[2])}console.log(l);let u=!1;c["a"].state.tasks.forEach(t=>{t.uri===e.subject.value&&(u=!0)}),u||(console.log("Found state: "+n),c["a"].state.tasks.push({id:Date.now(),uri:e.subject.value,position:l,title:t,description:a,imageuri:o,responsible:r,state:n,date:"16.09.2022",type:"issue"}))}})}},computed:{},watch:{columns:{handler:function(e,t){console.log("Task list changed.."),e.forEach((t,a)=>{e[a].tasks.forEach(t=>{c["a"].state.tasks.forEach((o,s)=>{if(o.id===t.id&&o.state!=e[a].title){console.log(o.title+" : Has changed."),console.log("URI: "+o.uri),c["a"].state.rs.rdfStore.removeMatches(Ws.sym(o.uri),d["c"].IFOUR("taskStatus"),o.state),c["a"].state.tasks[s].state=e[a].title,c["a"].state.rs.rdfStore.add(Ws.sym(c["a"].state.tasks[s].uri),d["c"].IFOUR("taskStatus"),c["a"].state.tasks[s].state,Ws.default),c["a"].state.rs.tempRdfStore=Ws.graph(),c["a"].state.rs.tempRdfStore.add(Ws.sym(c["a"].state.tasks[s].uri),d["c"].IFOUR("taskStatus"),c["a"].state.tasks[s].state,Ws.default);let t=ne["a"].storeToTurtle(c["a"].state.rs.tempRdfStore,"");t=re["a"].modifyTurtle(t),console.log(t);let r=g["a"].getCharactersBefore(c["a"].state.tasks[s].uri,"node/")+"i";console.log("Taskpod:"+r)}})})})},deep:!1}},mounted(){this.checklogin(),this.currentPOD=this.$route.query.location,this.currentContainer=this.$route.query.location+"home/",this.columns[0].tasks=[],console.log(c["a"].state.tasks.length),c["a"].state.tasks=[],this.getTasksFromServer()},created(){}},Ys=qs,Ks=(a("f90f"),Object(A["a"])(Ys,xs,_s,!1,null,"8a7a1d6c",null)),Xs=Ks.exports;x()(Ks,{VCard:ue["a"]});var Zs={name:"WorklistV",components:{WorkList:Xs}},Js=Zs,$s=Object(A["a"])(Js,As,Es,!1,null,null,null),Qs=$s.exports,er=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrapper",style:{height:e.viewHeight+"px"}},[a("v-btn",{staticClass:"white--text",staticStyle:{position:"absolute","z-index":"3",top:"28px",right:"8px"},attrs:{color:"#3577cb"},on:{click:e.toggleViews}},[a("v-icon",[e._v("mdi-arrow-split-vertical")])],1),a("Multipane",{staticClass:"vertical-panes",style:{height:e.viewHeight+"px"},attrs:{id:"resizer",layout:"vertical"},on:{paneResizeStart:function(t){return e.paneresizestarted(t)},paneResizeStop:function(t){return e.paneresizestopped(t)}}},[a("div",{ref:"leftpane",staticClass:"vertical",staticStyle:{overflow:"scroll"},style:{height:e.viewHeight+"px"}},[a("IFCexporter",{attrs:{msg:"Show IFCexporter form"}})],1),a("multipane-resizer",{staticClass:"resizer",style:{height:e.viewHeight+"px"}},[e._v("-")]),a("BIMviewer",{ref:"myviewer",staticClass:"verticalflex",style:{height:e.viewHeight+"px"},attrs:{msg:"Show bimviewer form"}})],1)],1)},tr=[],ar=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"inputwrapper",attrs:{align:"left"}},[a("v-form",{ref:"form1",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-btn",{staticClass:"white--text",attrs:{color:"#3577cb"},on:{click:function(t){return e.clearScene()}}},[e._v(" Clear scene ")]),a("br"),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#3577cb"},on:{click:function(t){return e.createTrinpods()}}},[e._v(" Create trinpods ")]),a("br"),a("br"),e.loading?e._e():a("div",[a("h2",[e._v("Select IFC file")]),a("hr",{staticClass:"hr1"}),a("br"),a("v-select",{attrs:{items:e.ifcfiles,label:e.$t("text_all"),"return-object":"",single:"",chips:"",solo:""},model:{value:e.ifcfile,callback:function(t){e.ifcfile=t},expression:"ifcfile"}})],1),e.loading?e._e():a("div",[a("h2",[e._v("Create GLTF by IFC types")]),a("hr",{staticClass:"hr1"}),a("br"),a("v-select",{attrs:{items:e.ifctypes,label:e.$t("text_all"),"return-object":"",multiple:"",chips:"",solo:""},model:{value:e.ifctypesselected,callback:function(t){e.ifctypesselected=t},expression:"ifctypesselected"}})],1),a("v-switch",{attrs:{label:"Split by floor",color:"blue","hide-details":""},model:{value:e.splitbyfloor,callback:function(t){e.splitbyfloor=t},expression:"splitbyfloor"}}),a("br"),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#3577cb"},on:{click:function(t){return e.convertIFCtoGLTF()}}},[e._v(" Export GLTF by types ")]),a("br"),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#3577cb"},on:{click:function(t){return e.exportIFCProperties()}}},[e._v(" Export JSON property set ")]),a("br"),a("br"),e.loading?e._e():a("div",[a("h2",[e._v("Create floorplan by floor")]),a("hr",{staticClass:"hr1"}),a("br"),a("v-btn",{staticClass:"black--text",attrs:{color:"#AAAAAA"},on:{click:function(t){return e.getIFCStoreys()}}},[e._v(" Get floors from IFC ")]),a("br"),a("br"),a("v-select",{attrs:{items:e.floorlist,label:e.$t("text_all"),"return-object":"",single:"",chips:"",solo:""},model:{value:e.floorsselected,callback:function(t){e.floorsselected=t},expression:"floorsselected"}})],1),a("v-btn",{staticClass:"white--text",attrs:{color:"#3577cb"},on:{click:function(t){return e.createFloorplan()}}},[e._v(" Create Floorplan ")]),a("br"),a("br"),e.loading?e._e():a("div",[a("h2",[e._v("Gather sensor information")]),a("hr",{staticClass:"hr1"}),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#3577cb"},on:{click:function(t){return e.getIFCSensorElements()}}},[e._v(" Store sensors ")]),a("br"),a("br")],1),e.loading?e._e():a("div",[a("h2",[e._v("Generate room numbers")]),a("hr",{staticClass:"hr1"}),a("br"),a("v-btn",{staticClass:"black--text",attrs:{color:"#AAAAAA",disabled:1!=e.roomNumberProcess||e.loading},on:{click:function(t){return e.getIFCStoreys()}}},[e._v(" Get floors from IFC ")]),a("br"),a("br"),a("v-select",{attrs:{items:e.floorlist,label:e.$t("text_all"),"return-object":"",single:"",chips:"",solo:"",disabled:e.loading},model:{value:e.floorsselected,callback:function(t){e.floorsselected=t},expression:"floorsselected"}})],1),a("v-radio-group",{staticStyle:{width:"100%"},attrs:{inline:""},model:{value:e.labelType,callback:function(t){e.labelType=t},expression:"labelType"}},[a("v-radio",{attrs:{label:"Trafficload",value:"1",selected:""}}),a("v-radio",{attrs:{label:"Room numbers",value:"2"}})],1),a("v-switch",{attrs:{label:"Rooms exist in trinpod",color:"blue","hide-details":""},model:{value:e.roomsExistInTrinpod,callback:function(t){e.roomsExistInTrinpod=t},expression:"roomsExistInTrinpod"}}),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#337733",disabled:3!=e.roomNumberProcess||e.loading},on:{click:function(t){return e.generateDoorCirculation()}}},[e._v(" Generate door circulation ")]),a("br"),a("br"),a("v-data-table",{staticClass:"elevation-0",attrs:{headers:e.doorIssueTableHeaders,items:e.doorIssueTableList,search:e.search,flat:"","item-key":"doorid","show-select":""},model:{value:e.doorIssueTableSelectedRow,callback:function(t){e.doorIssueTableSelectedRow=t},expression:"doorIssueTableSelectedRow"}}),a("br"),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#337733",disabled:4!=e.roomNumberProcess||e.loading},on:{click:function(t){return e.generateOpeningCirculation()}}},[e._v(" Generate opening circulation ")]),a("br"),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#337733",disabled:!1},on:{click:function(t){return e.generateStoreyLevelCirculation()}}},[e._v(" Generate storey level circulation ")]),a("br"),a("br"),a("b",[e._v("Building main entrances:")]),a("br"),e._l(e.buildingMainEntrances,(function(t){return a("li",[e._v(" "+e._s(t)+" ")])})),e.roomSelected?a("v-btn",{staticClass:"white--text",attrs:{color:"#3577cb",disabled:e.loading},on:{click:function(t){return e.setBuildingMainEntrance()}}},[e._v("Set")]):e._e(),a("br"),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#3577cb",disabled:e.loading},on:{click:function(t){e.calculateRoomTrafficLoad()}}},[e._v(" Calculate traffic load ")]),a("br"),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#3577cb"},on:{click:function(t){return e.generateRoomNames()}}},[e._v(" Generate roomnames ")]),a("br"),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#337733"},on:{click:function(t){return e.runNextTrafficArea()}}},[e._v(" Approve ")]),a("br"),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#3577cb"},on:{click:function(t){return e.editIFCStoreyNames()}}},[e._v(" Save updated IFC file ")]),a("br"),a("br"),a("h2",[e._v("Data upload")]),a("hr",{staticClass:"hr1"}),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#337733"},on:{click:function(t){return e.uploadFloorsToTrinpod()}}},[e._v(" Upload floors to trinpod ")]),a("br"),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#337733"},on:{click:function(t){return e.generateRoomsTurtle()}}},[e._v(" Upload rooms and doors to trinpod ")]),a("br"),a("br"),a("hr",{staticClass:"hr1"}),a("br"),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#337733"},on:{click:function(t){return e.loadIFCSlabs()}}},[e._v(" Show slabs ")]),a("br"),a("br"),a("h2",[e._v("Position building")]),a("hr",{staticClass:"hr1"}),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#337733"},on:{click:function(t){return e.showIFC()}}},[e._v(" Show IFC ")]),a("br"),a("br"),e._v(" Rotate building with E and R. "),a("br"),e._v(" Move building with WASD. "),a("br"),e._v(" Building height with Z and X. "),a("br"),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#337733"},on:{click:function(t){return e.setBuildingPoint1()}}},[e._v(" Set point 1 ")]),a("br"),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#3333BB"},on:{click:function(t){return e.setBuildingLatLong1()}}},[e._v(" Set LatLong 1 ")]),a("br"),a("br"),a("v-btn",{staticClass:"white--text",attrs:{color:"#337733"},on:{click:function(t){return e.fineTuneBuildingRotation()}}},[e._v(" Finetune rotation ")]),a("br"),a("br"),e._v(" "+e._s(e.buildingPosition)+" "),a("v-btn",{staticClass:"white--text",attrs:{color:"#BB33BB"},on:{click:function(t){return e.uploadPropertiesJson()}}},[e._v(" Upload JSON ")]),a("br"),a("br")],2)],1)},or=[],sr=(a("6ca8"),a("b418")),rr=a("95cc"),nr=a.n(rr),ir=a("a2ed"),lr=a("e90a"),cr=a("0dbf"),dr=a("00ce"),ur=a("ec14");const hr=a("592d"),gr=new dr["a"];async function mr(){console.log("Initialize multithreading.."),await gr.ifcManager.useWebWorkers(!0,"../IFCWorker.js"),await gr.ifcManager.setWasmPath("../")}gr.ifcManager.setupThreeMeshBVH(cr["b"],cr["c"],cr["a"]),Number.prototype.pad=function(e){var t=String(this);while(t.length<(e||2))t="0"+t;return t};const pr=c["a"].state.serverPath;let fr=void 0;d["c"].SIO("SIO_000202"),d["c"].DUL("hasPart"),d["c"].LDP("contains"),d["c"].NEO("t_1pr4n"),d["c"].NEO("m_port"),d["c"].SIO("SIO_000202"),d["c"].DUL("hasPart"),d["c"].LDP("contains"),d["c"].NEO("t_1pr4n");const br="https://hovedbygg111."+c["a"].state.testNum+pr;let vr=hr.graph();function yr(e,t,a,o=!1){c["a"].state.rs.rdfStore.match(e,t,a)[0]?(o&&console.log("Warning: data already exist:"),o&&console.log("Subject: "+e.value+" Predicate: "+t.value+"Object: "+a.value)):c["a"].state.rs.rdfStore.add(e,t,a,hr.default)}function wr(e,t,a,o,s=!1){vr.match(e,t,a)[0]?(s&&console.log("Warning: data already exist:"),s&&console.log("Subject: "+e.value+" Predicate: "+t.value+"Object: "+a.value)):vr.add(e,t,a,hr.default)}const Ir=document.createElement("div"),Sr=new ur["a"]({container:Ir,backgroundColor:new js["o"](16777215)});Sr.IFC.loader.ifcManager.useWebWorkers(!0,"../IFCWorker.js"),Sr.IFC.setWasmPath("../");let Rr=void 0;const Ar=(e,t,a)=>Math.abs(e-t)<a,Er=(e,t)=>{let a=[];for(let o=0;o<e.length-1;o++)for(let s=o+1;s<e.length;s++)Ar(e[o],e[s],t)&&(a[o]=e[o],a[100+s]=e[s]);return a.filter(Number).sort((function(e,t){return e-t}))},xr={};var _r={id:xr,name:"IFCexporter",data(){return{valid:!0,labelType:"1",loading:!1,ifctypesselected:[],ifctypes:["IFCWALLSTANDARDCASE","IFCSLAB","IFCWALL","IFCROOF","IFCCOVERING","IFCDOOR","IFCWINDOW","IFCFURNISHINGELEMENT","IFCMEMBER","IFCPLATE","IFCCURTAINWALL","IFCSPACE","IFCFLOWFITTING","IFCFLOWMOVINGDEVICE","IFCFLOWSEGMENT","IFCFLOWTERMINAL","IFCFLOWCONTROLLER","IFCFLOWCONTROLLERTYPE","IFCFLOWFITTINGTYPE","IFCFLOWINSTRUMENT","IFCFLOWINSTRUMENTTYPE","IFCFLOWMETER","IFCFLOWMETERTYPE","IFCFLOWMOVINGDEVICETYPE","IFCFLOWSEGMENTTYPE","IFCFLOWSTORAGEDEVICE","IFCFLOWSTORAGEDEVICETYPE","IFCFLOWTERMINALTYPE","IFCFLOWTREATMENTDEVICE","IFCFLOWTREATMENTDEVICETYPE"],splitbyfloor:!0,floorsselected:[],floorlist:[],floorheights:[],floorids:[],floortags:[],ifcfile:"building.ifc",ifcfiles:[],roomsExistInTrinpod:!1,buildingMainEntrances:[],buildingMainEntranceURIs:[],roomSelected:!1,roomList:[],ifcmodelLoaded:!1,search:"",roomNumberProcess:1,roomURIsNumbered:[],nextTrafficArea:{},deep:0,wingEntranceList:[],wingEntranceNames:[],spaceIntersections:[],lockedDoors:[],uriBlackList:[],doorIssueTableHeaders:[{text:"Door id",align:"start",filterable:!1,value:"doorid"},{text:"Room1",value:"room1"},{text:"Room2",value:"room2"}],doorIssueTableList:[],doorIssueTableSelectedRow:[],rotationStep:48,buildingPosition:{buildinglat:0,buildinglong:0,xAnchorDisplacement:0,yAnchorDisplacement:0,buildingPosX:0,buildingPosY:0,rotation:{x:0,y:0,z:0},buildingdimensions:{v1:{x:0,y:0,z:0},v2:{x:0,y:0,z:0},v3:{x:0,y:0,z:0}}}}},methods:{...Object(oa["c"])("bv",["RESIZE"]),...Object(oa["b"])("bv",["RENDER","INITIALIZE_PLAYER"]),addEventListerners(){document.addEventListener("keyup",this.keyEvents)},removeEventListerners(){document.removeEventListener("keyup",this.keyEvents)},keyEvents(e){82!==e.keyCode?69!==e.keyCode?87!==e.keyCode?83!==e.keyCode?65!==e.keyCode?68!==e.keyCode||this.moveBuildingBox(1,0,0):this.moveBuildingBox(-1,0,0):this.moveBuildingBox(0,0,1):this.moveBuildingBox(0,0,-1):this.rotateBuildingbox(-1):this.rotateBuildingbox(1)},checklogin(){console.log(window.solid.session.info),window.solid.session.info.isLoggedIn?console.log("Test logged in"):(console.log("Is logged out, reroute"),this.$router.push({path:"/"}))},clearScene(){const e=c["a"].state.bv.scene.getObjectByName("buildingbox");for(var t=c["a"].state.bv.scene.children.length-1;t>=0;t--)"buildingbox"==c["a"].state.bv.scene.children[t].name||"light"==c["a"].state.bv.scene.children[t].name||c["a"].state.bv.scene.children[t].name.includes("map")||c["a"].state.bv.scene.remove(c["a"].state.bv.scene.children[t]);for(t=e.children.length-1;t>=0;t--)e.remove(e.children[t]);this.roomNumberProcess=1,this.loading=!1,this.roomURIsNumbered=[],this.ifcmodelLoaded=!1,this.doorIssueTableList=[]},createTrinpods(){let e=[];const t=c["a"].state.testNum;console.log("URI:");let a="https://espen"+t+"."+c["a"].state.serverPath;e.push(["helsenorge"+t,"Helse og Omsorgsdepartementet",a,"organization","construction"]),e.push(["helsenord"+t,"Helse Nord RHF","https://helsenorge"+t+"."+c["a"].state.serverPath,"sub_org","construction"]),e.push(["helgeland"+t,"Helgelandsykehuset HF","https://helsenord"+t+"."+c["a"].state.serverPath,"sub_org","construction"]),e.push(["moirana"+t,"1 - Mo I Rana","https://helgeland"+t+"."+c["a"].state.serverPath,"sub_org","construction"]),e.push(["sjoforsgata36"+t,"Sjøforsgata 36","https://moirana"+t+"."+c["a"].state.serverPath,"site","construction"]),e.push(["hovedbygg111"+t,"111 - Hovedbygg","https://sjoforsgata36"+t+"."+c["a"].state.serverPath,"building","construction"]),jt["a"].createTrinpods(e).then(e=>{console.log(e)})},async convertIFCtoGLTF(e="IFCSPACE",t=[lr["IFCSPACE"]]){let a=[];this.ifctypesselected.forEach(e=>{"IFCWALLSTANDARDCASE"==e&&a.push(lr["IFCWALLSTANDARDCASE"]),"IFCSLAB"==e&&a.push(lr["IFCSLAB"]),"IFCWALL"==e&&a.push(lr["IFCWALLSTANDARDCASE"]),"IFCROOF"==e&&a.push(lr["IFCWALL"]),"IFCDOOR"==e&&a.push(lr["IFCROOF"]),"IFCWINDOW"==e&&a.push(lr["IFCDOOR"]),"IFCFURNISHINGELEMENT"==e&&a.push(lr["IFCWINDOW"]),"IFCMEMBER"==e&&a.push(lr["IFCMEMBER"]),"IFCPLATE"==e&&a.push(lr["IFCPLATE"]),"IFCCURTAINWALL"==e&&a.push(lr["IFCCURTAINWALL"]),"IFCSPACE"==e&&a.push(lr["IFCSPACE"]),"IFCCOVERING"==e&&a.push(lr["IFCCOVERING"]),"IFCFLOWFITTING"==e&&a.push(lr["IFCFLOWFITTING"]),"IFCFLOWMOVINGDEVICE"==e&&a.push(lr["IFCFLOWMOVINGDEVICE"]),"IFCFLOWSEGMENT"==e&&a.push(lr["IFCFLOWSEGMENT"]),"IFCFLOWTERMINAL"==e&&a.push(lr["IFCFLOWTERMINAL"]),"IFCFLOWCONTROLLER"==e&&a.push(lr["IFCFLOWCONTROLLER"]),"IFCFLOWCONTROLLERTYPE"==e&&a.push(lr["IFCFLOWCONTROLLERTYPE"]),"IFCFLOWFITTINGTYPE"==e&&a.push(lr["IFCFLOWFITTINGTYPE"]),"IFCFLOWINSTRUMENT"==e&&a.push(lr["IFCFLOWINSTRUMENT"]),"IFCFLOWINSTRUMENTTYPE"==e&&a.push(lr["IFCFLOWINSTRUMENTTYPE"]),"IFCFLOWMETER"==e&&a.push(lr["IFCFLOWMETER"]),"IFCFLOWMETERTYPE"==e&&a.push(lr["IFCFLOWMETERTYPE"]),"IFCFLOWMOVINGDEVICETYPE"==e&&a.push(lr["IFCFLOWMOVINGDEVICETYPE"]),"IFCFLOWSEGMENTTYPE"==e&&a.push(lr["IFCFLOWSEGMENTTYPE"]),"IFCFLOWSTORAGEDEVICE"==e&&a.push(lr["IFCFLOWSTORAGEDEVICE"]),"IFCFLOWSTORAGEDEVICETYPE"==e&&a.push(lr["IFCFLOWSTORAGEDEVICETYPE"]),"IFCFLOWTERMINALTYPE"==e&&a.push(lr["IFCFLOWTERMINALTYPE"]),"IFCFLOWTREATMENTDEVICE"==e&&a.push(lr["IFCFLOWTREATMENTDEVICE"]),"IFCFLOWTREATMENTDEVICETYPE"==e&&a.push(lr["IFCFLOWTREATMENTDEVICETYPE"])}),this.ifcloading=!0;let o=this.$route.query.location+"home/IFC/"+this.ifcfile;console.log("IFC uri: "+o);try{const t=await window.solid.session.fetch(o,{method:"GET",credentials:"include"});console.log(t);let s=await t.arrayBuffer(),r=URL.createObjectURL(new Blob([s],{type:"application/x-step"}));const n=await Sr.GLTF.exportIfcFileAsGltf({ifcFileUrl:r,splitByFloors:this.splitbyfloor,categories:{category:a},getProperties:!1});console.log(n);const i=document.createElement("a");document.body.appendChild(i);const l=await kt["a"].getIFCmetaDataFromJson(this.$route.query.location+"home/IFC/building.json");let c=l.tag;for(const a in n.gltf){const t=n.gltf[a];for(const a in t){t.height;const o=t[a].file;if(o){let t=c;for(const[o,s]of Object.entries(l.storeys))s==a&&(t=c+"."+o+"."+e);i.download=t+".gltf",i.href=URL.createObjectURL(o),i.click()}}}this.ifcmodelLoaded||(Rr=await gr.loadAsync(r),this.ifcmodelLoaded=!0);const d=await Sr.IFC.properties.serializeAllProperties(Rr),u=new File(d,"properties");i=document.createElement("a"),document.body.appendChild(i),i.href=URL.createObjectURL(u),i.download="ifc.json",i.click(),i.remove(),this.ifcloading=!1}catch(s){console.log(s)}},createFloorplan(){Dt["a"].unloadGeometryUsingTag(c["a"].state.currentBuildingTag,["BUILDING"]);let e=c["a"].state.currentBuildingTag+".";const t=this.$route.query.location+"home/IFC/"+this.ifcfile;let a=0;for(let o=0;o<this.floorlist.length;o++)this.floorlist[o]==this.floorsselected&&(a=o);console.log("FloorNumber:"+a),kt["a"].createFloorplan(a,t,e)},getRoomURIbyName(e){let t=c["a"].state.rs.rdfStore.match(null,d["c"].RDFS("label"),hr.literal("Room "+e,"en"))[0];return t?t.subject.value:(console.log("Warning: Did not find room URI!.."),ne["a"].getBlankNode("Room "+e))},getRoomNamebyURI(e){let t=c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].FOAF("name"),null)[0];return t?t.object.value:(console.log("Warning: Did not find name for URI!.."),"")},getRoomPolylinebyURI(e){let t=c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].IFOUR("m_polyline"),null)[0];return t?t.object.value:(console.log("Warning: Did not find polyline for URI!.."),"")},getExpressIDbyURI(e){let t=c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].IFOUR("expressid"),null)[0];return t?t.object.value:(console.log("Warning: Did not expressid for URI!.."),"")},getGlobalIDbyURI(e){let t=c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].IFOUR("globalid"),null)[0];return t?t.object.value:(console.log("Warning: Did not expressid for URI!.."),"")},async editIFCStoreyNames(){const e=gr.ifcManager,t=Rr.modelID,a=await e.getAllItemsOfType(t,lr["IFCBUILDINGSTOREY"],!1),o=a[0],s=await e.ifcAPI.GetLine(t,o);console.log(s),s.LongName?s.LongName.value="NivelEditado":s.Name.value="NivelEditado";const r=await e.ifcAPI.WriteLine(t,s);console.log(r);const n=await e.ifcAPI.ExportFileAsIFC(t),i=new Blob([n]),l=new File([i],"modified.ifc"),c=document.createElement("a");c.download="modified.ifc",c.href=URL.createObjectURL(l),document.body.appendChild(c),c.click(),c.remove()},generateRoomList(){console.log("Generating room list...");const e=[];let t=void 0;if(this.floorsselected.length>0)for(let a=0;a<this.floorlist.length;a++)this.floorsselected==this.floorlist[a]&&(t=this.floorheights[a]);return c["a"].state.rs.rdfStore.match(null,d["c"].IFOUR("roomhag"),null).forEach(a=>{let o=new js["uc"](0,0,0);if(c["a"].state.rs.rdfStore.match(hr.sym(a.subject.value),d["c"].SIO("SIO_000507"),null)[0]){let e=c["a"].state.rs.rdfStore.match(hr.sym(a.subject.value),d["c"].SIO("SIO_000507"),null)[0].object.value;o=ne["a"].pointStringToVector3(e)}let s=0;try{c["a"].state.rs.rdfStore.match(hr.sym(a.subject.value),d["c"].IFOUR("trafficload"),null)[0]?(s=Number(c["a"].state.rs.rdfStore.match(hr.sym(a.subject.value),d["c"].IFOUR("trafficload"),null)[0].object.value),console.log("Trafficload = "+s)):console.log("Trafficload was not found.")}catch(l){console.log(l)}let r=!1;e.forEach(e=>{e.uri==a.subject.value&&(r=!0)});let n=this.getRoomPolylinebyURI(a.subject.value),i=this.getRoomNamebyURI(a.subject.value).replace(" ","")+"";t?t!=a.object.value||r||e.push({uri:a.subject.value,name:i,trafficload:s,trafficAreaType:"",heightaboveground:a.object.value,loc:o,polyline:n,newname:"",globalid:this.getGlobalIDbyURI(a.subject.value),floorprefix:""}):r||e.push({uri:a.subject.value,name:i,trafficload:s,trafficAreaType:"",heightaboveground:a.object.value,loc:o,polyline:n,newname:"",expressid:this.getExpressIDbyURI(a.subject.value),globalid:this.getGlobalIDbyURI(a.subject.value),floorprefix:""})}),console.log("Roomlist length: "+e.length),console.log(e),e},async calculateRoomTrafficLoad(e=!1){this.loading=!0;const t=c["a"].state.bv.scene.getObjectByName("buildingbox");this.roomList.length<5&&(this.roomList=this.generateRoomList()),console.log("Find main entrance room");let a="";a=this.buildingMainEntrances[0],a+="".replace("Room ",""),a+="".replace("Rom ",""),this.roomList.forEach((t,o)=>{try{const e=hr.literal(a,"en"),o=hr.literal(t.name,"en");let s=sr["a"].methods.wayBetweenRooms(e,o,1,"Stair",this.uriBlackList,!1);s.length>0&&this.roomList.forEach((e,t)=>{s.includes(e.uri)&&(this.roomList[t].trafficload=this.roomList[t].trafficload+1)})}catch(s){e&&console.log("Traffic load error:"),e&&console.log(s)}}),e&&this.roomList.forEach((e,a)=>{let o=new js["uc"](0,0,0);e.loc&&(o=new js["uc"](e.loc.x,e.loc.y,e.loc.z)),Dt["a"].createSimpleLabel(o.applyMatrix4(t.matrixWorld),""+e.trafficload)}),this.roomList.forEach(e=>{yr(hr.sym(e.uri),d["c"].IFOUR("trafficload"),e.trafficload)}),this.generateTurtleFromStore(),this.loading=!1,this.roomNumberProcess=7},createLockedDoorList(){this.lockedDoors=[],this.$route.query.location.includes("hovedbygg111")&&(this.lockedDoors.push("V120"),this.lockedDoors.push(1635474)),this.addLockedDoorsToStore()},async checkForPermanentFloorURIs(){console.log("Checking for permanent storey URIs....");const e=[],t=[];let a=await Fe["a"].searchAndGetURIs("BUILDINGSTOREY");return a&&console.log(a),c["a"].state.rs.rdfStore.match(null,d["c"].TAG("tag"),"BUILDINGSTOREY").forEach(a=>{if(!t.includes(a.subject.value)){let o=0;c["a"].state.rs.rdfStore.match(hr.sym(a.subject.value),d["c"].IFOUR("roomhag"),null)[0]&&(o=c["a"].state.rs.rdfStore.match(hr.sym(a.subject.value),d["c"].IFOUR("roomhag"),null)[0].object.value),e.push({uri:a.subject.value,roomhag:o}),t.push(a.subject.value)}}),console.log("storeyList"),console.log(e),e},uploadFloorsToTrinpod(e=!0){vr=hr.graph(),this.floorids.forEach(e=>{""==e.uri&&(e.uri=ne["a"].getBlankNode(e.name)),wr(e.uri,d["c"].RDF("type"),d["c"].BOT("Storey"),hr.default),wr(e.uri,d["c"].RDFS("label"),hr.literal(e.name,"no"),hr.default),wr(e.uri,d["c"].RDFS("label"),hr.literal(e.name,"en"),hr.default),wr(e.uri,d["c"].TAG("tag"),"BUILDINGSTOREY"),wr(e.uri,d["c"].IFOUR("roomhag"),e.roomhag,hr.default),wr(e.uri,d["c"].IFOUR("expressid"),e.expressid,hr.default),wr(e.uri,d["c"].IFOUR("globalid"),e.globalid,hr.default),""!=e.tag&&wr(e.uri,d["c"].TAG("tag"),e.tag,hr.default),wr(hr.sym(this.$route.query.location+"i"),d["c"].SIO("SIO_000202"),e.uri,hr.default)});var t=ne["a"].storeToTurtle(vr,br);t=re["a"].modifyTurtle(t),console.log(t);const a=this.$route.query.location+"/i";window.solid.session.info.isLoggedIn&&""!=t&&!e?re["a"].uploadTurtle(a,t,!1).then(e=>{console.log("Upload floors response:"),console.log(e)}):console.log("Aborted upload, test = "+e)},addLockedDoorsToStore(){this.uriBlackList=[],this.lockedDoors.forEach(e=>{if(c["a"].state.rs.rdfStore.match(null,d["c"].FOAF("name"),hr.literal(e))[0]){const t=c["a"].state.rs.rdfStore.match(null,d["c"].FOAF("name"),hr.literal(e))[0].subject.value;this.uriBlackList.push(t),c["a"].state.rs.rdfStore.match(hr.sym(t),d["c"].IFOUR("islocked"),null)[0]||yr(hr.sym(t),d["c"].IFOUR("islocked"),hr.literal("yes"))}if(c["a"].state.rs.rdfStore.match(null,d["c"].IFOUR("expressid"),e)[0]){const t=c["a"].state.rs.rdfStore.match(null,d["c"].IFOUR("expressid"),e)[0].subject.value;this.uriBlackList.push(t),c["a"].state.rs.rdfStore.match(hr.sym(t),d["c"].IFOUR("islocked"),null)[0]||yr(hr.sym(t),d["c"].IFOUR("islocked"),hr.literal("yes"))}})},async nameTechnicalRooms(e){let t=0;for(let s=0;s<this.floorids.length;s++)this.floorids[s].name==this.floorsselected&&(t=this.floorids[s].expressid);let a=await this.getSpacesRelatedToStorey(t,Rr.modelID,!0),o=0;for(let s=0;s<this.roomList.length;s++)if(0==this.roomList[s].trafficload&&this.roomList[s].newname.length<1&&a.includes(Number(this.roomList[s].expressid))){o++,this.roomList[s].newname="T"+e+"."+o.pad(2);const t=[this.polyLineTo2dArray(this.roomList[s].polyline)],a=nr()(t,1),r=Dt["a"].convertPolylineToXY(this.roomList[s].polyline);let n=new js["uc"](r.x+a[1],this.roomList[s].loc.y,-r.y+a[0]);console.log("Technical: "+this.roomList[s].name),this.setSpaceLabel(n,this.roomList[s].newname)}},async generateRoomNames(){console.log("Find main entrance room"),Dt["a"].removeAllLabels();let e="",t="";this.buildingMainEntrances.forEach(a=>{try{const o=c["a"].state.rs.rdfStore.match(null,d["c"].RDFS("label"),hr.literal(a,"en"))[0].subject.value,s=c["a"].state.rs.rdfStore.match(null,d["c"].NEO("m_port"),hr.sym(o))[0].subject.value,r=c["a"].state.rs.rdfStore.match(hr.sym(s),d["c"].RDFS("label"),null)[0].object.value;e.includes("Outdoor")||(t=s,e=r.replace("Room ",""))}catch(o){}}),console.log("Entrance room name: "+e),this.roomList.length<5&&(this.roomList=this.generateRoomList());let a="1";this.$route.query.location.includes("hovedbygg111")&&(this.floorsselected.includes("2U.")&&(a="U2",this.wingEntranceList.push({name:"038",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"E"+a+"."}),this.wingEntranceList.push({name:"002",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"F"+a+"."}),this.wingEntranceList.push({name:"B001",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"G"+a+"."})),this.floorsselected.includes("1U.")&&(a="U1",this.wingEntranceList.push({name:"0Ø01",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"A"+a+"."}),this.wingEntranceList.push({name:"0N01",uri:"",doorlocation:void 0,resetnum:!1,wingtag:"A"+a+"."}),this.wingEntranceList.push({name:"0V04",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"B"+a+"."}),this.wingEntranceList.push({name:"0Ø05",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"C"+a+"."}),this.wingEntranceList.push({name:"0Ø07",uri:"",doorlocation:void 0,resetnum:!1,wingtag:"C"+a+"."}),this.wingEntranceList.push({name:"174",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"E"+a+"."}),this.wingEntranceList.push({name:"152",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"F"+a+"."}),this.wingEntranceList.push({name:"151",uri:"",doorlocation:void 0,resetnum:!1,wingtag:"F"+a+"."}),this.wingEntranceList.push({name:"B101",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"G"+a+"."}),this.wingEntranceList.push({name:"S00.K01",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"H"+a+"."})),this.floorsselected.includes("1.")&&(a="1",this.wingEntranceList.push({name:"1N01",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"A"+a+"."}),this.wingEntranceList.push({name:"1V3",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"B"+a+"."}),this.wingEntranceList.push({name:"1Ø09",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"C"+a+"."}),this.wingEntranceList.push({name:"1Ø11",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"D"+a+"."}),this.wingEntranceList.push({name:"F131",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"E"+a+"."}),this.wingEntranceList.push({name:"252",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"F"+a+"."}),this.wingEntranceList.push({name:"B201",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"G"+a+"."}),this.wingEntranceList.push({name:"S01.K01",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"H"+a+"."})),this.floorsselected.includes("2.")&&(a="2",this.wingEntranceList.push({name:"2Ø02",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"A"+a+"."}),this.wingEntranceList.push({name:"V224",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"B"+a+"."}),this.wingEntranceList.push({name:"V234",uri:"",doorlocation:void 0,resetnum:!1,wingtag:"B"+a+"."}),this.wingEntranceList.push({name:"2Ø07",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"C"+a+"."}),this.wingEntranceList.push({name:"2M01",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"D"+a+"."}),this.wingEntranceList.push({name:"F215",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"E"+a+"."}),this.wingEntranceList.push({name:"352",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"F"+a+"."}),this.wingEntranceList.push({name:"S02.K01",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"H"+a+"."})),this.floorsselected.includes("3.")&&(a="3",this.wingEntranceList.push({name:"3V1",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"B"+a+"."}),this.wingEntranceList.push({name:"Ø327",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"C"+a+"."}),this.wingEntranceList.push({name:"F336",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"E"+a+"."})),this.floorsselected.includes("4.")&&(a="4",this.wingEntranceList.push({name:"4Ø02",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"C"+a+"."})),this.floorsselected.includes("5.")&&(a="5",this.wingEntranceList.push({name:"5Ø02",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"C"+a+"."})),this.floorsselected.includes("6.")&&(a="6",this.wingEntranceList.push({name:"6Ø02",uri:"",doorlocation:void 0,resetnum:!0,wingtag:"C"+a+"."}))),this.$route.query.location.includes("hovedbygg211")&&(this.wingEntranceList.push({name:"5133",uri:"_:t236",doorlocation:this.getDoorLocation("_:t236"),wingtag:"A1"}),this.wingEntranceList.push({name:"1027",uri:"_:t255",doorlocation:this.getDoorLocation("_:t255"),wingtag:"B1"}),this.wingEntranceList.push({name:"4126",uri:"_:t258",doorlocation:this.getDoorLocation("_:t258"),wingtag:"C1"})),this.$route.query.location.includes("hovedbygg311")&&(this.floorsselected.includes("3. Etasje")&&(this.wingEntranceList.push({name:e,uri:t,doorlocation:this.getEntranceDoorLocation(this.buildingMainEntranceURIs[0]),wingtag:"A3"}),this.wingEntranceList.push({name:"G316",uri:"_:t534",doorlocation:this.getDoorLocation("_:t534"),wingtag:"B3"}),this.wingEntranceList.push({name:"C309",uri:"_:t536",doorlocation:this.getDoorLocation("_:t536"),wingtag:"C3"}),this.increaseTrafficLoadForSpace(e,"H314","G313",200)),this.floorsselected.includes("2. Etasje")&&(this.wingEntranceList.push({name:"H214",uri:"_:t298",doorlocation:this.getDoorLocation("_:t298"),wingtag:"A2"}),this.wingEntranceList.push({name:"J214",uri:"_:t337",doorlocation:this.getDoorLocation("_:t337"),wingtag:"B2"}),this.wingEntranceList.push({name:"G214",uri:"_:t270",doorlocation:this.getDoorLocation("_:t270"),wingtag:""}),this.wingEntranceList.push({name:"C209",uri:"_:t184",doorlocation:this.getDoorLocation("_:t184"),wingtag:"C2"}))),await this.showDoorMarkers2(),this.wingEntranceList.forEach(e=>{e.uri=this.getRoomURIbyName(e.name),e.doorlocation=this.getDoorLocation(e.uri),this.wingEntranceNames.push(e.name)});for(let s=0;s<this.roomList.length;s++)this.checkIfVerticalPassage(this.roomList[s].uri)&&(this.roomList[s].trafficload=2,this.roomList[s].trafficAreaType="Verticalpassage");console.log("Wing entrance list:"),console.log(this.wingEntranceList);let o=0;this.wingEntranceList.forEach(e=>{""!=e.wingtag&&(e.resetnum&&(o=0),this.deep=0,Dt["a"].createPlaceMarker(e.doorlocation,65280,!1,2,"placemarker",.25),o=this.newTrafficArea(e.uri,o,e.doorlocation,e.wingtag,a))}),await this.nameTechnicalRooms(a),this.storeNewRoomNumbers(),c["a"].state.bv.needsrender=!0},newTrafficArea(e,t,a,o,s,r=!0){let n="simplelabel";r||(n="templabel"),t++,console.log("Running trafficarea: "+t+" with URI: "+e);let i=0,l=new js["uc"](0,0,0),c="",d=0,u=0;this.roomList.forEach((t,a)=>{if(t.uri==e){const e=[this.polyLineTo2dArray(t.polyline)],o=nr()(e,1),r=Dt["a"].convertPolylineToXY(t.polyline);l=new js["uc"](r.x+o[1],t.loc.y,-r.y+o[0]),i=t.trafficload,c=t.name,d=a,u=t.heightaboveground,t.floorprefix=s}});let h=this.getDoorsInSpace(e,a.clone());console.log("Door array before:"),console.log(h);const g=this.getRoomPolylinebyURI(e),m=Dt["a"].getDoorDirectionVector(g,a.clone(),!1);h.forEach(t=>{const a=this.getRoomBehindDoor(t.uri,e);this.checkIfVerticalPassage(e)&&(i=2,a.roomtype="Subrooms"),t.roomobject=a,"Join"==t.type&&this.spaceIntersections.forEach(e=>{(t.name.replace("Room ","").replace("Rom ","")==e.room1&&c==e.room2||t.name.replace("Room ","").replace("Rom ","")==e.room2&&c==e.room1)&&(t.position=new js["uc"](e.point.x,e.point.y,e.point.z))})}),h.forEach(e=>{h.length>=3&&(e.x=this.getDoorXDistance(e.position.clone(),a.clone(),m.clone()),e.y=this.getDoorYDistance(e.position.clone(),a.clone(),m.clone()))});let p=this.getCurrentTrafficAreaType(h);this.checkIfVerticalPassage(e)&&(p="Verticalpassage"),this.roomList[d].trafficAreaType=p,this.setSpaceLabelType(l,o+t.pad(2),p,n),this.roomList[d].newname=o+t.pad(2),this.roomURIsNumbered.push(e),console.log("TrafficAreaType: "+p),"Wideareasmall"==p&&(h=this.sortWideAreaSmall(h)),"Widearealarge"==p&&(h=this.sortWideAreaLarge(h)),"Hallcross"==p&&(h=this.sortHallCross(h)),"Hallaway"==p&&(h=this.sortHallAway(h)),console.log("Number of doors: "+h.length);for(let f=0;f<h.length;f++){const e=h[f];if(0!=e.roomobject.trafficload&&!this.roomURIsNumbered.includes(e.roomobject.uri)){if(!Ar(e.roomobject.heightaboveground,u,.5))continue;l=new js["uc"](0,0,0),e.roomobject.position&&(l=e.roomobject.position);const a=this.polyLineTo2dArray(e.roomobject.polyline);if(a.length>8){const t=[a],o=nr()(t,1),s=Dt["a"].convertPolylineToXY(e.roomobject.polyline);l=new js["uc"](s.x+o[1],e.roomobject.position.y,-s.y+o[0])}"Single"==e.roomobject.roomtype&&(t++,this.checkIfVerticalPassage(e.roomobject.uri)?this.setSpaceLabelType(l,o+t.pad(2),"Verticalpassage",n):this.setSpaceLabel(l,o+t.pad(2),n),this.roomList[d].newname=o+t.pad(2),this.roomURIsNumbered.push(e.roomobject.uri)),"Subrooms"==e.roomobject.roomtype&&(t++,this.checkIfVerticalPassage(e.roomobject.uri)?this.setSpaceLabelType(l,o+t.pad(2),"Verticalpassage",n):this.setSpaceLabel(l,o+t.pad(2),n),this.roomList[d].newname=o+t.pad(2),this.roomURIsNumbered.push(e.roomobject.uri),this.numberSubRooms(e.roomobject.uri,o,t))}}h.sort((e,t)=>e.roomobject.trafficload<t.roomobject.trafficload?1:e.roomobject.trafficload>t.roomobject.trafficload?-1:0);for(let f=0;f<h.length;f++){const e=h[f];if((!this.lockedDoors.includes(e.roomobject.name.replace("Rom ","").replace("Room ",""))||"Join"!=e.type)&&(!this.lockedDoors.includes(e.uri)&&Ar(e.roomobject.heightaboveground,u,.5)&&0!=e.roomobject.trafficload&&!this.roomURIsNumbered.includes(e.roomobject.uri))){let a=!1;this.wingEntranceNames.forEach(t=>{t==e.roomobject.name.replace("Room ","")&&(a=!0),t==e.roomobject.name.replace("Rom ","")&&(a=!0)}),"Trafficarea"==e.roomobject.roomtype&&!a&&e.roomobject.trafficload<i&&(this.deep++,this.deep<25&&(console.log("Running new trafficarea: "+e.roomobject.name),console.log(e.position),Dt["a"].createPlaceMarker(e.position.clone(),65280,!1,2,"placemarker",.25),"_:t1105"==e.roomobject.uri?this.nextTrafficArea={spaceURI:e.roomobject.uri,roomNum:t,doorLocation:e.position.clone(),wingtag:o,floorPrefix:s,roomNumbersApproved:!0}:t=this.newTrafficArea(e.roomobject.uri,t,e.position.clone(),o,s,!0)))}}return t},runNextTrafficArea(){this.newTrafficArea(this.nextTrafficArea.spaceURI,this.nextTrafficArea.roomNum,this.nextTrafficArea.doorLocation,this.nextTrafficArea.wingtag,this.nextTrafficArea.floorPrefix,this.nextTrafficArea.roomNumbersApproved)},checkIfVerticalPassage(e){return!!c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].NEO("b_capable"),d["c"].SBEO("VerticalPassage"))[0]},sortWideAreaSmall(e){return e.sort((function(e,t){return Math.abs(t.y-e.y)>.3?e.y-t.y:e.x-t.x}))},sortWideAreaLarge(e,t=!0){const a=[],o=[];let s=[];e.forEach(e=>{a.push(e.x),o.push(e.y)});const r=Math.max.apply(Math,a),n=Math.min.apply(Math,a);Math.max.apply(Math,o),Math.min.apply(Math,o);o.forEach(e=>{console.log("doorYValue: "+e)});let i=Er(a,.6),l=Er(o,.6);i.sort((e,t)=>e<t?1:e>t?-1:0),l.sort((e,t)=>e<t?1:e>t?-1:0),i.forEach(e=>{console.log("DuplicateX: "+e)}),l.forEach(e=>{console.log("DuplicateY: "+e)});let c=[],d=!1;const u=this.countDuplicates(i,e,!0),h=this.countDuplicates(l,e,!1);console.log("Doorcount X:"+u+" Y:"+h),u>h&&(d=!0);let g=[];if(d){while(i.length>0)c=this.moveXLineValues(i,e,r,n,t),i=c[0],e=c[1],g=this.checkForGapInDistances(c[2]),g.forEach(e=>{s.push(e)});while(l.length>0)c=this.moveYLineValues(l,e,r,n,t),l=c[0],e=c[1],g=this.checkForGapInDistances(c[2]),g.forEach(e=>{s.push(e)})}else{while(l.length>0)c=this.moveYLineValues(l,e,r,n,t),l=c[0],e=c[1],g=this.checkForGapInDistances(c[2]),g.forEach(e=>{s.push(e)});while(i.length>0)c=this.moveXLineValues(i,e,r,n,t),i=c[0],e=c[1],g=this.checkForGapInDistances(c[2]),g.forEach(e=>{s.push(e)})}t&&console.log("Sorted door array after :"+s.length);for(var m=0;m<e.length;m++){const t=e[m];s.push({x:e[m].x,y:e[m].y,doorarray:[t]}),e.splice(m,1),m--}s=this.sortHallAway(s),console.log("sortedDoorArray: "+s.length),console.log(s);const p=[];return s.forEach(e=>{e.doorarray.forEach(e=>{p.push(e)})}),console.log("sortedDoorArray: "),console.log(p),p},checkForGapInDistances(e){console.log("Doorarray"),console.log(e.doorarray);let t=[],a=[],o=!1,s=void 0,r=void 0;for(let i=0;i<e.doorarray.length;i++)0!=i?(s&&e.doorarray[i].x-s>=8&&(o=!0),r&&e.doorarray[i].y-r>=8&&(o=!0),o?a.push(e.doorarray[i]):t.push(e.doorarray[i])):t.push(e.doorarray[i]),s=e.doorarray[i].x,r=e.doorarray[i].y;let n=[];return t[0]&&n.push({x:t[0].x,y:t[0].y,doorarray:t}),a[0]&&n.push({x:a[0].x,y:a[0].y,doorarray:a}),n},countDuplicates(e,t,a){const o=[];e.forEach(e=>{let t=!1;o.forEach(a=>{Ar(e,a,.6)&&(t=!0)}),t||o.push(e)});let s=0;const r=[];for(var n=0;n<o.length;n++){s=0;for(var i=0;i<t.length;i++)Ar(t[i].x,o[n],.6)&&a&&s++,Ar(t[i].y,o[n],.6)&&!a&&s++;r.push(s)}return s=0,console.log("arrayofcounts"),console.log(r),r.forEach(e=>{e>4?s+=2:e>2&&s++}),s},removeTwoDoorDuplicates(e,t,a){},moveYLineValues(e,t,a,o,s){const r=Math.min.apply(Math,e);let n=[];for(var i=0;i<e.length;i++){let c=2.5;if(e[i]<=r+c){for(var l=0;l<t.length;l++)t[l].y==e[i]&&Math.abs(t[l].x-a)>.3&&Math.abs(t[l].x-o)>.3&&(n.push(t[l]),s&&console.log("Adding to Y line: "+t[l].name),t.splice(l,1),l--);e.splice(i,1),i--}}n=this.sortHallCross(n);let c={x:0,y:0};return n[0]&&(c={x:n[0].x,y:n[0].y}),s&&console.log("First door point x: "+c.x+" y: "+c.y),s&&console.log("Moving to new line..."),[e,t,{x:c.x,y:c.y,doorarray:n}]},moveXLineValues(e,t,a,o,s){const r=Math.min.apply(Math,e);let n=[];for(var i=0;i<e.length;i++){let a=2.5;if(e[i]<=r+a){for(var l=0;l<t.length;l++)t[l].x==e[i]&&(n.push(t[l]),s&&console.log("Adding to X line: "+t[l].name),t.splice(l,1),l--);e.splice(i,1),i--}}n=this.sortHallAway(n);let c={x:0,y:0};return n[0]&&(c={x:n[0].x,y:n[0].y}),s&&console.log("Moving to new line..."),[e,t,{x:c.x,y:c.y,doorarray:n}]},sortHallCross(e){return e.sort((function(e,t){return Math.abs(t.x-e.x)>.3?e.x-t.x:e.y-t.y}))},sortHallAway(e){return e.sort((function(e,t){return Math.abs(t.y-e.y)>.3?e.y-t.y:e.x-t.x}))},getDoorsInSpace(e,t=!1){const a=[],o=[],s=[];return c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].NEO("m_port"),null).forEach(e=>{a.includes(e.object.value)||(a.push(e.object.value),o.push(2))}),c["a"].state.rs.rdfStore.match(null,d["c"].NEO("m_port"),hr.sym(e)).forEach(e=>{a.includes(e.subject.value)||(a.push(e.subject.value),o.push(2))}),c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].NEO("m_join"),null).forEach(e=>{a.includes(e.object.value)||(a.push(e.object.value),o.push(1))}),c["a"].state.rs.rdfStore.match(null,d["c"].NEO("m_join"),hr.sym(e)).forEach(e=>{a.includes(e.subject.value)||(a.push(e.subject.value),o.push(1))}),a.forEach((e,a)=>{const r=c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].RDFS("label"),null)[0].object.value;let n=0;c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].IFOUR("roomhag"),null)[0]&&(n=c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].IFOUR("roomhag"),null)[0].object.value),t&&console.log("DoorName: "+r),t&&console.log("DoorURI: "+e);let i="Door";1==o[a]&&(i="Join");let l=new js["uc"](0,0,0);l="Join"!=i?this.getDoorPosition(e):this.getJoinPosition(e),s.push({uri:e,name:r,position:l,x:0,y:0,pri:o[a],nextroomhag:n,type:i,roomobject:{}})}),s},getRoomBehindDoor(e,t){let a=e,o="",s="",r="",n=0,i=0,l=c["a"].state.rs.rdfStore.match(hr.sym(a),d["c"].RDFS("label"),null)[0].object.value,u=!1;c["a"].state.rs.rdfStore.match(hr.sym(a),d["c"].RDF("type"),d["c"].BOT("Space"))[0]&&(u=!0),u||(c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].NEO("m_port"),null).forEach(e=>{e.object.value!=t&&(a=e.object.value)}),c["a"].state.rs.rdfStore.match(null,d["c"].NEO("m_port"),hr.sym(e)).forEach(e=>{e.subject.value!=t&&(a=e.subject.value)})),c["a"].state.rs.rdfStore.match(hr.sym(a),d["c"].RDFS("label"),null)[0]&&(l=c["a"].state.rs.rdfStore.match(hr.sym(a),d["c"].RDFS("label"),null)[0].object.value);let h=new js["uc"](0,0,0);return this.roomList.forEach((e,t)=>{e.uri==a&&(i=e.trafficload,h=new js["uc"](e.loc.x,e.loc.y,e.loc.z),s=e.polyline,n=e.heightaboveground,r=e.trafficAreaType)}),i<2&&(o="Single"),i<4&&i>1&&(o="Subrooms"),i>=4&&(o="Trafficarea"),{uri:a,name:l.replace("  "," "),position:h,polyline:s,trafficload:i,roomtype:o,heightaboveground:n}},setSpaceLabel(e,t,a){const o=c["a"].state.bv.scene.getObjectByName("buildingbox");Dt["a"].createSimpleLabel(e.applyMatrix4(o.matrixWorld),""+t,a)},setSpaceLabelType(e,t,a,o){const s=c["a"].state.bv.scene.getObjectByName("buildingbox");Dt["a"].createLabelWithType(e.applyMatrix4(s.matrixWorld),""+t,""+a,o)},polyLineTo2dArray(e){const t=Dt["a"].convertPolylineToPolyarray(e),a=[];while(t.length>1){const e=t.splice(0,3);a.push([Number(e[0]),Number(e[1])])}return a},polyLineXY(e){const t=Dt["a"].convertPolylineToPolyarray(e),a=[];while(t.length>1){const e=t.splice(0,3);a.push([Number(e[0]),Number(e[1])])}return a},numberSubRooms(e,t,a,o=0,s){const r=this.getDoorsInSpace(e),n=[];let i=0,l=0;this.roomList.forEach((t,a)=>{t.uri==e&&(i=t.trafficload,l=a)}),r.forEach(t=>{const a=this.getRoomBehindDoor(t.uri,e);if(t.roomobject=a,"Join"==t.type){n.push(t.roomobject.polyline);let e=Dt["a"].findSpaceIntersections(n,.5,!1);e.forEach(e=>{(t.name.includes(e.room1)||t.name.includes(e.room2))&&(t.position=new js["uc"](e.point.x,e.point.y,e.point.z))})}}),r.forEach(r=>{if(0!=r.roomobject.trafficload&&!this.roomURIsNumbered.includes(r.roomobject.uri)&&r.roomobject.trafficload<i){let n=new js["uc"](0,0,0);r.roomobject.position&&(n=r.roomobject.position);let c=this.getTrafficLoadInSpaceBehind(e,r.roomobject.uri);if(c<=i||"Join"==r.type){o++,this.setSpaceLabel(n,t+a.pad(2)+"."+o,s),this.roomList[l].newname=t+a.pad(2)+"."+o,this.roomURIsNumbered.push(r.roomobject.uri);const i=this.getDoorsInSpace(r.roomobject.uri);i.forEach(s=>{const n=this.getRoomBehindDoor(r.uri,e);s.roomobject=n,this.numberSubRooms(s.roomobject.uri,t,a,o)})}}})},getTrafficLoadInSpaceBehind(e,t){const a=this.getDoorsInSpace(t);let o=0;return a.forEach(a=>{const s=this.getRoomBehindDoor(a.uri,t);s.uri!=e&&s.uri!=t&&s.trafficload>o&&(o=s.trafficload)}),o},getDoorXDistance(e,t,a,o=!1){const s=t.distanceTo(e);a=t.clone().add(a.normalize().multiplyScalar(s));const r=new js["V"](t,a);o&&Dt["a"].createVisibleVector(t,a,255,s);const n=new js["uc"](0,0,0),i=new js["uc"](e.x,e.y,e.z);r.closestPointToPoint(i,!1,n);let l=n.distanceTo(i);var c=(new js["uc"]).subVectors(a,t).normalize(),d=(new js["uc"]).subVectors(e,t).normalize(),u=(new js["uc"]).crossVectors(c,d);const h=u.dot(new js["uc"](0,1,0));return h>0&&(l*=-1),isNaN(l)&&(l=0),l},getDoorYDistance(e,t,a,o=!1){const s=t.clone().distanceTo(e);var r=new js["Lb"];r.setFromAxisAngle(new js["uc"](0,1,0),Math.PI/2),a.applyQuaternion(r),o&&Dt["a"].createVisibleVector(t,a,65280,s);const n=t.clone().add(a.clone().multiplyScalar(s)),i=t.clone().add(a.clone().negate().multiplyScalar(s));o&&Dt["a"].createVisibleVector(t,a.clone().negate(),65280,s);const l=new js["V"](n,i),c=new js["uc"](0,0,0),d=new js["uc"](e.x,e.y,e.z);l.closestPointToPoint(d,!1,c);let u=c.distanceTo(d);var h=(new js["uc"]).subVectors(n,t).normalize(),g=(new js["uc"]).subVectors(e,t).normalize(),m=(new js["uc"]).crossVectors(h,g);const p=m.dot(new js["uc"](0,1,0));return p>0&&(u*=-1),isNaN(u)&&(u=0),u},getDoorLocation(e){let t=new js["uc"](0,0,0),a=5e3;return this.roomList.forEach(t=>{t.uri==e&&(a=t.trafficload,console.log("Current trafficload: "+a))}),c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].NEO("m_port"),null).forEach(o=>{c["a"].state.rs.rdfStore.match(null,d["c"].NEO("m_port"),hr.sym(o.object.value)).forEach(s=>{s.subject.value!=e&&this.roomList.forEach(e=>{if(e.uri==s.subject.value&&e.trafficload>a&&c["a"].state.rs.rdfStore.match(hr.sym(o.object.value),d["c"].SIO("SIO_000507"),null)[0]){let e=c["a"].state.rs.rdfStore.match(hr.sym(o.object.value),d["c"].SIO("SIO_000507"),null)[0].object.value;t=ne["a"].pointStringToVector3(e)}})})}),c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].IFOUR("hasInterfacePoint"),null).forEach(o=>{c["a"].state.rs.rdfStore.match(null,d["c"].IFOUR("hasInterfacePoint"),hr.sym(o.object.value)).forEach(s=>{s.subject.value!=e&&this.roomList.forEach(e=>{if(e.uri==s.subject.value&&e.trafficload>a&&c["a"].state.rs.rdfStore.match(hr.sym(o.object.value),d["c"].SIO("SIO_000507"),null)[0]){let e=c["a"].state.rs.rdfStore.match(hr.sym(o.object.value),d["c"].SIO("SIO_000507"),null)[0].object.value;t=ne["a"].pointStringToVector3(e)}})})}),t},getDoorPosition(e){let t=new js["uc"](0,0,0);if(c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].SIO("SIO_000507"),null)[0]){let a=c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].SIO("SIO_000507"),null)[0].object.value;t=ne["a"].pointStringToVector3(a)}return t},getJoinPosition(e){let t=new js["uc"](1,0,0),a=5e3;return this.roomList.forEach(t=>{t.uri==e&&(a=t.trafficload,console.log("Current trafficload: "+a))}),c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].IFOUR("hasInterfacePoint"),null).forEach(o=>{c["a"].state.rs.rdfStore.match(null,d["c"].IFOUR("hasInterfacePoint"),hr.sym(o.object.value)).forEach(s=>{s.subject.value!=e&&this.roomList.forEach(e=>{if(e.uri==s.subject.value&&e.trafficload>a&&c["a"].state.rs.rdfStore.match(hr.sym(o.object.value),d["c"].SIO("SIO_000507"),null)[0]){let e=c["a"].state.rs.rdfStore.match(hr.sym(o.object.value),d["c"].SIO("SIO_000507"),null)[0].object.value;t=ne["a"].pointStringToVector3(e)}})})}),t},getEntranceDoorLocation(e){let t=new js["uc"](0,0,0);if(c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].SIO("SIO_000507"),null)[0]){let a=c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].SIO("SIO_000507"),null)[0].object.value;t=ne["a"].pointStringToVector3(a)}return t},getCurrentTrafficAreaType(e){let t="Wideareasmall";const a=[],o=[];e.forEach(e=>{a.push(e.x),o.push(e.y)});const s=Math.max.apply(Math,a),r=Math.min.apply(Math,a),n=Math.max.apply(Math,o),i=Math.min.apply(Math,o),l=s-r,c=n-i;console.log("Length X: "+l+" length Y: "+c);const d=Er(a,.5),u=Er(o,.5);return d.length>2&&(t="Hallaway"),u.length>2&&u.length>d.length&&(t="Hallcross"),(l>=6&&c>=10||l>=10&&c>=6)&&(t="Widearealarge"),t},increaseTrafficLoadForSpace(e,t,a,o=1){const s=hr.literal(e,"en"),r=hr.literal(t,"en");let n=sr["a"].methods.wayBetweenRooms(s,r,1,"Stair",this.uriBlackList,!1);n.length>0&&this.roomList.forEach((e,t)=>{n.includes(e.uri)&&this.roomList[t].name!=a&&(this.roomList[t].trafficload=this.roomList[t].trafficload+o,console.log("Increased traffic load for space: "+this.roomList[t].name+" to value: "+this.roomList[t].trafficload))})},async loadIFCSlabs(){const e=c["a"].state.bv.scene.getObjectByName("buildingbox");this.ifcloading=!0;document.createElement("div");let t=this.$route.query.location+"home/IFC/"+this.ifcfile;try{const a=await window.solid.session.fetch(t,{method:"GET",credentials:"include"});let o=await a.arrayBuffer(),s=URL.createObjectURL(new Blob([o],{type:"application/x-step"}));this.ifcmodelLoaded||(Rr=await gr.loadAsync(s),this.ifcmodelLoaded=!0);const r=Rr.modelID,n=await gr.ifcManager.getAllItemsOfType(r,lr["IFCSLAB"]),i=kt["a"].getAllSubsetMeshes(n,r,gr);let l=[];for(let e=0;e<=n.length-1;e++)l.push({expressID:n[e],elementID:i[e].id});const c=new js["ob"]({transparent:!0,opacity:.5,color:11184895,depthTest:!0});for(let t=0;t<=i.length-2;t++){const a=await gr.ifcManager.getItemProperties(r,n[t]);console.log("Slab props:"),console.log(a);const o=kt["a"].getAllSubsetMeshes([n[t]],r,gr)[0];o.material=c.clone(),o.material.side=js["v"],o.updateMatrixWorld(),e.add(o)}this.RENDER()}catch(a){console.log(a)}},async showRoomsForStorey(e=0,t){const a=c["a"].state.bv.scene.getObjectByName("buildingbox");await Dt["a"].removeAllLabels(),a.children.forEach(o=>{const s=Dt["a"].getMeshHeightAboveGround(o);Dt["a"].checkIfMeshCrossStoreyLevel(e,s.min,s.max)?(o.visible=!0,this.roomList.forEach(e=>{if(o.name==e.name){let t=new js["uc"](0,0,0);if(e.loc&&(t=new js["uc"](e.loc.x,e.loc.y,e.loc.z)),"1"==this.labelType)Dt["a"].createSimpleLabel(t.applyMatrix4(a.matrixWorld),""+e.trafficload);else{let o=e.newname;""==o&&(o=e.name),Dt["a"].createLabelWithType(t.applyMatrix4(a.matrixWorld),""+o,""+e.trafficAreaType)}}})):o.visible=!1,t&&Dt["a"].checkIfMeshCrossStoreyLevel(t,s.min,s.max)&&(o.visible=!0)}),this.showDoorMarkers2(),c["a"].state.bv.needsrender=!0},showAllRooms(){const e=c["a"].state.bv.scene.getObjectByName("buildingbox");e.children.forEach(e=>{e.visible=!0}),c["a"].state.bv.needsrender=!0},async setBuildingMainEntrance(){this.buildingMainEntrances=[];let e=c["a"].state.bv.selectedRoomNames[0];this.buildingMainEntrances.push(e);let t=this.getRoomURIbyName(e),a=[];c["a"].state.rs.rdfStore.match(hr.sym(t),d["c"].NEO("m_port"),null).forEach(e=>{a.push(e.object.value)}),console.log("Doors:");let o=[];if(a.forEach(e=>{let t=c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].RDFS("label"),null)[0].object.value;t.includes("Outdoor")&&(o.push({name:t,uri:e}),console.log("Selected door: "+t))}),o.length>0){let e=this.$route.query.location+"i";o.forEach(t=>{this.buildingMainEntranceURIs.includes(t.uri)||this.buildingMainEntranceURIs.push(t.uri),yr(hr.sym(e),d["c"].NEO("m_port"),hr.sym(t.uri))})}this.roomNumberProcess=6},getBuildingMainEntrances(){let e=this.$route.query.location+"i";c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].NEO("m_port"),null).forEach(e=>{c["a"].state.rs.rdfStore.match(hr.sym(e.object.value),d["c"].RDFS("label"),null).forEach(e=>{this.buildingMainEntrances.push(e.object.value)})})},checkIfRoomNameExists(e,t){let a=0;""==e&&(e="UN");while(t.includes(e))console.log("Found room name duplicate: "+e),a++,e=e+".D"+a;return e},async addAllRoomsToStores(e){let t=await this.checkForPermanentFloorURIs();const a=await gr.ifcManager.getAllItemsOfType(e,lr["IFCSPACE"]);console.log("Start adding "+a.length+" rooms to store...");const o=[];for(let s=0;s<a.length;s++){const r=await gr.ifcManager.getItemProperties(e,a[s]);let n="room"+a[s];r.Name&&(n=ne["a"].formatString(r.Name.value));let i="";r.GlobalId&&(i=r.GlobalId.value),n=this.checkIfRoomNameExists(n,o),o.push(n);const l=ne["a"].getBlankNode(n);yr(l,d["c"].RDF("type"),d["c"].BOT("Space")),yr(l,d["c"].RDFS("label"),hr.literal("Room "+n,"en")),yr(l,d["c"].RDFS("label"),hr.literal("Rom "+n,"no")),yr(l,d["c"].FOAF("name"),hr.literal(n)),yr(l,d["c"].IFOUR("expressid"),a[s]),yr(l,d["c"].IFOUR("globalid"),i);let u=Dt["a"].getMeshHeightAboveGround(c["a"].state.bv.scene.getObjectByName(n)).min;u&&(yr(l,d["c"].IFOUR("roomhag"),u),t.forEach(e=>{Number(e.roomhag)==Number(u)&&yr(hr.sym(e.uri),d["c"].SIO("SIO_000202"),l)}));let h=new js["uc"](0,0,0);c["a"].state.bv.scene.getObjectByName(n)&&(h=Dt["a"].getMeshCenterPoint(c["a"].state.bv.scene.getObjectByName(n))),h&&yr(l,d["c"].SIO("SIO_000507"),hr.literal("("+h.x+") ("+h.y+") ("+h.z+")"));let g=await this.getPolylineForSpace(e,a[s],n,u);yr(l,d["c"].IFOUR("m_polyline"),g);let m="";this.floorheights.forEach((e,t)=>{Ar(e,u,.5)&&(m=this.floortags[t])}),m=m.substring(1),c["a"].state.rs.rdfStore.match(null,d["c"].RDF("type"),d["c"].BOT("Storey")).forEach(e=>{c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].TAG("tag"),null).forEach(t=>{t.object.value.includes(m)&&""!=m&&yr(hr.sym(e.subject.value),d["c"].SIO("SIO_000202"),l)})})}},async addAllStoreysToStores(e){},async getPolylineForSpace(e,t,a,o){const s=await gr.ifcManager.getItemProperties(e,t),r=await gr.ifcManager.getItemProperties(e,s.ObjectPlacement.value),n=(await gr.ifcManager.getItemProperties(e,r.PlacementRelTo.value),await gr.ifcManager.getItemProperties(e,r.RelativePlacement.value)),i=await gr.ifcManager.getItemProperties(e,n.Location.value),l=await gr.ifcManager.getItemProperties(e,n.Axis.value),c=await gr.ifcManager.getItemProperties(e,n.RefDirection.value),d=c.DirectionRatios,u=l.DirectionRatios,h=i.Coordinates,g=await gr.ifcManager.getItemProperties(e,s.Representation.value),m=await gr.ifcManager.getItemProperties(e,g.Representations[1].value),p=await gr.ifcManager.getItemProperties(e,m.Items[0].value),f=await gr.ifcManager.getItemProperties(e,p.Elements[0].value);if(void 0!=f.Segments){const t=f.Segments;for(let a=0;a<t.length;a++){const o=await gr.ifcManager.getItemProperties(e,t[a].value),s=await gr.ifcManager.getItemProperties(e,o.ParentCurve.value);if(void 0!=s.Points)void 0===f.Points&&(f.Points=[]),s.Points.forEach(e=>{f.Points.push(e)});else{await gr.ifcManager.getItemProperties(e,s.BasisCurve.value)}}}let b={x:d[0].value,y:d[1].value,z:d[2].value};b.x||(b={x:d[0],y:d[1],z:d[2]});let v={x:u[0].value,y:u[1].value,z:u[2].value};v.x||(v={x:u[0],y:u[1],z:u[2]});const y=_t["a"].v3cross(b,v),w={x:0,y:-1,z:0};var I=_t["a"].getAngleRadians(y.x,y.y,b.x,b.y),S=_t["a"].getAngleRadians(v.x,v.y,w.x,w.y);I=S-I+Math.PI/4;const R=[];if(f.Points){for(var A=0;A<f.Points.length;A++){const t=await gr.ifcManager.getItemProperties(e,f.Points[A].value);R.push(t.Coordinates)}var E="polyline;"+encodeURI(a)+";"+h[0].value/1e3+";"+h[1].value/1e3+";"+o+";2.9;[";for(A=0;A<R.length;A++){var x=R[A][0].value/1e3,_=R[A][1].value/1e3;const e=_t["a"].rotateRadians(0,0,x,_,I);x=e[0],_=e[1],E=""+E+x+","+_+",0",A<R.length-1&&(E+=",")}return E+="]",E}return""},async saveDoorToTrinpod(e,t,a,o,s,r,n,i,l,u,h,g,m,p,f){void 0==t&&(t="Outdoor"),void 0==a&&(a="Outdoor"),t=ne["a"].formatString(t),a=ne["a"].formatString(a);let b=ne["a"].getBlankNode("Door "+t+"-"+a),v=ne["a"].prettyTAG(h+g+".DØR."+t+a),y=ne["a"].prettyTAG(h+g+".DØR."+a+t);if(this.roomsExistInTrinpod){let e=await Fe["a"].searchAndGetURIs("#"+v+"*"),t=await Fe["a"].searchAndGetURIs("#"+y+"*");if(""!=e||""!=t)return void console.log("Warning - Found duplicate door!!!!!!!!")}yr(b,d["c"].RDF("type"),d["c"].NEO("x_door")),yr(b,d["c"].TAG("tag"),v),yr(b,d["c"].RDFS("label"),hr.literal("Door "+t+"_"+a,"en")),yr(b,d["c"].RDFS("label"),hr.literal("Dør "+t+"_"+a,"no")),yr(b,d["c"].FOAF("name"),hr.literal(n)),yr(b,d["c"].SIO("SIO_000507"),hr.literal("("+i+") ("+l+") ("+u+")")),yr(b,d["c"].IFOUR("expressid"),p),yr(b,d["c"].IFOUR("globalid"),f),m&&yr(b,d["c"].IFOUR("islocked"),hr.literal("yes")),o&&yr(hr.sym(o),d["c"].NEO("m_port"),hr.sym(b)),s&&yr(hr.sym(s),d["c"].NEO("m_port"),hr.sym(b));const w=c["a"].state.rs.rdfStore.match(hr.sym(o),d["c"].RDF("type"),d["c"].BOT("Space"))[0];!w&&o.value.includes("_:")&&(yr(o,d["c"].RDF("type"),d["c"].BOT("Space")),yr(o,d["c"].RDFS("label"),hr.literal("Room "+t,"en")),yr(o,d["c"].RDFS("label"),hr.literal("Rom "+t,"no")));const I=c["a"].state.rs.rdfStore.match(hr.sym(s),d["c"].RDF("type"),d["c"].BOT("Space"))[0];!I&&s.value.includes("_:")&&(yr(s,d["c"].RDF("type"),d["c"].BOT("Space")),yr(s,d["c"].RDFS("label"),hr.literal("Room "+a,"en")),yr(s,d["c"].RDFS("label"),hr.literal("Rom "+a,"no")));let S=new js["uc"](i,l+.2,u);m?Dt["a"].createPlaceMarker(S,16776960,!1,2,"placemarker",.16):Dt["a"].createPlaceMarker(S,16711680,!1,2,"placemarker",.16)},async saveDoorListToTrinpod(e,t){let a="";for(const[s,r]of Object.entries(fr))"tag"==s&&(a=r);for(let s=0;s<e.length;s++){const o=e[s];let r="",n="";if(this.roomsExistInTrinpod?(r=this.getRoomURIbyName("V131"),n=this.getRoomURIbyName("V135")):(r=ne["a"].getBlankNode(o.room1),n=ne["a"].getBlankNode(o.room2)),void 0===r||void 0===n)throw new Error("Room URI not found");await this.saveDoorToTrinpod(t,o.room1,o.room2,r,n,o.heightaboveground,o.name,o.x,o.y,o.z,a,o.storeytag,o.islocked,o.expressid,o.globalid)}var o=ne["a"].storeToTurtle(vr,br);o=re["a"].modifyTurtle(o),console.log("Turtle"),console.log(o)},async generateOpeningCirculation(e=!1){console.log("Started finding space intersections."),this.loading=!0;const t=Rr.modelID,a=[],o=await gr.ifcManager.getAllItemsOfType(t,lr["IFCBUILDINGSTOREY"]);for(let r=0;r<this.floorlist.length;r++)if(this.floorsselected==this.floorlist[r]||0==this.floorsselected.length){const e=await gr.ifcManager.getItemProperties(t,o[r]),s=e.Elevation.value/1e3;c["a"].state.rs.rdfStore.match(null,d["c"].IFOUR("m_polyline"),null).forEach(e=>{const t=e.object.value.split(";"),o=parseFloat(t[4]),r=parseFloat(t[5]);Dt["a"].checkIfMeshCrossStoreyLevel(s,o,o+r)&&a.push(e.object.value)})}e&&console.log("Selected polylines:"),e&&console.log(a);const s=Dt["a"].findSpaceIntersections(a,.5,!0);s.forEach(e=>{this.spaceIntersections.push(e)}),this.storeSpaceIntersections(s,!1),await this.getIFCOpeningElements(),this.loading=!1,this.roomNumberProcess=5,console.log("Finished finding space intersections.")},storeSpaceIntersections(e,t=!1){e.forEach(e=>{let a=void 0,o=void 0;try{a=c["a"].state.rs.rdfStore.match(null,d["c"].RDFS("label"),hr.literal("Room "+e.room1,"en"))[0].subject.value,o=c["a"].state.rs.rdfStore.match(null,d["c"].RDFS("label"),hr.literal("Room "+e.room2,"en"))[0].subject.value}catch(s){}if(a&&o){let s="";c["a"].state.rs.rdfStore.match(hr.sym(a),d["c"].DUL("hasPart"),null)[0]&&(s=c["a"].state.rs.rdfStore.match(hr.sym(a),d["c"].DUL("hasPart"),null)[0].object.value),c["a"].state.rs.rdfStore.match(hr.sym(o),d["c"].DUL("hasPart"),null)[0]&&(s=c["a"].state.rs.rdfStore.match(hr.sym(o),d["c"].DUL("hasPart"),null)[0].object.value),""==s&&(s=ne["a"].getBlankNode("Parentspace "+e.room1+"-"+e.room2)),yr(hr.sym(s),d["c"].DUL("hasPart"),hr.sym(a)),yr(hr.sym(s),d["c"].DUL("hasPart"),hr.sym(o)),yr(hr.sym(a),d["c"].NEO("m_join"),hr.sym(o)),this.lockedDoors.includes(e.room1)?(yr(hr.sym(a),d["c"].IFOUR("islocked"),hr.literal("yes")),Dt["a"].createPlaceMarker(e.point,16776960,!1,1)):this.lockedDoors.includes(e.room2)?(yr(hr.sym(o),d["c"].IFOUR("islocked"),hr.literal("yes")),Dt["a"].createPlaceMarker(e.point,16776960,!1,1)):Dt["a"].createPlaceMarker(e.point,153,!1,1);const r=ne["a"].getBlankNode("Interface_"+e.room1+"-"+e.room2);yr(r,d["c"].RDF("type"),d["c"].IFOUR("InterfacePoint")),yr(r,d["c"].SIO("SIO_000507"),hr.literal("("+e.point.x+") ("+e.point.y+") ("+e.point.z+")")),yr(hr.sym(a),d["c"].IFOUR("hasInterfacePoint"),r),yr(hr.sym(o),d["c"].IFOUR("hasInterfacePoint"),r),t&&console.log("Saving room1: "+e.room1+" and room2: "+e.room2),t&&this.setSpaceLabel(e.point,e.room1+"-"+e.room2)}else t&&console.log("Did not find room1: "+e.room1+" and room2: "+e.room2)})},async getSpacePolyline(e){const t=Rr.modelID,a=await this.getPolylineForSpace(t,e,"",1);a.split(";")[6]},async generateStoreyLevelCirculation(e=!0){const t=c["a"].state.bv.scene.getObjectByName("buildingbox");fr=await kt["a"].getIFCmetaDataFromJson(this.$route.query.location+"home/IFC/building.json"),this.ifcloading=!0;let a=this.$route.query.location+"home/IFC/"+this.ifcfile;console.log("IFC uri: "+a);const o=await window.solid.session.fetch(a,{method:"GET",credentials:"include"});let s=await o.arrayBuffer(),r=URL.createObjectURL(new Blob([s],{type:"application/x-step"}));this.ifcmodelLoaded||(Rr=await gr.loadAsync(r),this.ifcmodelLoaded=!0);const n=Rr.modelID,i=await gr.ifcManager.getAllItemsOfType(n,lr["IFCSPACE"]);for(let u=0;u<=i.length;u++){const a=await gr.ifcManager.getItemProperties(n,i[u]);let o="room"+i[u];if(!a)continue;a.Name&&(o=a.Name.value),o=o.replace("Room ",""),o=ne["a"].hexToString(o);let s=c["a"].state.bv.scene.getObjectByName(o);if(s){const a=Dt["a"].getMeshCenterPointTop(s);let r=this.getMeshHeight(s);if(r>=2.91){e&&Dt["a"].createPlaceMarker(a.clone(),16711680,!1,1);const s=new js["uc"](0,1,0),r=Dt["a"].raycastUsingVector(a.clone(),s);let n=r[1];if(n){n.object||(n=r[2]),"placemarker"!=n.object.name&&n.object.name!=o||(n=r[2]);try{const e=n.object.name;console.log("Room1: "+o+" Room2: "+e);const s=await this.getStairShaftOrElevator(i[u],o,e);t.matrixWorld.elements[2]>0?await Dt["a"].createLabelWithType(a.applyMatrix4(t.matrixWorld),""+s,o+" : "+e):await Dt["a"].createLabelWithType(a.applyMatrix4(t.matrixWorld.invert()),""+s,o+" : "+e);const r=this.getRoomURIbyName(o),l=this.getRoomURIbyName(e);if(o==e)continue;"Stair"==s&&(yr(hr.sym(r),d["c"].NEO("m_join"),hr.sym(l)),yr(hr.sym(r),d["c"].NEO("b_capable"),d["c"].SBEO("VerticalPassage")),yr(hr.sym(l),d["c"].NEO("b_capable"),d["c"].SBEO("VerticalPassage")),yr(hr.sym(r),d["c"].RDF("type"),d["c"].SEAS("Stairs")),yr(hr.sym(l),d["c"].RDF("type"),d["c"].SEAS("Stairs"))),"Shaft"==s&&yr(hr.sym(r),d["c"].NEO("m_join"),hr.sym(l)),"Elevator"==s&&(yr(hr.sym(r),d["c"].NEO("m_join"),hr.sym(l)),yr(hr.sym(r),d["c"].NEO("b_capable"),d["c"].SBEO("VerticalPassage")),yr(hr.sym(l),d["c"].NEO("b_capable"),d["c"].SBEO("VerticalPassage")),yr(hr.sym(r),d["c"].RDF("type"),d["c"].SEAS("Elevator")),yr(hr.sym(l),d["c"].RDF("type"),d["c"].SEAS("Elevator")))}catch(l){console.log(l)}this.createLockedDoorList(),this.RENDER()}}}else console.log("Warning: Did not find space mesh: "+o)}},async getStairShaftOrElevator(e,t,a){let o="Shaft",s=0,r=0,n=0,i=0;const l=Rr.modelID,u=await this.getPolylineForSpace(l,e,"",1),h=Dt["a"].trinagulateAndCalculateArea(u);h>8&&(s+=2),5<h<8&&(n+=1),h<5&&(r+=5);const g=this.getRoomURIbyName(t);i=c["a"].state.rs.rdfStore.match(hr.sym(g),d["c"].IFOUR("roomhag"),null)[0].object.value,console.log("SPACE URI: "+g+" Name: "+t),console.log("Calculated area: "+h);const m=this.getDoorsInSpace(g);return console.log(m),m.forEach(e=>{"Door"==e.type&&(s+=2),e.nextroomhag==i&&(console.log("Found door: "+e.type),"Join"==e.type&&(n+=2),r-=2)}),console.log("Shaft: "+r+" Stair: "+s+" Elevator: "+n),s>=r&&s>=n&&(o="Stair"),r>=s&&r>=n&&(o="Shaft"),n>=r&&n>=s&&(o="Elevator"),console.log("Set to: "+o),o},async generateDoorCirculation(){const e=c["a"].state.bv.scene.getObjectByName("buildingbox");document.createElement("div");fr=await kt["a"].getIFCmetaDataFromJson(this.$route.query.location+"home/IFC/building.json");const t=[];this.ifcloading=!0;let a=this.$route.query.location+"home/IFC/"+this.ifcfile;const o=await window.solid.session.fetch(a,{method:"GET",credentials:"include"});console.log(o);let s=await o.arrayBuffer(),r=URL.createObjectURL(new Blob([s],{type:"application/x-step"}));this.ifcmodelLoaded||(Rr=await gr.loadAsync(r),this.ifcmodelLoaded=!0);const n=Rr.modelID,i=await gr.ifcManager.getAllItemsOfType(n,lr["IFCDOOR"]),l=kt["a"].getAllSubsetMeshes(i,n,gr);await this.getRoomZones(n,e);let d="";const u=await gr.ifcManager.getAllItemsOfType(n,lr["IFCBUILDINGSTOREY"]);for(let c=0;c<this.floorlist.length;c++)if(this.floorsselected==this.floorlist[c]||0==this.floorsselected.length){const e=await gr.ifcManager.getItemProperties(n,u[c]);for(const[t,o]of Object.entries(fr.storeys))o==e.Name.value&&(d=t);const a=e.Elevation.value/1e3;console.log("selectdStoreyHeightAboveGround: "+a);for(let o=0;o<i.length-1;o++){const e=Dt["a"].getMeshCenterPoint(l[o]),s=Dt["a"].getMeshHeightAboveGround(l[o]).min;if(e.y=s,Ar(a,s,.5)){const a=await this.getRoomZonesOnEachSideOfDoor(n,i[o],e),r=await gr.ifcManager.getItemProperties(n,i[o]);let l=!1;this.lockedDoors.includes(i[o])&&(l=!0);let c=ne["a"].formatString(r.Name.value);t.push({room1:a[0],room2:a[1],x:e.x,y:e.y,z:e.z,storeytag:d,heightaboveground:s,ifcid:r.GlobalId.value,expressid:r.expressID,globalid:r.GlobalId.value,name:c,width:r.OverallWidth.value,height:r.OverallHeight.value,objecttype:r.ObjectType.value,doorid:i[o],islocked:l})}}}console.log(t),await this.addAllRoomsToStores(n),await this.saveDoorListToTrinpod(t,n),this.ifcloading=!1,this.roomNumberProcess=4},async showDoorMarkers2(){let e=0;const t=[],a=Rr.modelID,o=await gr.ifcManager.getAllItemsOfType(a,lr["IFCBUILDINGSTOREY"]);for(let n=0;n<this.floorlist.length;n++)if(this.floorsselected==this.floorlist[n]||0==this.floorsselected.length){const t=await gr.ifcManager.getItemProperties(a,o[n]);e=t.Elevation.value/1e3}const s=c["a"].state.rs.rdfStore.match(null,d["c"].RDF("type"),d["c"].NEO("x_door"));for(let n=0;n<s.length;n++){const t=this.getDoorPosition(s[n].subject.value);if(Ar(e,t.y,.5)){let e="";c["a"].state.rs.rdfStore.match(hr.sym(s[n].subject.value),d["c"].IFOUR("expressid"),null)[0]&&(e=c["a"].state.rs.rdfStore.match(hr.sym(s[n].subject.value),d["c"].IFOUR("expressid"),null)[0].object.value),Dt["a"].createPlaceMarker(t,16711680,!1,2,"placemarker"+e,.16)}}const r=c["a"].state.rs.rdfStore.match(null,d["c"].RDF("type"),d["c"].IFOUR("InterfacePoint"));for(let n=0;n<r.length;n++){const t=this.getDoorPosition(r[n].subject.value);Ar(e,t.y,.5)&&c["a"].state.rs.rdfStore.match(null,d["c"].IFOUR("hasInterfacePoint"),hr.sym(r[n].subject.value)).forEach(e=>{const a=this.getRoomNamebyURI(e.subject.value);this.lockedDoors.includes(a)?(yr(hr.sym(e.subject.value),d["c"].IFOUR("islocked"),hr.literal("yes")),Dt["a"].createPlaceMarker(t,16776960,!1,3,"placemarker",.3)):Dt["a"].createPlaceMarker(t,153,!1,2)})}if(this.spaceIntersections.length<4){c["a"].state.rs.rdfStore.match(null,d["c"].IFOUR("m_polyline"),null).forEach(a=>{const o=a.object.value.split(";"),s=parseFloat(o[4]),r=parseFloat(o[5]);Dt["a"].checkIfMeshCrossStoreyLevel(e,s,s+r)&&t.push(a.object.value)});const a=Dt["a"].findSpaceIntersections(t,.5,!0);a.forEach(e=>{this.spaceIntersections.push(e)})}c["a"].state.bv.needsrender=!0},storeNewRoomNumbers(){},async getCirclulationFromCSV(){let e=await kt["a"].getCirculationCSV(this.$route.query.location);for(var t=e.split(/\r\n|\n/),a=t[0].split(";"),o=[],s=1;s<t.length;s++){if("<html>"==t[s])break;var r=t[s].split(";");if(r.length==a.length){for(var n=[],i=0;i<a.length;i++)n.push(r[i]);o.push(n)}}console.log(o);for(s=1;s<o.length;s++){const e=o[s][0],t=o[s][1],a=this.getRoomURIbyName(e),r=this.getRoomURIbyName(t),n=o[s][2]+" ";let i=ne["a"].getBlankNode(n+e+"-"+t);yr(i,d["c"].RDF("type"),d["c"].NEO("m_interface-point")),yr(i,d["c"].RDFS("label"),hr.literal(n+e+"-"+t,"en")),yr(i,d["c"].RDFS("label"),hr.literal(n+e+"-"+t,"no")),a&&yr(hr.sym(a),d["c"].NEO("m_port"),hr.sym(i)),r&&yr(hr.sym(r),d["c"].NEO("m_port"),hr.sym(i))}},async getRoomZonesOnEachSideOfDoor(e,t=0,a,o=!1){const s=c["a"].state.bv.scene.getObjectByName("buildingbox");let r=!1,n=.8;if(t){const a=await gr.ifcManager.getItemProperties(e,t),o=a.OverallWidth.value;n=o/1600}let i=[];const l=a.clone();l.y=l.y+1;let d=0;do{1==d&&(console.log("Second attempt to find rooms..."+n),i.length>2&&(i=[]),i.length<2?n=.5:n/=2);const e=new js["uc"](n,0,0),t=l.clone().add(e),a=_t["a"].v3subtract(l,t);o&&Dt["a"].createVisibleVector(t,a,16711680),o&&Dt["a"].createPlaceMarker(t.clone(),65280);const s=Dt["a"].raycastUsingVectorDir(t,a);o&&Dt["a"].createVisibleVector(t,a,16711680);const c=[];s.forEach(e=>{if(c.push(e),e.distance<=n){const t=e.object.name;o&&Dt["a"].createPlaceMarker(e.point,26367),o&&console.log("Room name: "+t+" Distance: "+e.distance),i.includes(t)||""==t||t.includes("placemarker")||i.push(t),""==t&&(r=!0)}});const u=new js["uc"](0,1,0),h=Math.PI/3;for(let d=0;d<=4;d++){const t=l.clone().add(e.applyAxisAngle(u,h));o&&Dt["a"].createPlaceMarker(t,255);const a=_t["a"].v3subtract(l,t).normalize();o&&Dt["a"].createVisibleVector(t,a,16750848);const s=Dt["a"].raycastUsingVectorDir(t,a);o&&console.log("Intersects"),o&&console.log(s),s.forEach(e=>{if(c.push(e),e.distance<=n){const t=e.object.name;i.includes(t)||""==t||t.includes("placemarker")||i.push(t),""!=t&&t||(r=!0)}})}o=!1,d+=2,2!=i.length&&(d-=1)}while(d<2);if(o&&console.log("Number of rooms: "+i.length),i.length>2&&i.forEach(e=>{console.log(e)}),2!=i.length){Dt["a"].createPlaceMarker(l,16720384,!1,1,"placemarker");let e="Issue:"+i.length;i.length>=3&&(e=i[0]+":"+i[1]),r&&(e=e.replace("Issue","Unnamed")),Dt["a"].createSimpleLabel(l.applyMatrix4(s.matrixWorld),e);let a=!1;this.doorIssueTableList.forEach(e=>{e.doorid==t&&(a=!0)}),a||this.doorIssueTableList.push(JSON.parse('{"doorid":"'+t+'","room1":"'+encodeURI(i[0])+'","room2":"'+encodeURI(i[1])+'"}'))}return i},async getRoomZones(e,t){const a=await gr.ifcManager.getAllItemsOfType(e,lr["IFCSPACE"]),o=kt["a"].getAllSubsetMeshes(a,e,gr);let s=[];for(let n=0;n<a.length;n++)s.push({expressID:a[n],elementID:o[n].id});const r=new js["ob"]({transparent:!0,opacity:.5,color:11184895,depthTest:!0});for(let n=0;n<o.length;n++){const o=await gr.ifcManager.getItemProperties(e,a[n]),s=kt["a"].getAllSubsetMeshes([a[n]],e,gr)[0];s.material=r.clone(),s.material.side=js["v"],o.Name?(s.name=ne["a"].formatString(o.Name.value),""==s.name&&(s.name="room"+a[n])):s.name="room"+a[n],s.updateMatrixWorld(),t.add(s),this.getSpacePolyline(a[n])}if(this.floorsselected.length>0)for(let n=0;n<this.floorlist.length;n++)this.floorsselected==this.floorlist[n]&&(console.log("Floor height: "+this.floorheights[n]),this.showRoomsForStorey(this.floorheights[n]));this.RENDER()},getMeshHeight(e){let t=1e5,a=-1e5;for(let o=1;o<=e.geometry.attributes.position.array.length;o+=3)a=Math.max(e.geometry.attributes.position.array[o],a),t=Math.min(e.geometry.attributes.position.array[o],t);return a-t},async getIFCElementDimentions(e,t,a=!1){const o=await gr.ifcManager.getItemProperties(t,e),s=await gr.ifcManager.getItemProperties(t,o.ObjectPlacement.value);a&&console.log("positionProperties"),a&&console.log(s);const r=await gr.ifcManager.getItemProperties(t,o.Representation.value);a&&console.log("representation"),a&&console.log(r);const n=await gr.ifcManager.getItemProperties(t,r.Representations[0].value);a&&console.log("representations"),a&&console.log(n);const i=await gr.ifcManager.getItemProperties(t,n.Items[0].value);a&&console.log("items"),a&&console.log(i);let l=0,c=0,d=0;if(i.Depth&&(l=i.Depth.value,a&&console.log("Depth: "+l),i.SweptArea)){const e=await gr.ifcManager.getItemProperties(t,i.SweptArea.value);a&&console.log("SweptArea"),a&&console.log(e),e.XDim&&(c=e.XDim.value),a&&console.log("xDim: "+c),e.YDim&&(d=e.YDim.value),a&&console.log("yDim: "+d)}return{x:c,y:d,z:l}},async getIFCElementPosition(e,t,a={x:0,y:-1,z:0}){const o=await gr.ifcManager.getItemProperties(t,e),s=await gr.ifcManager.getItemProperties(t,o.ObjectPlacement.value),r=await gr.ifcManager.getItemProperties(t,s.RelativePlacement.value),n=await gr.ifcManager.getItemProperties(t,r.Location.value),i=await gr.ifcManager.getItemProperties(t,r.Axis.value),l=await gr.ifcManager.getItemProperties(t,r.RefDirection.value),c=l.DirectionRatios,d=i.DirectionRatios,u=n.Coordinates;var h=u[0].value/1e3,g=u[1].value/1e3,m=u[2].value/1e3;let p={x:c[0].value,y:c[1].value,z:c[2].value};p.x||(p={x:c[0],y:c[1],z:c[2]});let f={x:d[0].value,y:d[1].value,z:d[2].value};f.x||(f={x:d[0],y:d[1],z:d[2]});const b=kt["a"].v3cross(p,f);var v=kt["a"].getAngleRadians(b.x,b.y,p.x,p.y),y=kt["a"].getAngleRadians(f.x,f.y,a.x,a.y);return v=y-v+Math.PI/4,{x:h,y:g,z:m,rot:p}},async getIFCElementLocationTranslated(e,t,a={x:0,y:-1,z:0}){const o=await gr.ifcManager.getItemProperties(t,e),s=await gr.ifcManager.getItemProperties(t,o.ObjectPlacement.value),r=await gr.ifcManager.getItemProperties(t,s.RelativePlacement.value),n=await gr.ifcManager.getItemProperties(t,r.Location.value),i=await gr.ifcManager.getItemProperties(t,r.Axis.value),l=await gr.ifcManager.getItemProperties(t,r.RefDirection.value),c=l.DirectionRatios,d=i.DirectionRatios,u=n.Coordinates;var h=u[0].value/1e3,g=u[1].value/1e3,m=u[2].value/1e3;let p={x:c[0].value,y:c[1].value,z:c[2].value};p.x||(p={x:c[0],y:c[1],z:c[2]});let f={x:d[0].value,y:d[1].value,z:d[2].value};f.x||(f={x:d[0],y:d[1],z:d[2]});const b=kt["a"].v3cross(p,f);var v=kt["a"].getAngleRadians(b.x,b.y,p.x,p.y),y=kt["a"].getAngleRadians(f.x,f.y,a.x,a.y);v=y-v+Math.PI/4;const w=kt["a"].rotateRadians(0,0,h,g,v);return h=w[0],g=w[1],{x:h,y:g,z:m}},async getSpacesRelatedToWall(e,t,a=!1){const o=await gr.ifcManager.getItemProperties(t,e);a&&console.log("elementProperties"),a&&console.log(o);const s=await gr.ifcManager.getAllItemsOfType(t,lr["IFCRELSPACEBOUNDARY"]),r=[];for(let n=0;n<s.length;n++){const o=await gr.ifcManager.getItemProperties(t,s[n]);o.RelatedBuildingElement&&(o.RelatedBuildingElement.value==e&&(a&&console.log("Found space related to building element: "+o.RelatingSpace.value),r.push(o.RelatingSpace.value)))}return r},async getStoreysRelatedToSpace(e,t,a=!1){const o=await gr.ifcManager.getItemProperties(t,e);a&&console.log("elementProperties"),a&&console.log(o);const s=await gr.ifcManager.getAllItemsOfType(t,lr["IFCRELAGGREGATES"]),r=[];for(let n=0;n<s.length;n++){const o=await gr.ifcManager.getItemProperties(t,s[n]);for(let t=0;t<o.RelatedObjects.length;t++)o.RelatedObjects[t].value==e&&(a&&console.log("Found STOREY related to building element: "+o.RelatingObject.value),r.push(o.RelatingObject.value))}return a&&console.log("relatedStoreys"),a&&console.log(r),r},async getSpacesRelatedToStorey(e,t,a=!1){const o=await gr.ifcManager.getItemProperties(t,e);a&&console.log("storeyProperties"),a&&console.log(o);const s=await gr.ifcManager.getAllItemsOfType(t,lr["IFCRELAGGREGATES"]),r=[];for(let n=0;n<s.length;n++){const a=await gr.ifcManager.getItemProperties(t,s[n]);if(a.RelatingObject.value==e)for(let e=0;e<a.RelatedObjects.length;e++)r.push(a.RelatedObjects[e].value)}return a&&console.log("relatedSpaces"),a&&console.log(r),r},async exportIFCProperties(){document.createElement("div");this.ifcloading=!0;let e=this.$route.query.location+"home/IFC/"+this.ifcfile;try{const t=await window.solid.session.fetch(e,{method:"GET",credentials:"include"});console.log(t);let a=await t.arrayBuffer(),o=URL.createObjectURL(new Blob([a],{type:"application/x-step"}));this.ifcmodelLoaded||(Rr=await Sr.IFC.loadIfcUrl(o),this.ifcmodelLoaded=!0);const s=await Sr.IFC.properties.serializeAllProperties(Rr),r=new File(s,"properties");let n=document.createElement("a");document.body.appendChild(n),n.href=URL.createObjectURL(r),n.download="ifc.json",n.click(),n.remove(),this.ifcloading=!1}catch(t){console.log(t)}},async getIFCStoreys(){document.createElement("div");this.ifcloading=!0;let e=this.$route.query.location+"home/IFC/"+this.ifcfile;try{const t=await window.solid.session.fetch(e,{method:"GET",credentials:"include"});let a=await t.arrayBuffer(),o=URL.createObjectURL(new Blob([a],{type:"application/x-step"}));this.ifcmodelLoaded||(Rr=await gr.loadAsync(o),this.ifcmodelLoaded=!0);const s=Rr.modelID;console.log("ModelID: "+s);const r=await gr.ifcManager.getAllItemsOfType(s,lr["IFCBUILDINGSTOREY"],!1),n=await kt["a"].getIFCmetaDataFromJson(this.$route.query.location+"home/IFC/building.json");for(let e=0;e<r.length;e++){const t=await gr.ifcManager.getItemProperties(s,r[e]),a=this.getFloorTagfromJson(n,t.Name.value);this.floorlist.push(t.Name.value),this.floorids.push({uri:"",name:t.Name.value,expressid:t.expressID,globalid:t.GlobalId.value,roomhag:t.Elevation.value/1e3,tag:a}),this.floorheights.push(t.Elevation.value/1e3),this.floortags.push(a)}console.log("Floor object list:"),console.log(this.floorids),this.createLockedDoorList();const i=c["a"].state.bv.scene.getObjectByName("buildingbox");await this.getRoomZones(s,i),await this.addAllRoomsToStores(s),this.roomList.length<5&&(this.roomList=this.generateRoomList()),console.log("Ready for generate door circulation.."),this.loading=!1,this.roomNumberProcess=3}catch(t){console.log(t)}},async getIFCOpeningElements(e=!1,t=!1){c["a"].state.bv.scene.getObjectByName("buildingbox"),document.createElement("div");fr=await kt["a"].getIFCmetaDataFromJson(this.$route.query.location+"home/IFC/building.json"),this.ifcloading=!0;let a=this.$route.query.location+"home/IFC/"+this.ifcfile;const o=await window.solid.session.fetch(a,{method:"GET",credentials:"include"});console.log(o);let s=await o.arrayBuffer(),r=URL.createObjectURL(new Blob([s],{type:"application/x-step"}));this.ifcmodelLoaded||(Rr=await gr.loadAsync(r),this.ifcmodelLoaded=!0);const n=Rr.modelID,i=await gr.ifcManager.getAllItemsOfType(n,lr["IFCOPENINGELEMENT"]),l=await gr.ifcManager.getAllItemsOfType(n,lr["IFCRELFILLSELEMENT"]),d=await gr.ifcManager.getAllItemsOfType(n,lr["IFCRELVOIDSELEMENT"]),u=[];for(let c=0;c<l.length;c++){const e=await gr.ifcManager.getItemProperties(n,l[c]);u.push(e.RelatingOpeningElement.value)}const h=[];for(let c=0;c<d.length;c++){const e=await gr.ifcManager.getItemProperties(n,d[c]);e&&h.push({opening:e.RelatedOpeningElement.value,buildingelement:e.RelatingBuildingElement.value})}const g=[];let m=0;for(let c=0;c<i.length;c++){let e=0;for(let t=0;t<h.length;t++)h[t].opening==i[c]&&(e=h[t].buildingelement);const a=await this.getIFCElementDimentions(i[c],n,!1);let o=!1;if(u.includes(i[c])&&(o=!0),a.x>=600&&a.y>=600&&!o){const a=await this.getIFCElementPosition(e,n);t&&console.log("wall location"),t&&console.log(a);let o=a.rot;t&&console.log("Rot: "+a.rot.x+"-"+a.rot.y+"-"+a.rot.z);const s=await this.getIFCElementLocationTranslated(i[c],n,o);t&&console.log("location"),t&&console.log(s);const r=new js["uc"](a.x+s.x,a.z+s.z,-a.y+s.y),l=await this.getSpacesRelatedToWall(e,n);let d=await this.getStoreysRelatedToSpace(l[0],n),u=await gr.ifcManager.getItemProperties(n,d[0]);if(u||(console.log("Number of related spaces: "+l.length+" Trying next.."),d=await this.getStoreysRelatedToSpace(l[1],n),u=await gr.ifcManager.getItemProperties(n,d[0])),u){const e=u.Elevation.value/1e3;r.y=r.y+e,t&&console.log("Storey height: "+e)}else console.log("Warning, storey height was not found.");t&&console.log(r),Dt["a"].createPlaceMarker(r,0,!1,1,"placemarker",.2);const h=await this.getRoomZonesOnEachSideOfDoor(n,void 0,r);if(console.log(h),!h[0])continue;g.push({room1:ne["a"].formatString(h[0]),room2:ne["a"].formatString(h[1]),point:r,length:1}),t&&console.log("Found room1: "+h[0]+" and: "+h[1]),t&&console.log("Open opening id: "+i[c]),m++}}this.storeSpaceIntersections(g,!1),console.log("Count of found elements: "+m)},async getIFCSensorElements(e=!1){fr=await kt["a"].getIFCmetaDataFromJson(this.$route.query.location+"home/IFC/building.json"),this.ifcloading=!0;let t=this.$route.query.location+"home/IFC/"+this.ifcfile;const a=await window.solid.session.fetch(t,{method:"GET",credentials:"include"});console.log(a);let o=await a.arrayBuffer(),s=URL.createObjectURL(new Blob([o],{type:"application/x-step"}));this.ifcmodelLoaded||(Rr=await gr.loadAsync(s),this.ifcmodelLoaded=!0);const r=Rr.modelID,n=await gr.ifcManager.getAllItemsOfType(r,lr["IFCDISTRIBUTIONCONTROLELEMENT"]);for(let i=0;i<n.length;i++){const e=await gr.ifcManager.getItemProperties(r,n[i]),t=(e.GlobalId.value,e.Name.value,e.expressID);await this.getIFCElementLocationTranslated(t,r);let a="",o="";const s=await gr.ifcManager.getAllItemsOfType(r,lr["IFCRELDEFINESBYTYPE"]);for(let n=0;n<s.length;n++){const e=await gr.ifcManager.getItemProperties(r,s[n]);for(let s=0;s<e.RelatedObjects.length;s++){const n=e.RelatedObjects[s];if(n.value==t){const t=e.RelatingType.value,s=await gr.ifcManager.getItemProperties(r,t);a=s.Name.value,o=s.PredefinedType.value}}}let l="",c="",d=0;const u=await gr.ifcManager.getAllItemsOfType(r,lr["IFCRELCONTAINEDINSPATIALSTRUCTURE"]);for(let n=0;n<u.length;n++){const e=await gr.ifcManager.getItemProperties(r,u[n]);for(let a=0;a<e.RelatedElements.length;a++)if(e.RelatedElements[a].value==t){const t=await gr.ifcManager.getItemProperties(r,e.RelatingStructure.value);l=t.GlobalId.value,c=t.Name.value,d=t.expressID}}let h="",g="",m="",p="";const f=await gr.ifcManager.getAllItemsOfType(r,lr["IFCRELDEFINESBYPROPERTIES"]);for(let n=0;n<f.length;n++){const e=await gr.ifcManager.getItemProperties(r,f[n]);for(let a=0;a<e.RelatedObjects.length;a++)if(e.RelatedObjects[a].value==t){const t=await gr.ifcManager.getItemProperties(r,e.RelatingPropertyDefinition.value),a=t.HasProperties;for(let e=0;e<a.length;e++){const t=await gr.ifcManager.getItemProperties(r,a[e].value);"GLN"==t.Name.value&&(h=t.NominalValue.value,console.log("glnNumber"),console.log(h)),"SerialNumber"==t.Name.value&&(g=t.NominalValue.value),"Manufacturer"==t.Name.value&&(m=t.NominalValue.value),"ProductionYear"==t.Name.value&&(p=t.NominalValue.value)}}}}},showWay(e){if(e.length<=2)return;let t=[],a=void 0,o=new js["uc"](0,0,0);e.forEach(e=>{let s=!1;if(c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].RDF("type"),d["c"].NEO("x_door"))[0]&&(o=this.getDoorPosition(e),s=!0),void 0!=a&&!s)if(c["a"].state.rs.rdfStore.match(hr.sym(a),d["c"].RDF("type"),d["c"].NEO("x_door"))[0]){const a=this.getRoomPolylinebyURI(e),s=Dt["a"].getDoorDirectionVector(a,o,!1);t.push({uri:e,pos:o,vec:s})}else{const o=[];let s=new js["uc"](0,0,0);o.push(this.getRoomPolylinebyURI(a)),o.push(this.getRoomPolylinebyURI(e));let r=Dt["a"].findSpaceIntersections(o,.5,!1);r[0]&&(s=r[0].point);const n=Dt["a"].getDoorDirectionVector(o[1],s,!1);t.push({uri:"",pos:s,vec:n})}a=e});let s=void 0;t=t.reduce((function(e,t){let a=t.pos.clone().add(t.vec.clone().negate());if(e.push({uri:"",pos:a.clone(),vec:t.vec}),e.push(t),void 0!=s){let o=new js["uc"](0,0,0).subVectors(a.clone(),s.pos.clone().add(s.vec.clone())).normalize();console.log("After dir:"),console.log(o);let r=t.pos.clone().distanceTo(s.pos),n=s.pos.clone().add(s.vec.clone());e.push({uri:"",pos:n,vec:o});for(let t=3;t<Math.abs(r-3);t+=3){let a=n.clone().addScaledVector(o.clone(),t);e.push({uri:"",pos:a,vec:o})}}return s=t,e}),[]),c["a"].state.bv.arrowModelStart=!1,t.forEach(e=>{Dt["a"].createVisibleVector(e.pos,e.vec,65535),Dt["a"].createPlaceMarker(e.pos.clone(),65535,!1,2,"placemarker",.25),Dt["a"].placeArrow(e.pos,e.vec)})},getFloorTagfromJson(e,t){for(let a=0;a<=Object.keys(e.storeys).length;a++)if(Object.values(e.storeys)[a]==t)return Object.keys(e.storeys)[a];return""},generateTurtleFromStore(){var e=ne["a"].storeToTurtle(c["a"].state.rs.rdfStore,br);let t=this.$route.query.location+"home/TTL/rooms.rtf";var a=new Blob([e],{type:"text/plain;charset=utf-8"});try{window.solid.session.fetch(t,{method:"PUT",credentials:"include",body:a,headers:{"Content-Type":""},onUploadProgress:function(e){this.progress=parseInt(Math.round(e.loaded/e.total*100))}.bind(this)}).then(t=>{console.log("done uploading",t),console.log(e)})}catch(o){this.error="Error has occured"}},async populateStoreFromTurtle(){if(console.log("Populating store from turtle..."),c["a"].state.rs.rdfStore.match(null,d["c"].RDF("type"),d["c"].BOT("Space"))[10])return;let e=this.$route.query.location+"home/TTL/rooms.rtf";try{window.solid.session.fetch(e,{method:"GET",credentials:"include"}).then(t=>{t.arrayBuffer().then(t=>{let a=new Blob([t]);const o=new FileReader;o.onload=function(){hr.parse(this.result,c["a"].state.rs.rdfStore,e,"text/turtle"),c["a"].state.rs.rdfStore.match(null,d["c"].RDF("type"),d["c"].BOT("Space")).forEach(e=>{console.log("Room: "+e.subject.value)});ne["a"].storeToTurtle(c["a"].state.rs.rdfStore,br)},o.readAsText(a)})})}catch(t){console.log(t),console.log("Failed to parse Turtle from file...")}},generateRoomsTurtle(){vr=hr.graph(),c["a"].state.rs.rdfStore.match(null,d["c"].RDF("type"),d["c"].BOT("Space")).forEach(e=>{wr(hr.sym(e.subject.value),d["c"].RDF("type"),d["c"].BOT("Space"),hr.default),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].TAG("tag"),null)[0]&&wr(hr.sym(e.subject.value),d["c"].TAG("tag"),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].TAG("tag"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].IFOUR("m_polyline"),null)[0]&&wr(hr.sym(e.subject.value),d["c"].IFOUR("m_polyline"),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].IFOUR("m_polyline"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].RDFS("label"),null).forEach(t=>{wr(hr.sym(e.subject.value),d["c"].RDFS("label"),t.object.value,hr.default)}),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].RDFS("label"),null)[1]&&wr(hr.sym(e.subject.value),d["c"].RDFS("label"),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].RDFS("label"),null)[1].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].NEO("m_area-net"),null)[0]&&wr(hr.sym(e.subject.value),d["c"].NEO("m_area-net"),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].NEO("m_area-net"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].NEO("m_area-gross"),null)[0]&&wr(hr.sym(e.subject.value),d["c"].NEO("m_area-gross"),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].NEO("m_area-gross"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].NEO("b_capable"),null)[0]&&wr(hr.sym(e.subject.value),d["c"].NEO("b_capable"),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].NEO("b_capable"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].FOAF("name"),null)[0]&&wr(hr.sym(e.subject.value),d["c"].FOAF("name"),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].FOAF("name"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].IFOUR("trafficload"),null)[0]&&wr(hr.sym(e.subject.value),d["c"].IFOUR("trafficload"),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].IFOUR("trafficload"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].IFOUR("expressid"),null)[0]&&wr(hr.sym(e.subject.value),d["c"].IFOUR("expressid"),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].IFOUR("expressid"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].IFOUR("globalid"),null)[0]&&wr(hr.sym(e.subject.value),d["c"].IFOUR("globalid"),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].IFOUR("globalid"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].IFOUR("roomhag"),null)[0]&&wr(hr.sym(e.subject.value),d["c"].IFOUR("roomhag"),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].IFOUR("roomhag"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].SIO("SIO_000507"),null)[0]&&wr(hr.sym(e.subject.value),d["c"].SIO("SIO_000507"),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].SIO("SIO_000507"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].NEO("m_port"),null).forEach(t=>{wr(hr.sym(e.subject.value),d["c"].NEO("m_port"),t.object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(t.object.value),d["c"].RDF("type"),null)[0]&&wr(hr.sym(t.object.value),d["c"].RDF("type"),c["a"].state.rs.rdfStore.match(hr.sym(t.object.value),d["c"].RDF("type"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(t.object.value),d["c"].SIO("SIO_000507"),null)[0]&&wr(hr.sym(t.object.value),d["c"].SIO("SIO_000507"),c["a"].state.rs.rdfStore.match(hr.sym(t.object.value),d["c"].SIO("SIO_000507"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(t.object.value),d["c"].TAG("tag"),null)[0]&&wr(hr.sym(t.object.value),d["c"].TAG("tag"),c["a"].state.rs.rdfStore.match(hr.sym(t.object.value),d["c"].TAG("tag"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(t.object.value),d["c"].FOAF("name"),null)[0]&&wr(hr.sym(t.object.value),d["c"].FOAF("name"),c["a"].state.rs.rdfStore.match(hr.sym(t.object.value),d["c"].FOAF("name"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(t.object.value),d["c"].IFOUR("expressid"),null)[0]&&wr(hr.sym(t.object.value),d["c"].IFOUR("expressid"),c["a"].state.rs.rdfStore.match(hr.sym(t.object.value),d["c"].IFOUR("expressid"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(t.object.value),d["c"].IFOUR("globalid"),null)[0]&&wr(hr.sym(t.object.value),d["c"].IFOUR("globalid"),c["a"].state.rs.rdfStore.match(hr.sym(t.object.value),d["c"].IFOUR("globalid"),null)[0].object.value,hr.default),c["a"].state.rs.rdfStore.match(hr.sym(t.object.value),d["c"].RDFS("label"),null).forEach(e=>{wr(hr.sym(t.object.value),d["c"].RDFS("label"),e.object.value.replace("  "," "),hr.default)})}),c["a"].state.rs.rdfStore.match(hr.sym(e.subject.value),d["c"].NEO("m_join"),null).forEach(t=>{wr(hr.sym(e.subject.value),d["c"].NEO("m_join"),t.object.value,hr.default)})});var e=ne["a"].storeToTurtle(vr,br);e=re["a"].modifyTurtle(e),console.log("Turtle"),console.log(e);this.$route.query.location;new Blob([e],{type:"text/plain;charset=utf-8"})},getIfcFiles(){let e=this.$route.query.location+"home/IFC/";re["a"].fetchAndSaveTurtle(e,!0).then(t=>{let a=[],o=[],s=c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].LDP("contains"),null);return s.forEach(e=>{a.includes(e.object.value)||a.push(e.object.value)}),s=c["a"].state.rs.rdfStore.match(null,d["c"].RDF("type"),d["c"].REG("file")),s.forEach(e=>{!o.includes(e.subject.value)&&a.includes(e.subject.value)&&o.push(e.subject.value)}),o.forEach((e,t)=>{let a=c["a"].state.rs.rdfStore.match(hr.sym(e),d["c"].RDFS("label"),null);a.forEach(e=>{console.log("File: ",e.object.value),e.object.value.includes(".ifc")&&!this.ifcfiles.includes(e.object.value)&&this.ifcfiles.push(e.object.value)})}),t})},async showIFC(){let e=this.$route.query.location+"home/IFC/building.ifc";console.log("IFC uri: "+e);try{const t=await window.solid.session.fetch(e,{method:"GET",credentials:"include"});console.log(t);let a=await t.arrayBuffer(),o=URL.createObjectURL(new Blob([a],{type:"application/ifc"}));const s=c["a"].state.bv.scene.getObjectByName("buildingbox");let r=await gr.loadAsync(o);r.scale.set(c["a"].state.bv.scaleFactor,c["a"].state.bv.scaleFactor,c["a"].state.bv.scaleFactor),r.name="IFCModel",console.log(r),this.buildingPosition.buildingdimensions.v2.x=r.geometry.boundingBox.max.x-r.geometry.boundingBox.min.x,this.buildingPosition.buildingdimensions.v3.y=r.geometry.boundingBox.max.z-r.geometry.boundingBox.min.z,this.buildingPosition.buildingdimensions.v3.z=r.geometry.boundingBox.max.y-r.geometry.boundingBox.min.y,this.buildingPosition.xAnchorDisplacement=-r.geometry.boundingBox.min.x,this.buildingPosition.yAnchorDisplacement=r.geometry.boundingBox.max.z,s.geometry=vt["a"].methods.lineDashBox(this.buildingPosition.buildingdimensions.v2.x*c["a"].state.bv.scaleFactor,this.buildingPosition.buildingdimensions.v3.z*c["a"].state.bv.scaleFactor,this.buildingPosition.buildingdimensions.v3.y*c["a"].state.bv.scaleFactor),s.updateMatrix(),s.matrixAutoUpdate=!1,s.castShadow=!1,s.renderOrder=1,s.add(r),console.log("IFCModel:"),console.log(r),r=c["a"].state.bv.scene.getObjectByName("IFCModel"),r.position.x=this.buildingPosition.xAnchorDisplacement*c["a"].state.bv.scaleFactor-this.buildingPosition.buildingdimensions.v2.x/2*c["a"].state.bv.scaleFactor,r.position.z=-this.buildingPosition.yAnchorDisplacement*c["a"].state.bv.scaleFactor+this.buildingPosition.buildingdimensions.v3.y/2*c["a"].state.bv.scaleFactor,r.updateMatrix(),r.matrixAutoUpdate=!1,r.renderOrder=1,console.log("IFCModel:"),console.log(r);const n=await kt["a"].getIFCmetaDataFromJson(this.$route.query.location+"home/IFC/building.json");this.buildingPosition.buildinglat=n.buildinglat,this.buildingPosition.buildinglong=n.buildinglong,this.buildingPosition.buildingdimensions.v1.x=n.buildingdimensions.v1.x,this.buildingPosition.buildingdimensions.v1.y=n.buildingdimensions.v1.y,this.buildingPosition.buildingdimensions.v1.z=n.buildingdimensions.v1.z,this.buildingPosition.rotation.x=n.rotation.x,this.buildingPosition.rotation.y=n.rotation.y,this.buildingPosition.rotation.z=n.rotation.z,this.RENDER()}catch(t){console.log(t)}},setBuildingPoint1(){const e=c["a"].state.bv.scene.getObjectByName("buildingbox");this.buildingPosition.buildingPosX=c["a"].state.bv.intersectXY.x-e.position.x+this.buildingPosition.buildingdimensions.v2.x/2*c["a"].state.bv.scaleFactor,this.buildingPosition.buildingPosY=c["a"].state.bv.intersectXY.y+50-e.position.z-this.buildingPosition.buildingdimensions.v3.y/2*c["a"].state.bv.scaleFactor},fineTuneBuildingRotation(){this.rotationStep=720},setBuildingLatLong1(){const e=c["a"].state.bv.scene.getObjectByName("buildingbox");console.log(c["a"].state.bv.buildingboxPosition),console.log(c["a"].state.bv.intersectXY);const t=ir["c"].sphericalToDatums(c["a"].state.bv.buildingboxPosition.x+c["a"].state.bv.intersectXY.x,c["a"].state.bv.buildingboxPosition.z-c["a"].state.bv.intersectXY.y);this.buildingPosition.buildinglat=t.latitude,this.buildingPosition.buildinglong=t.longitude,console.log("Removing building box.."),console.log(e);let a=c["a"].state.bv.intersectXY.x-e.position.x+this.buildingPosition.buildingdimensions.v2.x/2*c["a"].state.bv.scaleFactor,o=c["a"].state.bv.intersectXY.y+50-e.position.z-this.buildingPosition.buildingdimensions.v3.y/2*c["a"].state.bv.scaleFactor;e.translateX(a),e.translateZ(o),e.translateX(-this.buildingPosition.buildingPosX),e.translateZ(-this.buildingPosition.buildingPosY),e.updateMatrix(),e.matrixAutoUpdate=!1,e.castShadow=!1,e.renderOrder=1,this.RENDER()},rotateBuildingbox(e){const t=c["a"].state.bv.scene.getObjectByName("buildingbox");let a=Math.PI/this.rotationStep*e;t.translateX(-this.buildingPosition.buildingdimensions.v2.x/2*c["a"].state.bv.scaleFactor+this.buildingPosition.buildingPosX),t.translateZ(this.buildingPosition.buildingdimensions.v3.y/2*c["a"].state.bv.scaleFactor+this.buildingPosition.buildingPosY),t.rotateOnAxis(new js["uc"](0,1,0),-a),t.translateX(this.buildingPosition.buildingdimensions.v2.x/2*c["a"].state.bv.scaleFactor-this.buildingPosition.buildingPosX),t.translateZ(-this.buildingPosition.buildingdimensions.v3.y/2*c["a"].state.bv.scaleFactor-this.buildingPosition.buildingPosY),t.updateMatrix(),t.matrixAutoUpdate=!1,t.castShadow=!1,t.renderOrder=1,this.RENDER(),console.log(t),this.buildingPosition.rotation.x=t.rotation.x,this.buildingPosition.rotation.y=t.rotation.y,this.buildingPosition.rotation.z=t.rotation.z},moveBuildingBox(e,t,a){const o=c["a"].state.bv.scene.getObjectByName("buildingbox");o.translateX(e),o.translateX(t),o.translateZ(a),o.updateMatrix(),o.matrixAutoUpdate=!1,o.castShadow=!1,o.renderOrder=1,this.RENDER(),console.log(o),this.buildingPosition.buildingdimensions.v1.x=o.position.x,this.buildingPosition.buildingdimensions.v1.y=o.position.y,this.buildingPosition.buildingdimensions.v1.z=o.position.z},async uploadPropertiesJson(){const e=await kt["a"].getIFCmetaDataFromJson(this.$route.query.location+"home/IFC/building.json");e.buildingdimensions=this.buildingPosition.buildingdimensions,e.buildinglat=this.buildingPosition.buildinglat,e.buildinglong=this.buildingPosition.buildinglong,e.xAnchorDisplacement=this.buildingPosition.xAnchorDisplacement,e.yAnchorDisplacement=this.buildingPosition.yAnchorDisplacement,e.rotation=this.buildingPosition.rotation,e.name="Test1",console.log(e);let t=this.$route.query.location+"home/IFC/building.json";var a=new Blob([JSON.stringify(e)],{type:"text/plain;charset=utf-8"});try{window.solid.session.fetch(t,{method:"PUT",credentials:"include",body:a,headers:{"Content-Type":""},onUploadProgress:function(e){this.progress=parseInt(Math.round(e.loaded/e.total*100))}.bind(this)}).then(e=>{console.log("done uploading",e)})}catch(o){this.error="Error has occured"}}},computed:{},watch:{ifctypesselected:async function(e){this.getIFCOpeningElements()},"$store.state.bv.selectedRoomNames":function(e){1==e.length?this.roomSelected=!0:this.roomSelected=!1},floorsselected:function(e){console.log("Floor selected: "),console.log(this.floorsselected);for(let a=0;a<this.floorlist.length;a++)this.floorsselected==this.floorlist[a]&&(console.log("Floor height: "+this.floorheights[a]),this.showRoomsForStorey(this.floorheights[a]),c["a"].state.bv.selectedStorey.hag=this.floorheights[a]);let t=0;for(let a=0;a<this.floorids.length;a++)this.floorids[a].name==this.floorsselected&&(t=this.floorids[a].expressid);console.log("FloorExpressID: "+t);this.getSpacesRelatedToStorey(t,Rr.modelID,!0);this.doorIssueTableList=[],this.roomNumberProcess=3},doorIssueTableSelectedRow:function(e){c["a"].state.bv.selectedRoomIDs=[],e.forEach(e=>{c["a"].state.bv.selectedRoomIDs.push(decodeURI(e.room1))})}},mounted(){this.checklogin(),mr(),this.getBuildingMainEntrances(),this.getIfcFiles(),this.populateStoreFromTurtle();let e=[[[100,0],[101,0],[101,1],[100,1],[100,0],[100.2,.2],[100.8,.2],[100.8,.8],[100.2,.8],[100.2,.2]]];const t="polyline;1N01;62.205509379700004;30.75;3;2.9;[0,0,0,-2.54,-3.110602869834277e-16,0,-2.5393294347499995,-2.2650000000000006,0,-2.3018294347499997,-2.2650000000000006,0,-2.3018294347499997,-2.6900000000000004,0,-2.5529999999999995,-2.6900000000000004,0,-2.5529999999999995,-3.53550937975,0,0.009117699423760433,-3.5355093797499997,0,0.00747572507190033,-2.69,0,-0.23817056524899965,-2.69,0,-0.2381705652489997,-2.2655093797499997,0,2.774136024559312e-16,-2.26525397077,0,0,0,0]";e=[this.polyLineTo2dArray(t)],console.log(e);var a=nr()(e,1);console.log("Point1"),console.log(a)},created(){this.addEventListerners()},beforeDestroy(){this.removeEventListerners()}},jr=_r,Tr=(a("2382"),a("67b6")),Fr=a("43a6"),Or=Object(A["a"])(jr,ar,or,!1,null,"2e2d0c2b",null),Cr=Or.exports;x()(Or,{VBtn:_["a"],VDataTable:pe["a"],VForm:Ie["a"],VRadio:Tr["a"],VRadioGroup:Fr["a"],VSelect:Ae["a"],VSwitch:Go["a"]});var Nr={name:"IFCexporterV",components:{IFCexporter:Cr,BIMviewer:vt["a"],Multipane:zt["a"],MultipaneResizer:zt["b"]},data:function(){return{bimVisible:!0,viewHeight:600}},mounted:function(){},methods:{...Object(oa["c"])("bv",["RESIZE"]),updateCanvasSize(){const e=this.$refs.myviewer;console.log(e);const t=window.innerHeight-60;this.viewHeight=t;const a=e.$el.clientWidth+10;console.log("Width is: "+a),c["a"].state.bv.renderer.setSize(a,t),c["a"].state.bv.twodim?(c["a"].state.bv.labelrenderer.setSize(a,t),c["a"].state.bv.twodimcamera.left=a/-2,c["a"].state.bv.twodimcamera.right=a/2,c["a"].state.bv.twodimcamera.top=t/2,c["a"].state.bv.twodimcamera.bottom=t/-2,c["a"].state.bv.twodimcamera.updateProjectionMatrix()):c["a"].state.bv.thirdperson?(c["a"].state.bv.thirdpersoncamera.aspect=a/t,c["a"].state.bv.thirdpersoncamera.updateProjectionMatrix()):(c["a"].state.bv.labelrenderer.setSize(a,t),c["a"].state.bv.camera.aspect=a/t,c["a"].state.bv.camera.updateProjectionMatrix())},toggleViews(){const e=this.$refs.leftpane;console.log(e),e.clientWidth>0?e.style.width="0vw":e.style.width="100vw",this.updateCanvasSize()},windowResize(){this.updateCanvasSize()},paneresizestarted:function(e){console.log("resize start...")},paneresizestopped:function(e){console.log("resize stop..."),this.updateCanvasSize(),window.dispatchEvent(new Event("resize"))}},mounted(){this.windowResize()},created(){window.addEventListener("resize",this.windowResize)},destroyed(){window.removeEventListener("resize",this.windowResize)}},Lr=Nr,Pr=(a("53a9"),Object(A["a"])(Lr,er,tr,!1,null,"94ab7896",null)),Dr=Pr.exports;x()(Pr,{VBtn:_["a"],VIcon:Se["a"]});var kr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"feedback",attrs:{id:"wrapper"}},[a("div",{staticClass:"left"},[a("RentModule",{attrs:{msg:"Show RentModule form"}})],1),a("div",{staticClass:"right"},[a("BIMviewer",{attrs:{msg:"Show bimviewer form"}})],1)])},Ur=[],Mr=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"inputwrapper",attrs:{align:"left"}},[a("v-form",{ref:"form1",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("div",[a("h2",[e._v(e._s(e.$t("select_building")))]),a("hr",{staticClass:"hr2"}),a("v-select",{attrs:{items:e.buildingNames,label:e.$t("text_all"),multiple:"",chips:"",solo:""},model:{value:e.buildingSelected,callback:function(t){e.buildingSelected=t},expression:"buildingSelected"}})],1),""!=e.buildingSelected?a("div",[a("h2",[e._v(e._s(e.$t("select_wings")))]),a("hr",{staticClass:"hr2"}),a("v-select",{attrs:{items:e.wings,label:e.$t("text_all"),multiple:"",chips:"",solo:""},model:{value:e.wingselected,callback:function(t){e.wingselected=t},expression:"wingselected"}})],1):e._e(),""!=e.wingselected?a("div",[a("h2",[e._v(e._s(e.$t("select_floors")))]),a("hr",{staticClass:"hr2"}),a("v-select",{attrs:{items:e.floors,label:e.$t("text_all"),single:"",chips:"",solo:""},model:{value:e.floorselected,callback:function(t){e.floorselected=t},expression:"floorselected"}})],1):e._e(),e.loading?e._e():a("div",[a("h2",[e._v(e._s(e.$t("select_functions")))]),a("hr",{staticClass:"hr1"}),a("v-sheet",{staticClass:"pa-4 primary lighten-2"},[a("v-text-field",{attrs:{label:"Search",dark:"",flat:"","solo-inverted":"","hide-details":"",clearable:"","clear-icon":"mdi-close-circle-outline"},model:{value:e.csfsearch,callback:function(t){e.csfsearch=t},expression:"csfsearch"}}),a("v-checkbox",{attrs:{dark:"","hide-details":"",label:"Case sensitive search"},model:{value:e.caseSensitive,callback:function(t){e.caseSensitive=t},expression:"caseSensitive"}})],1),a("v-treeview",{attrs:{items:e.csfitems,search:e.csfsearch,filter:e.filter,transition:!0,"open-on-click":!0,rounded:!0,selectable:"","return-object":"",dense:""},scopedSlots:e._u([{key:"prepend",fn:function(t){var o=t.item;t.open;return[a("v-icon",{attrs:{color:o.color}},[e._v(" "+e._s("mdi-folder"))])]}}],null,!1,1680069583),model:{value:e.csfselection,callback:function(t){e.csfselection=t},expression:"csfselection"}})],1),a("v-btn",{staticClass:"white--text",attrs:{color:"#3577cb"},on:{click:function(t){return e.setAllFunctionsSelected()}}},[e._v(" Select all ")]),a("br"),a("br"),a("v-switch",{attrs:{label:"Split by floor",color:"blue","hide-details":""},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}}),a("br"),a("br")],1)],1)},Br=[];const Vr=a("592d");a("c8c8");const Gr={searchAndGetTriples:async function(e){let t=c["a"].state.webId.replace("/i","/search/")+encodeURIComponent(e);console.log("Trying to search.."),console.log(t);try{let e=await window.solid.session.fetch(t,{method:"GET",credentials:"include",headers:{Accept:"text/turtle"}}).then(e=>e.text());return Vr.parse(e,c["a"].state.rs.rdfStore,t,"text/turtle"),e}catch(a){console.log("Search failed"),console.log(a)}}},zr=(e,t)=>/^\d/.test(e.name)-/^\d/.test(t.name)||e.name.localeCompare(t.name,void 0,{numeric:!0});function Wr(e){return(parseInt(e.substr(1),16)<<8)/256}var Hr={id:Gr,name:"IFCexporter",data(){return{rhf:[],rhfselected:[],rhfselectedURIs:[],helseforetak:[],hfselected:[],hfselectedURIs:[],lokselected:[],locationNames:[],locationURIs:[],buildingNames:[],buildingURIs:[],buildingSelected:[],wings:[],wingURIs:[],wingselected:[],floors:[],floorURIs:[],floorselected:[],siteURIs:[],siteNames:[],siteSelected:[],roomsSelected:[],selectedRoomURIs:[],valid:!0,loading:!1,csfselection:[],csfsearch:null,caseSensitive:!1,partfunctionsSelected:[],colorlist:["#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080"],csfitems:[{id:1,name:"Root",color:"#FF0000",children:[{id:2,name:"Child #1",color:"#0000FF"},{id:3,name:"Child #2",color:"#00FF00"},{id:4,name:"Child #3",color:"#0000FF"}]}]}},methods:{...Object(oa["c"])("bv",["RESIZE"]),...Object(oa["b"])("bv",["RENDER","INITIALIZE_PLAYER"]),checklogin(){console.log(window.solid.session.info),window.solid.session.info.isLoggedIn?console.log("Test logged in"):(console.log("Is logged out, reroute"),this.$router.push({path:"/"}))},async getHospitalFunctions(){await Gr.searchAndGetTriples("#NMH.F.SYKEHUS.*");this.csfitems=[];const e=[],t=[],a=[],o=[];c["a"].state.rs.rdfStore.match(null,d["c"].TAG("tag"),null).forEach(s=>{if(s.object.value.includes("NMH.F.SYKEHUS.")){let r=!1;c["a"].state.rs.rdfStore.match(Vr.sym(s.subject.value),d["c"].RDFS("label"),null).forEach(e=>{e.object.value.includes("Hovedfunksjon")&&(r=!0)}),r?(console.log("Found: "+s.object.value),e.push(s.object.value),t.push(s.subject.value)):(a.push(s.object.value),o.push(s.subject.value))}});let s=0;e.forEach((e,r)=>{const n=[];a.forEach((t,a)=>{if(t.includes(e+".")){const e=c["a"].state.rs.rdfStore.match(Vr.sym(o[a]),d["c"].RDFS("label"),null)[0].object.value.replace("Delfunksjon: ","");n.push({id:s,name:e,color:this.colorlist[r],tag:t,uri:o[a]}),s++}}),n.sort(zr);const i=c["a"].state.rs.rdfStore.match(Vr.sym(t[r]),d["c"].RDFS("label"),null)[0].object.value.replace("Hovedfunksjon: ","");this.csfitems.push({id:s,name:i,color:this.colorlist[r],tag:e,uri:t[r],children:n}),this.csfitems.sort(zr),s++})},setAllFunctionsSelected(){this.csfselection.length>0?this.csfselection=[]:this.csfitems.forEach(e=>{this.csfselection.push(e)})},getRHFDataFromTrinity(){const e=c["a"].state.ministryURI;0!=c["a"].state.rs.rdfStore.match(Vr.sym(e+"/i"),d["c"].ORG("hasSubOrganization"),null).length?(console.log("RHF FOUND!, getting data from local storage."),c["a"].state.rs.rdfStore.match(Vr.sym(e+"/i"),d["c"].ORG("hasSubOrganization"),null).forEach(e=>{console.log("RHF URI"+e.object),this.rhfselectedURIs.push(e.object)}),this.rhfselectedURIs.forEach((e,t)=>{const a=Vr.st(e,d["c"].FOAF("name"),null);let o=[];o.push(a),this.getURIObject(o,a,"").then(e=>{e.forEach((e,t)=>{this.rhf.includes(""+e.object)||(this.rhf.push(""+e.object),this.rhfselected.push(""+e.object))})})})):(console.log("RHF NOT FOUND!, getting data from TrinPod"),re["a"].aLoadURI(e+"/i",null,null).then(t=>{t?(c["a"].state.rs.rdfStore.match(Vr.sym(e+"/i"),d["c"].ORG("hasSubOrganization"),null).forEach(e=>{console.log("RHF URI"+e.object),c["a"].state.rs.rdfStore.add(e),this.rhfselectedURIs.push(e.object)}),this.rhfselectedURIs.forEach((e,t)=>{const a=Vr.st(e,d["c"].FOAF("name"),null);let o=[];o.push(a),this.getURIObject(o,a,"").then(e=>{e.forEach((e,t)=>{this.rhf.includes(""+e.object)||(this.rhf.push(""+e.object),this.rhfselected.push(""+e.object))})})})):console.log("Ministry Of Health URI not found.")}))},async getURIObject(e,t,a){return new Promise(o=>{let s=[];0!=c["a"].state.rs.rdfStore.match(t.subject,t.predicate,null).length?(console.log("Getting locally."),e=this.getTripleMatches(e,c["a"].state.rs.rdfStore),e.forEach(e=>{e.object.value.includes(a)&&(console.log("Found URI"+e),s.push(e))}),o(s)):(console.log("Getting TrinPod."),re["a"].aLoadURI(t.subject.value,null,null).then(t=>{t&&(console.log(t),e=this.getTripleMatches(e,c["a"].state.rs.rdfStore),e.forEach(e=>{e.object.value.includes(a)&&(c["a"].state.rs.rdfStore.add(e),s.push(e))}),o(s))}))})},async getURISubject(e,t,a){return new Promise(o=>{let s=[];0!=c["a"].state.rs.rdfStore.match(null,t.predicate,t.object).length?(console.log("Getting locally."),e=this.getTripleMatches(e,c["a"].state.rs.rdfStore),e.forEach(e=>{e.subject.value.includes(a)&&(console.log("Found URI"+e),s.push(e))}),o(s)):(console.log("Getting TrinPod."),re["a"].aLoadURI(t.object.value,null,null).then(t=>{t&&(console.log(t),console.log(e),e=this.getTripleMatches(e,c["a"].state.rs.rdfStore),e.forEach(e=>{e.subject.value.includes(a)&&(c["a"].state.rs.rdfStore.add(e),s.push(e))}),o(s))}))})},getTripleMatches(e,t){let a=[];return e.forEach((o,s)=>{0==s?t.match(e[s].subject,e[s].predicate,e[s].object).forEach(e=>{a.push(e)}):t.match(e[s].subject,e[s].predicate,e[s].object).forEach(e=>{a.includes(e)?(a=this.arrayRemove(a,e),a.push(e)):a.push(e)})}),a}},computed:{filter(){return this.caseSensitive?(e,t,a)=>e[a].indexOf(t)>-1:void 0}},watch:{csfselection:function(e,t){this.partfunctionsSelected=[],console.log(e),c["a"].state.bv.roomGeometry=[];const a=c["a"].state.bv.scene.getObjectByName("buildingbox");for(var o=a.children.length-1;o>=0;o--)a.children[o].name.includes("FLOORPLAN")||a.remove(a.children[o]);e.forEach(e=>{this.partfunctionsSelected.push({uri:e.uri,color:e.color})})},partfunctionsSelected:function(e,t){this.roomsSelected=[],e.forEach(e=>{this.selectedRoomURIs.forEach(t=>{c["a"].state.rs.rdfStore.match(Vr.sym(t),null,Vr.sym(e.uri)).forEach(t=>{this.roomsSelected.push({uri:t.subject.value,color:e.color})})})})},roomsSelected:function(e,t){console.log("Found rooms"),e.forEach(e=>{console.log("RoomURI: "+e.uri),c["a"].state.rs.rdfStore.match(Vr.sym(e.uri),d["c"].IFOUR("m_polyline"),null).forEach((t,a)=>{Dt["a"].addRoomMatrix(t,Wr(e.color),1,e.uri)})})},rhfselected:function(e){console.log("rhf selected...");var t=0,a=0,o=0,s=0;for(let r=0;r<this.rhfselected.length;r++)console.log("Selected RHF: "+this.rhfselected[r]),"Helse Nord RHF"==this.rhfselected[r]&&(t=1),"Helse Midt-Norge RHF"==this.rhfselected[r]&&(a=1),"Helse Vest RHF"==this.rhfselected[r]&&(o=1),"Helse Sør-Øst RHF"==this.rhfselected[r]&&(s=1);this.hrimage="hr"+t+a+o+s+".png",this.rhfselectedURIs.forEach((e,t)=>{const a=Vr.st(e,d["c"].ORG("hasSubOrganization"),null);let o=[];o.push(a),this.getURIObject(o,a,"").then(e=>{e.forEach((e,t)=>{console.log("Found HF URIs: "+e.object.value),this.hfselectedURIs.push(e.object);const a=Vr.st(e.object,d["c"].FOAF("name"),null);let o=[];o.push(a),this.getURIObject(o,a,"").then(e=>{e.forEach((e,t)=>{this.hfselected.includes(""+e.object.value)||(this.helseforetak.push(e.object.value),this.hfselected.push(e.object.value))})})})})})},hfselected:function(e){console.log("hf selected..."),this.hfselectedURIs.forEach((e,t)=>{const a=Vr.st(e,d["c"].ORG("hasSubOrganization"),null);let o=[];o.push(a),this.getURIObject(o,a,"").then(e=>{e.forEach((e,t)=>{console.log("Found Location URIs: "+e.object.value),this.locationURIs.push(e.object);const a=Vr.st(e.object,d["c"].FOAF("name"),null);let o=[];o.push(a),this.getURIObject(o,a,"").then(e=>{e.forEach((e,t)=>{this.locationNames.includes(""+e.object.value)||(this.locationNames.push(e.object.value),this.lokselected.push(e.object.value))})})})})})},lokselected:function(e){console.log("location selected..."),this.locationURIs.forEach((e,t)=>{const a=Vr.st(null,d["c"].ACL("owner"),e);let o=[];o.push(a),this.getURISubject(o,a,"").then(e=>{e.forEach((e,t)=>{console.log("Found Site URIs: "+e.subject.value),this.siteURIs.push(e.subject)}),this.siteURIs.forEach((e,t)=>{const a=Vr.st(null,d["c"].ACL("owner"),e);let o=[];o.push(a),this.getURISubject(o,a,"").then(e=>{e.forEach((e,t)=>{console.log("Found Building URIs: "+e.subject.value),this.buildingURIs.push(e.subject);const a=Vr.st(e.subject,d["c"].FOAF("name"),null);let o=[];o.push(a),this.getURIObject(o,a,"").then(e=>{e.forEach((e,t)=>{this.buildingNames.includes(""+e.object.value)||(this.buildingNames.push(""+e.object.value),this.buildingSelected.push(""+e.object.value))})})})})})})})},buildingSelected:async function(e){const t=[];this.buildingNames.forEach((e,a)=>{t.push(this.buildingURIs[a])});await t.forEach((e,t)=>{re["a"].fetchAndSaveTurtle(e.value,!0).then(e=>e)}),await Fe["a"].searchAndGetURIs("#"+c["a"].state.currentBuildingTag+".FLOY*");c["a"].state.rs.rdfStore.match(null,d["c"].RDF("type"),d["c"].NEO("s_instance")).forEach(e=>{console.log("Found wing: "+e.subject.value),this.wingURIs.push(e.subject.value)}),this.wingURIs.forEach((e,t)=>{let a=c["a"].state.rs.rdfStore.match(Vr.sym(e),d["c"].RDFS("label"),null);a.forEach(e=>{console.log("Found wing name: "+e.object.value),this.wings.includes(decodeURI(e.object.value))||this.wings.push(decodeURI(e.object.value))})})},wingselected:async function(e){await Fe["a"].searchAndGetURIs("#"+c["a"].state.currentBuildingTag+"*");c["a"].state.rs.rdfStore.match(null,d["c"].RDF("type"),d["c"].BOT("Storey")).forEach(e=>{console.log("Found storey: "+e.subject.value),this.floorURIs.push(e.subject.value)}),this.floorURIs.forEach((e,t)=>{let a=c["a"].state.rs.rdfStore.match(Vr.sym(e),d["c"].RDFS("label"),null);a.forEach(e=>{console.log("Found storey name: "+e.object.value),this.floors.includes(decodeURI(e.object.value))||this.floors.push(decodeURI(e.object.value))})})},floorselected:async function(e){console.log(this.floorselected),c["a"].state.bv.GLTFloadingQueue=[],Dt["a"].unloadGeometryUsingTag(c["a"].state.currentBuildingTag,["BUILDING"]),Dt["a"].unloadGeometryContainingString("FLOORPLAN");let t=[];this.floors.forEach((e,a)=>{if(this.floorselected.includes(e)){let a=c["a"].state.rs.rdfStore.match(null,d["c"].RDFS("label"),Vr.literal(e,"en"));a.forEach(e=>{console.log("Found selected Storey URI: "+e.subject.value),t.push(e.subject.value)})}else{let t=c["a"].state.rs.rdfStore.match(null,d["c"].RDFS("label"),Vr.literal(e,"en"));t.forEach(e=>{c["a"].state.rs.rdfStore.match(Vr.sym(e.subject.value),d["c"].TAG("tag"),null).forEach(e=>{console.log("Storey tag to remove: "+e.object.value),Dt["a"].unloadGeometryUsingTag(e.object.value,["FLOORPLAN"])})})}});let a="";t.forEach(e=>{c["a"].state.rs.rdfStore.match(Vr.sym(e),d["c"].TAG("tag"),null).forEach(e=>{console.log("Storey tag: "+e.object.value),a=e.object.value,a=a.replace(".FLOY_O",""),a=a.replace(".FLOY_S",""),c["a"].state.bv.gltfGeoVisible&&Dt["a"].loadGeometryUsingTag(a,this.$route.query.location,["FLOORPLAN"])})}),console.log("StoreyTAG:"+a);await Fe["a"].searchAndGetURIs("#"+a+"*");console.log(),c["a"].state.rs.rdfStore.match(null,d["c"].RDFS("label"),null).forEach(e=>{e.object.value.includes("Room")&&(console.log("Found room: "+e.subject.value),this.selectedRoomURIs.includes(e.subject.value)||this.selectedRoomURIs.push(e.subject.value))});for(let o=0;o<this.selectedRoomURIs.length;o++){await re["a"].fetchAndSaveTurtle(this.selectedRoomURIs[o]).then(e=>(console.log("Finished doing room fetch!"),e))}}},mounted(){this.checklogin(),console.log(c["a"].state.webId),this.getHospitalFunctions(),this.getRHFDataFromTrinity()},created(){c["a"].state.bv.twodim=!0}},qr=Hr,Yr=(a("51a2"),Object(A["a"])(qr,Mr,Br,!1,null,"3df10dd4",null)),Kr=Yr.exports;x()(Yr,{VBtn:_["a"],VCheckbox:ge["a"],VForm:Ie["a"],VIcon:Se["a"],VSelect:Ae["a"],VSheet:Ee["a"],VSwitch:Go["a"],VTextField:xe["a"],VTreeview:_e["a"]});var Xr={name:"RentModuleV",components:{RentModule:Kr,BIMviewer:vt["a"]}},Zr=Xr,Jr=(a("100f"),Object(A["a"])(Zr,kr,Ur,!1,null,"5bd0ca6e",null)),$r=Jr.exports;o["default"].use(s["a"]);const Qr=[{path:"/",name:"Login",component:D},{path:"/logout",name:"Logout",component:X},{path:"/about",name:"About",component:ee},{path:"/importdata",name:"ImportData",component:pt,props:!0},{path:"/bimviewer",name:"BIMviewer",component:St},{path:"/bmviewer",name:"BMviewer",component:Yt},{path:"/assetslist",name:"AssetsList",component:ia},{path:"/fileslib",name:"FilesLib",component:Wa},{path:"/podselect",name:"PodSelect",component:fo},{path:"/fileedit",name:"FileEdit",component:Fo},{path:"/search",name:"Search",component:Ko},{path:"/capacity",name:"Capacity",component:ga,props:!0},{path:"/importifc",name:"ImportIFC",component:ls,props:!0},{path:"/pdfviewer",name:"PDFviewer",component:Rs},{path:"/worklist",name:"WorkList",component:Qs},{path:"/ifcexporter",name:"IFCexporter",component:Dr},{path:"/rentmodule",name:"RentModule",component:$r}],en=new s["a"]({mode:"history",base:"/",routes:Qr});var tn=t["a"]=en},a39f:function(e,t,a){"use strict";a("c9f7")},a6fa:function(e,t,a){},a8b5:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-card",[o("v-toolbar",{attrs:{dark:"",color:"primary"}},[o("v-btn",{attrs:{icon:"",dark:""},on:{click:e.closeview}},[o("v-icon",[e._v("mdi-close")])],1),o("v-toolbar-title",[e._v(e._s(e.$t("text_room_details")))]),o("v-spacer"),o("v-toolbar-items",[o("v-btn",{attrs:{dark:"",text:""},on:{click:e.getRoomDetails}},[e._v(" Reload ")])],1)],1),o("v-container",{staticStyle:{"align-items":"left","background-color":"white",border:"0px",margin:"0px"},attrs:{fluid:""}},[o("v-row",{attrs:{"no-gutters":""}},[o("v-card",{staticClass:"pa-2",staticStyle:{"margin-bottom":"10px","margin-right":"10px"}},[o("v-list-item",{attrs:{"three-line":""}},[o("v-list-item-content",{staticStyle:{"max-width":"350px"}},[o("v-list-item-title",{staticClass:"roomtitle",domProps:{textContent:e._s(e.roomName)}}),o("v-list-item-subtitle",{staticClass:"roomuri",domProps:{textContent:e._s(e.roomURI)}}),o("v-simple-table",{staticClass:"simpletable",attrs:{dense:""},scopedSlots:e._u([{key:"default",fn:function(){return[o("tbody",[o("tr",[o("td",[o("b",[e._v("Navn:")])]),o("td",[e._v(e._s(e.roomName))])]),o("tr",[o("td",[o("b",[e._v("RomNr:")])]),o("td",[e._v(e._s(e.roomNum))])]),o("tr",[o("td",[o("b",[e._v("Bygg:")])]),o("td",[e._v(e._s(e.building))])]),o("tr",[o("td",[o("b",[e._v("Etasje:")])]),o("td",[e._v(e._s(e.storey))])]),o("tr",[o("td",[o("b",[e._v("Hovedfunksjon:")])]),o("td",[e._v(e._s(e.mainfunction))])]),o("tr",[o("td",[o("b",[e._v("Delfunksjon:")])]),o("td",[e._v(e._s(e.partfunction))])]),o("tr",[o("td",[o("b",[e._v("Type:")])]),o("td",[e._v(e._s(e.renttype))])]),o("tr",[o("td",[o("b",[e._v("Utleieareal:")])]),o("td",[e._v(e._s(e.rentarea+" ㎡"))])]),o("tr",[o("td",[o("b",[e._v("Fri Andel:")])]),o("td",[e._v(e._s(e.freesharepercent+" %"))])])])]},proxy:!0}])})],1),o("v-list-item-avatar",{attrs:{tile:"",size:"100"}},[o("img",{attrs:{src:a("6d2a")}})])],1)],1),o("v-card",{staticClass:"pa-2",staticStyle:{"margin-bottom":"10px","margin-right":"0px"}},[e._v(" Fordeling av kontrakter"),o("br"),o("Pie",{attrs:{"chart-options":e.chartOptions,"chart-data":e.chartData,"chart-id":e.chartId,"dataset-id-key":e.datasetIdKey,plugins:e.plugins,"css-classes":e.cssClasses,styles:e.styles,width:e.width,height:e.height}})],1),o("v-card",{staticClass:"pa-2",staticStyle:{"margin-bottom":"10px","margin-right":"10px"}},[o("v-list-item",{attrs:{"three-line":""}},[o("v-list-item-content",{staticStyle:{"max-width":"350px"}},[o("v-list-item-title",{staticClass:"roomtitle",domProps:{textContent:e._s(e.$t("text_room_geometry"))}}),o("v-simple-table",{staticClass:"simpletable",attrs:{dense:""},scopedSlots:e._u([{key:"default",fn:function(){return[o("tbody",[o("tr",[o("td",[o("b",[e._v(e._s(e.$t("text_netarea")))])]),o("td",[e._v(e._s(e.netarea))])]),o("tr",[o("td",[o("b",[e._v(e._s(e.$t("text_netarea_calculated")))])]),o("td",[e._v(e._s(e.netareacalculated))])]),o("tr",[o("td",[o("b",[e._v(e._s(e.$t("text_grossarea")))])]),o("td",[e._v(e._s(e.grossarea))])]),o("tr",[o("td",[o("b",[e._v(e._s(e.$t("text_doors")))])]),o("td",[e._v(e._s(e.doors))])])])]},proxy:!0}])})],1),o("v-list-item-avatar",{attrs:{tile:"",size:"100"}},[o("img",{attrs:{src:a("2ae3")}})])],1)],1)],1)],1),o("div",{staticClass:"inputwrapper"},[o("h2",[e._v(e._s(e.$t("text_contracts")))]),o("hr",{staticClass:"hr1"}),o("br"),o("v-card",[o("v-card-title",[o("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"","hide-details":""},model:{value:e.contractSearch,callback:function(t){e.contractSearch=t},expression:"contractSearch"}})],1),o("v-data-table",{staticClass:"elevation-0",attrs:{headers:e.contractTableHeaders,items:e.contractTableList,search:e.contractSearch,flat:"","item-key":"contractid","show-select":""},model:{value:e.contractTableSelectedRow,callback:function(t){e.contractTableSelectedRow=t},expression:"contractTableSelectedRow"}})],1)],1)],1)},s=[],r=a("4360"),n=(a("a18c"),a("fb26")),i=a("575c"),l=a("b33c"),c=a("706e"),d=a("d8d8"),u=a("7fff"),h=a("7b97"),g=a("dd61");const m=a("dae0"),p=(new m.Store,a("592d"));a("c8c8");const f={};g["e"].register(g["m"],g["n"],g["g"],g["a"],g["d"]);var b={id:f,name:"RoomDetails",props:{chartId:{type:String,default:"pie-chart"},datasetIdKey:{type:String,default:"label"},width:{type:Number,default:460},height:{type:Number,default:310},cssClasses:{default:"",type:String},styles:{type:Object,default:()=>{}},plugins:{type:Array,default:()=>[]}},data(){return{documenturl:"",roomURI:"",roomName:"",roomNum:"",building:"",storey:"",mainfunction:"",partfunction:"",renttype:"",rentarea:"",freesharepercent:"",contractSearch:"",netarea:"",netareacalculated:"",grossarea:"",doors:"",contractTableHeaders:[{text:"#",align:"start",filterable:!1,value:"contractid"},{text:this.$t("text_owner"),value:"owner"},{text:this.$t("text_contract_nr"),value:"contractnr"},{text:this.$t("text_contract_type"),value:"type"},{text:this.$t("text_contractor"),value:"contractor"},{text:this.$t("text_from"),value:"from"},{text:this.$t("text_to"),value:"to"},{text:this.$t("text_rented_area"),value:"area"},{text:this.$t("text_share"),value:"share"}],contractTableList:[{contractid:1,owner:"Helgelandssykehuset HF",contractnr:"2016001",type:"Standard",contractor:"Bildediagnostikk",from:"4/1/2022",to:"",area:"0.87 m2",share:12},{contractid:2,owner:"Helgelandssykehuset HF",contractnr:"2016002",type:"Standard",contractor:"Medisinsk klinikk",from:"4/1/2022",to:"",area:"0.87 m2",share:12},{contractid:3,owner:"Helgelandssykehuset HF",contractnr:"2016003",type:"Standard",contractor:"ØNH-, kjeve og øyesykdommer",from:"4/1/2022",to:"",area:"0.87 m2",share:12},{contractid:4,owner:"Helgelandssykehuset HF",contractnr:"2016004",type:"Standard",contractor:"Nevroklinikken",from:"4/1/2022",to:"",area:"0.3 m2",share:12,color:"B"},{contractid:5,owner:"Helgelandssykehuset HF",contractnr:"2016005",type:"Standard",contractor:"Kliniske servicefunksjoner",from:"4/1/2022",to:"",area:"0.87 m2",share:12},{contractid:6,owner:"Helgelandssykehuset HF",contractnr:"2016006",type:"Standard",contractor:"Fysikalsk medisin og rehab.",from:"4/1/2022",to:"",area:"0.87 m2",share:12},{contractid:7,owner:"Helgelandssykehuset HF",contractnr:"2016007",type:"Standard",contractor:"Mat og Cafe",from:"4/1/2022",to:"",area:"0.87 m2",share:4.5},{contractid:8,owner:"Helgelandssykehuset HF",contractnr:"2016008",type:"Standard",contractor:"Klinikk for anestesi og intensivmedisin",from:"4/1/2022",to:"",area:"0.87 m2",share:12}],contractTableSelectedRow:[],colorSet:["#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080"],chartData:{labels:["Half","And"],datasets:[{backgroundColor:["#3cb44b","#ffe119"],data:[50,50]}]},chartOptions:{responsive:!1,maintainAspectRatio:!0}}},components:{Pie:h["a"]},methods:{closeview(){console.log("Close view"),r["a"].state.cp.roomDetailURI=""},async getRoomDetails(){console.log("roomDetailURI: "+r["a"].state.cp.roomDetailURI),this.roomURI=r["a"].state.cp.roomDetailURI;let e="";r["a"].state.rs.rdfStore.match(p.sym(this.roomURI),n["c"].TAG("tag"),null).forEach(t=>{e=t.object.value}),r["a"].state.rs.rdfStore.match(p.sym(this.roomURI),n["c"].RDFS("label"),null).forEach(e=>{this.roomName=l["a"].decodeCharacters(e.object.value)}),this.roomNum=this.roomName.replace("Rom ","").replace("Room ",""),r["a"].state.rs.rdfStore.match(null,n["c"].DUL("hasPart"),p.sym(this.roomURI)).forEach(e=>{r["a"].state.rs.rdfStore.match(p.sym(e.subject.value),n["c"].RDF("type"),n["c"].BOT("Storey")).length>=0&&r["a"].state.rs.rdfStore.match(p.sym(e.subject.value),n["c"].RDFS("label"),null).forEach(e=>{this.storey=e.object})});let t=r["a"].state.rs.rdfStore.match(p.sym(this.roomURI),n["c"].NEO("b_capable"),null);for(let i=0;i<t.length;i++){await c["a"].fetchAndSaveTurtle(t[i].object.value,!0).then(e=>e);r["a"].state.rs.rdfStore.match(p.sym(t[i].object.value),n["c"].RDFS("label"),null).forEach(e=>{this.partfunction=e.object.value.replace("Delfunksjon: ","")}),r["a"].state.rs.rdfStore.match(p.sym(t[i].object.value),n["c"].NEO("t_genus"),null).forEach(e=>{r["a"].state.rs.rdfStore.match(p.sym(e.object.value),n["c"].RDFS("label"),null).forEach(e=>{this.mainfunction=e.object.value.replace("Hovedfunksjon: ","")})})}let a=i["a"].removeCharactersAfter(this.roomURI,"/node")+"/i";r["a"].state.rs.rdfStore.match(p.sym(a),n["c"].FOAF("name"),null).forEach(e=>{this.building=e.object.value});let o="";o=e.replace("."+i["a"].getCharactersAfter(e,"."),"");o.replace("."+i["a"].getCharactersAfter(o,"."),"");const s=i["a"].getCharactersAfter(o,".");this.storey=s.replace("E",""),r["a"].state.rs.rdfStore.match(null,n["c"].SIO("SIO_000202"),p.sym(this.roomURI)).forEach(e=>{r["a"].state.rs.rdfStore.match(p.sym(e.subject.value),n["c"].RDF("type"),n["c"].BOT("Storey"))>0&&r["a"].state.rs.rdfStore.match(p.sym(e.subject.value),n["c"].RDFS("label"),null).forEach(e=>{this.storey=e.object.value})}),r["a"].state.rs.rdfStore.match(p.sym(this.roomURI),n["c"].IFOUR("m_polyline"),null).forEach(e=>{const t=e.object.value,a=d["a"].trinagulateAndCalculateArea(t);this.netareacalculated=""+a}),this.netarea="0",r["a"].state.rs.rdfStore.match(p.sym(this.roomURI),n["c"].NEO("m_area-net"),null).forEach(e=>{this.netarea=e.object.value}),this.grossarea="0",r["a"].state.rs.rdfStore.match(p.sym(this.roomURI),n["c"].NEO("m_area-gross"),null).forEach(e=>{this.grossarea=e.object.value}),console.log("Found in Json:"),u["a"].clearContainValues();let h=u["a"].ContainsKeyValue(r["a"].state.bv.IFCPropertyJson,"expressID",814526);console.log(h),this.renttype="Leie plass",this.rentarea=6.73,this.setSharePercentage(),this.setDiagramValues()},setSharePercentage(){let e=0;this.contractTableList.forEach((t,a)=>{"Ingen"==t.owner?this.contractTableList.splice(a,1):(t.area=(this.rentarea*t.share/100).toFixed(2),e+=t.share)}),this.freesharepercent=(100-e).toFixed(1),this.contractTableList.push({contractid:0,owner:"Ingen",contractnr:"",type:"",contractor:"Ikke utleid",from:"",to:"",area:(this.rentarea*this.freesharepercent/100).toFixed(2),share:this.freesharepercent,color:"B"})},setDiagramValues(){this.chartData.labels=[],this.chartData.datasets[0].data=[],this.chartData.datasets[0].backgroundColor=[],this.contractTableList.forEach((e,t)=>{this.chartData.labels.push(e.contractor),this.chartData.datasets[0].data.push(e.area),"Ingen"==e.owner?this.chartData.datasets[0].backgroundColor.push("#ffffff"):this.chartData.datasets[0].backgroundColor.push(this.colorSet[t])})},reloadview(){this.getRoomDetails()}},computed:{},watch:{"$store.state.cp.roomDetailURI":function(e){this.reloadview()}},mounted(){this.documenturl=this.$route.query.select,this.$route.query.location||this.$router.push({path:this.$route.path,query:{select:this.documenturl}}),this.getRoomDetails(),this.setSharePercentage(),this.setDiagramValues()},created(){}},v=b,y=(a("4e67"),a("2877")),w=a("6544"),I=a.n(w),S=a("8336"),R=a("b0af"),A=a("99d9"),E=a("a523"),x=a("8fea"),_=a("132d"),j=a("da13"),T=a("8270"),F=a("5d23"),O=a("0fd9"),C=a("1f4f"),N=a("2fa4"),L=a("8654"),P=a("71d9"),D=a("2a7f"),k=Object(y["a"])(v,o,s,!1,null,"b949ee44",null);t["a"]=k.exports;I()(k,{VBtn:S["a"],VCard:R["a"],VCardTitle:A["d"],VContainer:E["a"],VDataTable:x["a"],VIcon:_["a"],VListItem:j["a"],VListItemAvatar:T["a"],VListItemContent:F["a"],VListItemSubtitle:F["b"],VListItemTitle:F["c"],VRow:O["a"],VSimpleTable:C["a"],VSpacer:N["a"],VTextField:L["a"],VToolbar:P["a"],VToolbarItems:D["a"],VToolbarTitle:D["b"]})},aa01:function(e,t,a){},afe7:function(e,t,a){},b2d7:function(e,t,a){e.exports=a.p+"img/door.6bfd6c28.png"},b33c:function(e,t,a){"use strict";var o=a("93ef"),s=a("a026"),r=a("4360"),n=a("7909"),i=a("5a89");const l=a("1157"),c=a("dae0"),d=a("6d6b"),u=a("592d"),h=a("4e14"),g={unique:function(e){if(Array.isArray(e))return e.filter((function(e){return!this[e]&&(this[e]=!0)}),{})},getBlankNode:function(e){let t="";return r["a"].state.rs.bIndex.forEach((a,o)=>{a.label==e&&(t=a.blank,r["a"].state.blankExisted=!0)}),""==t&&(r["a"].commit("blankNodeIncrement"),t=u.sym(r["a"].state.blankNodeString),r["a"].state.rs.bIndex.push({label:e,blank:t}),r["a"].state.blankExisted=!1),t},prettyTAG:function(e){let t=e.replaceAll(" ","");return t=t.replaceAll("Æ","AE"),t=t.replaceAll("Ø","O"),t=t.replaceAll("Å","AA"),t=t.replaceAll("æ","ae"),t=t.replaceAll("ø","o"),t=t.replaceAll("å","aa"),t},decodeCharacters:function(e){e=decodeURIComponent(e);var t=/\\u([\d\w]{4})/gi;return e+="".replace(t,(function(e,t){return String.fromCharCode(parseInt(t,16))})),e=Object(n["a"])(e),e},hexToString:function(e){var t=/\\X2\\([\d\w]{2,4})\\X0\\/gi;return e+="".replace(t,(function(e,t){return String.fromCharCode(parseInt(t,16))})),e=Object(n["a"])(e),e},formatString:function(e){return e=g.hexToString(e),e=g.decodeCharacters(e),e+="".replace(" ",""),e},storeToTurtle:function(e,t){var a;return u.serialize(void 0,e,t,"text/turtle",(function(e,t){console.log("Turtle serialize error: ",e),a=t})),a},pointStringToVector3:function(e){let t=e.split(" ");for(let a=0;a<=2;a++)t[a]=t[a].replace("(",""),t[a]=t[a].replace(")","");return new i["uc"](parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]))},deNullify:function(e){if(Array.isArray(e))return e.filter(e=>null!=e)},ajaxError:function(e,t,a,o,s,r){log.error("ERROR lobe.Ajax",{jqXHR:t,textStatus:a,errorThrown:o,url:e,data:JSON.stringify(s),callback:JSON.stringify(r)}),alert("Internal error - please request help from graphMetrix admin (or see developer console).\nError: "+o+"\nStatus: "+a+"\nURL: "+e)},ajax:function(e,t,a,o,s,r,n){var i;a||(a="POST"),r||(r=!1),o||(o="json"),i="boolean"!==typeof n||n,l.ajaxSetup({async:i}),l.ajax({type:a,url:e,data:s,async:i,cache:r,success:function(e){t(e)},error:function(a,o,r){g.ajaxError(e,a,o,r,s,t)},dataType:o})},isTrinPod:function(){var e=r["a"].state.xPoweredBy;return!(!e||!e.match("TrinPod"))},setProp:function(e,t,a){const o=t.shift();e[o]||s["default"].set(e,o,{}),t.length?g.setProp(e[o],t,a):a&&"object"===typeof a&&!Array.isArray(a)?e[o]={...e[o],...a}:e[o]=a},statementP:function(e){return"object"===l.type(e)&&!!(e.subject&&e.predicate&&e.object)},termP:function(e){return"object"===l.type(e)&&"NamedNode"===e.termType},getURL:function(e){var t;return"object"===l.type(e)&&(t="NamedNode"===e.termType?e.value:e.uri),t||"string"!==l.type(e)||(t=e),t?g.checkURL(t)?e:g.checkIRI(t)?e.substr(1,e.length-2):null:null},gmxSolidP:function(e){var t=g.getURL(e);return!(!t||!t.match(r["a"].state.brain+"/ns/"))},removeURIfragment:function(e){e=g.getURI(e);if("string"===l.type(e)){var t=h.parse(e);return t=g.deleteKeys(t,"fragment"),h.serialize(t)}},uriToNamedNode:function(e){if(e=g.getURI(e),e)return c.termFromId(g.getURI(e))},getBaseURI:function(e){return g.getPodNode(e)},getURI:function(e){if("array"===l.type(e))return 0===e.length?void 0:l.map(e,(function(e){return g.getURL(e)}));if(g.isTreeNode(e))return e.data.uri;if("object"===l.type(e)){if("NamedNode"===e.termType)return e.value;if("BlankNode"===e.termType)return e}else{if(!g.gmxSolidP(e))return"string"===typeof e&&(e=e.replace("<","").replace(">","")),g.getURL(e);var t=e.replace(r["a"].state.brain+"/ns/",""),a=t.split("/");if("array"===l.type(a)){var o=a[0],s=decodeURIComponent(a[1]);return ns[o](s).uri}}},getURIs:function(e){if("array"===l.type(e))return l.map(e,(function(e){return g.getURI(e)}))},getSolidHost:function(e){e||(e=r["a"].state.server);e=g.getURI(e);if(e){var t=h.parse(e),a=t.port,o=t.host;return o.match("localhost")?o+":"+a:o}},getIRI:function(e){return g.checkIRI(e)?e:g.checkURL(e)?(e.indexOf("?")>-1&&(e=e.split("?")[0]),"<"+e+">"):null},checkIRI:function(e){return"string"===l.type(e)&&(0==e.indexOf("<http")&&e.indexOf(">")>-1&&-1==e.indexOf("?"))},checkURL:function(e){let t;try{return t=new URL(e),!0}catch(a){return!1}},deparam:function(e){e||(e=window.location.href),e=e.substring(e.indexOf("?")+1).split("&");for(var t,a={},o=decodeURIComponent,s=e.length-1;s>=0;s--)t=e[s].split("="),a[o(t[0])]=o(t[1]||"");return a},deleteKeys:function(e,t){if(e){var a=g.getEObj(e);return t?"array"!==l.type(t)&&(t=[t]):t=Object.keys(a),l.map(t,(function(e){delete a[e]})),a}},removeItem:function(e,t){return t=l.grep(t,(function(t){return t!=e})),t},addQuery:function(e,t,a){if(e&&t){a||(a=g.deparam());var o=g.getEObj(a);return o[e]=t,o}},checkQuery:function(e,t,a){a||(a=g.deparam());var o=Object.keys(a);return log.debug("query",a,e,a[e]),a[e]===t||!l.inArray(e,o)},queryFocus:function(e,t,a,o){o||(o=g.deparam());var s=g.deleteKeys(o,a);return s=g.addQuery(e,t,s),s},getEObj:function(e){return e||(e=g.deparam()),Object.assign({},e)},toggleMode:function(e,t,a){if(e&&t&&a){var o=g.getEObj(a);return o[e]?g.deleteKeys(o,e):(o[e]=t,o)}},select:function(e,t){return g.toggleMode("select",e,t)},checkEmail:function(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},getReload:function(e){var t=JSON.parse(JSON.stringify(e)),a=t.reload;return a="true"===a?"false":"true",t.reload=a,t},getIntersection:function(e,t){return"array"===l.type(e)&&"array"===l.type(t)?e.filter(e=>-1!==t.indexOf(e)):"array"===l.type(e)?e:"array"===l.type(t)?t:void 0},getUnion:function(e,t){return"array"===l.type(e)&&"array"===l.type(t)?e.concat(t):"array"===l.type(e)?e:"array"===l.type(t)?t:void 0},getDifference:function(e,t){if(Array.isArray(e)&&Array.isArray(t)){var a=[];return e.forEach(e=>{t.includes(e)||a.push(e)}),t.forEach(t=>{e.includes(t)||a.push(t)}),a}},dynamicSort:function(e){var t=1;return"-"===e[0]&&(t=-1,e=e.substr(1)),function(a,o){var s=a[e].toLowerCase()<o[e].toLowerCase()?-1:a[e].toLowerCase()>o[e].toLowerCase()?1:0;return s*t}},functionSort:function(e,t){return t||(t=1),"-"===t&&(t=-1),function(a,o){var s=e(a)<e(o)?-1:e(a)>e(o)?1:0;return s*t}},areObjsEquiv:function(e,t){var a=Object.getOwnPropertyNames(e),o=Object.getOwnPropertyNames(t);if(a.length!=o.length)return!1;for(var s=0;s<a.length;s++){var r=a[s];if(e[r]!==t[r])return!1}return!0},areArraysEqual:function(e,t){return JSON.stringify(e)==JSON.stringify(t)}},m=(e,t)=>"number"==typeof e&&"number"==typeof t&&""+e=="NaN"&&""+t=="NaN"||e===t;g.deepEquals=function(e,t,a=m,o=m){if(e instanceof Array&&t instanceof Array)return g.arraysEqual(e,t,a);if(e&&t&&Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(t)===Object.prototype)return g.objectsEqual(e,t,a);if(e instanceof Map&&t instanceof Map)return g.mapsEqual(e,t,a);if(e instanceof Set&&t instanceof Set){if(o===m)return g.setsEqual(e,t);throw"Error: set equality by hashing not implemented because cannot guarantee custom notion of equality is transitive without programmer intervention."}return(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(t instanceof ArrayBuffer||ArrayBuffer.isView(t))?typedArraysEqual(e,t):a(e,t)},g.arraysEqual=function(e,t,a){if(e.length!=t.length)return!1;for(var o=0;o<e.length;o++)if(!g.deepEquals(e[o],t[o],a))return!1;return!0},g.objectsEqual=function(e,t,a){var o=Object.getOwnPropertyNames(e),s=Object.getOwnPropertyNames(t);if(o.length!=s.length)return!1;o.sort(),s.sort();for(var r=0;r<o.length;r++)if(!a(o[r],s[r]))return!1;return g.deepEquals(o.map(t=>e[t]),o.map(e=>t[e]),a)},g.mapsEqual=function(e,t,a){return e.size==t.size&&[...e.keys()].every(o=>t.has(o)&&g.deepEquals(e.get(o),t.get(o),a))},g.setsEqual=function(e,t){return e.size==t.size&&[...e.keys()].every(e=>t.has(e))},g.typedArraysEqual=function(e,t){if(e=new Uint8Array(e),t=new Uint8Array(t),e.length!=t.length)return!1;for(var a=0;a<e.length;a++)if(e[a]!=t[a])return!1;return!0},g.arrayGroups=function(e,t,a){a||(a={});var o=Math.ceil(e.length/t),s=t*o;log.debug("arrayGroups - n, row,length",t,o,s);for(var r=[],n=0;n<o;n+=1){for(var i=[],l=0;l<t;l+=1){var c=e.slice(n*t+l,n*t+l+1);log.debug("col arrayGroups",i,c,n,l),i=c.length>0?i.concat(c):i.concat([a])}r.push(i),log.debug("row arrayGroups",i)}return r},g.getHash=function(){return window.location.hash.split("?")[0].substr(1)},g.getNode=function(){return decodeURIComponent(g.getHash().substr(1))},g.getParameterByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",a=new RegExp(t),o=a.exec(window.location.search);return null===o?null:decodeURIComponent(o[1])},g.appWindowWidthCalc=function(e,t,a){var o=0,s=0,n=t;e.settings?o=330:("default"===e.navigator||"search"===e.navigator||e.connections)&&(o=720),e.properties&&(s=500),n=n-s-o,r["a"].commit("leftMenuWidth",o),r["a"].commit("rightMenuWidth",s),r["a"].commit("appWindowWidth",n),r["a"].commit("appWindowHeight",a)},g.getSubdomain=function(e){e||(e=router.currentRoute.query.location);try{const t=new URL(e),a=t.hostname.split(".");if(a.length>1)return a[0]}catch(t){log.error(t)}},g.getPodNode=function(e){e=g.getURI(e),e||(e=router.currentRoute.query.location);try{const t=new URL(e);return t.origin}catch(t){log.error(t)}},g.getPodServer=function(e){if(e=g.getURI(e),e){var t=g.getPodNode(e);if(t){var a=g.getSubdomain(t);if(a&&t.includes(a))return t.replace(a+".","")}}},g.getSubstance=function(e){var t=g.getPodNode(e);if(t)return t+"/node/Substance"},g.getCard=function(e){var t=g.getPodNode(e);if(t)return t+"/profile/card"},g.getHome=function(e){var t=g.getPodNode(e);if(t)return t+"/home/"},g.base64ToUint8Array=function(e){for(var t=e,a=new Uint8Array(t.length),o=0;o<t.length;o++)a[o]=t.charCodeAt(o);return a},g.blobToBase64=function(e){return new Promise((t,a)=>{const o=new FileReader;o.onloadend=()=>t(o.result),o.readAsDataURL(e)})},g.blobToUint8Array=async function(e){var t=await g.blobToBase64(e);if(t)return g.base64ToUint8Array(t)},g.getFile=async function(e){if(e){const t=await o["a"](e,{fetch:window.solid.session.fetch});return t}},g.getFileData=async function(e){var t=await g.getFile(e);log.debug(t);var a=await t.arrayBuffer(),o=await new Uint8Array(a);return o},g.getArrayBuffer=async function(e){var t=await g.getFile(e),a=await t.arrayBuffer();log.debug("buffer",a);for(var o=await window.atob(a),s=o.length,r=new Uint8Array(s),n=0;n<s;n++)r[n]=o.charCodeAt(n);return r.buffer},g.getId=function(e){var t=g.getURI(e),a=t.split("#");if(a.length>1)return a=a.reverse(),a[0];a=t.split("/");return a.length>1?(a=a.reverse(),""===a[0]&&a.shift(),decodeURIComponent(a[0])):decodeURIComponent(t)},g.isBlankNode=function(e){return"object"===l.type(e)&&"BlankNode"===e.termType},g.stringEscapeXml=function(e){var t="";if("string"===typeof e)return[...e].forEach(e=>{"&"===e?e="&amp;":"'"===e?e="&apos;":'"'===e?e="&quot;":"<"===e?e="&lt;":">"===e&&(e="&gt;"),t+=e}),t},g.areEqualObjects=(e,t)=>{let a=e=>Object.entries(e).sort().map(e=>(e[1]instanceof Object&&(e[1]=a(e[1])),e));return JSON.stringify(a(e))===JSON.stringify(a(t))},g.getClientID=function(){var e,t=window.localStorage;if("object"===l.type(t)){var a=Object.keys(window.localStorage);Array.isArray(a)&&a.some(a=>{if(a.search("solidClientAuthenticationUser:")>-1){var o=JSON.parse(t[a]);if(o.clientId)return e=o.clientId,e}})}return e},g.systemStart=function(){var e=s["default"].router.history.current.query;return"object"===l.type(e)&&0===Object.keys(e).length},g.cloneArray=function(e){if(Array.isArray(e))return e.map(e=>({...e}))},g.sanitize=function(e,t){var a=/[\/\?<>\\:\*\|"]/g,o=/[\x00-\x1f\x80-\x9f]/g,s=/^\.+$/,r=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,n=/[\. ]+$/;if("string"===typeof e){var i=e.replace(a,t).replace(o,t).replace(s,t).replace(r,t).replace(n,t);return d(i,255)}log.error("Input must be string")},g.sanitizeFilename=function(e,t){var a,o=t&&t.replacement||"",s=g.sanitize(e,o);if(a=""===o?s:g.sanitize(s,""),"string"===typeof a)return encodeURIComponent(a)},g.isTree=function(e){return"object"===l.type(e)&&"number"===typeof e.edgeSize},g.isTreeNode=function(e){return!("object"!==l.type(e)||!e.data||!e.data.uri)},g.isRdfNode=function(e){return!("object"!==l.type(e)||!e.termType||"NamedNode"!==e.termType)},g.findTreeNode=function(e,t){var a;e=g.getURI(e);return e&&g.isTree(t)&&t.traverse(t=>{if(t.data.uri===e)return a=t,!0}),a},t["a"]=g},b418:function(e,t,a){"use strict";a("11c1");var o=a("4360"),s=a("fb26"),r=(a("706e"),a("b33c")),n=(a("9b92"),a("4e8a")),i=a.n(n);const l={},c=a("592d"),{Node:d,shortest:u,neighbors:h}=a("2f2f"),g={...a("9b92"),...a("d0b4")};let m=g.dataset();const p=[];t["a"]={wf:l,name:"Wayfinder",data(){return{}},methods:{populateWayRdfStore(){console.log("Populating way RDF Store");const e=[];o["a"].state.rs.rdfStore.match(null,s["c"].NEO("m_join"),null).forEach(t=>{e.includes(t.subject.value)||e.push(t.subject.value),e.includes(t.object.value)||e.push(t.object.value)}),o["a"].state.rs.rdfStore.match(null,s["c"].NEO("m_port"),null).forEach(t=>{e.includes(t.subject.value)||e.push(t.subject.value)}),o["a"].state.rs.rdfStore.match(null,s["c"].IFOUR("islocked"),null).forEach(e=>{m.add(g.quad(g.namedNode(e.subject.value),g.namedNode(e.predicate.value),g.namedNode(e.object.value),g.defaultGraph()))}),e.forEach(e=>{o["a"].state.rs.rdfStore.match(c.sym(e),s["c"].NEO("m_port"),null).forEach(e=>{o["a"].state.rs.rdfStore.match(c.sym(e.object.value),s["c"].RDFS("label"),null)[0].object.value.includes("Outdoor")||m.add(g.quad(g.namedNode(e.subject.value),g.namedNode(e.predicate.value),g.namedNode(e.object.value),g.defaultGraph()))}),o["a"].state.rs.rdfStore.match(c.sym(e),s["c"].NEO("m_join"),null).forEach(e=>{m.add(g.quad(g.namedNode(e.subject.value),g.namedNode(e.predicate.value),g.namedNode(e.object.value),g.defaultGraph()))}),o["a"].state.rs.rdfStore.match(null,s["c"].NEO("m_join"),c.sym(e)).forEach(e=>{m.add(g.quad(g.namedNode(e.subject.value),g.namedNode(e.predicate.value),g.namedNode(e.object.value),g.defaultGraph()))})}),o["a"].state.rs.rdfStore.match(null,s["c"].RDF("type"),s["c"].SEAS("Elevator")).forEach(e=>{console.log("Avvoiding elevator."),p.push(g.namedNode(e.subject.value))})},wayBetweenRooms(e,t,a,r,n=[],l=!0){const h=performance.now();let f=[],b="",v="";o["a"].state.rs.rdfStore.match(null,s["c"].RDFS("label"),c.literal("Room "+e,"en")).forEach(e=>{b=e.subject.value,l&&console.log("RoomID1:",b)}),o["a"].state.rs.rdfStore.match(null,s["c"].RDFS("label"),e).forEach(e=>{b=e.subject.value,l&&console.log("RoomID1:",b)}),o["a"].state.rs.rdfStore.match(null,s["c"].RDFS("label"),c.literal("Room "+t,"en")).forEach(e=>{v=e.subject.value,l&&console.log("RoomID2:",v)}),o["a"].state.rs.rdfStore.match(null,s["c"].RDFS("label"),t).forEach(e=>{v=e.subject.value,l&&console.log("RoomID2:",v)}),0==m._size&&this.populateWayRdfStore();const y=new d({dataset:m,term:g.namedNode(b)}),w=new d({dataset:m,term:g.namedNode(v)}),I=this.blackListAllExeptNearestStairs(b,v),S=[];n.forEach(e=>{S.push(g.namedNode(e))});const R=new i.a(S),A=new i.a(I.concat(p).concat(S));let E=u(y,w,{dirIn:!0,followLiterals:!0,nodeBlacklist:A});const x=new i.a(p.concat(S));E||(E=u(y,w,{dirIn:!0,followLiterals:!0,nodeBlacklist:x})),E||(E=u(y,w,{dirIn:!0,followLiterals:!0,nodeBlacklist:R}));let _=[];if(E){l&&console.log("Path found: "),l&&console.log(E),l&&console.log(E.toString());for(let e=0;e<E.edges.length;e++)_.includes(E.edges[e].quad.subject.value)||_.push(E.edges[e].quad.subject.value),_.includes(E.edges[e].quad.object.value)||_.push(E.edges[e].quad.object.value)}if(l&&console.log("Foundway"),l&&console.log(_),f.push({way:_,priority:0}),l){const e=[];f.forEach(t=>{const a=[];t.way.forEach(e=>{a.push(o["a"].state.rs.rdfStore.match(c.sym(e),s["c"].RDFS("label"),null)[0].object.value)}),e.push(a)}),l&&console.log(e)}const j=[];f.forEach(e=>{j.includes(e)||j.push(e)});const T=performance.now();return l&&console.log(`Wayfinding used: ${T-h} milliseconds`),j[0]?j[0].way:(console.log("Warning: Did not find any Way.."),[])},blackListAllExeptNearestStairs(e,t){const a=[];let n=0;o["a"].state.rs.rdfStore.match(c.sym(e),s["c"].IFOUR("roomhag"),null).forEach(e=>{n=Number(e.object.value)});let i=0;if(o["a"].state.rs.rdfStore.match(c.sym(t),s["c"].IFOUR("roomhag"),null).forEach(e=>{i=Number(e.object.value)}),n==i)return[];let l=void 0,d=5e3,u=void 0;if(o["a"].state.rs.rdfStore.match(c.sym(e),s["c"].SIO("SIO_000507"),null)[0]){const t=o["a"].state.rs.rdfStore.match(c.sym(e),s["c"].SIO("SIO_000507"),null)[0].object.value;u=r["a"].pointStringToVector3(t)}return u?(o["a"].state.rs.rdfStore.match(null,s["c"].RDF("type"),s["c"].SEAS("Stairs")).forEach(e=>{const t=e.subject.value;let a=void 0;if(o["a"].state.rs.rdfStore.match(c.sym(t),s["c"].SIO("SIO_000507"),null)[0]){const e=o["a"].state.rs.rdfStore.match(c.sym(t),s["c"].SIO("SIO_000507"),null)[0].object.value;a=r["a"].pointStringToVector3(e),u.distanceTo(a)<=d&&(d=u.distanceTo(a),l=t)}}),o["a"].state.rs.rdfStore.match(null,s["c"].RDF("type"),s["c"].SEAS("Stairs")).forEach(e=>{const t=e.subject.value;let r=void 0;o["a"].state.rs.rdfStore.match(c.sym(t),s["c"].IFOUR("roomhag"),null).forEach(e=>{r=Number(e.object.value)}),r&&n==r&&l!=t&&a.push(g.namedNode(t))}),a):[]}},watch:{}}},b6f0:function(e,t,a){"use strict";a("348e")},b737:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAACe0lEQVRYhe2XvU9aURiHf++FQSRFtKHXqi1tDDj2g4T+A4ImGCeZLGMZ2w60aWJJYGmadCEGQtK5E0sHBxMv6eQdakyapjAZi8TE1kU+ahQazn07VCiCltqLZai/6eS+b/I895xzT+4hZkYvY6wPiKitOD09fVUI8ZKZZwAM6WTtEdEbq9X6JJVKfW8TOAW+xsxjOsH1DDHzw0KhcAjgWUcBIcQiM49ZrdbNWCw2Pjo6qosejUa3V1dXrwF40FFgcnLSx8xzRHQQj8evyLKsC76xsfF1fX29PpPHllJqbfZ6vWYiSgDA/Pz8rizLl/TAhRAiHA5bJiYm2jfZSQKapkWY2W6z2b4EAoGbeuAAsLCwsG00GvudTueJ9WMCU1NTt4joMRFp0WhUlqQ2vzNFUZTP2Wz2htvtPrWnQYhEIpKmaa+Z2ejz+fYdDocuerFY3E8kEtddLhf6+vo6C6iqOsfM7oGBgYNgMGjRAweAUCh0ODw8bBwZGfltX+MrYOYgAJRKpf7Z2VldcLvdDiGEzeVydextPglvMzPC4TDMZvNfw/P5PJLJJPx+/x/1N5aAmS8D0AUHfr79WaJvm3chFwIXAhcC/49AtVoFABDRt54IZDKZtaOh+s8FdnZ2PuRyubtExET0qrl26k9pt1Iul/Oqqo4fsV4oivKuuX6uM1Cr1cqKogCABcDbdDr9vLXn3ASYWSwvL29qmmYH8NFkMt0H0HYNaxbYA4Ctra2uCCiK8qlSqdwhot1arTaztLR0cFIf1e+GHo8nBuBRV+i/UpYkybuysvK++WHzfbQxA4ODg0+JaBFAoQvgEoCUwWC41wpvDfX6dtzzo/gHscvnooL4LIYAAAAASUVORK5CYII="},b827:function(e,t,a){"use strict";var o=a("4360"),s=a("b33c");const r={},n=a("592d");r.searchAndGetURIs=async function(e){let t="https://helsenorge"+o["a"].state.testNum+"."+o["a"].state.serverPath+"/search/"+encodeURIComponent(e);try{let e=await window.solid.session.fetch(t,{method:"GET",credentials:"include",headers:{Accept:"text/turtle"}}).then(e=>e.text());return console.log(e),n.parse(e,o["a"].state.rs.rdfStore,t,"text/turtle"),e}catch(a){console.log(a),console.log("Search failed")}},r.uploadFile=async function(e,t){window.solid.session.fetch(t+e.name,{method:"PUT",credentials:"include",body:e,headers:{"Content-Type":""},onUploadProgress:function(e){this.uploadPercentage=parseInt(Math.round(e.loaded/e.total*100)),console.log(this.uploadPercentage)}.bind(this)}).then(e=>{console.log("done uploading",e)}).catch(e=>{console.error(JSON.stringify(e.message))})},r.populateStoreFromTurtle=async function(){console.log("Populating store from turtle...");let e=o["a"].state.location+"home/TTL/rooms.rtf";try{window.solid.session.fetch(e,{method:"GET",credentials:"include"}).then(t=>{t.arrayBuffer().then(t=>{let a=new Blob([t]);const r=new FileReader;r.onload=function(){n.parse(this.result,o["a"].state.rs.rdfStore,e,"text/turtle");s["a"].storeToTurtle(o["a"].state.rs.rdfStore,e)},r.readAsText(a)})})}catch(t){console.log(t),console.log("Failed to parse Turtle from file...")}},t["a"]=r},b91f:function(e,t,a){"use strict"},ba66:function(e,t,a){},bb5e:function(e,t,a){},bc83:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAeCAYAAABNChwpAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQklEQVRIie2Xv6vaUBTHv/caYzu4iEMfxUUXBUHo0L/ADMHFTV5Bi7RDF0sU54CDQxenQpdOcegPKO300CR/hbj4D5RHIQ4GAoKedOhL0fTGF0XeG/q+W+45N59zz8kJ5zLf93Gf4vdKfwgAgLT7wBjbM7bbbTiOA8/zwDmvM8beb7fbpydwrjnnr6bT6VXYEJmByWTyFw7gWSKR+HYiHACeENFHkUESLQLAaDQCESGXy104jmN5nsdVVUWv14tNnc1mGAwGWK1WAHAh8hFmoFargYjQ7/cfOY7zw/O8TKlUQqfTORqu6/pBP2EGZFnGer3GaDR6R0TPM5kMdF1HMpk8Gl6pVA76CjPgui5SqdRLInorSRJ0XUc2m40FXywWseGAIAO+70NRFMiy/GG9XmOz2UDTtFjwQPl8PhZcGEAg13UfA4BlWUfB5/M5ut1ubP9/SqCqKizLigzsNpXL5aP89wKoVqsgIgDYnhrAsdo7KeccRARVVRvBmqIodxfAzekbRPQJAJrNJlqtVuyXBe03HA5j7wl/A3XO+WciOhq+237FYjH2PrY7kDQaDX+5XMbevKtCoQBN04TwoIyWZbGwba8EAfzU1hPBDcP4A5KkX6K9Z5kHolrPMAyMx2MwxnwieiPyObnfb1MA55wDwAvTNL/fWQChk1/atv0lyvfsI9kunDF2EA6cOQOhtF+apnkQDoTaUFGUn4iYXOLq5m/asG37a9gmuoOES/AawPWp8HQ67RFRXQSPEnu4Gf33AfwGskMCD7S3+RMAAAAASUVORK5CYII="},bfe7:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAeCAYAAABNChwpAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAo0lEQVRIie2WUQ7AIAhDy7KjcWzv5n4XVwYSE5cMPg3YB1aj9N6xM46t6gVQAAXwBYCTLYoIAEBVH69Ua03GNZZn1YwPnzkBa1NPbLaGAngiKyFCHmBj9/KjR0U9MCv4BuJNiwLcI2rEbExfw5XiKQBV7RkTpgEsQ60K6oGxwyxAZFKuCaMbRfJZI/QIvI4zE7FqTA9YBSvFAUDqV1wABfB7gAveoFGpsjXCngAAAABJRU5ErkJggg=="},c233:function(e,t,a){"use strict";a("1dc8")},c296:function(e,t,a){e.exports=a.p+"img/position2.7ba517a9.png"},c57d:function(e,t,a){},c79f:function(e,t,a){"use strict";a("aa01")},c8c8:function(e,t,a){},c9f7:function(e,t,a){},cf05:function(e,t,a){e.exports=a.p+"img/logo.ee707e9b.png"},d0f8:function(e,t,a){},d8d8:function(e,t,a){"use strict";var o=a("34ad"),s=a("5a89"),r=a("4360"),n=a("706e"),i=a("575c"),l=a("0ee7"),c=a("faa9"),d=a("b33c"),u=a("fb26"),h=a("7fff"),g=a("a2ed"),m=a("aea1");a("1b6e"),a("edb8");const p={},f=a("592d");p.getEmployeeList=async function(e){return new Promise(async(t,a)=>{n["a"].fetchAndSaveTurtle(e,!0).then(a=>{console.log("Get employees from: "+e);let o=[],s=[],l=r["a"].state.rs.rdfStore.match(f.sym(e),u["c"].ORG("hasMember"),null);l.forEach(e=>{s.includes(e.object.value)||(console.log("Found employee.."),s.push(e.object.value))}),s.forEach((e,t)=>{o.push({filename:"pod",personuri:e,initials:"",name:e,color:i["a"].makeRandomColor()})}),o.forEach((e,a)=>{n["a"].fetchAndSaveTurtle(e.personuri,!0).then(s=>{try{let t=r["a"].state.rs.rdfStore.match(f.sym(e.personuri),u["c"].FOAF("name"),null)[0].object.value||"";e.name=t,console.log("Name: "+t),e.initials=i["a"].getInitials(t)}catch(n){console.log(n)}a===o.length-1&&(console.log("Returning list"),t(o))})})})})},p.sendEmailToResponsible=async function(e){console.log("Starting to send e-mail..."),n["a"].fetchAndSaveTurtle(e,!0).then(t=>{let a=r["a"].state.rs.rdfStore.match(f.sym(e),u["c"].VCARD("hasEmail"),null);if(a[0]){let e=a[0].object.value;console.log("Email: "+e)}})},p.getMeshHeightAboveGround=function(e){let t=1e3,a=-1e3;try{if(e.geometry)for(let o=1;o<=e.geometry.attributes.position.array.length;o+=3)t=Math.min(e.geometry.attributes.position.array[o],t),a=Math.max(e.geometry.attributes.position.array[o],a);if(e.children[0].geometry)for(let o=1;o<=e.children[0].geometry.attributes.position.array.length;o+=3)t=Math.min(e.children[0].geometry.attributes.position.array[o],t),a=Math.max(e.children[0].geometry.attributes.position.array[o],a);if(e.children[0].children[0].geometry)for(let o=1;o<=e.children[0].children[0].geometry.attributes.position.array.length;o+=3)t=Math.min(e.children[0].children[0].geometry.attributes.position.array[o],t),a=Math.max(e.children[0].children[0].geometry.attributes.position.array[o],a)}catch(o){}return{min:t,max:a}},p.checkIfMeshCrossStoreyLevel=function(e,t,a){return e==t||t-.5<e&&a>e+2&&a+.1>e},p.downloadGLTFfromTrinpod=async function(e,t){try{const a=await window.solid.session.fetch(e,{method:"GET",credentials:"include"});console.log(a);let o=await a.arrayBuffer(),s=URL.createObjectURL(new Blob([o],{type:"application/gltf"}));console.log("Flag: "+r["a"].state.bv.GLTFloadingFlag),r["a"].state.bv.GLTFloadingFlag?(console.log("Something is already loading, need queue. Putting in queue"),r["a"].state.bv.GLTFloadingQueue.push(s)):(p.loadGLTF(s,t),r["a"].state.bv.GLTFloadingQueue.push(s))}catch(a){console.log(a)}},p.downloadImagefromTrinpod=async function(e){try{const a=await window.solid.session.fetch(e,{method:"GET",credentials:"include"});console.log(a);let o=await a.arrayBuffer();var t=window.URL||window.webkitURL;let s=t.createObjectURL(new Blob([o],{type:"image/jpeg"}));return s}catch(a){console.log(a)}},p.addRoomMatrix=async function(e,t,a,o){var s=e+"";s=s.replace("^^neo:a_matrix-3m",""),s=s.replaceAll('"',"");const n=s.split(";");let i='{"x":'+n[2]+', "y":'+n[3]+', "z":'+n[4]+', "height":'+n[5]+', "color":'+t+', "opacity":'+a+', "roomuri":"'+o+'", "polyline":"'+n[6]+'"}',l=JSON.parse(i),c=!1;r["a"].state.bv.roomGeometry.forEach(e=>{!e.roomuri==o&&(c=!0)}),c||r["a"].state.bv.roomGeometry.push(l)},p.loadGLTF=async function(e,t,a=!0,s=0){return new Promise(async(n,i)=>{const c=r["a"].state.bv.scene.getObjectByName("buildingbox"),d=new o["a"];console.log("Starting to load "+t+" gltf.."),r["a"].state.bv.GLTFloadingFlag=!0,d.load(e,(function(e){const o=e.scene;0==s?r["a"].state.bv.mapMode&&o.scale.set(r["a"].state.bv.scaleFactor,r["a"].state.bv.scaleFactor,r["a"].state.bv.scaleFactor):o.scale.set(s,s,s),o.name=t,a&&c.add(o),n(o)}),(function(e){let a=e.loaded/e.total*100;console.log(a+"% loaded"),100==a&&(console.log("GLTF loading finished!"),setTimeout((function(){window.requestAnimationFrame(()=>{r["a"].state.bv.needsrender=!0})}),300),r["a"].state.bv.GLTFloadingFlag=!1,r["a"].state.bv.GLTFloadingQueue=l["a"].removeFirstElement(r["a"].state.bv.GLTFloadingQueue),console.log(r["a"].state.bv.GLTFloadingQueue.length),r["a"].state.bv.GLTFloadingQueue.length>=1&&(console.log("Something found in queue"),p.loadGLTF(r["a"].state.bv.GLTFloadingQueue[0],t)))}),(function(e){console.log("An error happened: "+e),r["a"].state.bv.GLTFloadingFlag=!1,r["a"].state.bv.GLTFloadingQueue=l["a"].removeFirstElement(r["a"].state.bv.GLTFloadingQueue),r["a"].state.bv.GLTFloadingQueue.length>=1&&p.loadGLTF(r["a"].state.bv.GLTFloadingQueue[0],t)}))})},p.loadGeometryUsingTag=function(e,t,a){a.forEach(a=>{let o=e+"."+a;if(!r["a"].state.bv.gltfLoadedList.includes(o)){const e=t+"home/GLTF/"+o+".gltf";p.downloadGLTFfromTrinpod(e,o),r["a"].state.bv.gltfLoadedList.push(o)}})},p.unloadGeometryUsingTag=function(e,t){const a=r["a"].state.bv.scene.getObjectByName("buildingbox");t.forEach(t=>{let o=e+"."+t;if(r["a"].state.bv.gltfLoadedList.includes(o))try{let e=r["a"].state.bv.scene.getObjectByName(o);a.remove(e),r["a"].state.bv.gltfLoadedList=l["a"].removeValueFromArray(r["a"].state.bv.gltfLoadedList,o)}catch(s){console.log(s)}})},p.unloadGeometryContainingString=function(e){const t=r["a"].state.bv.scene.getObjectByName("buildingbox");t.children.forEach(a=>{a.name.includes(e)&&t.remove(a)})},p.checkIfPointInsideMesh=function(e,t){const a=r["a"].state.bv.scene.getObjectByName("buildingbox"),o=new s["uc"](1,1,1);r["a"].state.bv.raycaster.set(e.applyMatrix4(a.matrixWorld),o);let n=r["a"].state.bv.raycaster.intersectObject(t,!0);try{return!!(n.length&&o.dot(n[0].face.normal)>0)}catch(i){}},p.raycastRoomsFromPoint=function(e,t){r["a"].state.bv.raycaster.set(e,t);let a=r["a"].state.bv.raycaster.intersectObject(mesh,!0);const o=[];return a.forEach(e=>{o.includes(e.name)||o.push(e.name)}),o},p.raycastUsingVector=function(e,t){const a=r["a"].state.bv.scene.getObjectByName("buildingbox");a.updateMatrixWorld(),r["a"].state.bv.raycaster.set(e.applyMatrix4(a.matrixWorld),t.applyMatrix4(a.matrixWorld));let o=r["a"].state.bv.raycaster.intersectObjects(a.children,!0);const s=a.matrixWorld.invert();for(let r=0;r<o.length-1;r++)o[r].point.applyMatrix4(s);return o},p.raycastUsingVectorDir=function(e,t){const a=r["a"].state.bv.scene.getObjectByName("buildingbox");a.updateMatrixWorld(),r["a"].state.bv.raycaster.set(e.applyMatrix4(a.matrixWorld),t);let o=r["a"].state.bv.raycaster.intersectObjects(a.children,!0);const s=a.matrixWorld.invert();for(let r=0;r<o.length-1;r++)o[r].point.applyMatrix4(s);return o},p.zoomTwoDimCamera=function(){let e,t,a=300,o=300,s=50;function n(i){void 0===e&&(e=i);t!==i&&(a-=(o-s)/150,r["a"].state.bv.twodimcamera.position.set(r["a"].state.bv.twodimcamera.position.x,a,r["a"].state.bv.twodimcamera.position.z),r["a"].state.bv.controls2d.update()),counter<=150?(t=i,counter+=1,window.requestAnimationFrame(n)):r["a"].state.bv.autorotate||(r["a"].state.bv.animate=!1)}r["a"].state.bv.animate=!0,window.requestAnimationFrame(n)},p.moveToObject=function(){var e=new s["uc"],t=new s["uc"],a=new s["uc"];let o=r["a"].state.bv.twodimcamera.zoom,n=o;var i=(new s["i"]).setFromObject(r["a"].state.bv.INTERSECTED);let l,c;r["a"].state.bv.animate=!0,t=i.getSize(t),a=i.getCenter(a),console.log("SizeX:"+t.x+" SizeY:"+t.y),t.x>=t.y?r["a"].state.bv.camerafocuswidth=t.x:r["a"].state.bv.camerafocuswidth=t.y;r["a"].state.bv.INTERSECTED.getWorldPosition(e);var d=a.x+(15+.5*r["a"].state.bv.camerafocuswidth),u=a.y+(15+.5*r["a"].state.bv.camerafocuswidth),h=a.z+(15+.5*r["a"].state.bv.camerafocuswidth),g=a.x,m=a.y,p=a.z,f=r["a"].state.bv.camera.position.x,b=r["a"].state.bv.camera.position.z,v=r["a"].state.bv.camera.position.y,y=r["a"].state.bv.controls3d.target.x,w=r["a"].state.bv.controls3d.target.y,I=r["a"].state.bv.controls3d.target.z,S=2,R=f,A=b,E=v,x=y,_=w,j=I;function T(e){void 0===l&&(l=e);c!==e&&(R-=(f-d)/15,A-=(b-h)/15,E-=(v-u)/15,x-=(y-g)/15,_-=(w-m)/15,j-=(I-p)/15,n-=(o-1)/15,r["a"].state.bv.camera.position.set(R,E,A),r["a"].state.bv.controls3d.target.set(x,j,_),r["a"].state.bv.twodimcamera.zoom=n,r["a"].state.bv.twodimcamera.position.set(0,300,0),r["a"].state.bv.twodimcamera.aspect=r["a"].state.bv.width/r["a"].state.bv.height,r["a"].state.bv.twodimcamera.updateProjectionMatrix(),r["a"].state.bv.controls2d.target.set(0,0,0),r["a"].state.bv.controls2d.update()),S<=15?(c=e,S+=1,window.requestAnimationFrame(T)):r["a"].state.bv.autorotate||(r["a"].state.bv.animate=!1)}window.requestAnimationFrame(T),console.log("Zoom to object")},p.createBuildingLocationList=async function(e){console.log("BuildingURIs"),console.log(e),r["a"].state.cp.buildingLocationList=[],r["a"].state.bv.scene.children.forEach(e=>{"buildinglabel"==e.name&&r["a"].state.bv.scene.remove(e)});for(let a=0;a<e.length;a++)try{let t=e[a];console.log("bURI"),console.log(t);const o=t.replace("/i","/home/IFC/building.json"),n=await h["a"].getIFCmetaDataFromJson(o),i=g["c"].datumsToSpherical(n.buildinglat,n.buildinglong),l=new s["uc"](-r["a"].state.bv.buildingboxPosition.x+i.x,0,r["a"].state.bv.buildingboxPosition.z-i.y);let c=!0;n.uri+""==""&&(c=!1),r["a"].state.cp.buildingLocationList.forEach(t=>{t.uri==e[a]&&(c=!1)}),console.log(e[a]+"Add flag: "+c);let d="";r["a"].state.rs.rdfStore.match(f.sym(e[a]),u["c"].FOAF("name"),null)[0]&&(d=r["a"].state.rs.rdfStore.match(f.sym(e[a]),u["c"].FOAF("name"),null)[0].object.value),c&&r["a"].state.cp.buildingLocationList.push({name:d,uri:e[a],buildinglat:n.buildinglat,buildinglong:n.buildinglong,position:l,cluster:a,rotation:n.rotation,buildingdimensions:n.buildingdimensions}),c&&p.createBuildingLabelHTML(d,l,"",e[a])}catch(t){console.log("Error: "+t)}console.log("Building list"),console.log(r["a"].state.cp.buildingLocationList)},p.createBuildingLabelHTML=async function(e,t,o,s){const n=document.createElement("div");n.classList.add("building-base-label"),n.uri=s;const i=document.createElement("div");i.classList.add("building-label"),n.appendChild(i);const l=document.createElement("div");l.setAttribute("style","display: flex;"),i.appendChild(l);const c=document.createElement("button");c.classList.add("number-button"),c.textContent="1",c.classList.add("hidden"),n.appendChild(c);const d=a("e563"),u=document.createElement("img");u.setAttribute("style","width: 35px; margin-right: 0px; margin-top: 0px"),u.setAttribute("src",d),l.appendChild(u);const h=document.createElement("h4");h.classList.add("hidden"),h.setAttribute("style","margin-left: 5px; margin-top: 4px"),h.textContent=e,l.appendChild(h);const g=document.createElement("div");g.classList.add("hidden"),g.classList.add("texttop"),i.appendChild(g);const f=document.createElement("span");f.classList.add("texttop"),f.textContent=o,g.appendChild(f);const b=document.createElement("button");b.classList.add("details-button"),b.classList.add("hidden"),b.textContent="Asset view",g.appendChild(b);const v=document.createElement("button");v.classList.add("details-button"),v.classList.add("hidden"),v.textContent="Details",g.appendChild(v);const y=document.createElement("button");y.classList.add("details-button"),y.classList.add("hidden"),y.textContent="Zoom",g.appendChild(y),n.onmouseenter=()=>{h.classList.remove("hidden"),g.classList.remove("hidden"),v.classList.remove("hidden"),b.classList.remove("hidden"),y.classList.remove("hidden")},n.onmouseleave=()=>{h.classList.add("hidden"),g.classList.add("hidden"),v.classList.add("hidden"),b.classList.add("hidden"),y.classList.add("hidden")},v.onclick=()=>{console.log("Button clicked."),r["a"].state.cp.buildingDetailURI=s},b.onclick=()=>{e.includes("111")&&(r["a"].state.redirect={path:"BMViewer",query:{select:"moir.scs",location:r["a"].state.location}}),e.includes("311")&&(r["a"].state.redirect={path:"BMViewer",query:{select:"sand.scs",location:""}})},y.onclick=()=>{r["a"].state.bv.INTERSECTED=r["a"].state.bv.scene.getObjectByName("buildingbox"),p.moveToObject()};const w=new m["a"](n);w.position.copy(t),w.name="buildinglabel",r["a"].state.bv.scene.add(w)},p.createSimpleLabel=async function(e,t,a="simplelabel"){const o=document.createElement("div");o.classList.add("building-base-label");const s=document.createElement("div");s.classList.add("simple-building-label"),o.appendChild(s);const n=document.createElement("span");n.classList.add("texttop"),n.textContent=t,s.appendChild(n);const i=new m["a"](o);i.position.copy(e),i.name=a,r["a"].state.bv.scene.add(i)},p.createLabelWithType=async function(e,t,a,o="simplelabel"){const s=document.createElement("div");s.classList.add("building-base-label");const n=document.createElement("div");n.classList.add("simple-building-label"),s.appendChild(n);const i=document.createElement("div");i.classList.add("texttitle"),i.textContent=a,n.appendChild(i);const l=document.createElement("div");l.classList.add("texttop"),l.textContent=t,n.appendChild(l);const c=new m["a"](s);c.position.copy(e),c.name=o,r["a"].state.bv.scene.add(c)},p.removeAllLabels=async function(){for(var e=r["a"].state.bv.scene.children.length-1;e>=0;e--){const t=r["a"].state.bv.scene.children[e];"simplelabel"==t.name&&r["a"].state.bv.scene.remove(t)}},p.removeTempLabels=async function(){for(var e=r["a"].state.bv.scene.children.length-1;e>=0;e--){const t=r["a"].state.bv.scene.children[e];"templabel"==t.name&&r["a"].state.bv.scene.remove(t)}},p.polylineToShape=function(e){const t=p.convertPolylineToPolyarray(e),a=new s["Wb"];var o=0;while(t.length>1){const e=t.splice(0,3),s=e[0],r=e[1];0==o?(a.moveTo(s,r),o+=1):a.lineTo(s,r)}return a.autoClose=!0,a},p.convertPolylineToPolyarray=function(e){var t=e+"";t=t.replace("^^neo:a_matrix-3m",""),t=t.replaceAll('"',"");const a=t.split(";");e=a[6];let o=[];return""!=e&&(e=e.replace("^^neo:a_matrix-3xm",""),e=e.replace("[",""),e=e.replace("]",""),o=e.split(",")),o},p.convertPolylineToXY=function(e){var t=e+"";t=t.replace("^^neo:a_matrix-3m",""),t=t.replaceAll('"',"");const a=t.split(";"),o={x:Number(a[2]),y:Number(a[3])};return o},p.convertPolyStringToarray=function(e){e+="";let t=[];return""!=e&&(e=e.replaceAll("[",""),e=e.replaceAll("]",""),e=e.replaceAll('"',""),t=e.split(",")),t},p.convertPolylineToPolyJson=function(e){var t=e+"";t=t.replace("^^neo:a_matrix-3m",""),t=t.replaceAll('"',"");const a=t.split(";");let o='{"roomname": "'+a[1]+'", "x":'+a[2]+', "y":'+a[3]+', "z":'+a[4]+', "height":'+a[5]+', "color":1789810, "opacity":1, "roomuri":"", "polyline":"'+a[6]+'"}';return JSON.parse(o)},p.trinagulateAndCalculateArea=function(e){const t=p.convertPolylineToPolyarray(e);var o=[];if(t.length>=10)while(t.length>1){const e=t.splice(0,3),a=e[0],s=e[1];var r=[a,s];o.push(r)}for(var n=a("7eb3"),i=[],l=0;l<o.length-1;++l)i.push(new n.Point(o[l][0],o[l][1]));let c=0;try{var d=new n.SweepContext(i),u=d.triangulate();for(l=0;l<u.triangles_.length;++l){let e=new s["uc"](u.triangles_[l].points_[0].x,u.triangles_[l].points_[0].y,0),t=new s["uc"](u.triangles_[l].points_[1].x,u.triangles_[l].points_[1].y,0),a=new s["uc"](u.triangles_[l].points_[2].x,u.triangles_[l].points_[2].y,0);const o=new s["kc"](e,t,a);c+=o.getArea()}}catch(h){}return console.log("Total area: "+c),c},p.createPlaceMarker=function(e,t=16711680,a,o=5,n="placemarker",i=.16){const l=r["a"].state.bv.scene.getObjectByName("buildingbox"),c=r["a"].state.bv.scene.getObjectByName("placemarker");c&&a&&l.remove(c);const d=new s["ob"]({transparent:!0,opacity:.6,color:t,depthTest:!1}),u=new s["j"](i,o,i);u.translate(e.x,e.y+o/2+.2,e.z);const h=new s["lb"](u,d);return h.name=n,l.add(h),h},p.createVisibleVector=function(e,t,a=255,o=1){const n=r["a"].state.bv.scene.getObjectByName("buildingbox");t.normalize();const i=new s["e"](t,e,o,a);n?n.add(i):r["a"].state.bv.scene.add(i)},p.placeArrow=async function(e,t,a){const o=r["a"].state.bv.scene.getObjectByName("buildingbox");if(t.normalize(),r["a"].state.bv.arrowModelStart||(r["a"].state.bv.arrowModel=await p.loadGLTF("../arrow.glb","arrow",!1,.02*a),r["a"].state.bv.arrowModelStart=!0),r["a"].state.bv.arrowModel){let a=r["a"].state.bv.arrowModel.clone();console.log(a),a.translateX(.2),a.translateY(.3),a.translateX(e.x),a.translateZ(e.z);const n=p.angleThreeVectors(new s["uc"](1,0,0),new s["uc"](0,0,0),t)*(t.z>0?-1:1);console.log("Angle: "+n),a.rotateOnAxis(new s["uc"](0,1,0),n),a.rotateOnAxis(new s["uc"](0,1,0),-Math.PI/2),a.translateY(e.y),o.add(a)}else setTimeout((function(){let a=r["a"].state.bv.arrowModel.clone();a.translateX(e.x-.2),a.translateY(e.z+.2);let n=new s["uc"](0,1,0).angleTo(t);a.rotateOnAxis(new s["uc"](0,1,0),n),o.add(a)}),5e3)},p.getDoorPosition=function(e){let t=new s["uc"](0,0,0);if(r["a"].state.rs.rdfStore.match(f.sym(e),u["c"].SIO("SIO_000507"),null)[0]){let a=r["a"].state.rs.rdfStore.match(f.sym(e),u["c"].SIO("SIO_000507"),null)[0].object.value;t=d["a"].pointStringToVector3(a)}return t},p.getRoomPolylinebyURI=function(e){let t=r["a"].state.rs.rdfStore.match(f.sym(e),u["c"].IFOUR("m_polyline"),null)[0];return t?t.object.value:(console.log("Warning: Did not find polyline for URI!.."),"")},p.showWay=function(e,t=1){if(e.length<=2)return;let a=[],o=void 0,n=new s["uc"](0,0,0);e.forEach(e=>{let t=!1;if(r["a"].state.rs.rdfStore.match(f.sym(e),u["c"].RDF("type"),u["c"].NEO("x_door"))[0]&&(n=p.getDoorPosition(e),t=!0),void 0!=o&&!t)if(r["a"].state.rs.rdfStore.match(f.sym(o),u["c"].RDF("type"),u["c"].NEO("x_door"))[0]){const t=p.getRoomPolylinebyURI(e),o=p.getDoorDirectionVector(t,n,!1);a.push({uri:e,pos:n,vec:o})}else{const t=[];let r=new s["uc"](0,0,0);t.push(p.getRoomPolylinebyURI(o)),t.push(p.getRoomPolylinebyURI(e));let n=p.findSpaceIntersections(t,.5,!1);n[0]&&(r=n[0].point);const i=p.getDoorDirectionVector(t[1],r,!1);a.push({uri:"",pos:r,vec:i})}o=e});let i=void 0;a=a.reduce((function(e,t){let a=t.pos.clone().add(t.vec.clone().negate());if(e.push({uri:"",pos:a.clone(),vec:t.vec}),e.push(t),void 0!=i){let o=new s["uc"](0,0,0).subVectors(a.clone(),i.pos.clone().add(i.vec.clone())).normalize();console.log("After dir:"),console.log(o);let r=t.pos.clone().distanceTo(i.pos),n=i.pos.clone().add(i.vec.clone());e.push({uri:"",pos:n,vec:o});for(let t=2;t<Math.abs(r-2);t+=2){let a=n.clone().addScaledVector(o.clone(),t);e.push({uri:"",pos:a,vec:o})}}return i=t,e}),[]),r["a"].state.bv.arrowModelStart=!1,a.forEach(e=>{p.placeArrow(e.pos.clone().multiplyScalar(t),e.vec,t)})},p.createLine=function(e,t=16777215){const a=r["a"].state.bv.scene.getObjectByName("buildingbox"),o=new s["W"]({color:t}),n=[];e.forEach(e=>{n.push(new s["uc"](e.x,5,e.z))});const i=(new s["l"]).setFromPoints(n);a.add(new s["U"](i,o))},p.createPointsFromPolyArray=function(e,t){const a=[];while(e.length>1){const o=e.splice(0,3);a.push(new s["uc"](parseFloat(o[1])+t.x,t.z,o[0]-t.y))}return a},p.draw2dspace=function(e,t,a=12303325,o=""){const n=r["a"].state.bv.scene.getObjectByName("buildingbox"),i=new s["ob"]({color:a,transparent:!0,opacity:.3});let l=new s["Wb"],c=[];e.forEach(e=>{c.push(e)});let d=0;while(c.length>1){const e=c.splice(0,3),a=e[0],o=e[1];0==d?(l.moveTo(-a+t.y,-o-t.x,t.z),d+=1):l.lineTo(-a+t.y,-o-t.x,t.z)}l.autoClose=!0;const u={extrudePath:new s["X"](new s["uc"](0,t.z,0),new s["uc"](0,t.z+.5,0))},h=new s["C"](l,u),g=new s["lb"](h,i);g.name=o,n.add(g)},p.angleThreeVectors=function(e,t,a){let o=0;return 0===e.x&&0===e.y&&0===e.z||0===a.x&&0===a.y&&0===a.z?0:(e.sub(t),a.sub(t),o=e.angleTo(a),e.add(t),a.add(t),o)},p.getDoorDirectionVector=function(e,t,a=!1){console.log("Getting door direction vector"),a&&p.createPlaceMarker(t,65280);const o=p.convertPolylineToPolyJson(e),r={x:o.x,y:o.y,z:o.z,height:o.height,roomuri:o.roomuri},n=p.convertPolyStringToarray(o.polyline);a&&p.draw2dspace(n,r,10066346,"Name");const i=p.createPointsFromPolyArray(n,r),l=[];let d=0;for(let s=0;s<i.length;s++)a&&p.createPlaceMarker(i[s]),s!=i.length-1?l.push(c["a"].v3subtract(i[s+1],i[s])):l.push(c["a"].v3subtract(i[s],i[0]));for(let c=0;c<i.length;c++){let e=l[i.length-2].clone();0!=c&&(e=l[c-1].clone());const t=l[c].clone(),a=p.angleThreeVectors(e,new s["uc"](0,0,0),t);d+=a}a&&console.log("Angle sum: "+d);let u=!0;d>=0?(a&&console.log("Angle sum is positive. Use right hand side for out."),u=!1):(a&&console.log("Angle sum is negative. Use left hand side for out."),u=!0);let h=new s["uc"](0,-1,0),g=new s["uc"](0,0,0),m=new s["uc"](0,0,0),f=new s["uc"](0,0,0),b=1e3;for(let c=0;c<i.length-1;c++){const e=(new s["Lb"]).setFromAxisAngle(h,Math.PI/2);0==c&&(g=l[i.length-2].clone().applyQuaternion(e),a&&p.createVisibleVector(i[c],g,10066176));let o=void 0,r=void 0;c==l.length-1?(o=l[1].clone().applyQuaternion(e),r=new s["V"](i[c].clone(),i[0].clone())):(o=l[c].clone().applyQuaternion(e),r=new s["V"](i[c].clone(),i[c+1].clone()));let n=new s["uc"](0,0,0);r.closestPointToPoint(t.clone(),!1,n);const d=n.distanceTo(t.clone());console.log("Distance: "+d),d<b&&(b=d,m=o.clone(),r&&r.getCenter(f)),a&&p.createVisibleVector(i[c],o,39168),g.normalize(),o.normalize(),g=o}const v=m.negate();return p.createVisibleVector(t,v,0),v},p.createGrossAreaSpaces=function(e,t=!0){console.log("Creating gross spaces");const a=[],o=[],n=[];for(let s=0;s<e.length;s++){const t=p.convertPolylineToPolyJson(e[s]);n.push({x:t.x,y:t.y,z:t.z,height:t.height,roomuri:t.roomuri}),o.push(p.convertPolyStringToarray(t.polyline))}for(let s=0;s<o.length;s++)0!=s&&p.draw2dspace(o[s],n[s],10066346,s+"");for(let i=50;i<70;i++){const e=p.createPointsFromPolyArray(o[i],n[i]),l=[];let d=new s["uc"](0,0,0),u=0;for(let a=0;a<e.length;a++)t&&p.createPlaceMarker(e[a]),a!=e.length-1?l.push(c["a"].v3subtract(e[a+1],e[a])):l.push(c["a"].v3subtract(e[a],e[0]));for(let t=0;t<e.length;t++){const a=l[e.length-2].clone();0!=t&&(a=l[t-1].clone());const o=l[t].clone();console.log(a),console.log(o);const r=p.angleThreeVectors(a,new s["uc"](0,0,0),o);console.log("Angle: "+r),u+=r}console.log("Angle sum: "+u);let h=!0;u>=0?(console.log("Angle sum is positive. Use right hand side for out."),h=!1):(console.log("Angle sum is negative. Use left hand side for out."),h=!0);let g=new s["uc"](0,-1,0),m=new s["uc"](0,0,0),f=new s["uc"](0,0,0);const b=[];for(let a=0;a<e.length-1;a++){const o=(new s["Lb"]).setFromAxisAngle(g,Math.PI/2);0==a?(m=l[e.length-2].clone().applyQuaternion(o),f=e[e.length-2].clone().add(c["a"].v3half(l[e.length-2])),t&&p.createVisibleVector(e[a],m,10066176)):a<=e.length-2&&t&&p.createVisibleVector(e[a],m,10027008);let u=void 0,h=void 0;a==l.length-1?(u=e[1].clone().add(c["a"].v3half(l[1])),h=l[1].clone().applyQuaternion(o)):(u=e[a].clone().add(c["a"].v3half(l[a])),h=l[a].clone().applyQuaternion(o)),m.normalize(),h.normalize(),t&&p.createVisibleVector(u,h,34816,.2*a+.2),t&&p.createVisibleVector(e[a],h,136);let v=.3,y=.3;r["a"].state.bv.raycaster.set(u,h);let w=r["a"].state.bv.raycaster.intersectObjects(r["a"].state.bv.scene.getObjectByName("buildingbox").children,!0);if(w[0]&&w[0].distance<=.5&&(y=w[0].distance),r["a"].state.bv.raycaster.set(f,m),w=r["a"].state.bv.raycaster.intersectObjects(r["a"].state.bv.scene.getObjectByName("buildingbox").children,!0),w[0]&&w[0].distance<=.5&&(v=w[0].distance),console.log("Gap before: "+v),console.log("Gap after: "+y),t&&p.createLine([e[a],e[a].clone().add(l[a])]),t&&p.createLine([e[e.length-2],e[e.length-2].clone().add(l[l.length-2])]),y>=0&&y<=1){const o=m.clone(),r=h.clone();let n=p.angleThreeVectors(o,new s["uc"](0,0,0),r),i=o.x*r.z-o.z*r.x;i>0&&(n=2*Math.PI-n),console.log("Angle between directions: "+n);const l=v/2,c=y/2;let u=c,f=-l;(n<=Math.PI/2-.002||n>=Math.PI/2+.002)&&(u=(c-l*Math.cos(n))/Math.sin(n)),(u>=.5||u<=-.5)&&(u=0);const w=m.clone().applyAxisAngle(new s["uc"](g.x,-g.y,g.z),Math.PI/2);0==a&&(d=w.clone().normalize());const I=d;let S=p.angleThreeVectors(I,new s["uc"](0,0,0),w);i=I.x*w.z-I.z*w.x,i>0&&(S=2*Math.PI-S),t&&console.log("Angle to world: "+S);let R=new s["uc"](u,0,-f);if(R.applyAxisAngle(new s["uc"](0,1,0),S),R.applyAxisAngle(new s["uc"](0,1,0),p.angleThreeVectors(new s["uc"](1,0,0),new s["uc"](0,0,0),d)),0==n){t&&console.log("Angle is 0......");let e=Math.min(v,y)/2;t&&console.log("Length: "+e),R=m.normalize().multiplyScalar(e)}t&&console.log("Found point x:"+u+" y:"+f),p.angleThreeVectors(h,new s["uc"](0,0,0),R)>2&&R.negate();const A=e[a].clone().add(R);b.push(A.z),b.push(A.x),b.push(3),t&&p.createVisibleVector(e[a],R,0)}else console.log("Warning, distance to neighbour is out of limits"),p.createVisibleVector(u,h,34816,1),p.panToFocusObject(n[i].x,-n[i].y),console.log(w),b.push(e[a].z),b.push(e[a].x),b.push(3);m=h,f=u}p.draw2dspace(b,{x:0,y:0,z:3},8913032,""),a.push(b)}},p.findSpaceIntersections=function(e,t,a=!0){a&&console.log("Finding space intersections");const o=[],n=[],i=[],l=[];for(let s=0;s<e.length;s++){const t=p.convertPolylineToPolyJson(e[s]);n.push({x:t.x,y:t.y,z:t.z,height:t.height,roomuri:t.roomuri}),o.push(p.convertPolyStringToarray(t.polyline)),i.push(t.roomname)}for(let s=0;s<o.length;s++)0!=s&&p.draw2dspace(o[s],n[s],10066346,i[s]);for(let u=0;u<o.length;u++){const e=p.createPointsFromPolyArray(o[u],n[u]),h=[];new s["uc"](0,0,0);let g=0;for(let t=0;t<e.length;t++)t!=e.length-1?h.push(c["a"].v3subtract(e[t+1],e[t])):h.push(c["a"].v3subtract(e[t],e[0]));for(let t=0;t<e.length;t++){let a=h[e.length-2].clone();0!=t&&(a=h[t-1].clone());const o=h[t].clone(),r=p.angleThreeVectors(a,new s["uc"](0,0,0),o);g+=r}let m=!0;m=!(g>=0);let f=new s["uc"](0,-1,0),b=new s["uc"](0,0,0),v=new s["uc"](0,0,0);for(let o=0;o<e.length-1;o++){const n=(new s["Lb"]).setFromAxisAngle(f,Math.PI/2);0==o&&(b=h[e.length-2].clone().applyQuaternion(n),v=e[e.length-2].clone().add(c["a"].v3half(h[e.length-2])));let g=void 0,m=void 0;o==h.length-1?(g=e[1].clone().add(c["a"].v3half(h[1])),m=h[1].clone().applyQuaternion(n)):(g=e[o].clone().add(c["a"].v3half(h[o])),m=h[o].clone().applyQuaternion(n)),b.normalize(),m.normalize();let p=.3;const y=i[u];let w="";r["a"].state.bv.raycaster.set(g,m);let I=r["a"].state.bv.raycaster.intersectObjects(r["a"].state.bv.scene.getObjectByName("buildingbox").children,!0);for(let e=0;e<1;e++)I[e]&&I[e].distance<=.03&&(p=I[e].distance,w=I[e].object.name);if(p>=-.01&&p<=.01&&d["a"].formatString(y)!=d["a"].formatString(w)){const e=h[o].clone().length();e>=t&&(a&&console.log("Space: "+y+" intersects: "+w),l.push({room1:d["a"].formatString(y),room2:d["a"].formatString(w),point:g,length:e}))}b=m,v=g}}return a&&console.log(l),l},p.panToFocusObject=function(e,t){r["a"].state.bv.twodimcamera.position.set(e,20,t),r["a"].state.bv.controls2d.target.set(e,1,t),r["a"].state.bv.controls2d.update(),r["a"].state.bv.needsrender=!0},p.getMeshCenterPoint=function(e){let t=-1e5,a=1e5,o=-1e5,r=1e5,n=1e5;for(let s=0;s<=e.geometry.attributes.position.array.length-3;s+=3)t=Math.max(e.geometry.attributes.position.array[s],t),a=Math.min(e.geometry.attributes.position.array[s],a);for(let s=2;s<=e.geometry.attributes.position.array.length;s+=3)o=Math.max(e.geometry.attributes.position.array[s],o),r=Math.min(e.geometry.attributes.position.array[s],r);for(let s=1;s<=e.geometry.attributes.position.array.length;s+=3)n=Math.min(e.geometry.attributes.position.array[s],n);return new s["uc"]((t+a)/2,n,(o+r)/2)},p.getMeshCenterPointTop=function(e){let t=-1e5,a=1e5,o=-1e5,r=1e5,n=-1e5;for(let s=0;s<=e.geometry.attributes.position.array.length-3;s+=3)t=Math.max(e.geometry.attributes.position.array[s],t),a=Math.min(e.geometry.attributes.position.array[s],a);for(let s=2;s<=e.geometry.attributes.position.array.length;s+=3)o=Math.max(e.geometry.attributes.position.array[s],o),r=Math.min(e.geometry.attributes.position.array[s],r);for(let s=1;s<=e.geometry.attributes.position.array.length;s+=3)n=Math.max(e.geometry.attributes.position.array[s],n);return new s["uc"]((t+a)/2,n,(o+r)/2)},t["a"]=p},da1a:function(e,t,a){"use strict";a("9479")},daa1:function(e,t,a){"use strict";a("1d0f")},dc69:function(e,t,a){},e563:function(e,t,a){e.exports=a.p+"img/building3.78d884c2.png"},e678:function(e,t,a){},e829:function(e,t,a){e.exports=a.p+"img/floor.e65cb651.png"},ed15:function(e,t,a){},f811:function(e,t,a){"use strict";a("7084")},f8d2:function(e,t,a){},f90f:function(e,t,a){"use strict";a("dc69")},f973:function(e,t,a){"use strict";var o=a("fb26"),s=a("b33c"),r=a("706e"),n=a("4360");const i=a("1157"),l=a("592d"),c=n["a"].state.rs.rdfStore,d={substance:function(e){},cause:function(e){var t=s["a"].getURI(e);if(t&&r["a"].isEvent(t)){var a=s["a"].unique(c.match(null,o["b"].f_cause,l.sym(t)));if(a&&a.length>0){var n=[];return a.forEach(e=>n.push(e.subject.value)),n}}},effect:function(e){var t=s["a"].getURI(e);if(t&&r["a"].isEvent(t)){var a=s["a"].unique(c.match(l.sym(t),o["b"].f_cause));if(a&&a.length>0){var n=[];return a.forEach(e=>n.push(e.object.value)),n}}},capability:function(e,t){var a=s["a"].getURI(e);if(a)if(r["a"].isEvent(a)){var n=c.anyStatementMatching(l.sym(a),o["b"].t_execute);if(n)return n.object.value}else{var i,d=null;t&&(i=s["a"].getURI(t),i&&(d=l.sym(i)));var u=s["a"].unique(c.match(l.sym(a),o["b"].b_capable,d));if(u.length>0){var h=[];if(u.forEach((function(e){var t=r["a"].quadToState(e);t&&h.push(t)})),Array.isArray(h)&&h.length>0)return h}}},input:function(e){var t=s["a"].getURI(e),a=[];if(t){var n=l.sym(t);if(r["a"].isEvent(t)){var i=s["a"].unique(c.match(null,o["b"].i_input,n));i.length>0&&i.forEach(e=>a.push(e.subject.value))}else if(r["a"].isState(t)){i=s["a"].unique(c.match(n,o["b"].i_input));i.length>0&&i.forEach(e=>a.push(e.object.value))}else if(r["a"].isEntity(t)){var u=d.state(t);u&&u.forEach((function(e){var t=d.input(e);t.length>0&&(a=s["a"].unique(a.concat(t)))}))}}return s["a"].unique(a)},output:function(e){var t=s["a"].getURI(e),a=[];if(t){var n=l.sym(t);if(r["a"].isEvent(t)){var i=s["a"].unique(c.match(n,o["b"].o_output));i.length>0&&i.forEach(e=>a.push(e.object.value))}else if(r["a"].isState(t)){i=s["a"].unique(c.match(null,o["b"].o_output,n));i.length>0&&i.forEach(e=>a.push(e.subject.value))}else if(r["a"].isEntity(t)){var u=d.state(t);u&&u.forEach((function(e){var t=d.output(e);t.length>0&&(a=s["a"].unique(a.concat(t)))}))}}return a},start:function(e){var t=s["a"].getURI(e);if(t){var a=c.anyStatementMatching(l.sym(t),o["b"].t_start);if(a){var n=r["a"].attributeToElems(a.object);if(n){var i=n.a_result;if(i)return i.value}}}},end:function(e){var t=s["a"].getURI(e);if(t){var a=c.anyStatementMatching(l.sym(t),o["b"].t_end);if(a){var n=r["a"].attributeToElems(a.object);if(n){var i=n.a_result;if(i)return i.value}}}},updateTime:function(e){return d.end(e)||d.start(e)},started:function(e){var t=s["a"].getURI(e);if(t)return!!c.anyStatementMatching(l.sym(t),o["b"].t_start)},ended:function(e){var t=s["a"].getURI(e);return!!t&&!!c.anyStatementMatching(l.sym(t),o["b"].t_end)},active:function(e){var t=s["a"].getURI(e);if(t)return!(!d.started(t)||d.ended(t))},status:function(e){var t=s["a"].getURI(e);if(t){var a=[];if(t){if(r["a"].isEvent(t))a=d.status(d.effect(t));else{var n=l.sym(t),u=s["a"].unique(c.match(n,o["b"].m_status));if(u&&u.length>0)u.forEach(e=>a.push(e.object.value));else{var h=d.input(t);if("array"===i.type(h)&&h.length>0){a=[];h.forEach(e=>a.push(e.status(e)))}}}return"array"===i.type(a)&&a.length>0?a:null}}},entity:function(e){if(Array.isArray(e)){var t=[],a=[];return e.forEach((function(e){t.push(d.entity(e))})),t.forEach(e=>{a=a.concat(e)}),s["a"].unique(a)}var n=s["a"].getURI(e);if(n)if(r["a"].isState(n)){var u=s["a"].unique(c.match(null,o["c"].NEO("i_entity"),l.sym(s["a"].getURI(n)))),h=i.map(u,(function(e){var t=e.subject.value;if(!r["a"].isAttribute(t))return t}));if(h)return s["a"].unique(h)}else if(r["a"].isEntity(n))return n},state:function(e){var t=s["a"].getURI(e);if(t){if(r["a"].isState(t))return t;if(r["a"].isAttribute(t)){var a=s["a"].unique(c.match(l.sym(t),o["b"].i_attribute));return s["a"].unique(i.map(a,(function(e){return e.object.value})))}a=s["a"].unique(c.match(l.sym(t),o["b"].i_entity));return s["a"].unique(i.map(a,(function(e){return e.object.value})))}},attribute:function(e){var t=s["a"].getURI(e);if(t)if(r["a"].isState(t)){var a=r["a"].stateToElems(t);if("object"===typeof a)return[a.a_attribute]}else{if(r["a"].isAttribute(t))return[t];if(r["a"].isEntity(t)){var o=d.state(t);if(o)return i.map(o,(function(e){return d.attribute(e)}))}}},_function:function(e){var t=s["a"].getURI(e);if(t){if(Array.isArray(e)){var a=[];return e.forEach(e=>a.push(d._function(e))),a}if(r["a"].isEvent(t)){var o=d.capability(t);if(o)return d.result(o)}else{var n=[],l=d.attribute(t);if(l&&(i.map(l,(function(e){n.push(r["a"].attributeToElems(e))})),n))return s["a"].unique(i.map(n,(function(e){if("object"===i.type(e))return e.f_function})))}}},result:function(e){if(Array.isArray(e)){var t=[];return e.forEach(e=>t.push(r["a"].a_result(e))),t}return r["a"].a_result(e)},rank:function(e){var t=s["a"].getURI(e);if(t){var a=s["a"].unique(c.match(l.sym(t),o["c"].NEO("m_rank")));return a&&a.length>0?parseFloat(a[0].object.value):100}return 100},lastChange:function(e){var t=s["a"].getURI(e);if(t){var a=c.anyStatementMatching(l.sym(t),o["b"].m_lastChange);if(a)return a.object.value}},lastCapability:function(e){var t=s["a"].getURI(e);if(t){var a=d.lastChange(t),o=d.capability(a);if(o)return o}},lastFunction:function(e){var t=d.lastCapability(e);if(t)return d.result(t)},lastSystem:function(e){var t=d.lastCapability(e);if(t){var a=d.entity(t);if(Array.isArray(a))return a[0]}}};t["a"]=d},faa9:function(e,t,a){"use strict";var o=a("5a89");const s={v3subtract:function(e,t){const a=new o["uc"](0,0,0);return a.x=e.x-t.x,a.y=e.y-t.y,a.z=e.z-t.z,a},v3add:function(e,t){const a=new o["uc"](0,0,0);return a.x=e.x+t.x,a.y=e.y+t.y,a.z=e.z+t.z,a},v3multiply:function(e,t){const a=new o["uc"](0,0,0);return a.x=e.x*t.x,a.y=e.y*t.y,a.z=e.z*t.z,a},v3half:function(e){const t=new o["uc"](0,0,0);return t.x=e.x/2,t.y=e.y/2,t.z=e.z/2,t},v3cross:function(e,t){let a={x:0,y:0,z:0};return a.x=e.y*t.z-e.z*t.y,a.y=e.z*t.x-e.x*t.z,a.z=e.x*t.y-e.y*t.x,a},rotateRadians:function(e,t,a,o,s){const r=Math.cos(s),n=Math.sin(s),i=r*(a-e)+n*(o-t)+e,l=r*(o-t)-n*(a-e)+t;return[i,l]},getAngleRadians:function(e,t,a,o){let s=e-a,r=t-o,n=Math.atan2(r,s);return n}};t["a"]=s},fb26:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return n})),a.d(t,"b",(function(){return l})),a.d(t,"f",(function(){return d})),a.d(t,"e",(function(){return u})),a.d(t,"g",(function(){return h}));const o=a("1157"),s=a("592d");var r=Object.create(null),n=Object.create(null),i=Object.create(null),l=Object.create(null);const c=a("dae0");var d=Object.create(null),u=Object.create(null);r.FOAF=s.Namespace("http://xmlns.com/foaf/0.1/"),n.FOAF="http://xmlns.com/foaf/0.1/",r.VCARD=s.Namespace("http://www.w3.org/2006/vcard/ns#"),n.VCARD="http://www.w3.org/2006/vcard/ns",r.REG=s.Namespace("https://www.w3.org/ns/assignments/reg#"),n.REG="https://www.w3.org/ns/assignments/reg#",r.RDF=s.Namespace("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),n.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",r.RDFS=s.Namespace("http://www.w3.org/2000/01/rdf-schema#"),n.RDFS="http://www.w3.org/2000/01/rdf-schema#",r.OWL=s.Namespace("http://www.w3.org/2002/07/owl#"),n.OWL="http://www.w3.org/2002/07/owl",r.DC=s.Namespace("http://purl.org/dc/elements/1.1/"),n.DC="http://purl.org/dc/elements/1.1/",r.DCTERMS=s.Namespace("http://purl.org/dc/terms/"),n.DCTERMS="http://purl.org/dc/terms/",r.RSS=s.Namespace("http://purl.org/rss/1.0/"),n.RSS="http://purl.org/rss/1.0",r.XSD=s.Namespace("http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/#dt-"),r.CONTACT=s.Namespace("http://www.w3.org/2000/10/swap/pim/contact#"),n.CONTACT="http://www.w3.org/2000/10/swap/pim/contact",r.DIO=s.Namespace("https://w3id.org/dio#"),n.DIO="https://w3id.org/dio",r.DOAP=s.Namespace("http://usefulinc.com/ns/doap#"),n.DOAP="http://usefulinc.com/ns/doap#",r.LDP=s.Namespace("http://www.w3.org/ns/ldp#"),n.LDP="http://www.w3.org/ns/ldp#",r.LODE=s.Namespace("http://linkedevents.org/ontology/"),n.LODE="http://linkedevents.org/ontology/",r.LVONT=s.Namespace("http://lexvo.org/ontology#"),n.LVONT="http://lexvo.org/ontology",r.POSIX=s.Namespace("https://www.w3.org/ns/posix/stat#"),n.POSIX="https://www.w3.org/ns/posix/stat",r.SH=s.Namespace("http://www.w3.org/ns/shacl#"),n.SH="http://www.w3.org/ns/shacl#",r.SPACE=s.Namespace("http://www.w3.org/ns/pim/space#"),n.SPACE="http://www.w3.org/ns/pim/space",r.SCHEMA=s.Namespace("http://schema.org/"),n.SCHEMA="http://schema.org/",r.SOLID=s.Namespace("http://www.w3.org/ns/solid/terms#"),n.SOLID="http://www.w3.org/ns/solid/terms",r.TAG=s.Namespace("http://www.holygoat.co.uk/owl/redwood/0.1/tags/"),n.TAG="http://www.holygoat.co.uk/owl/redwood/0.1/tags/",r.TXN=s.Namespace("http://lod.taxonconcept.org/ontology/txn.owl#"),n.TXN="http://lod.taxonconcept.org/ontology/txn.owl",r.GMX=s.Namespace("http://graphmetrix.com/node#"),n.GMX="http://graphmetrix.com/node#7",r.GMXO=s.Namespace("https://ontology.graphmetrix.com/node/"),n.GMXO="https://ontology.graphmetrix.com/node/",r.MUTO=s.Namespace("http://purl.org/muto/core#"),n.MUTO="http://purl.org/muto/core",r.NEO=s.Namespace("https://neo.graphmetrix.net/node/"),n.NEO="https://neo.graphmetrix.net",r.DUL=s.Namespace("http://www.ontologydesignpatterns.org/ont/dul/DUL.owl#"),n.DUL="http://www.ontologydesignpatterns.org/ont/dul/DUL.owl",r.SIO=s.Namespace("http://semanticscience.org/resource/"),n.SIO="http://semanticscience.org/ontology/sio.owl",r.ACL=s.Namespace("http://www.w3.org/ns/auth/acl#"),n.ACL="http://www.w3.org/ns/auth/acl",r.TET=s.Namespace("http://www.pdflib.com/XML/TET5/TET-5.0/"),n.TET="http://www.pdflib.com/XML/TET5/TET-5.0",r.PROV=s.Namespace("http://www.w3.org/ns/prov#"),n.PROV="http://www.w3.org/ns/prov#",r.ISOADR=s.Namespace("http://reference.data.gov.au/def/ont/iso19160-1-address#"),n.ISOADR="http://reference.data.gov.au/def/ont/iso19160-1-address",r.SKOS=s.Namespace("http://www.w3.org/2004/02/skos/core#"),n.SKOS="http://www.w3.org/2004/02/skos/core",r.OM=s.Namespace("http://def.seegrid.csiro.au/isotc211/iso19156/2011/observation#"),n.OM="http://def.seegrid.csiro.au/isotc211/iso19156/2011/observation",r.GEO=s.Namespace("http://www.w3.org/2003/01/geo/wgs84_pos#"),n.GEO="http://www.w3.org/2003/01/geo/wgs84_pos",r.OPMV=s.Namespace("http://purl.org/net/opmv/ns#"),n.OPMV="http://purl.org/net/opmv/ns#",r.BIOTOP=s.Namespace("http://purl.org/biotop/biotop.owl#"),n.BIOTOP="http://purl.org/biotop/biotop.owl",r.GN=s.Namespace("http://www.geonames.org/ontology#"),n.GN="http://www.geonames.org/ontology",r.EVENT=s.Namespace("http://purl.org/NET/c4dm/event.owl#"),n.EVENT="http://purl.org/NET/c4dm/event.owl",r.PEXT=s.Namespace("http://www.ontotext.com/proton/protonext#"),n.PEXT="http://www.ontotext.com/proton/protonext",r.PICO=s.Namespace("http://data.cochrane.org/ontologies/pico/"),n.PICO="http://data.cochrane.org/ontologies/pico/",r.FRBR=s.Namespace("http://purl.org/vocab/frbr/core#"),n.FRBR="http://purl.org/vocab/frbr/core",r.CON=s.Namespace("http://www.w3.org/2000/10/swap/pim/contact#"),n.CON="http://www.w3.org/2000/10/swap/pim/contact",r.DBPEDIA=s.Namespace("http://dbpedia.org/ontology/"),n.DBPEDIA="http://dbpedia.org/ontology/",r.MD=s.Namespace("http://def.seegrid.csiro.au/isotc211/iso19115/2003/metadata#"),n.MD="http://def.seegrid.csiro.au/isotc211/iso19115/2003/metadata",r.GR=s.Namespace("http://purl.org/goodrelations/v1#"),n.GR="http://purl.org/goodrelations/v1",r.JUSO=s.Namespace("http://rdfs.co/juso/"),n.JUSO="http://rdfs.co/juso/",r.SP=s.Namespace("http://spinrdf.org/sp#"),n.SP="http://spinrdf.org/sp",r.RDFG=s.Namespace("http://www.w3.org/2004/03/trix/rdfg-1/"),n.RDFG="http://www.w3.org/2004/03/trix/rdfg-1/",r.BIBO=s.Namespace("http://purl.org/ontology/bibo/"),n.BIBO="http://purl.org/ontology/bibo/",r.OV=s.Namespace("http://open.vocab.org/terms/"),n.OV="http://open.vocab.org/terms",r.UNIT=s.Namespace("http://data.nasa.gov/qudt/owl/unit#"),n.UNIT="http://data.qudt.org/qudt/owl/1.0.0/unit.owl",r.QUANTITY=s.Namespace("http://data.nasa.gov/qudt/owl/quantity#"),n.QUANTITY="http://data.qudt.org/qudt/owl/1.0.0/unit.owl",r.QUDT=s.Namespace("http://data.nasa.gov/qudt/owl/qudt#"),n.QUDT="http://data.qudt.org/qudt/owl/1.0.0/unit.owl",r.DQV=s.Namespace("http://www.w3.org/ns/dqv#"),n.DQV="http://www.w3.org/ns/dqv",r.BIO=s.Namespace("http://purl.org/vocab/bio/0.1/"),n.BIO="http://purl.org/vocab/bio/0.1/",r.RAMI=s.Namespace("http://iais.fraunhofer.de/vocabs/rami#"),n.RAMI="https://w3id.org/i40/rami/",r.SEAS=s.Namespace("https://w3id.org/seas/"),n.SEAS="https://w3id.org/seas/",r.CC=s.Namespace("http://creativecommons.org/ns#"),n.CC="http://creativecommons.org/ns",r.TEMPORAL=s.Namespace("http://franz.com/ns/allegrograph/3.0/temporal/"),n.TEMPORAL="http://franz.com/ns/allegrograph/3.0/temporal/",r.XSD=s.Namespace("http://www.w3.org/2001/XMLSchema#"),n.XSD="http://www.w3.org/2001/XMLSchema",r.OBO=s.Namespace("http://purl.obolibrary.org/obo/"),n.OBO="http://purl.obolibrary.org/obo/obi.owl",r.DCTERMS=s.Namespace("http://purl.org/dc/terms/"),n.DCTERMS="http://purl.org/dc/terms/",r.LINK=s.Namespace("http://www.w3.org/2007/ont/link#"),n.LINK="http://www.w3.org/2007/ont/link",r.COGS=s.Namespace("http://vocab.deri.ie/cogs#"),n.COGS="http://vocab.deri.ie/cogs",r.OCDS=s.Namespace("http://purl.org/onto-ocds/ocds#"),n.OCDS="http://purl.org/onto-ocds/ocds",r.PAY=s.Namespace("http://reference.data.gov.uk/def/payment#"),n.PAY="http://reference.data.gov.uk/def/payment#",r.ORG=s.Namespace("http://www.w3.org/ns/org#"),n.ORG="http://www.w3.org/ns/org#",r.IANA=s.Namespace("http://www.w3.org/ns/iana/media-types/application/"),n.IANA="http://www.w3.org/ns/iana/media-types/application/",r.LINKS=s.Namespace("http://www.iana.org/assignments/link-relations/"),n.LINKS="http://www.iana.org/assignments/link-relations",r.HTTPH=s.Namespace("http://www.w3.org/2007/ont/httph#"),n.HTTPH="http://www.w3.org/2007/ont/httph",r.TL=s.Namespace("http://purl.org/NET/c4dm/timeline.owl#"),n.TL="http://purl.org/NET/c4dm/timeline.owl",r.VANN=s.Namespace("http://purl.org/vocab/vann/"),n.VANN="http://purl.org/vocab/vann/",r.FABIO=s.Namespace("http://purl.org/spar/fabio/"),n.FABIO="http://purl.org/spar/fabio",r.BOT=s.Namespace("https://w3id.org/bot#"),n.BOT="https://w3id.org/bot",r.SSN=s.Namespace("http://www.w3.org/ns/ssn/"),r.SOSA=s.Namespace("http://www.w3.org/ns/sosa/"),r.CDT=s.Namespace("http://w3id.org/lindt/custom_datatypes#"),r.DCT=s.Namespace("http://purl.org/dc/terms/"),r.SUR=s.Namespace("https://w3id.org/survey-ontology#"),r.SHBSPEC=s.Namespace("https://shb.graphmetrix.net/specifications/ontology#"),r.SHB=s.Namespace("https://shb.stage.graphmetrix.net/"),r.SHBSAND=s.Namespace("https://shbsandnessjoen.stage.graphmetrix.net/shb/"),r.SHBMOIRA=s.Namespace("https://shb.stage.graphmetrix.net/shb/"),r.IFOUR=s.Namespace("http://www.i4technology.no/node/"),r.CTO=s.Namespace("https://w3id.org/cto#"),r.SBEO=s.Namespace("https://w3id.org/sbeo#"),o.map(Object.keys(n),(function(e){i[r[e]().uri]=e})),l.b_capable=r.SIO("SIO_000586"),l.o_result=r.NEO("o_result"),l.i_function=r.NEO("i_function"),l.t_start=r.NEO("t_start"),l.t_end=r.NEO("t_end"),l.i_attribute=r.NEO("i_attribute"),l.i_entity=r.NEO("i_entity"),l.o_type=r.NEO("o_type"),l.f_cause=r.NEO("f_cause"),l.t_execute=r.OBO("OBI_0000308"),l.i_input=r.SIO("SIO_000230"),l.o_output=r.SIO("SIO_000229"),l.m_status=r.SCHEMA("status"),l.m_cid=r.NEO("m_cid"),l.m_contains=r.SIO("SIO_000202"),l.m_port=r.NEO("m_port"),l.m_join=r.NEO("m_join"),l.m_rank=r.NEO("m_rank"),l.j_do=r.NEO("j_do"),l.m_lastChange=r.NEO("m_last-change"),l.t_start_event=r.NEO("t_start-event"),l.t_end_event=r.NEO("t_end-event"),l.m_version=r.DCTERMS("hasVersion"),l.m_graph_prefix=r.VANN("preferredNamespacePrefix"),l.m_label=r.RDFS("label"),l.f_tag=r.TAG("tag"),l.n3={},l.n3.i_function=c.termFromId(l.i_function.value),l.n3.o_result=c.termFromId(l.o_result.value),l.n3.t_start=c.termFromId(l.t_start.value),l.n3.i_input=c.termFromId(l.i_input.value),l.n3.o_output=c.termFromId(l.o_output.value),l.n3.f_cause=c.termFromId(l.f_cause.value),l.n3.t_execute=c.termFromId(l.t_execute.value),l.n3.m_rank=c.termFromId(l.m_rank.value),l.predicates=[l.o_result,l.i_function,l.t_start,l.t_end,l.i_attribute,l.i_entity,l.o_type,l.f_cause,l.i_input,l.o_output,l.t_execute,l.t_start_event,l.t_end_event];var h={};h.string=r.XSD("string"),h.integer=r.XSD("integer"),h.dateTime=r.XSD("dateTime");var g="https://trinity.graphmetrix.net/node/",m="https://trinapp.graphmetrix.net/node/";u.w_trinapp_cde=s.sym(m+"t_82"),u.w_trinapp_crosslink=s.sym(g+"t_2cf"),d.f_crosslink_start=s.sym(g+"t_2cf"),d.f_crosslink_review_approve=s.sym(g+"t_2cq"),u.w_trinapp_files=s.sym(m+"t_88"),u.w_trinapp_launchpad=s.sym(m+"t_7i"),u.w_trinapp_oneworld=s.sym(m+"t_7s"),u.w_trinapp_projects=s.sym(m+"t_jy"),u.w_trinapp_store=s.sym(m+"t_1kt"),u.w_trinapp_add_employee=s.sym(g+"t_1g3"),d.f_add_employee=s.sym(g+"t_1g3"),u.w_trinapp_add_member=s.sym(g+"t_20y"),d.f_add_member=s.sym(g+"t_20y"),u.w_trinapp_add_collaborator=s.sym(g+"t_46x"),d.f_add_collaborator=s.sym(g+"t_46x"),u.w_trinapp_add_project=s.sym(g+"t_27e"),d.f_add_project_trinpod=s.sym(g+"t_27e"),u.w_trinapp_add_building=s.sym(g+"t_276"),d.f_add_building_trinpod=s.sym(g+"t_276"),u.w_trinapp_add_business_pod=s.sym(g+"t_26a"),d.f_add_business_trinpod=s.sym(g+"t_26a"),d.f_add_site_trinpod=s.sym(g+"t_2m7"),d.f_add_organization_trinpod=s.sym(g+"t_2mk"),d.f_add_suborg_trinpod=s.sym(g+"t_2mx"),d.f_add_group_trinpod=s.sym(g+"t_2na"),u.w_trinapp_remove_employee=s.sym(g+"t_16d"),d.f_remove_employee=s.sym(g+"t_16d"),u.w_trinapp_remove_member=s.sym(g+"t_20t"),d.f_remove_member=s.sym(g+"t_20t"),u.w_trinapp_web=s.sym(m+"t_7n"),u.w_trinapp_append=s.sym(g+"t_29g"),d.f_solid_append=s.sym(g+"t_29g"),u.w_trinapp_control=s.sym(g+"t_29k"),d.f_solid_control=s.sym(g+"t_29k"),u.w_trinapp_read=s.sym(g+"trinity:t_297"),d.f_solid_read=s.sym(g+"trinity:t_297"),u.w_trinapp_write=s.sym(g+"t_28z"),d.f_solid_write=s.sym(g+"t_28z");var p={};Object.keys(r).forEach((function(e){p[e]=r[e]().value}))}});
//# sourceMappingURL=app.14e24c11.js.map